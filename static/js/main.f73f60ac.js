/*! For license information please see main.f73f60ac.js.LICENSE.txt */
!function(){var e={110:function(e,t,n){"use strict";var r=n(309),a={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},i={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},o={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function u(e){return r.isMemo(e)?o:s[e.$$typeof]||a}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=o;var c=Object.defineProperty,l=Object.getOwnPropertyNames,f=Object.getOwnPropertySymbols,h=Object.getOwnPropertyDescriptor,p=Object.getPrototypeOf,d=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(d){var a=p(n);a&&a!==d&&e(t,a,r)}var o=l(n);f&&(o=o.concat(f(n)));for(var s=u(t),v=u(n),m=0;m<o.length;++m){var y=o[m];if(!i[y]&&(!r||!r[y])&&(!v||!v[y])&&(!s||!s[y])){var g=h(n,y);try{c(t,y,g)}catch(b){}}}}return t}},746:function(e,t){"use strict";var n="function"===typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,a=n?Symbol.for("react.portal"):60106,i=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,s=n?Symbol.for("react.profiler"):60114,u=n?Symbol.for("react.provider"):60109,c=n?Symbol.for("react.context"):60110,l=n?Symbol.for("react.async_mode"):60111,f=n?Symbol.for("react.concurrent_mode"):60111,h=n?Symbol.for("react.forward_ref"):60112,p=n?Symbol.for("react.suspense"):60113,d=n?Symbol.for("react.suspense_list"):60120,v=n?Symbol.for("react.memo"):60115,m=n?Symbol.for("react.lazy"):60116,y=n?Symbol.for("react.block"):60121,g=n?Symbol.for("react.fundamental"):60117,b=n?Symbol.for("react.responder"):60118,x=n?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case l:case f:case i:case s:case o:case p:return e;default:switch(e=e&&e.$$typeof){case c:case h:case m:case v:case u:return e;default:return t}}case a:return t}}}function k(e){return w(e)===f}t.AsyncMode=l,t.ConcurrentMode=f,t.ContextConsumer=c,t.ContextProvider=u,t.Element=r,t.ForwardRef=h,t.Fragment=i,t.Lazy=m,t.Memo=v,t.Portal=a,t.Profiler=s,t.StrictMode=o,t.Suspense=p,t.isAsyncMode=function(e){return k(e)||w(e)===l},t.isConcurrentMode=k,t.isContextConsumer=function(e){return w(e)===c},t.isContextProvider=function(e){return w(e)===u},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===r},t.isForwardRef=function(e){return w(e)===h},t.isFragment=function(e){return w(e)===i},t.isLazy=function(e){return w(e)===m},t.isMemo=function(e){return w(e)===v},t.isPortal=function(e){return w(e)===a},t.isProfiler=function(e){return w(e)===s},t.isStrictMode=function(e){return w(e)===o},t.isSuspense=function(e){return w(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===i||e===f||e===s||e===o||e===p||e===d||"object"===typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===v||e.$$typeof===u||e.$$typeof===c||e.$$typeof===h||e.$$typeof===g||e.$$typeof===b||e.$$typeof===x||e.$$typeof===y)},t.typeOf=w},309:function(e,t,n){"use strict";e.exports=n(746)},463:function(e,t,n){"use strict";var r=n(791),a=n(296);function i(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,s={};function u(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)o.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),f=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},d={};function v(e,t,n,r,a,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=a,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var m={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){m[e]=new v(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];m[t]=new v(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){m[e]=new v(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){m[e]=new v(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){m[e]=new v(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){m[e]=new v(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){m[e]=new v(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){m[e]=new v(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){m[e]=new v(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function g(e){return e[1].toUpperCase()}function b(e,t,n,r){var a=m.hasOwnProperty(t)?m[t]:null;(null!==a?0!==a.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,a,r)&&(n=null),r||null===a?function(e){return!!f.call(d,e)||!f.call(p,e)&&(h.test(e)?d[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):a.mustUseProperty?e[a.propertyName]=null===n?3!==a.type&&"":n:(t=a.attributeName,r=a.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(a=a.type)||4===a&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,g);m[t]=new v(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,g);m[t]=new v(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,g);m[t]=new v(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!1,!1)})),m.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){m[e]=new v(e,1,!1,e.toLowerCase(),null,!0,!0)}));var x=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),k=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),S=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),I=Symbol.for("react.provider"),T=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),_=Symbol.for("react.suspense"),R=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var M=Symbol.iterator;function F(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=M&&e[M]||e["@@iterator"])?e:null}var P,L=Object.assign;function B(e){if(void 0===P)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);P=t&&t[1]||""}return"\n"+P+e}var V=!1;function z(e,t){if(!e||V)return"";V=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s]){var u="\n"+a[o].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=o&&0<=s);break}}}finally{V=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?B(e):""}function U(e){switch(e.tag){case 5:return B(e.type);case 16:return B("Lazy");case 13:return B("Suspense");case 19:return B("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function W(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case k:return"Portal";case C:return"Profiler";case S:return"StrictMode";case _:return"Suspense";case R:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case I:return(e._context.displayName||"Context")+".Provider";case N:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case A:return null!==(t=e.displayName||null)?t:W(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return W(e(t))}catch(n){}}return null}function j(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return W(t);case 8:return t===S?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function G(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function q(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var a=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(e){r=""+e,i.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function X(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function $(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=G(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){Y(e,t);var n=G(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,G(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&X(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var a=0;a<n.length;a++)t["$"+n[a]]=!0;for(n=0;n<e.length;n++)a=t.hasOwnProperty("$"+e[n].value),e[n].selected!==a&&(e[n].selected=a),a&&r&&(e[n].defaultSelected=!0)}else{for(n=""+G(n),t=null,a=0;a<e.length;a++){if(e[a].value===n)return e[a].selected=!0,void(r&&(e[a].defaultSelected=!0));null!==t||e[a].disabled||(t=e[a])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(i(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ae(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(i(92));if(te(n)){if(1<n.length)throw Error(i(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:G(n)}}function ie(e,t){var n=G(t.value),r=G(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,fe=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var pe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},de=["Webkit","ms","Moz","O"];function ve(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||pe.hasOwnProperty(e)&&pe[e]?(""+t).trim():t+"px"}function me(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),a=ve(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,a):e[n]=a}}Object.keys(pe).forEach((function(e){de.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),pe[t]=pe[e]}))}));var ye=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ge(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(i(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(i(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(i(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(i(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xe=null;function we(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Ee=null,Se=null;function Ce(e){if(e=ba(e)){if("function"!==typeof ke)throw Error(i(280));var t=e.stateNode;t&&(t=wa(t),ke(e.stateNode,e.type,t))}}function Ie(e){Ee?Se?Se.push(e):Se=[e]:Ee=e}function Te(){if(Ee){var e=Ee,t=Se;if(Se=Ee=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Ne(e,t){return e(t)}function _e(){}var Re=!1;function Ae(e,t,n){if(Re)return e(t,n);Re=!0;try{return Ne(e,t,n)}finally{Re=!1,(null!==Ee||null!==Se)&&(_e(),Te())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var r=wa(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(i(231,t,typeof n));return n}var Oe=!1;if(l)try{var Me={};Object.defineProperty(Me,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Me,Me),window.removeEventListener("test",Me,Me)}catch(le){Oe=!1}function Fe(e,t,n,r,a,i,o,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var Pe=!1,Le=null,Be=!1,Ve=null,ze={onError:function(e){Pe=!0,Le=e}};function Ue(e,t,n,r,a,i,o,s,u){Pe=!1,Le=null,Fe.apply(ze,arguments)}function We(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ge(e){if(We(e)!==e)throw Error(i(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=We(e)))throw Error(i(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var o=a.alternate;if(null===o){if(null!==(r=a.return)){n=r;continue}break}if(a.child===o.child){for(o=a.child;o;){if(o===n)return Ge(a),e;if(o===r)return Ge(a),t;o=o.sibling}throw Error(i(188))}if(n.return!==r.return)n=a,r=o;else{for(var s=!1,u=a.child;u;){if(u===n){s=!0,n=a,r=o;break}if(u===r){s=!0,r=a,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=a;break}if(u===r){s=!0,r=o,n=a;break}u=u.sibling}if(!s)throw Error(i(189))}}if(n.alternate!==r)throw Error(i(190))}if(3!==n.tag)throw Error(i(188));return n.stateNode.current===n?e:t}(e))?qe(e):null}function qe(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=qe(e);if(null!==t)return t;e=e.sibling}return null}var Ke=a.unstable_scheduleCallback,Xe=a.unstable_cancelCallback,$e=a.unstable_shouldYield,Qe=a.unstable_requestPaint,Ye=a.unstable_now,Je=a.unstable_getCurrentPriorityLevel,Ze=a.unstable_ImmediatePriority,et=a.unstable_UserBlockingPriority,tt=a.unstable_NormalPriority,nt=a.unstable_LowPriority,rt=a.unstable_IdlePriority,at=null,it=null;var ot=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var ct=64,lt=4194304;function ft(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,a=e.suspendedLanes,i=e.pingedLanes,o=268435455&n;if(0!==o){var s=o&~a;0!==s?r=ft(s):0!==(i&=o)&&(r=ft(i))}else 0!==(o=n&~a)?r=ft(o):0!==i&&(r=ft(i));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&a)&&((a=r&-r)>=(i=t&-t)||16===a&&0!==(4194240&i)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-ot(t)),r|=e[n],t&=~a;return r}function pt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function dt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function vt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function mt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function gt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),a=1<<r;a&t|e[r]&t&&(e[r]|=t),n&=~a}}var bt=0;function xt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var wt,kt,Et,St,Ct,It=!1,Tt=[],Nt=null,_t=null,Rt=null,At=new Map,Dt=new Map,Ot=[],Mt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ft(e,t){switch(e){case"focusin":case"focusout":Nt=null;break;case"dragenter":case"dragleave":_t=null;break;case"mouseover":case"mouseout":Rt=null;break;case"pointerover":case"pointerout":At.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Pt(e,t,n,r,a,i){return null===e||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[a]},null!==t&&(null!==(t=ba(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==a&&-1===t.indexOf(a)&&t.push(a),e)}function Lt(e){var t=ga(e.target);if(null!==t){var n=We(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=je(n)))return e.blockedOn=t,void Ct(e.priority,(function(){Et(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Bt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=$t(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ba(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);xe=r,n.target.dispatchEvent(r),xe=null,t.shift()}return!0}function Vt(e,t,n){Bt(e)&&n.delete(t)}function zt(){It=!1,null!==Nt&&Bt(Nt)&&(Nt=null),null!==_t&&Bt(_t)&&(_t=null),null!==Rt&&Bt(Rt)&&(Rt=null),At.forEach(Vt),Dt.forEach(Vt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,It||(It=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,zt)))}function Wt(e){function t(t){return Ut(t,e)}if(0<Tt.length){Ut(Tt[0],e);for(var n=1;n<Tt.length;n++){var r=Tt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Nt&&Ut(Nt,e),null!==_t&&Ut(_t,e),null!==Rt&&Ut(Rt,e),At.forEach(t),Dt.forEach(t),n=0;n<Ot.length;n++)(r=Ot[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Ot.length&&null===(n=Ot[0]).blockedOn;)Lt(n),null===n.blockedOn&&Ot.shift()}var jt=x.ReactCurrentBatchConfig,Gt=!0;function Ht(e,t,n,r){var a=bt,i=jt.transition;jt.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=a,jt.transition=i}}function qt(e,t,n,r){var a=bt,i=jt.transition;jt.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=a,jt.transition=i}}function Kt(e,t,n,r){if(Gt){var a=$t(e,t,n,r);if(null===a)Gr(e,t,r,Xt,n),Ft(e,r);else if(function(e,t,n,r,a){switch(t){case"focusin":return Nt=Pt(Nt,e,t,n,r,a),!0;case"dragenter":return _t=Pt(_t,e,t,n,r,a),!0;case"mouseover":return Rt=Pt(Rt,e,t,n,r,a),!0;case"pointerover":var i=a.pointerId;return At.set(i,Pt(At.get(i)||null,e,t,n,r,a)),!0;case"gotpointercapture":return i=a.pointerId,Dt.set(i,Pt(Dt.get(i)||null,e,t,n,r,a)),!0}return!1}(a,e,t,n,r))r.stopPropagation();else if(Ft(e,r),4&t&&-1<Mt.indexOf(e)){for(;null!==a;){var i=ba(a);if(null!==i&&wt(i),null===(i=$t(e,t,n,r))&&Gr(e,t,r,Xt,n),i===a)break;a=i}null!==a&&r.stopPropagation()}else Gr(e,t,r,null,n)}}var Xt=null;function $t(e,t,n,r){if(Xt=null,null!==(e=ga(e=we(r))))if(null===(t=We(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=je(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Xt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Yt=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,r=n.length,a="value"in Yt?Yt.value:Yt.textContent,i=a.length;for(e=0;e<r&&n[e]===a[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===a[i-t];t++);return Zt=a.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function an(e){function t(t,n,r,a,i){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=a,this.target=i,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(a):a[o]);return this.isDefaultPrevented=(null!=a.defaultPrevented?a.defaultPrevented:!1===a.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,sn,un,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ln=an(cn),fn=L({},cn,{view:0,detail:0}),hn=an(fn),pn=L({},fn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(on=e.screenX-un.screenX,sn=e.screenY-un.screenY):sn=on=0,un=e),on)},movementY:function(e){return"movementY"in e?e.movementY:sn}}),dn=an(pn),vn=an(L({},pn,{dataTransfer:0})),mn=an(L({},fn,{relatedTarget:0})),yn=an(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),gn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=an(gn),xn=an(L({},cn,{data:0})),wn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Sn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function Cn(){return Sn}var In=L({},fn,{key:function(e){if(e.key){var t=wn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Tn=an(In),Nn=an(L({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),_n=an(L({},fn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Rn=an(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),An=L({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=an(An),On=[9,13,27,32],Mn=l&&"CompositionEvent"in window,Fn=null;l&&"documentMode"in document&&(Fn=document.documentMode);var Pn=l&&"TextEvent"in window&&!Fn,Ln=l&&(!Mn||Fn&&8<Fn&&11>=Fn),Bn=String.fromCharCode(32),Vn=!1;function zn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Wn=!1;var jn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!jn[e.type]:"textarea"===t}function Hn(e,t,n,r){Ie(r),0<(t=qr(t,"onChange")).length&&(n=new ln("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var qn=null,Kn=null;function Xn(e){Br(e,0)}function $n(e){if(K(xa(e)))return e}function Qn(e,t){if("change"===e)return t}var Yn=!1;if(l){var Jn;if(l){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Jn=Zn}else Jn=!1;Yn=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){qn&&(qn.detachEvent("onpropertychange",nr),Kn=qn=null)}function nr(e){if("value"===e.propertyName&&$n(Kn)){var t=[];Hn(t,Kn,e,we(e)),Ae(Xn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(qn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ar(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $n(Kn)}function ir(e,t){if("click"===e)return $n(t)}function or(e,t){if("input"===e||"change"===e)return $n(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var a=n[r];if(!f.call(t,a)||!sr(e[a],t[a]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function lr(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function fr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?fr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=X();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=X((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function dr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&fr(n.ownerDocument.documentElement,n)){if(null!==r&&pr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var a=n.textContent.length,i=Math.min(r.start,a);r=void 0===r.end?i:Math.min(r.end,a),!e.extend&&i>r&&(a=r,r=i,i=a),a=lr(n,i);var o=lr(n,r);a&&o&&(1!==e.rangeCount||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(a.node,a.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var vr=l&&"documentMode"in document&&11>=document.documentMode,mr=null,yr=null,gr=null,br=!1;function xr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==mr||mr!==X(r)||("selectionStart"in(r=mr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},gr&&ur(gr,r)||(gr=r,0<(r=qr(yr,"onSelect")).length&&(t=new ln("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}function wr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:wr("Animation","AnimationEnd"),animationiteration:wr("Animation","AnimationIteration"),animationstart:wr("Animation","AnimationStart"),transitionend:wr("Transition","TransitionEnd")},Er={},Sr={};function Cr(e){if(Er[e])return Er[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Sr)return Er[e]=n[t];return e}l&&(Sr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Ir=Cr("animationend"),Tr=Cr("animationiteration"),Nr=Cr("animationstart"),_r=Cr("transitionend"),Rr=new Map,Ar="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){Rr.set(e,t),u(t,[e])}for(var Or=0;Or<Ar.length;Or++){var Mr=Ar[Or];Dr(Mr.toLowerCase(),"on"+(Mr[0].toUpperCase()+Mr.slice(1)))}Dr(Ir,"onAnimationEnd"),Dr(Tr,"onAnimationIteration"),Dr(Nr,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(_r,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Pr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,a,o,s,u,c){if(Ue.apply(this,arguments),Pe){if(!Pe)throw Error(i(198));var l=Le;Pe=!1,Le=null,Be||(Be=!0,Ve=l)}}(r,t,void 0,e),e.currentTarget=null}function Br(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],a=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var s=r[o],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==i&&a.isPropagationStopped())break e;Lr(a,s,c),i=u}else for(o=0;o<r.length;o++){if(u=(s=r[o]).instance,c=s.currentTarget,s=s.listener,u!==i&&a.isPropagationStopped())break e;Lr(a,s,c),i=u}}}if(Be)throw e=Ve,Be=!1,Ve=null,e}function Vr(e,t){var n=t[va];void 0===n&&(n=t[va]=new Set);var r=e+"__bubble";n.has(r)||(jr(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),jr(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Wr(e){if(!e[Ur]){e[Ur]=!0,o.forEach((function(t){"selectionchange"!==t&&(Pr.has(t)||zr(t,!1,e),zr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,zr("selectionchange",!1,t))}}function jr(e,t,n,r){switch(Qt(t)){case 1:var a=Ht;break;case 4:a=qt;break;default:a=Kt}n=a.bind(null,t,n,e),a=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(a=!0),r?void 0!==a?e.addEventListener(t,n,{capture:!0,passive:a}):e.addEventListener(t,n,!0):void 0!==a?e.addEventListener(t,n,{passive:a}):e.addEventListener(t,n,!1)}function Gr(e,t,n,r,a){var i=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var s=r.stateNode.containerInfo;if(s===a||8===s.nodeType&&s.parentNode===a)break;if(4===o)for(o=r.return;null!==o;){var u=o.tag;if((3===u||4===u)&&((u=o.stateNode.containerInfo)===a||8===u.nodeType&&u.parentNode===a))return;o=o.return}for(;null!==s;){if(null===(o=ga(s)))return;if(5===(u=o.tag)||6===u){r=i=o;continue e}s=s.parentNode}}r=r.return}Ae((function(){var r=i,a=we(n),o=[];e:{var s=Rr.get(e);if(void 0!==s){var u=ln,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":u=Tn;break;case"focusin":c="focus",u=mn;break;case"focusout":c="blur",u=mn;break;case"beforeblur":case"afterblur":u=mn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=dn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=vn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=_n;break;case Ir:case Tr:case Nr:u=yn;break;case _r:u=Rn;break;case"scroll":u=hn;break;case"wheel":u=Dn;break;case"copy":case"cut":case"paste":u=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Nn}var l=0!==(4&t),f=!l&&"scroll"===e,h=l?null!==s?s+"Capture":null:s;l=[];for(var p,d=r;null!==d;){var v=(p=d).stateNode;if(5===p.tag&&null!==v&&(p=v,null!==h&&(null!=(v=De(d,h))&&l.push(Hr(d,v,p)))),f)break;d=d.return}0<l.length&&(s=new u(s,c,null,n,a),o.push({event:s,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===xe||!(c=n.relatedTarget||n.fromElement)||!ga(c)&&!c[da])&&(u||s)&&(s=a.window===a?a:(s=a.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=r,null!==(c=(c=n.relatedTarget||n.toElement)?ga(c):null)&&(c!==(f=We(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=r),u!==c)){if(l=dn,v="onMouseLeave",h="onMouseEnter",d="mouse","pointerout"!==e&&"pointerover"!==e||(l=Nn,v="onPointerLeave",h="onPointerEnter",d="pointer"),f=null==u?s:xa(u),p=null==c?s:xa(c),(s=new l(v,d+"leave",u,n,a)).target=f,s.relatedTarget=p,v=null,ga(a)===r&&((l=new l(h,d+"enter",c,n,a)).target=p,l.relatedTarget=f,v=l),f=v,u&&c)e:{for(h=c,d=0,p=l=u;p;p=Kr(p))d++;for(p=0,v=h;v;v=Kr(v))p++;for(;0<d-p;)l=Kr(l),d--;for(;0<p-d;)h=Kr(h),p--;for(;d--;){if(l===h||null!==h&&l===h.alternate)break e;l=Kr(l),h=Kr(h)}l=null}else l=null;null!==u&&Xr(o,s,u,l,!1),null!==c&&null!==f&&Xr(o,f,c,l,!0)}if("select"===(u=(s=r?xa(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var m=Qn;else if(Gn(s))if(Yn)m=or;else{m=ar;var y=rr}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=ir);switch(m&&(m=m(e,r))?Hn(o,m,n,a):(y&&y(e,s,r),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ee(s,"number",s.value)),y=r?xa(r):window,e){case"focusin":(Gn(y)||"true"===y.contentEditable)&&(mr=y,yr=r,gr=null);break;case"focusout":gr=yr=mr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,xr(o,n,a);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":xr(o,n,a)}var g;if(Mn)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Wn?zn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Wn&&(g=en()):(Jt="value"in(Yt=a)?Yt.value:Yt.textContent,Wn=!0)),0<(y=qr(r,b)).length&&(b=new xn(b,e,null,n,a),o.push({event:b,listeners:y}),g?b.data=g:null!==(g=Un(n))&&(b.data=g))),(g=Pn?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Vn=!0,Bn);case"textInput":return(e=t.data)===Bn&&Vn?null:e;default:return null}}(e,n):function(e,t){if(Wn)return"compositionend"===e||!Mn&&zn(e,t)?(e=en(),Zt=Jt=Yt=null,Wn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=qr(r,"onBeforeInput")).length&&(a=new xn("onBeforeInput","beforeinput",null,n,a),o.push({event:a,listeners:r}),a.data=g))}Br(o,t)}))}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var a=e,i=a.stateNode;5===a.tag&&null!==i&&(a=i,null!=(i=De(e,n))&&r.unshift(Hr(e,i,a)),null!=(i=De(e,t))&&r.push(Hr(e,i,a))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Xr(e,t,n,r,a){for(var i=t._reactName,o=[];null!==n&&n!==r;){var s=n,u=s.alternate,c=s.stateNode;if(null!==u&&u===r)break;5===s.tag&&null!==c&&(s=c,a?null!=(u=De(n,i))&&o.unshift(Hr(n,u,s)):a||null!=(u=De(n,i))&&o.push(Hr(n,u,s))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var $r=/\r\n?/g,Qr=/\u0000|\uFFFD/g;function Yr(e){return("string"===typeof e?e:""+e).replace($r,"\n").replace(Qr,"")}function Jr(e,t,n){if(t=Yr(t),Yr(e)!==t&&n)throw Error(i(425))}function Zr(){}var ea=null,ta=null;function na(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ra="function"===typeof setTimeout?setTimeout:void 0,aa="function"===typeof clearTimeout?clearTimeout:void 0,ia="function"===typeof Promise?Promise:void 0,oa="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof ia?function(e){return ia.resolve(null).then(e).catch(sa)}:ra;function sa(e){setTimeout((function(){throw e}))}function ua(e,t){var n=t,r=0;do{var a=n.nextSibling;if(e.removeChild(n),a&&8===a.nodeType)if("/$"===(n=a.data)){if(0===r)return e.removeChild(a),void Wt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=a}while(n);Wt(t)}function ca(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function la(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var fa=Math.random().toString(36).slice(2),ha="__reactFiber$"+fa,pa="__reactProps$"+fa,da="__reactContainer$"+fa,va="__reactEvents$"+fa,ma="__reactListeners$"+fa,ya="__reactHandles$"+fa;function ga(e){var t=e[ha];if(t)return t;for(var n=e.parentNode;n;){if(t=n[da]||n[ha]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=la(e);null!==e;){if(n=e[ha])return n;e=la(e)}return t}n=(e=n).parentNode}return null}function ba(e){return!(e=e[ha]||e[da])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function xa(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(i(33))}function wa(e){return e[pa]||null}var ka=[],Ea=-1;function Sa(e){return{current:e}}function Ca(e){0>Ea||(e.current=ka[Ea],ka[Ea]=null,Ea--)}function Ia(e,t){Ea++,ka[Ea]=e.current,e.current=t}var Ta={},Na=Sa(Ta),_a=Sa(!1),Ra=Ta;function Aa(e,t){var n=e.type.contextTypes;if(!n)return Ta;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Da(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Oa(){Ca(_a),Ca(Na)}function Ma(e,t,n){if(Na.current!==Ta)throw Error(i(168));Ia(Na,t),Ia(_a,n)}function Fa(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var a in r=r.getChildContext())if(!(a in t))throw Error(i(108,j(e)||"Unknown",a));return L({},n,r)}function Pa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ta,Ra=Na.current,Ia(Na,e),Ia(_a,_a.current),!0}function La(e,t,n){var r=e.stateNode;if(!r)throw Error(i(169));n?(e=Fa(e,t,Ra),r.__reactInternalMemoizedMergedChildContext=e,Ca(_a),Ca(Na),Ia(Na,e)):Ca(_a),Ia(_a,n)}var Ba=null,Va=!1,za=!1;function Ua(e){null===Ba?Ba=[e]:Ba.push(e)}function Wa(){if(!za&&null!==Ba){za=!0;var e=0,t=bt;try{var n=Ba;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ba=null,Va=!1}catch(a){throw null!==Ba&&(Ba=Ba.slice(e+1)),Ke(Ze,Wa),a}finally{bt=t,za=!1}}return null}var ja=[],Ga=0,Ha=null,qa=0,Ka=[],Xa=0,$a=null,Qa=1,Ya="";function Ja(e,t){ja[Ga++]=qa,ja[Ga++]=Ha,Ha=e,qa=t}function Za(e,t,n){Ka[Xa++]=Qa,Ka[Xa++]=Ya,Ka[Xa++]=$a,$a=e;var r=Qa;e=Ya;var a=32-ot(r)-1;r&=~(1<<a),n+=1;var i=32-ot(t)+a;if(30<i){var o=a-a%5;i=(r&(1<<o)-1).toString(32),r>>=o,a-=o,Qa=1<<32-ot(t)+a|n<<a|r,Ya=i+e}else Qa=1<<i|n<<a|r,Ya=e}function ei(e){null!==e.return&&(Ja(e,1),Za(e,1,0))}function ti(e){for(;e===Ha;)Ha=ja[--Ga],ja[Ga]=null,qa=ja[--Ga],ja[Ga]=null;for(;e===$a;)$a=Ka[--Xa],Ka[Xa]=null,Ya=Ka[--Xa],Ka[Xa]=null,Qa=Ka[--Xa],Ka[Xa]=null}var ni=null,ri=null,ai=!1,ii=null;function oi(e,t){var n=Ac(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function si(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ni=e,ri=ca(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ni=e,ri=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==$a?{id:Qa,overflow:Ya}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ac(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ni=e,ri=null,!0);default:return!1}}function ui(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ci(e){if(ai){var t=ri;if(t){var n=t;if(!si(e,t)){if(ui(e))throw Error(i(418));t=ca(n.nextSibling);var r=ni;t&&si(e,t)?oi(r,n):(e.flags=-4097&e.flags|2,ai=!1,ni=e)}}else{if(ui(e))throw Error(i(418));e.flags=-4097&e.flags|2,ai=!1,ni=e}}}function li(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ni=e}function fi(e){if(e!==ni)return!1;if(!ai)return li(e),ai=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!na(e.type,e.memoizedProps)),t&&(t=ri)){if(ui(e))throw hi(),Error(i(418));for(;t;)oi(e,t),t=ca(t.nextSibling)}if(li(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(i(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){ri=ca(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}ri=null}}else ri=ni?ca(e.stateNode.nextSibling):null;return!0}function hi(){for(var e=ri;e;)e=ca(e.nextSibling)}function pi(){ri=ni=null,ai=!1}function di(e){null===ii?ii=[e]:ii.push(e)}var vi=x.ReactCurrentBatchConfig;function mi(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var yi=Sa(null),gi=null,bi=null,xi=null;function wi(){xi=bi=gi=null}function ki(e){var t=yi.current;Ca(yi),e._currentValue=t}function Ei(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Si(e,t){gi=e,xi=bi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xs=!0),e.firstContext=null)}function Ci(e){var t=e._currentValue;if(xi!==e)if(e={context:e,memoizedValue:t,next:null},null===bi){if(null===gi)throw Error(i(308));bi=e,gi.dependencies={lanes:0,firstContext:e}}else bi=bi.next=e;return t}var Ii=null;function Ti(e){null===Ii?Ii=[e]:Ii.push(e)}function Ni(e,t,n,r){var a=t.interleaved;return null===a?(n.next=n,Ti(t)):(n.next=a.next,a.next=n),t.interleaved=n,_i(e,r)}function _i(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Ri=!1;function Ai(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Di(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Oi(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Mi(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Nu)){var a=r.pending;return null===a?t.next=t:(t.next=a.next,a.next=t),r.pending=t,_i(e,n)}return null===(a=r.interleaved)?(t.next=t,Ti(r)):(t.next=a.next,a.next=t),r.interleaved=t,_i(e,n)}function Fi(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}function Pi(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Li(e,t,n,r){var a=e.updateQueue;Ri=!1;var i=a.firstBaseUpdate,o=a.lastBaseUpdate,s=a.shared.pending;if(null!==s){a.shared.pending=null;var u=s,c=u.next;u.next=null,null===o?i=c:o.next=c,o=u;var l=e.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==o&&(null===s?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(null!==i){var f=a.baseState;for(o=0,l=c=u=null,s=i;;){var h=s.lane,p=s.eventTime;if((r&h)===h){null!==l&&(l=l.next={eventTime:p,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var d=e,v=s;switch(h=t,p=n,v.tag){case 1:if("function"===typeof(d=v.payload)){f=d.call(p,f,h);break e}f=d;break e;case 3:d.flags=-65537&d.flags|128;case 0:if(null===(h="function"===typeof(d=v.payload)?d.call(p,f,h):d)||void 0===h)break e;f=L({},f,h);break e;case 2:Ri=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(h=a.effects)?a.effects=[s]:h.push(s))}else p={eventTime:p,lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(c=l=p,u=f):l=l.next=p,o|=h;if(null===(s=s.next)){if(null===(s=a.shared.pending))break;s=(h=s).next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}if(null===l&&(u=f),a.baseState=u,a.firstBaseUpdate=c,a.lastBaseUpdate=l,null!==(t=a.shared.interleaved)){a=t;do{o|=a.lane,a=a.next}while(a!==t)}else null===i&&(a.shared.lanes=0);Pu|=o,e.lanes=o,e.memoizedState=f}}function Bi(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(i(191,a));a.call(r)}}}var Vi=(new r.Component).refs;function zi(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var Ui={isMounted:function(e){return!!(e=e._reactInternals)&&We(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=Oi(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Mi(e,i,a))&&(nc(t,e,a,r),Fi(t,e,a))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),a=tc(e),i=Oi(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),null!==(t=Mi(e,i,a))&&(nc(t,e,a,r),Fi(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),a=Oi(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),null!==(t=Mi(e,a,r))&&(nc(t,e,r,n),Fi(t,e,r))}};function Wi(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(a,i))}function ji(e,t,n){var r=!1,a=Ta,i=t.contextType;return"object"===typeof i&&null!==i?i=Ci(i):(a=Da(t)?Ra:Na.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?Aa(e,a):Ta),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=Ui,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Gi(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ui.enqueueReplaceState(t,t.state,null)}function Hi(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=Vi,Ai(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=Ci(i):(i=Da(t)?Ra:Na.current,a.context=Aa(e,i)),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(zi(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&Ui.enqueueReplaceState(a,a.state,null),Li(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4194308)}function qi(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(i(309));var r=n.stateNode}if(!r)throw Error(i(147,e));var a=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=a.refs;t===Vi&&(t=a.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(i(284));if(!n._owner)throw Error(i(290,e))}return e}function Ki(e,t){throw e=Object.prototype.toString.call(t),Error(i(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Xi(e){return(0,e._init)(e._payload)}function $i(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Lc(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function c(e,t,n,r){var i=n.type;return i===E?f(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===i||"object"===typeof i&&null!==i&&i.$$typeof===D&&Xi(i)===t.type)?((r=a(t,n.props)).ref=qi(e,t,n),r.return=e,r):((r=Mc(n.type,n.key,n.props,null,e.mode,r)).ref=qi(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Bc(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function f(e,t,n,r,i){return null===t||7!==t.tag?((t=Fc(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=Mc(t.type,t.key,t.props,null,e.mode,n)).ref=qi(e,null,t),n.return=e,n;case k:return(t=Bc(t,e.mode,n)).return=e,t;case D:return h(e,(0,t._init)(t._payload),n)}if(te(t)||F(t))return(t=Fc(t,e.mode,n,null)).return=e,t;Ki(e,t)}return null}function p(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==a?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===a?c(e,t,n,r):null;case k:return n.key===a?l(e,t,n,r):null;case D:return p(e,t,(a=n._init)(n._payload),r)}if(te(n)||F(n))return null!==a?null:f(e,t,n,r,null);Ki(e,n)}return null}function d(e,t,n,r,a){if("string"===typeof r&&""!==r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return c(t,e=e.get(null===r.key?n:r.key)||null,r,a);case k:return l(t,e=e.get(null===r.key?n:r.key)||null,r,a);case D:return d(e,t,n,(0,r._init)(r._payload),a)}if(te(r)||F(r))return f(t,e=e.get(n)||null,r,a,null);Ki(t,r)}return null}function v(a,i,s,u){for(var c=null,l=null,f=i,v=i=0,m=null;null!==f&&v<s.length;v++){f.index>v?(m=f,f=null):m=f.sibling;var y=p(a,f,s[v],u);if(null===y){null===f&&(f=m);break}e&&f&&null===y.alternate&&t(a,f),i=o(y,i,v),null===l?c=y:l.sibling=y,l=y,f=m}if(v===s.length)return n(a,f),ai&&Ja(a,v),c;if(null===f){for(;v<s.length;v++)null!==(f=h(a,s[v],u))&&(i=o(f,i,v),null===l?c=f:l.sibling=f,l=f);return ai&&Ja(a,v),c}for(f=r(a,f);v<s.length;v++)null!==(m=d(f,a,v,s[v],u))&&(e&&null!==m.alternate&&f.delete(null===m.key?v:m.key),i=o(m,i,v),null===l?c=m:l.sibling=m,l=m);return e&&f.forEach((function(e){return t(a,e)})),ai&&Ja(a,v),c}function m(a,s,u,c){var l=F(u);if("function"!==typeof l)throw Error(i(150));if(null==(u=l.call(u)))throw Error(i(151));for(var f=l=null,v=s,m=s=0,y=null,g=u.next();null!==v&&!g.done;m++,g=u.next()){v.index>m?(y=v,v=null):y=v.sibling;var b=p(a,v,g.value,c);if(null===b){null===v&&(v=y);break}e&&v&&null===b.alternate&&t(a,v),s=o(b,s,m),null===f?l=b:f.sibling=b,f=b,v=y}if(g.done)return n(a,v),ai&&Ja(a,m),l;if(null===v){for(;!g.done;m++,g=u.next())null!==(g=h(a,g.value,c))&&(s=o(g,s,m),null===f?l=g:f.sibling=g,f=g);return ai&&Ja(a,m),l}for(v=r(a,v);!g.done;m++,g=u.next())null!==(g=d(v,a,m,g.value,c))&&(e&&null!==g.alternate&&v.delete(null===g.key?m:g.key),s=o(g,s,m),null===f?l=g:f.sibling=g,f=g);return e&&v.forEach((function(e){return t(a,e)})),ai&&Ja(a,m),l}return function e(r,i,o,u){if("object"===typeof o&&null!==o&&o.type===E&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case w:e:{for(var c=o.key,l=i;null!==l;){if(l.key===c){if((c=o.type)===E){if(7===l.tag){n(r,l.sibling),(i=a(l,o.props.children)).return=r,r=i;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&Xi(c)===l.type){n(r,l.sibling),(i=a(l,o.props)).ref=qi(r,l,o),i.return=r,r=i;break e}n(r,l);break}t(r,l),l=l.sibling}o.type===E?((i=Fc(o.props.children,r.mode,u,o.key)).return=r,r=i):((u=Mc(o.type,o.key,o.props,null,r.mode,u)).ref=qi(r,i,o),u.return=r,r=u)}return s(r);case k:e:{for(l=o.key;null!==i;){if(i.key===l){if(4===i.tag&&i.stateNode.containerInfo===o.containerInfo&&i.stateNode.implementation===o.implementation){n(r,i.sibling),(i=a(i,o.children||[])).return=r,r=i;break e}n(r,i);break}t(r,i),i=i.sibling}(i=Bc(o,r.mode,u)).return=r,r=i}return s(r);case D:return e(r,i,(l=o._init)(o._payload),u)}if(te(o))return v(r,i,o,u);if(F(o))return m(r,i,o,u);Ki(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==i&&6===i.tag?(n(r,i.sibling),(i=a(i,o)).return=r,r=i):(n(r,i),(i=Lc(o,r.mode,u)).return=r,r=i),s(r)):n(r,i)}}var Qi=$i(!0),Yi=$i(!1),Ji={},Zi=Sa(Ji),eo=Sa(Ji),to=Sa(Ji);function no(e){if(e===Ji)throw Error(i(174));return e}function ro(e,t){switch(Ia(to,t),Ia(eo,e),Ia(Zi,Ji),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ca(Zi),Ia(Zi,t)}function ao(){Ca(Zi),Ca(eo),Ca(to)}function io(e){no(to.current);var t=no(Zi.current),n=ue(t,e.type);t!==n&&(Ia(eo,e),Ia(Zi,n))}function oo(e){eo.current===e&&(Ca(Zi),Ca(eo))}var so=Sa(0);function uo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var co=[];function lo(){for(var e=0;e<co.length;e++)co[e]._workInProgressVersionPrimary=null;co.length=0}var fo=x.ReactCurrentDispatcher,ho=x.ReactCurrentBatchConfig,po=0,vo=null,mo=null,yo=null,go=!1,bo=!1,xo=0,wo=0;function ko(){throw Error(i(321))}function Eo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function So(e,t,n,r,a,o){if(po=o,vo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fo.current=null===e||null===e.memoizedState?ss:us,e=n(r,a),bo){o=0;do{if(bo=!1,xo=0,25<=o)throw Error(i(301));o+=1,yo=mo=null,t.updateQueue=null,fo.current=cs,e=n(r,a)}while(bo)}if(fo.current=os,t=null!==mo&&null!==mo.next,po=0,yo=mo=vo=null,go=!1,t)throw Error(i(300));return e}function Co(){var e=0!==xo;return xo=0,e}function Io(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===yo?vo.memoizedState=yo=e:yo=yo.next=e,yo}function To(){if(null===mo){var e=vo.alternate;e=null!==e?e.memoizedState:null}else e=mo.next;var t=null===yo?vo.memoizedState:yo.next;if(null!==t)yo=t,mo=e;else{if(null===e)throw Error(i(310));e={memoizedState:(mo=e).memoizedState,baseState:mo.baseState,baseQueue:mo.baseQueue,queue:mo.queue,next:null},null===yo?vo.memoizedState=yo=e:yo=yo.next=e}return yo}function No(e,t){return"function"===typeof t?t(e):t}function _o(e){var t=To(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=mo,a=r.baseQueue,o=n.pending;if(null!==o){if(null!==a){var s=a.next;a.next=o.next,o.next=s}r.baseQueue=a=o,n.pending=null}if(null!==a){o=a.next,r=r.baseState;var u=s=null,c=null,l=o;do{var f=l.lane;if((po&f)===f)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:e(r,l.action);else{var h={lane:f,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(u=c=h,s=r):c=c.next=h,vo.lanes|=f,Pu|=f}l=l.next}while(null!==l&&l!==o);null===c?s=r:c.next=u,sr(r,t.memoizedState)||(xs=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){a=e;do{o=a.lane,vo.lanes|=o,Pu|=o,a=a.next}while(a!==e)}else null===a&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ro(e){var t=To(),n=t.queue;if(null===n)throw Error(i(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,o=t.memoizedState;if(null!==a){n.pending=null;var s=a=a.next;do{o=e(o,s.action),s=s.next}while(s!==a);sr(o,t.memoizedState)||(xs=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Ao(){}function Do(e,t){var n=vo,r=To(),a=t(),o=!sr(r.memoizedState,a);if(o&&(r.memoizedState=a,xs=!0),r=r.queue,Go(Fo.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==yo&&1&yo.memoizedState.tag){if(n.flags|=2048,Vo(9,Mo.bind(null,n,r,a,t),void 0,null),null===_u)throw Error(i(349));0!==(30&po)||Oo(n,t,a)}return a}function Oo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Mo(e,t,n,r){t.value=n,t.getSnapshot=r,Po(t)&&Lo(e)}function Fo(e,t,n){return n((function(){Po(t)&&Lo(e)}))}function Po(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!sr(e,n)}catch(r){return!0}}function Lo(e){var t=_i(e,1);null!==t&&nc(t,e,1,-1)}function Bo(e){var t=Io();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:No,lastRenderedState:e},t.queue=e,e=e.dispatch=ns.bind(null,vo,e),[t.memoizedState,e]}function Vo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=vo.updateQueue)?(t={lastEffect:null,stores:null},vo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function zo(){return To().memoizedState}function Uo(e,t,n,r){var a=Io();vo.flags|=e,a.memoizedState=Vo(1|t,n,void 0,void 0===r?null:r)}function Wo(e,t,n,r){var a=To();r=void 0===r?null:r;var i=void 0;if(null!==mo){var o=mo.memoizedState;if(i=o.destroy,null!==r&&Eo(r,o.deps))return void(a.memoizedState=Vo(t,n,i,r))}vo.flags|=e,a.memoizedState=Vo(1|t,n,i,r)}function jo(e,t){return Uo(8390656,8,e,t)}function Go(e,t){return Wo(2048,8,e,t)}function Ho(e,t){return Wo(4,2,e,t)}function qo(e,t){return Wo(4,4,e,t)}function Ko(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Xo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Wo(4,4,Ko.bind(null,t,e),n)}function $o(){}function Qo(e,t){var n=To();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Eo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Yo(e,t){var n=To();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Eo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Jo(e,t,n){return 0===(21&po)?(e.baseState&&(e.baseState=!1,xs=!0),e.memoizedState=n):(sr(n,t)||(n=vt(),vo.lanes|=n,Pu|=n,e.baseState=!0),t)}function Zo(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ho.transition;ho.transition={};try{e(!1),t()}finally{bt=n,ho.transition=r}}function es(){return To().memoizedState}function ts(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},rs(e))as(t,n);else if(null!==(n=Ni(e,t,n,r))){nc(n,e,r,ec()),is(n,t,r)}}function ns(e,t,n){var r=tc(e),a={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(rs(e))as(t,a);else{var i=e.alternate;if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var o=t.lastRenderedState,s=i(o,n);if(a.hasEagerState=!0,a.eagerState=s,sr(s,o)){var u=t.interleaved;return null===u?(a.next=a,Ti(t)):(a.next=u.next,u.next=a),void(t.interleaved=a)}}catch(c){}null!==(n=Ni(e,t,a,r))&&(nc(n,e,r,a=ec()),is(n,t,r))}}function rs(e){var t=e.alternate;return e===vo||null!==t&&t===vo}function as(e,t){bo=go=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function is(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,gt(e,n)}}var os={readContext:Ci,useCallback:ko,useContext:ko,useEffect:ko,useImperativeHandle:ko,useInsertionEffect:ko,useLayoutEffect:ko,useMemo:ko,useReducer:ko,useRef:ko,useState:ko,useDebugValue:ko,useDeferredValue:ko,useTransition:ko,useMutableSource:ko,useSyncExternalStore:ko,useId:ko,unstable_isNewReconciler:!1},ss={readContext:Ci,useCallback:function(e,t){return Io().memoizedState=[e,void 0===t?null:t],e},useContext:Ci,useEffect:jo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Uo(4194308,4,Ko.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Uo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Uo(4,2,e,t)},useMemo:function(e,t){var n=Io();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Io();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=ts.bind(null,vo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Io().memoizedState=e},useState:Bo,useDebugValue:$o,useDeferredValue:function(e){return Io().memoizedState=e},useTransition:function(){var e=Bo(!1),t=e[0];return e=Zo.bind(null,e[1]),Io().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=vo,a=Io();if(ai){if(void 0===n)throw Error(i(407));n=n()}else{if(n=t(),null===_u)throw Error(i(349));0!==(30&po)||Oo(r,t,n)}a.memoizedState=n;var o={value:n,getSnapshot:t};return a.queue=o,jo(Fo.bind(null,r,o,e),[e]),r.flags|=2048,Vo(9,Mo.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=Io(),t=_u.identifierPrefix;if(ai){var n=Ya;t=":"+t+"R"+(n=(Qa&~(1<<32-ot(Qa)-1)).toString(32)+n),0<(n=xo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=wo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},us={readContext:Ci,useCallback:Qo,useContext:Ci,useEffect:Go,useImperativeHandle:Xo,useInsertionEffect:Ho,useLayoutEffect:qo,useMemo:Yo,useReducer:_o,useRef:zo,useState:function(){return _o(No)},useDebugValue:$o,useDeferredValue:function(e){return Jo(To(),mo.memoizedState,e)},useTransition:function(){return[_o(No)[0],To().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Do,useId:es,unstable_isNewReconciler:!1},cs={readContext:Ci,useCallback:Qo,useContext:Ci,useEffect:Go,useImperativeHandle:Xo,useInsertionEffect:Ho,useLayoutEffect:qo,useMemo:Yo,useReducer:Ro,useRef:zo,useState:function(){return Ro(No)},useDebugValue:$o,useDeferredValue:function(e){var t=To();return null===mo?t.memoizedState=e:Jo(t,mo.memoizedState,e)},useTransition:function(){return[Ro(No)[0],To().memoizedState]},useMutableSource:Ao,useSyncExternalStore:Do,useId:es,unstable_isNewReconciler:!1};function ls(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a,digest:null}}function fs(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function hs(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ps="function"===typeof WeakMap?WeakMap:Map;function ds(e,t,n){(n=Oi(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Gu||(Gu=!0,Hu=r),hs(0,t)},n}function vs(e,t,n){(n=Oi(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return r(a)},n.callback=function(){hs(0,t)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){hs(0,t),"function"!==typeof r&&(null===qu?qu=new Set([this]):qu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ms(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ps;var a=new Set;r.set(t,a)}else void 0===(a=r.get(t))&&(a=new Set,r.set(t,a));a.has(n)||(a.add(n),e=Cc.bind(null,e,t,n),t.then(e,e))}function ys(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function gs(e,t,n,r,a){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Oi(-1,1)).tag=2,Mi(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=a,e)}var bs=x.ReactCurrentOwner,xs=!1;function ws(e,t,n,r){t.child=null===e?Yi(t,null,n,r):Qi(t,e.child,n,r)}function ks(e,t,n,r,a){n=n.render;var i=t.ref;return Si(t,a),r=So(e,t,n,r,i,a),n=Co(),null===e||xs?(ai&&n&&ei(t),t.flags|=1,ws(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gs(e,t,a))}function Es(e,t,n,r,a){if(null===e){var i=n.type;return"function"!==typeof i||Dc(i)||void 0!==i.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Mc(n.type,null,r,t,t.mode,a)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,Ss(e,t,i,r,a))}if(i=e.child,0===(e.lanes&a)){var o=i.memoizedProps;if((n=null!==(n=n.compare)?n:ur)(o,r)&&e.ref===t.ref)return Gs(e,t,a)}return t.flags|=1,(e=Oc(i,r)).ref=t.ref,e.return=t,t.child=e}function Ss(e,t,n,r,a){if(null!==e){var i=e.memoizedProps;if(ur(i,r)&&e.ref===t.ref){if(xs=!1,t.pendingProps=r=i,0===(e.lanes&a))return t.lanes=e.lanes,Gs(e,t,a);0!==(131072&e.flags)&&(xs=!0)}}return Ts(e,t,n,r,a)}function Cs(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ia(Ou,Du),Du|=n;else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ia(Ou,Du),Du|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==i?i.baseLanes:n,Ia(Ou,Du),Du|=r}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ia(Ou,Du),Du|=r;return ws(e,t,a,n),t.child}function Is(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ts(e,t,n,r,a){var i=Da(n)?Ra:Na.current;return i=Aa(t,i),Si(t,a),n=So(e,t,n,r,i,a),r=Co(),null===e||xs?(ai&&r&&ei(t),t.flags|=1,ws(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,Gs(e,t,a))}function Ns(e,t,n,r,a){if(Da(n)){var i=!0;Pa(t)}else i=!1;if(Si(t,a),null===t.stateNode)js(e,t),ji(t,n,r),Hi(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var u=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ci(c):c=Aa(t,c=Da(n)?Ra:Na.current);var l=n.getDerivedStateFromProps,f="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;f||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||u!==c)&&Gi(t,o,r,c),Ri=!1;var h=t.memoizedState;o.state=h,Li(t,r,o,a),u=t.memoizedState,s!==r||h!==u||_a.current||Ri?("function"===typeof l&&(zi(t,n,l,r),u=t.memoizedState),(s=Ri||Wi(t,n,s,r,h,u,c))?(f||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=u),o.props=r,o.state=u,o.context=c,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Di(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:mi(t.type,s),o.props=c,f=t.pendingProps,h=o.context,"object"===typeof(u=n.contextType)&&null!==u?u=Ci(u):u=Aa(t,u=Da(n)?Ra:Na.current);var p=n.getDerivedStateFromProps;(l="function"===typeof p||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==f||h!==u)&&Gi(t,o,r,u),Ri=!1,h=t.memoizedState,o.state=h,Li(t,r,o,a);var d=t.memoizedState;s!==f||h!==d||_a.current||Ri?("function"===typeof p&&(zi(t,n,p,r),d=t.memoizedState),(c=Ri||Wi(t,n,c,r,h,d,u)||!1)?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,d,u),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,d,u)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=d),o.props=r,o.state=d,o.context=u,r=c):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return _s(e,t,n,r,i,a)}function _s(e,t,n,r,a,i){Is(e,t);var o=0!==(128&t.flags);if(!r&&!o)return a&&La(t,n,!1),Gs(e,t,i);r=t.stateNode,bs.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Qi(t,e.child,null,i),t.child=Qi(t,null,s,i)):ws(e,t,s,i),t.memoizedState=r.state,a&&La(t,n,!0),t.child}function Rs(e){var t=e.stateNode;t.pendingContext?Ma(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ma(0,t.context,!1),ro(e,t.containerInfo)}function As(e,t,n,r,a){return pi(),di(a),t.flags|=256,ws(e,t,n,r),t.child}var Ds,Os,Ms,Fs={dehydrated:null,treeContext:null,retryLane:0};function Ps(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ls(e,t,n){var r,a=t.pendingProps,o=so.current,s=!1,u=0!==(128&t.flags);if((r=u)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ia(so,1&o),null===e)return ci(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=a.children,e=a.fallback,s?(a=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&a)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=Pc(u,a,0,null),e=Fc(e,a,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=Ps(n),t.memoizedState=Fs,e):Bs(t,u));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,a,o,s){if(n)return 256&t.flags?(t.flags&=-257,Vs(e,t,s,r=fs(Error(i(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,a=t.mode,r=Pc({mode:"visible",children:r.children},a,0,null),(o=Fc(o,a,s,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Qi(t,e.child,null,s),t.child.memoizedState=Ps(s),t.memoizedState=Fs,o);if(0===(1&t.mode))return Vs(e,t,s,null);if("$!"===a.data){if(r=a.nextSibling&&a.nextSibling.dataset)var u=r.dgst;return r=u,Vs(e,t,s,r=fs(o=Error(i(419)),r,void 0))}if(u=0!==(s&e.childLanes),xs||u){if(null!==(r=_u)){switch(s&-s){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}0!==(a=0!==(a&(r.suspendedLanes|s))?0:a)&&a!==o.retryLane&&(o.retryLane=a,_i(e,a),nc(r,e,a,-1))}return vc(),Vs(e,t,s,r=fs(Error(i(421))))}return"$?"===a.data?(t.flags|=128,t.child=e.child,t=Tc.bind(null,e),a._reactRetry=t,null):(e=o.treeContext,ri=ca(a.nextSibling),ni=t,ai=!0,ii=null,null!==e&&(Ka[Xa++]=Qa,Ka[Xa++]=Ya,Ka[Xa++]=$a,Qa=e.id,Ya=e.overflow,$a=t),(t=Bs(t,r.children)).flags|=4096,t)}(e,t,u,a,r,o,n);if(s){s=a.fallback,u=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:a.children};return 0===(1&u)&&t.child!==o?((a=t.child).childLanes=0,a.pendingProps=c,t.deletions=null):(a=Oc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?s=Oc(r,s):(s=Fc(s,u,n,null)).flags|=2,s.return=t,a.return=t,a.sibling=s,t.child=a,a=s,s=t.child,u=null===(u=e.child.memoizedState)?Ps(n):{baseLanes:u.baseLanes|n,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~n,t.memoizedState=Fs,a}return e=(s=e.child).sibling,a=Oc(s,{mode:"visible",children:a.children}),0===(1&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=a,t.memoizedState=null,a}function Bs(e,t){return(t=Pc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Vs(e,t,n,r){return null!==r&&di(r),Qi(t,e.child,null,n),(e=Bs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zs(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ei(e.return,t,n)}function Us(e,t,n,r,a){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=a)}function Ws(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(ws(e,t,r.children,n),0!==(2&(r=so.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zs(e,n,t);else if(19===e.tag)zs(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ia(so,r),0===(1&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===uo(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),Us(t,!1,a,n,i);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===uo(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}Us(t,!0,n,null,i);break;case"together":Us(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function js(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Gs(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Pu|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(i(153));if(null!==t.child){for(n=Oc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Oc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Hs(e,t){if(!ai)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function qs(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=14680064&a.subtreeFlags,r|=14680064&a.flags,a.return=e,a=a.sibling;else for(a=e.child;null!==a;)n|=a.lanes|a.childLanes,r|=a.subtreeFlags,r|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ks(e,t,n){var r=t.pendingProps;switch(ti(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qs(t),null;case 1:case 17:return Da(t.type)&&Oa(),qs(t),null;case 3:return r=t.stateNode,ao(),Ca(_a),Ca(Na),lo(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(fi(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ii&&(oc(ii),ii=null))),qs(t),null;case 5:oo(t);var a=no(to.current);if(n=t.type,null!==e&&null!=t.stateNode)Os(e,t,n,r),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(i(166));return qs(t),null}if(e=no(Zi.current),fi(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[ha]=t,r[pa]=o,e=0!==(1&t.mode),n){case"dialog":Vr("cancel",r),Vr("close",r);break;case"iframe":case"object":case"embed":Vr("load",r);break;case"video":case"audio":for(a=0;a<Fr.length;a++)Vr(Fr[a],r);break;case"source":Vr("error",r);break;case"img":case"image":case"link":Vr("error",r),Vr("load",r);break;case"details":Vr("toggle",r);break;case"input":Q(r,o),Vr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Vr("invalid",r);break;case"textarea":ae(r,o),Vr("invalid",r)}for(var u in ge(n,o),a=null,o)if(o.hasOwnProperty(u)){var c=o[u];"children"===u?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),a=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Jr(r.textContent,c,e),a=["children",""+c]):s.hasOwnProperty(u)&&null!=c&&"onScroll"===u&&Vr("scroll",r)}switch(n){case"input":q(r),Z(r,o,!0);break;case"textarea":q(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=a,t.updateQueue=r,null!==r&&(t.flags|=4)}else{u=9===a.nodeType?a:a.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[ha]=t,e[pa]=r,Ds(e,t),t.stateNode=e;e:{switch(u=be(n,r),n){case"dialog":Vr("cancel",e),Vr("close",e),a=r;break;case"iframe":case"object":case"embed":Vr("load",e),a=r;break;case"video":case"audio":for(a=0;a<Fr.length;a++)Vr(Fr[a],e);a=r;break;case"source":Vr("error",e),a=r;break;case"img":case"image":case"link":Vr("error",e),Vr("load",e),a=r;break;case"details":Vr("toggle",e),a=r;break;case"input":Q(e,r),a=$(e,r),Vr("invalid",e);break;case"option":default:a=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},a=L({},r,{value:void 0}),Vr("invalid",e);break;case"textarea":ae(e,r),a=re(e,r),Vr("invalid",e)}for(o in ge(n,a),c=a)if(c.hasOwnProperty(o)){var l=c[o];"style"===o?me(e,l):"dangerouslySetInnerHTML"===o?null!=(l=l?l.__html:void 0)&&fe(e,l):"children"===o?"string"===typeof l?("textarea"!==n||""!==l)&&he(e,l):"number"===typeof l&&he(e,""+l):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(s.hasOwnProperty(o)?null!=l&&"onScroll"===o&&Vr("scroll",e):null!=l&&b(e,o,l,u))}switch(n){case"input":q(e),Z(e,r,!1);break;case"textarea":q(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+G(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof a.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return qs(t),null;case 6:if(e&&null!=t.stateNode)Ms(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(i(166));if(n=no(to.current),no(Zi.current),fi(t)){if(r=t.stateNode,n=t.memoizedProps,r[ha]=t,(o=r.nodeValue!==n)&&null!==(e=ni))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[ha]=t,t.stateNode=r}return qs(t),null;case 13:if(Ca(so),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ai&&null!==ri&&0!==(1&t.mode)&&0===(128&t.flags))hi(),pi(),t.flags|=98560,o=!1;else if(o=fi(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(i(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(i(317));o[ha]=t}else pi(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;qs(t),o=!1}else null!==ii&&(oc(ii),ii=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&so.current)?0===Mu&&(Mu=3):vc())),null!==t.updateQueue&&(t.flags|=4),qs(t),null);case 4:return ao(),null===e&&Wr(t.stateNode.containerInfo),qs(t),null;case 10:return ki(t.type._context),qs(t),null;case 19:if(Ca(so),null===(o=t.memoizedState))return qs(t),null;if(r=0!==(128&t.flags),null===(u=o.rendering))if(r)Hs(o,!1);else{if(0!==Mu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=uo(e))){for(t.flags|=128,Hs(o,!1),null!==(r=u.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(u=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=u.childLanes,o.lanes=u.lanes,o.child=u.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=u.memoizedProps,o.memoizedState=u.memoizedState,o.updateQueue=u.updateQueue,o.type=u.type,e=u.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ia(so,1&so.current|2),t.child}e=e.sibling}null!==o.tail&&Ye()>Wu&&(t.flags|=128,r=!0,Hs(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=uo(u))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Hs(o,!0),null===o.tail&&"hidden"===o.tailMode&&!u.alternate&&!ai)return qs(t),null}else 2*Ye()-o.renderingStartTime>Wu&&1073741824!==n&&(t.flags|=128,r=!0,Hs(o,!1),t.lanes=4194304);o.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=o.last)?n.sibling=u:t.child=u,o.last=u)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ye(),t.sibling=null,n=so.current,Ia(so,r?1&n|2:1&n),t):(qs(t),null);case 22:case 23:return fc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Du)&&(qs(t),6&t.subtreeFlags&&(t.flags|=8192)):qs(t),null;case 24:case 25:return null}throw Error(i(156,t.tag))}function Xs(e,t){switch(ti(t),t.tag){case 1:return Da(t.type)&&Oa(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return ao(),Ca(_a),Ca(Na),lo(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return oo(t),null;case 13:if(Ca(so),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(i(340));pi()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ca(so),null;case 4:return ao(),null;case 10:return ki(t.type._context),null;case 22:case 23:return fc(),null;default:return null}}Ds=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Os=function(e,t,n,r){var a=e.memoizedProps;if(a!==r){e=t.stateNode,no(Zi.current);var i,o=null;switch(n){case"input":a=$(e,a),r=$(e,r),o=[];break;case"select":a=L({},a,{value:void 0}),r=L({},r,{value:void 0}),o=[];break;case"textarea":a=re(e,a),r=re(e,r),o=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(l in ge(n,r),n=null,a)if(!r.hasOwnProperty(l)&&a.hasOwnProperty(l)&&null!=a[l])if("style"===l){var u=a[l];for(i in u)u.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?o||(o=[]):(o=o||[]).push(l,null));for(l in r){var c=r[l];if(u=null!=a?a[l]:void 0,r.hasOwnProperty(l)&&c!==u&&(null!=c||null!=u))if("style"===l)if(u){for(i in u)!u.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&u[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(o||(o=[]),o.push(l,n)),n=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(o=o||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(s.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&Vr("scroll",e),o||u===c||(o=[])):(o=o||[]).push(l,c))}n&&(o=o||[]).push("style",n);var l=o;(t.updateQueue=l)&&(t.flags|=4)}},Ms=function(e,t,n,r){n!==r&&(t.flags|=4)};var $s=!1,Qs=!1,Ys="function"===typeof WeakSet?WeakSet:Set,Js=null;function Zs(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Sc(e,t,r)}else n.current=null}function eu(e,t,n){try{n()}catch(r){Sc(e,t,r)}}var tu=!1;function nu(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var a=r=r.next;do{if((a.tag&e)===e){var i=a.destroy;a.destroy=void 0,void 0!==i&&eu(t,n,i)}a=a.next}while(a!==r)}}function ru(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function au(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function iu(e){var t=e.alternate;null!==t&&(e.alternate=null,iu(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[ha],delete t[pa],delete t[va],delete t[ma],delete t[ya])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ou(e){return 5===e.tag||3===e.tag||4===e.tag}function su(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ou(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function uu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(uu(e,t,n),e=e.sibling;null!==e;)uu(e,t,n),e=e.sibling}function cu(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cu(e,t,n),e=e.sibling;null!==e;)cu(e,t,n),e=e.sibling}var lu=null,fu=!1;function hu(e,t,n){for(n=n.child;null!==n;)pu(e,t,n),n=n.sibling}function pu(e,t,n){if(it&&"function"===typeof it.onCommitFiberUnmount)try{it.onCommitFiberUnmount(at,n)}catch(s){}switch(n.tag){case 5:Qs||Zs(n,t);case 6:var r=lu,a=fu;lu=null,hu(e,t,n),fu=a,null!==(lu=r)&&(fu?(e=lu,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):lu.removeChild(n.stateNode));break;case 18:null!==lu&&(fu?(e=lu,n=n.stateNode,8===e.nodeType?ua(e.parentNode,n):1===e.nodeType&&ua(e,n),Wt(e)):ua(lu,n.stateNode));break;case 4:r=lu,a=fu,lu=n.stateNode.containerInfo,fu=!0,hu(e,t,n),lu=r,fu=a;break;case 0:case 11:case 14:case 15:if(!Qs&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){a=r=r.next;do{var i=a,o=i.destroy;i=i.tag,void 0!==o&&(0!==(2&i)||0!==(4&i))&&eu(n,t,o),a=a.next}while(a!==r)}hu(e,t,n);break;case 1:if(!Qs&&(Zs(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(s){Sc(n,t,s)}hu(e,t,n);break;case 21:hu(e,t,n);break;case 22:1&n.mode?(Qs=(r=Qs)||null!==n.memoizedState,hu(e,t,n),Qs=r):hu(e,t,n);break;default:hu(e,t,n)}}function du(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Ys),t.forEach((function(t){var r=Nc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function vu(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var a=n[r];try{var o=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:lu=u.stateNode,fu=!1;break e;case 3:case 4:lu=u.stateNode.containerInfo,fu=!0;break e}u=u.return}if(null===lu)throw Error(i(160));pu(o,s,a),lu=null,fu=!1;var c=a.alternate;null!==c&&(c.return=null),a.return=null}catch(l){Sc(a,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)mu(t,e),t=t.sibling}function mu(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(vu(t,e),yu(e),4&r){try{nu(3,e,e.return),ru(3,e)}catch(m){Sc(e,e.return,m)}try{nu(5,e,e.return)}catch(m){Sc(e,e.return,m)}}break;case 1:vu(t,e),yu(e),512&r&&null!==n&&Zs(n,n.return);break;case 5:if(vu(t,e),yu(e),512&r&&null!==n&&Zs(n,n.return),32&e.flags){var a=e.stateNode;try{he(a,"")}catch(m){Sc(e,e.return,m)}}if(4&r&&null!=(a=e.stateNode)){var o=e.memoizedProps,s=null!==n?n.memoizedProps:o,u=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===u&&"radio"===o.type&&null!=o.name&&Y(a,o),be(u,s);var l=be(u,o);for(s=0;s<c.length;s+=2){var f=c[s],h=c[s+1];"style"===f?me(a,h):"dangerouslySetInnerHTML"===f?fe(a,h):"children"===f?he(a,h):b(a,f,h,l)}switch(u){case"input":J(a,o);break;case"textarea":ie(a,o);break;case"select":var p=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!o.multiple;var d=o.value;null!=d?ne(a,!!o.multiple,d,!1):p!==!!o.multiple&&(null!=o.defaultValue?ne(a,!!o.multiple,o.defaultValue,!0):ne(a,!!o.multiple,o.multiple?[]:"",!1))}a[pa]=o}catch(m){Sc(e,e.return,m)}}break;case 6:if(vu(t,e),yu(e),4&r){if(null===e.stateNode)throw Error(i(162));a=e.stateNode,o=e.memoizedProps;try{a.nodeValue=o}catch(m){Sc(e,e.return,m)}}break;case 3:if(vu(t,e),yu(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Wt(t.containerInfo)}catch(m){Sc(e,e.return,m)}break;case 4:default:vu(t,e),yu(e);break;case 13:vu(t,e),yu(e),8192&(a=e.child).flags&&(o=null!==a.memoizedState,a.stateNode.isHidden=o,!o||null!==a.alternate&&null!==a.alternate.memoizedState||(Uu=Ye())),4&r&&du(e);break;case 22:if(f=null!==n&&null!==n.memoizedState,1&e.mode?(Qs=(l=Qs)||f,vu(t,e),Qs=l):vu(t,e),yu(e),8192&r){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!f&&0!==(1&e.mode))for(Js=e,f=e.child;null!==f;){for(h=Js=f;null!==Js;){switch(d=(p=Js).child,p.tag){case 0:case 11:case 14:case 15:nu(4,p,p.return);break;case 1:Zs(p,p.return);var v=p.stateNode;if("function"===typeof v.componentWillUnmount){r=p,n=p.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(m){Sc(r,n,m)}}break;case 5:Zs(p,p.return);break;case 22:if(null!==p.memoizedState){wu(h);continue}}null!==d?(d.return=p,Js=d):wu(h)}f=f.sibling}e:for(f=null,h=e;;){if(5===h.tag){if(null===f){f=h;try{a=h.stateNode,l?"function"===typeof(o=a.style).setProperty?o.setProperty("display","none","important"):o.display="none":(u=h.stateNode,s=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,u.style.display=ve("display",s))}catch(m){Sc(e,e.return,m)}}}else if(6===h.tag){if(null===f)try{h.stateNode.nodeValue=l?"":h.memoizedProps}catch(m){Sc(e,e.return,m)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;f===h&&(f=null),h=h.return}f===h&&(f=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:vu(t,e),yu(e),4&r&&du(e);case 21:}}function yu(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ou(n)){var r=n;break e}n=n.return}throw Error(i(160))}switch(r.tag){case 5:var a=r.stateNode;32&r.flags&&(he(a,""),r.flags&=-33),cu(e,su(e),a);break;case 3:case 4:var o=r.stateNode.containerInfo;uu(e,su(e),o);break;default:throw Error(i(161))}}catch(s){Sc(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function gu(e,t,n){Js=e,bu(e,t,n)}function bu(e,t,n){for(var r=0!==(1&e.mode);null!==Js;){var a=Js,i=a.child;if(22===a.tag&&r){var o=null!==a.memoizedState||$s;if(!o){var s=a.alternate,u=null!==s&&null!==s.memoizedState||Qs;s=$s;var c=Qs;if($s=o,(Qs=u)&&!c)for(Js=a;null!==Js;)u=(o=Js).child,22===o.tag&&null!==o.memoizedState?ku(a):null!==u?(u.return=o,Js=u):ku(a);for(;null!==i;)Js=i,bu(i,t,n),i=i.sibling;Js=a,$s=s,Qs=c}xu(e)}else 0!==(8772&a.subtreeFlags)&&null!==i?(i.return=a,Js=i):xu(e)}}function xu(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qs||ru(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Qs)if(null===n)r.componentDidMount();else{var a=t.elementType===t.type?n.memoizedProps:mi(t.type,n.memoizedProps);r.componentDidUpdate(a,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Bi(t,o,r);break;case 3:var s=t.updateQueue;if(null!==s){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Bi(t,s,n)}break;case 5:var u=t.stateNode;if(null===n&&4&t.flags){n=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var f=l.memoizedState;if(null!==f){var h=f.dehydrated;null!==h&&Wt(h)}}}break;default:throw Error(i(163))}Qs||512&t.flags&&au(t)}catch(p){Sc(t,t.return,p)}}if(t===e){Js=null;break}if(null!==(n=t.sibling)){n.return=t.return,Js=n;break}Js=t.return}}function wu(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Js=n;break}Js=t.return}}function ku(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ru(4,t)}catch(u){Sc(t,n,u)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var a=t.return;try{r.componentDidMount()}catch(u){Sc(t,a,u)}}var i=t.return;try{au(t)}catch(u){Sc(t,i,u)}break;case 5:var o=t.return;try{au(t)}catch(u){Sc(t,o,u)}}}catch(u){Sc(t,t.return,u)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var Eu,Su=Math.ceil,Cu=x.ReactCurrentDispatcher,Iu=x.ReactCurrentOwner,Tu=x.ReactCurrentBatchConfig,Nu=0,_u=null,Ru=null,Au=0,Du=0,Ou=Sa(0),Mu=0,Fu=null,Pu=0,Lu=0,Bu=0,Vu=null,zu=null,Uu=0,Wu=1/0,ju=null,Gu=!1,Hu=null,qu=null,Ku=!1,Xu=null,$u=0,Qu=0,Yu=null,Ju=-1,Zu=0;function ec(){return 0!==(6&Nu)?Ye():-1!==Ju?Ju:Ju=Ye()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Nu)&&0!==Au?Au&-Au:null!==vi.transition?(0===Zu&&(Zu=vt()),Zu):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function nc(e,t,n,r){if(50<Qu)throw Qu=0,Yu=null,Error(i(185));yt(e,n,r),0!==(2&Nu)&&e===_u||(e===_u&&(0===(2&Nu)&&(Lu|=n),4===Mu&&sc(e,Au)),rc(e,r),1===n&&0===Nu&&0===(1&t.mode)&&(Wu=Ye()+500,Va&&Wa()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,a=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-ot(i),s=1<<o,u=a[o];-1===u?0!==(s&n)&&0===(s&r)||(a[o]=pt(s,t)):u<=t&&(e.expiredLanes|=s),i&=~s}}(e,t);var r=ht(e,e===_u?Au:0);if(0===r)null!==n&&Xe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Xe(n),1===t)0===e.tag?function(e){Va=!0,Ua(e)}(uc.bind(null,e)):Ua(uc.bind(null,e)),oa((function(){0===(6&Nu)&&Wa()})),n=null;else{switch(xt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=_c(n,ac.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ac(e,t){if(Ju=-1,Zu=0,0!==(6&Nu))throw Error(i(327));var n=e.callbackNode;if(kc()&&e.callbackNode!==n)return null;var r=ht(e,e===_u?Au:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=mc(e,r);else{t=r;var a=Nu;Nu|=2;var o=dc();for(_u===e&&Au===t||(ju=null,Wu=Ye()+500,hc(e,t));;)try{gc();break}catch(u){pc(e,u)}wi(),Cu.current=o,Nu=a,null!==Ru?t=0:(_u=null,Au=0,t=Mu)}if(0!==t){if(2===t&&(0!==(a=dt(e))&&(r=a,t=ic(e,a))),1===t)throw n=Fu,hc(e,0),sc(e,r),rc(e,Ye()),n;if(6===t)sc(e,r);else{if(a=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var a=n[r],i=a.getSnapshot;a=a.value;try{if(!sr(i(),a))return!1}catch(s){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(a)&&(2===(t=mc(e,r))&&(0!==(o=dt(e))&&(r=o,t=ic(e,o))),1===t))throw n=Fu,hc(e,0),sc(e,r),rc(e,Ye()),n;switch(e.finishedWork=a,e.finishedLanes=r,t){case 0:case 1:throw Error(i(345));case 2:case 5:wc(e,zu,ju);break;case 3:if(sc(e,r),(130023424&r)===r&&10<(t=Uu+500-Ye())){if(0!==ht(e,0))break;if(((a=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=ra(wc.bind(null,e,zu,ju),t);break}wc(e,zu,ju);break;case 4:if(sc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,a=-1;0<r;){var s=31-ot(r);o=1<<s,(s=t[s])>a&&(a=s),r&=~o}if(r=a,10<(r=(120>(r=Ye()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Su(r/1960))-r)){e.timeoutHandle=ra(wc.bind(null,e,zu,ju),r);break}wc(e,zu,ju);break;default:throw Error(i(329))}}}return rc(e,Ye()),e.callbackNode===n?ac.bind(null,e):null}function ic(e,t){var n=Vu;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=mc(e,t))&&(t=zu,zu=n,null!==t&&oc(t)),e}function oc(e){null===zu?zu=e:zu.push.apply(zu,e)}function sc(e,t){for(t&=~Bu,t&=~Lu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function uc(e){if(0!==(6&Nu))throw Error(i(327));kc();var t=ht(e,0);if(0===(1&t))return rc(e,Ye()),null;var n=mc(e,t);if(0!==e.tag&&2===n){var r=dt(e);0!==r&&(t=r,n=ic(e,r))}if(1===n)throw n=Fu,hc(e,0),sc(e,t),rc(e,Ye()),n;if(6===n)throw Error(i(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,zu,ju),rc(e,Ye()),null}function cc(e,t){var n=Nu;Nu|=1;try{return e(t)}finally{0===(Nu=n)&&(Wu=Ye()+500,Va&&Wa())}}function lc(e){null!==Xu&&0===Xu.tag&&0===(6&Nu)&&kc();var t=Nu;Nu|=1;var n=Tu.transition,r=bt;try{if(Tu.transition=null,bt=1,e)return e()}finally{bt=r,Tu.transition=n,0===(6&(Nu=t))&&Wa()}}function fc(){Du=Ou.current,Ca(Ou)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,aa(n)),null!==Ru)for(n=Ru.return;null!==n;){var r=n;switch(ti(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Oa();break;case 3:ao(),Ca(_a),Ca(Na),lo();break;case 5:oo(r);break;case 4:ao();break;case 13:case 19:Ca(so);break;case 10:ki(r.type._context);break;case 22:case 23:fc()}n=n.return}if(_u=e,Ru=e=Oc(e.current,null),Au=Du=t,Mu=0,Fu=null,Bu=Lu=Pu=0,zu=Vu=null,null!==Ii){for(t=0;t<Ii.length;t++)if(null!==(r=(n=Ii[t]).interleaved)){n.interleaved=null;var a=r.next,i=n.pending;if(null!==i){var o=i.next;i.next=a,r.next=o}n.pending=r}Ii=null}return e}function pc(e,t){for(;;){var n=Ru;try{if(wi(),fo.current=os,go){for(var r=vo.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}go=!1}if(po=0,yo=mo=vo=null,bo=!1,xo=0,Iu.current=null,null===n||null===n.return){Mu=1,Fu=t,Ru=null;break}e:{var o=e,s=n.return,u=n,c=t;if(t=Au,u.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,f=u,h=f.tag;if(0===(1&f.mode)&&(0===h||11===h||15===h)){var p=f.alternate;p?(f.updateQueue=p.updateQueue,f.memoizedState=p.memoizedState,f.lanes=p.lanes):(f.updateQueue=null,f.memoizedState=null)}var d=ys(s);if(null!==d){d.flags&=-257,gs(d,s,u,0,t),1&d.mode&&ms(o,l,t),c=l;var v=(t=d).updateQueue;if(null===v){var m=new Set;m.add(c),t.updateQueue=m}else v.add(c);break e}if(0===(1&t)){ms(o,l,t),vc();break e}c=Error(i(426))}else if(ai&&1&u.mode){var y=ys(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),gs(y,s,u,0,t),di(ls(c,u));break e}}o=c=ls(c,u),4!==Mu&&(Mu=2),null===Vu?Vu=[o]:Vu.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,Pi(o,ds(0,c,t));break e;case 1:u=c;var g=o.type,b=o.stateNode;if(0===(128&o.flags)&&("function"===typeof g.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===qu||!qu.has(b)))){o.flags|=65536,t&=-t,o.lanes|=t,Pi(o,vs(o,u,t));break e}}o=o.return}while(null!==o)}xc(n)}catch(x){t=x,Ru===n&&null!==n&&(Ru=n=n.return);continue}break}}function dc(){var e=Cu.current;return Cu.current=os,null===e?os:e}function vc(){0!==Mu&&3!==Mu&&2!==Mu||(Mu=4),null===_u||0===(268435455&Pu)&&0===(268435455&Lu)||sc(_u,Au)}function mc(e,t){var n=Nu;Nu|=2;var r=dc();for(_u===e&&Au===t||(ju=null,hc(e,t));;)try{yc();break}catch(a){pc(e,a)}if(wi(),Nu=n,Cu.current=r,null!==Ru)throw Error(i(261));return _u=null,Au=0,Mu}function yc(){for(;null!==Ru;)bc(Ru)}function gc(){for(;null!==Ru&&!$e();)bc(Ru)}function bc(e){var t=Eu(e.alternate,e,Du);e.memoizedProps=e.pendingProps,null===t?xc(e):Ru=t,Iu.current=null}function xc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ks(n,t,Du)))return void(Ru=n)}else{if(null!==(n=Xs(n,t)))return n.flags&=32767,void(Ru=n);if(null===e)return Mu=6,void(Ru=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ru=t);Ru=t=e}while(null!==t);0===Mu&&(Mu=5)}function wc(e,t,n){var r=bt,a=Tu.transition;try{Tu.transition=null,bt=1,function(e,t,n,r){do{kc()}while(null!==Xu);if(0!==(6&Nu))throw Error(i(327));n=e.finishedWork;var a=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(i(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var a=31-ot(n),i=1<<a;t[a]=0,r[a]=-1,e[a]=-1,n&=~i}}(e,o),e===_u&&(Ru=_u=null,Au=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Ku||(Ku=!0,_c(tt,(function(){return kc(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Tu.transition,Tu.transition=null;var s=bt;bt=1;var u=Nu;Nu|=4,Iu.current=null,function(e,t){if(ea=Gt,pr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var a=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(w){n=null;break e}var s=0,u=-1,c=-1,l=0,f=0,h=e,p=null;t:for(;;){for(var d;h!==n||0!==a&&3!==h.nodeType||(u=s+a),h!==o||0!==r&&3!==h.nodeType||(c=s+r),3===h.nodeType&&(s+=h.nodeValue.length),null!==(d=h.firstChild);)p=h,h=d;for(;;){if(h===e)break t;if(p===n&&++l===a&&(u=s),p===o&&++f===r&&(c=s),null!==(d=h.nextSibling))break;p=(h=p).parentNode}h=d}n=-1===u||-1===c?null:{start:u,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ta={focusedElem:e,selectionRange:n},Gt=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var v=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==v){var m=v.memoizedProps,y=v.memoizedState,g=t.stateNode,b=g.getSnapshotBeforeUpdate(t.elementType===t.type?m:mi(t.type,m),y);g.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var x=t.stateNode.containerInfo;1===x.nodeType?x.textContent="":9===x.nodeType&&x.documentElement&&x.removeChild(x.documentElement);break;default:throw Error(i(163))}}catch(w){Sc(t,t.return,w)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}v=tu,tu=!1}(e,n),mu(n,e),dr(ta),Gt=!!ea,ta=ea=null,e.current=n,gu(n,e,a),Qe(),Nu=u,bt=s,Tu.transition=o}else e.current=n;if(Ku&&(Ku=!1,Xu=e,$u=a),0===(o=e.pendingLanes)&&(qu=null),function(e){if(it&&"function"===typeof it.onCommitFiberRoot)try{it.onCommitFiberRoot(at,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,Ye()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)r((a=t[n]).value,{componentStack:a.stack,digest:a.digest});if(Gu)throw Gu=!1,e=Hu,Hu=null,e;0!==(1&$u)&&0!==e.tag&&kc(),0!==(1&(o=e.pendingLanes))?e===Yu?Qu++:(Qu=0,Yu=e):Qu=0,Wa()}(e,t,n,r)}finally{Tu.transition=a,bt=r}return null}function kc(){if(null!==Xu){var e=xt($u),t=Tu.transition,n=bt;try{if(Tu.transition=null,bt=16>e?16:e,null===Xu)var r=!1;else{if(e=Xu,Xu=null,$u=0,0!==(6&Nu))throw Error(i(331));var a=Nu;for(Nu|=4,Js=e.current;null!==Js;){var o=Js,s=o.child;if(0!==(16&Js.flags)){var u=o.deletions;if(null!==u){for(var c=0;c<u.length;c++){var l=u[c];for(Js=l;null!==Js;){var f=Js;switch(f.tag){case 0:case 11:case 15:nu(8,f,o)}var h=f.child;if(null!==h)h.return=f,Js=h;else for(;null!==Js;){var p=(f=Js).sibling,d=f.return;if(iu(f),f===l){Js=null;break}if(null!==p){p.return=d,Js=p;break}Js=d}}}var v=o.alternate;if(null!==v){var m=v.child;if(null!==m){v.child=null;do{var y=m.sibling;m.sibling=null,m=y}while(null!==m)}}Js=o}}if(0!==(2064&o.subtreeFlags)&&null!==s)s.return=o,Js=s;else e:for(;null!==Js;){if(0!==(2048&(o=Js).flags))switch(o.tag){case 0:case 11:case 15:nu(9,o,o.return)}var g=o.sibling;if(null!==g){g.return=o.return,Js=g;break e}Js=o.return}}var b=e.current;for(Js=b;null!==Js;){var x=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==x)x.return=s,Js=x;else e:for(s=b;null!==Js;){if(0!==(2048&(u=Js).flags))try{switch(u.tag){case 0:case 11:case 15:ru(9,u)}}catch(k){Sc(u,u.return,k)}if(u===s){Js=null;break e}var w=u.sibling;if(null!==w){w.return=u.return,Js=w;break e}Js=u.return}}if(Nu=a,Wa(),it&&"function"===typeof it.onPostCommitFiberRoot)try{it.onPostCommitFiberRoot(at,e)}catch(k){}r=!0}return r}finally{bt=n,Tu.transition=t}}return!1}function Ec(e,t,n){e=Mi(e,t=ds(0,t=ls(n,t),1),1),t=ec(),null!==e&&(yt(e,1,t),rc(e,t))}function Sc(e,t,n){if(3===e.tag)Ec(e,e,n);else for(;null!==t;){if(3===t.tag){Ec(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===qu||!qu.has(r))){t=Mi(t,e=vs(t,e=ls(n,e),1),1),e=ec(),null!==t&&(yt(t,1,e),rc(t,e));break}}t=t.return}}function Cc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,_u===e&&(Au&n)===n&&(4===Mu||3===Mu&&(130023424&Au)===Au&&500>Ye()-Uu?hc(e,0):Bu|=n),rc(e,t)}function Ic(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var n=ec();null!==(e=_i(e,t))&&(yt(e,t,n),rc(e,n))}function Tc(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ic(e,n)}function Nc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,a=e.memoizedState;null!==a&&(n=a.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(i(314))}null!==r&&r.delete(t),Ic(e,n)}function _c(e,t){return Ke(e,t)}function Rc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ac(e,t,n,r){return new Rc(e,t,n,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var n=e.alternate;return null===n?((n=Ac(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mc(e,t,n,r,a,o){var s=2;if(r=e,"function"===typeof e)Dc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case E:return Fc(n.children,a,o,t);case S:s=8,a|=8;break;case C:return(e=Ac(12,n,t,2|a)).elementType=C,e.lanes=o,e;case _:return(e=Ac(13,n,t,a)).elementType=_,e.lanes=o,e;case R:return(e=Ac(19,n,t,a)).elementType=R,e.lanes=o,e;case O:return Pc(n,a,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case I:s=10;break e;case T:s=9;break e;case N:s=11;break e;case A:s=14;break e;case D:s=16,r=null;break e}throw Error(i(130,null==e?e:typeof e,""))}return(t=Ac(s,n,t,a)).elementType=e,t.type=r,t.lanes=o,t}function Fc(e,t,n,r){return(e=Ac(7,e,r,t)).lanes=n,e}function Pc(e,t,n,r){return(e=Ac(22,e,r,t)).elementType=O,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=Ac(6,e,null,t)).lanes=n,e}function Bc(e,t,n){return(t=Ac(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Vc(e,t,n,r,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mt(0),this.expirationTimes=mt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mt(0),this.identifierPrefix=r,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,a,i,o,s,u){return e=new Vc(e,t,n,s,u),1===t?(t=1,!0===i&&(t|=8)):t=0,i=Ac(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ai(i),e}function Uc(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Wc(e){if(!e)return Ta;e:{if(We(e=e._reactInternals)!==e||1!==e.tag)throw Error(i(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Da(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(i(171))}if(1===e.tag){var n=e.type;if(Da(n))return Fa(e,n,t)}return t}function jc(e,t,n,r,a,i,o,s,u){return(e=zc(n,r,!0,e,0,i,0,s,u)).context=Wc(null),n=e.current,(i=Oi(r=ec(),a=tc(n))).callback=void 0!==t&&null!==t?t:null,Mi(n,i,a),e.current.lanes=a,yt(e,a,r),rc(e,r),e}function Gc(e,t,n,r){var a=t.current,i=ec(),o=tc(a);return n=Wc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Oi(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Mi(a,t,o))&&(nc(e,a,o,i),Fi(e,a,o)),o}function Hc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function qc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Kc(e,t){qc(e,t),(e=e.alternate)&&qc(e,t)}Eu=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||_a.current)xs=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return xs=!1,function(e,t,n){switch(t.tag){case 3:Rs(t),pi();break;case 5:io(t);break;case 1:Da(t.type)&&Pa(t);break;case 4:ro(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,a=t.memoizedProps.value;Ia(yi,r._currentValue),r._currentValue=a;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ia(so,1&so.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Ls(e,t,n):(Ia(so,1&so.current),null!==(e=Gs(e,t,n))?e.sibling:null);Ia(so,1&so.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Ws(e,t,n);t.flags|=128}if(null!==(a=t.memoizedState)&&(a.rendering=null,a.tail=null,a.lastEffect=null),Ia(so,so.current),r)break;return null;case 22:case 23:return t.lanes=0,Cs(e,t,n)}return Gs(e,t,n)}(e,t,n);xs=0!==(131072&e.flags)}else xs=!1,ai&&0!==(1048576&t.flags)&&Za(t,qa,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;js(e,t),e=t.pendingProps;var a=Aa(t,Na.current);Si(t,n),a=So(null,t,r,e,a,n);var o=Co();return t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Da(r)?(o=!0,Pa(t)):o=!1,t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,Ai(t),a.updater=Ui,t.stateNode=a,a._reactInternals=t,Hi(t,r,e,n),t=_s(null,t,r,!0,o,n)):(t.tag=0,ai&&o&&ei(t),ws(null,t,a,n),t=t.child),t;case 16:r=t.elementType;e:{switch(js(e,t),e=t.pendingProps,r=(a=r._init)(r._payload),t.type=r,a=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===N)return 11;if(e===A)return 14}return 2}(r),e=mi(r,e),a){case 0:t=Ts(null,t,r,e,n);break e;case 1:t=Ns(null,t,r,e,n);break e;case 11:t=ks(null,t,r,e,n);break e;case 14:t=Es(null,t,r,mi(r.type,e),n);break e}throw Error(i(306,r,""))}return t;case 0:return r=t.type,a=t.pendingProps,Ts(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 1:return r=t.type,a=t.pendingProps,Ns(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 3:e:{if(Rs(t),null===e)throw Error(i(387));r=t.pendingProps,a=(o=t.memoizedState).element,Di(e,t),Li(t,r,null,n);var s=t.memoizedState;if(r=s.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=As(e,t,r,n,a=ls(Error(i(423)),t));break e}if(r!==a){t=As(e,t,r,n,a=ls(Error(i(424)),t));break e}for(ri=ca(t.stateNode.containerInfo.firstChild),ni=t,ai=!0,ii=null,n=Yi(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(pi(),r===a){t=Gs(e,t,n);break e}ws(e,t,r,n)}t=t.child}return t;case 5:return io(t),null===e&&ci(t),r=t.type,a=t.pendingProps,o=null!==e?e.memoizedProps:null,s=a.children,na(r,a)?s=null:null!==o&&na(r,o)&&(t.flags|=32),Is(e,t),ws(e,t,s,n),t.child;case 6:return null===e&&ci(t),null;case 13:return Ls(e,t,n);case 4:return ro(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Qi(t,null,r,n):ws(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,ks(e,t,r,a=t.elementType===r?a:mi(r,a),n);case 7:return ws(e,t,t.pendingProps,n),t.child;case 8:case 12:return ws(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,s=a.value,Ia(yi,r._currentValue),r._currentValue=s,null!==o)if(sr(o.value,s)){if(o.children===a.children&&!_a.current){t=Gs(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var u=o.dependencies;if(null!==u){s=o.child;for(var c=u.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=Oi(-1,n&-n)).tag=2;var l=o.updateQueue;if(null!==l){var f=(l=l.shared).pending;null===f?c.next=c:(c.next=f.next,f.next=c),l.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Ei(o.return,n,t),u.lanes|=n;break}c=c.next}}else if(10===o.tag)s=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(s=o.return))throw Error(i(341));s.lanes|=n,null!==(u=s.alternate)&&(u.lanes|=n),Ei(s,n,t),s=o.sibling}else s=o.child;if(null!==s)s.return=o;else for(s=o;null!==s;){if(s===t){s=null;break}if(null!==(o=s.sibling)){o.return=s.return,s=o;break}s=s.return}o=s}ws(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=t.pendingProps.children,Si(t,n),r=r(a=Ci(a)),t.flags|=1,ws(e,t,r,n),t.child;case 14:return a=mi(r=t.type,t.pendingProps),Es(e,t,r,a=mi(r.type,a),n);case 15:return Ss(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:mi(r,a),js(e,t),t.tag=1,Da(r)?(e=!0,Pa(t)):e=!1,Si(t,n),ji(t,r,a),Hi(t,r,a,n),_s(null,t,r,!0,e,n);case 19:return Ws(e,t,n);case 22:return Cs(e,t,n)}throw Error(i(156,t.tag))};var Xc="function"===typeof reportError?reportError:function(e){console.error(e)};function $c(e){this._internalRoot=e}function Qc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Jc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Zc(){}function el(e,t,n,r,a){var i=n._reactRootContainer;if(i){var o=i;if("function"===typeof a){var s=a;a=function(){var e=Hc(o);s.call(e)}}Gc(t,o,e,a)}else o=function(e,t,n,r,a){if(a){if("function"===typeof r){var i=r;r=function(){var e=Hc(o);i.call(e)}}var o=jc(t,r,e,0,null,!1,0,"",Zc);return e._reactRootContainer=o,e[da]=o.current,Wr(8===e.nodeType?e.parentNode:e),lc(),o}for(;a=e.lastChild;)e.removeChild(a);if("function"===typeof r){var s=r;r=function(){var e=Hc(u);s.call(e)}}var u=zc(e,0,!1,null,0,!1,0,"",Zc);return e._reactRootContainer=u,e[da]=u.current,Wr(8===e.nodeType?e.parentNode:e),lc((function(){Gc(t,u,n,r)})),u}(n,t,e,a,r);return Hc(o)}Qc.prototype.render=$c.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(i(409));Gc(e,t,null,null)},Qc.prototype.unmount=$c.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;lc((function(){Gc(null,e,null,null)})),t[da]=null}},Qc.prototype.unstable_scheduleHydration=function(e){if(e){var t=St();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Ot.length&&0!==t&&t<Ot[n].priority;n++);Ot.splice(n,0,e),0===n&&Lt(e)}},wt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ft(t.pendingLanes);0!==n&&(gt(t,1|n),rc(t,Ye()),0===(6&Nu)&&(Wu=Ye()+500,Wa()))}break;case 13:lc((function(){var t=_i(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Kc(e,1)}},kt=function(e){if(13===e.tag){var t=_i(e,134217728);if(null!==t)nc(t,e,134217728,ec());Kc(e,134217728)}},Et=function(e){if(13===e.tag){var t=tc(e),n=_i(e,t);if(null!==n)nc(n,e,t,ec());Kc(e,t)}},St=function(){return bt},Ct=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},ke=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var a=wa(r);if(!a)throw Error(i(90));K(r),J(r,a)}}}break;case"textarea":ie(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ne=cc,_e=lc;var tl={usingClientEntryPoint:!1,Events:[ba,xa,wa,Ie,Te,cc]},nl={findFiberByHostInstance:ga,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},rl={bundleType:nl.bundleType,version:nl.version,rendererPackageName:nl.rendererPackageName,rendererConfig:nl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:x.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:nl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var al=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!al.isDisabled&&al.supportsFiber)try{at=al.inject(rl),it=al}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(i(200));return Uc(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(i(299));var n=!1,r="",a=Xc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(a=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,a),e[da]=t.current,Wr(8===e.nodeType?e.parentNode:e),new $c(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(i(188));throw e=Object.keys(e).join(","),Error(i(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return lc(e)},t.hydrate=function(e,t,n){if(!Jc(t))throw Error(i(200));return el(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(i(405));var r=null!=n&&n.hydratedSources||null,a=!1,o="",s=Xc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(a=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(s=n.onRecoverableError)),t=jc(t,null,e,1,null!=n?n:null,a,0,o,s),e[da]=t.current,Wr(e),r)for(e=0;e<r.length;e++)a=(a=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,a]:t.mutableSourceEagerHydrationData.push(n,a);return new Qc(t)},t.render=function(e,t,n){if(!Jc(t))throw Error(i(200));return el(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Jc(e))throw Error(i(40));return!!e._reactRootContainer&&(lc((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[da]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Jc(n))throw Error(i(200));if(null==e||void 0===e._reactInternals)throw Error(i(38));return el(e,t,n,!1,r)},t.version="18.2.0-next-9e3b772b8-20220608"},250:function(e,t,n){"use strict";var r=n(164);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},164:function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(463)},374:function(e,t,n){"use strict";var r=n(791),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,i={},c=null,l=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)o.call(t,r)&&!u.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===i[r]&&(i[r]=t[r]);return{$$typeof:a,type:e,key:c,ref:l,props:i,_owner:s.current}}t.Fragment=i,t.jsx=c,t.jsxs=c},117:function(e,t){"use strict";var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;var d={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,m={};function y(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||d}function g(){}function b(e,t,n){this.props=e,this.context=t,this.refs=m,this.updater=n||d}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=y.prototype;var x=b.prototype=new g;x.constructor=b,v(x,y.prototype),x.isPureReactComponent=!0;var w=Array.isArray,k=Object.prototype.hasOwnProperty,E={current:null},S={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var a,i={},o=null,s=null;if(null!=t)for(a in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(o=""+t.key),t)k.call(t,a)&&!S.hasOwnProperty(a)&&(i[a]=t[a]);var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(a in u=e.defaultProps)void 0===i[a]&&(i[a]=u[a]);return{$$typeof:n,type:e,key:o,ref:s,props:i,_owner:E.current}}function I(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var T=/\/+/g;function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function _(e,t,a,i,o){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case r:u=!0}}if(u)return o=o(u=e),e=""===i?"."+N(u,0):i,w(o)?(a="",null!=e&&(a=e.replace(T,"$&/")+"/"),_(o,t,a,"",(function(e){return e}))):null!=o&&(I(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,a+(!o.key||u&&u.key===o.key?"":(""+o.key).replace(T,"$&/")+"/")+e)),t.push(o)),1;if(u=0,i=""===i?".":i+":",w(e))for(var c=0;c<e.length;c++){var l=i+N(s=e[c],c);u+=_(s,t,a,l,o)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=p&&e[p]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=_(s=s.value,t,a,l=i+N(s,c++),o);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function R(e,t,n){if(null==e)return e;var r=[],a=0;return _(e,r,"","",(function(e){return t.call(n,e,a++)})),r}function A(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},O={transition:null},M={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:O,ReactCurrentOwner:E};t.Children={map:R,forEach:function(e,t,n){R(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return R(e,(function(){t++})),t},toArray:function(e){return R(e,(function(e){return e}))||[]},only:function(e){if(!I(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=a,t.Profiler=o,t.PureComponent=b,t.StrictMode=i,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=M,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var a=v({},e.props),i=e.key,o=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,s=E.current),void 0!==t.key&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)k.call(t,c)&&!S.hasOwnProperty(c)&&(a[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)a.children=r;else if(1<c){u=Array(c);for(var l=0;l<c;l++)u[l]=arguments[l+2];a.children=u}return{$$typeof:n,type:e.type,key:i,ref:o,props:a,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=I,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:A}},t.memo=function(e,t){return{$$typeof:f,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.2.0"},791:function(e,t,n){"use strict";e.exports=n(117)},184:function(e,t,n){"use strict";e.exports=n(374)},813:function(e,t){"use strict";function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,a=e[r];if(!(0<i(a,t)))break e;e[r]=t,e[n]=a,n=r}}function r(e){return 0===e.length?null:e[0]}function a(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,a=e.length,o=a>>>1;r<o;){var s=2*(r+1)-1,u=e[s],c=s+1,l=e[c];if(0>i(u,n))c<a&&0>i(l,u)?(e[r]=l,e[c]=n,r=c):(e[r]=u,e[s]=n,r=s);else{if(!(c<a&&0>i(l,n)))break e;e[r]=l,e[c]=n,r=c}}}return t}function i(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],l=[],f=1,h=null,p=3,d=!1,v=!1,m=!1,y="function"===typeof setTimeout?setTimeout:null,g="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function x(e){for(var t=r(l);null!==t;){if(null===t.callback)a(l);else{if(!(t.startTime<=e))break;a(l),t.sortIndex=t.expirationTime,n(c,t)}t=r(l)}}function w(e){if(m=!1,x(e),!v)if(null!==r(c))v=!0,O(k);else{var t=r(l);null!==t&&M(w,t.startTime-e)}}function k(e,n){v=!1,m&&(m=!1,g(I),I=-1),d=!0;var i=p;try{for(x(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!_());){var o=h.callback;if("function"===typeof o){h.callback=null,p=h.priorityLevel;var s=o(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?h.callback=s:h===r(c)&&a(c),x(n)}else a(c);h=r(c)}if(null!==h)var u=!0;else{var f=r(l);null!==f&&M(w,f.startTime-n),u=!1}return u}finally{h=null,p=i,d=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,S=!1,C=null,I=-1,T=5,N=-1;function _(){return!(t.unstable_now()-N<T)}function R(){if(null!==C){var e=t.unstable_now();N=e;var n=!0;try{n=C(!0,e)}finally{n?E():(S=!1,C=null)}}else S=!1}if("function"===typeof b)E=function(){b(R)};else if("undefined"!==typeof MessageChannel){var A=new MessageChannel,D=A.port2;A.port1.onmessage=R,E=function(){D.postMessage(null)}}else E=function(){y(R,0)};function O(e){C=e,S||(S=!0,E())}function M(e,n){I=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){v||d||(v=!0,O(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,a,i){var o=t.unstable_now();switch("object"===typeof i&&null!==i?i="number"===typeof(i=i.delay)&&0<i?o+i:o:i=o,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:f++,callback:a,priorityLevel:e,startTime:i,expirationTime:s=i+s,sortIndex:-1},i>o?(e.sortIndex=i,n(l,e),null===r(c)&&e===r(l)&&(m?(g(I),I=-1):m=!0,M(w,i-o))):(e.sortIndex=s,n(c,e),v||d||(v=!0,O(k))),e},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},296:function(e,t,n){"use strict";e.exports=n(813)},902:function(){},522:function(){},753:function(){}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(r,a){if(1&a&&(r=this(r)),8&a)return r;if("object"===typeof r&&r){if(4&a&&r.__esModule)return r;if(16&a&&"function"===typeof r.then)return r}var i=Object.create(null);n.r(i);var o={};e=e||[null,t({}),t([]),t(t)];for(var s=2&a&&r;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){o[e]=function(){return r[e]}}));return o.default=function(){return r},n.d(i,o),i}}(),n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,r){return n.f[r](e,t),t}),[]))},n.u=function(e){return"static/js/"+e+".7cef73a6.chunk.js"},n.miniCssF=function(e){},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="chatr:";n.l=function(r,a,i,o){if(e[r])e[r].push(a);else{var s,u;if(void 0!==i)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var f=c[l];if(f.getAttribute("src")==r||f.getAttribute("data-webpack")==t+i){s=f;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+i),s.src=r),e[r]=[a];var h=function(t,n){s.onerror=s.onload=null,clearTimeout(p);var a=e[r];if(delete e[r],s.parentNode&&s.parentNode.removeChild(s),a&&a.forEach((function(e){return e(n)})),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/chatr/",function(){var e={179:0};n.f.j=function(t,r){var a=n.o(e,t)?e[t]:void 0;if(0!==a)if(a)r.push(a[2]);else{var i=new Promise((function(n,r){a=e[t]=[n,r]}));r.push(a[2]=i);var o=n.p+n.u(t),s=new Error;n.l(o,(function(r){if(n.o(e,t)&&(0!==(a=e[t])&&(e[t]=void 0),a)){var i=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;s.message="Loading chunk "+t+" failed.\n("+i+": "+o+")",s.name="ChunkLoadError",s.type=i,s.request=o,a[1](s)}}),"chunk-"+t,t)}};var t=function(t,r){var a,i,o=r[0],s=r[1],u=r[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(a in s)n.o(s,a)&&(n.m[a]=s[a]);if(u)u(n)}for(t&&t(r);c<o.length;c++)i=o[c],n.o(e,i)&&e[i]&&e[i][0](),e[i]=0},r=self.webpackChunkchatr=self.webpackChunkchatr||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}(),function(){"use strict";var e=n(791),t=n.t(e,2),r=n(250);function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){if(e){if("string"===typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);o=!0);}catch(u){s=!0,a=u}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e){return s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s(e)}function u(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=s(e)););return e}function c(){return c="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=u(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},c.apply(this,arguments)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function p(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(LE){return!1}}function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function v(e,t){if(t&&("object"===d(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}function m(e){var t=p();return function(){var n,r=s(e);if(t){var a=s(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return v(this,n)}}function y(e,t){var n="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=i(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw o}}}}function g(){g=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},a=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(N){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var a=t&&t.prototype instanceof f?t:f,i=Object.create(a.prototype),o=new C(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return T()}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var s=k(o,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,o),i}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(N){return{type:"throw",arg:N}}}e.wrap=u;var l={};function f(){}function h(){}function p(){}var v={};s(v,a,(function(){return this}));var m=Object.getPrototypeOf,y=m&&m(m(I([])));y&&y!==t&&n.call(y,a)&&(v=y);var b=p.prototype=f.prototype=Object.create(v);function x(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function r(a,i,o,s){var u=c(e[a],e,i);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==d(f)&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,o,s)}),(function(e){r("throw",e,o,s)})):t.resolve(f).then((function(e){l.value=e,o(l)}),(function(e){return r("throw",e,o,s)}))}s(u.arg)}var a;this._invoke=function(e,n){function i(){return new t((function(t,a){r(e,n,t,a)}))}return a=a?a.then(i,i):i()}}function k(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,k(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var a=r.arg;return a?a.done?(t[e.resultName]=a.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):a:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function I(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:T}}function T(){return{value:void 0,done:!0}}return h.prototype=p,s(b,"constructor",p),s(p,"constructor",h),h.displayName=s(p,o,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,s(e,o,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},x(w.prototype),s(w.prototype,i,(function(){return this})),e.AsyncIterator=w,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new w(u(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},x(b),s(b,o,"Generator"),s(b,a,(function(){return this})),s(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=I,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r];if(a.tryLoc<=this.prev&&n.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,l):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),S(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;S(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:I(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}function b(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,a)}function x(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){b(i,r,a,o,s,"next",e)}function s(e){b(i,r,a,o,s,"throw",e)}o(void 0)}))}}function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t,n){return t&&k(e.prototype,t),n&&k(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function S(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e,t,n){return I=p()?Reflect.construct.bind():function(e,t,n){var r=[null];r.push.apply(r,t);var a=new(Function.bind.apply(e,r));return n&&f(a,n.prototype),a},I.apply(null,arguments)}function T(e){var t="function"===typeof Map?new Map:void 0;return T=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return I(e,arguments,s(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),f(n,e)},T(e)}var N=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var a=e.charCodeAt(r);a<128?t[n++]=a:a<2048?(t[n++]=a>>6|192,t[n++]=63&a|128):55296===(64512&a)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++r)),t[n++]=a>>18|240,t[n++]=a>>12&63|128,t[n++]=a>>6&63|128,t[n++]=63&a|128):(t[n++]=a>>12|224,t[n++]=a>>6&63|128,t[n++]=63&a|128)}return t},_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],a=0;a<e.length;a+=3){var i=e[a],o=a+1<e.length,s=o?e[a+1]:0,u=a+2<e.length,c=u?e[a+2]:0,l=i>>2,f=(3&i)<<4|s>>4,h=(15&s)<<2|c>>6,p=63&c;u||(p=64,o||(h=64)),r.push(n[l],n[f],n[h],n[p])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(N(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var a=e[n++];if(a<128)t[r++]=String.fromCharCode(a);else if(a>191&&a<224){var i=e[n++];t[r++]=String.fromCharCode((31&a)<<6|63&i)}else if(a>239&&a<365){var o=((7&a)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(o>>10)),t[r++]=String.fromCharCode(56320+(1023&o))}else{var s=e[n++],u=e[n++];t[r++]=String.fromCharCode((15&a)<<12|(63&s)<<6|63&u)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],a=0;a<e.length;){var i=n[e.charAt(a++)],o=a<e.length?n[e.charAt(a)]:0,s=++a<e.length?n[e.charAt(a)]:64,u=++a<e.length?n[e.charAt(a)]:64;if(++a,null==i||null==o||null==s||null==u)throw Error();var c=i<<2|o>>4;if(r.push(c),64!==s){var l=o<<4&240|s>>2;if(r.push(l),64!==u){var f=s<<6&192|u;r.push(f)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},R=function(e){return function(e){var t=N(e);return _.encodeByteArray(t,!0)}(e).replace(/\./g,"")},A=function(e){try{return _.decodeString(e,!0)}catch(LE){console.error("base64Decode failed: ",LE)}return null};var D=function(){function e(){var t=this;w(this,e),this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))}return E(e,[{key:"wrapCallback",value:function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}}}]),e}();function O(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function M(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(O())}function F(){var e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function P(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function L(){var e=O();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}var B=function(e){h(n,e);var t=m(n);function n(e,r,a){var i;return w(this,n),(i=t.call(this,r)).code=e,i.customData=a,i.name="FirebaseError",Object.setPrototypeOf(l(i),n.prototype),Error.captureStackTrace&&Error.captureStackTrace(l(i),V.prototype.create),i}return E(n)}(T(Error)),V=function(){function e(t,n,r){w(this,e),this.service=t,this.serviceName=n,this.errors=r}return E(e,[{key:"create",value:function(e){var t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],a=r?z(r,t):"Error",i="".concat(this.serviceName,": ").concat(a," (").concat(n,")."),o=new B(n,i,t);return o}}]),e}();function z(e,t){return e.replace(U,(function(e,n){var r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}var U=/\{\$([^}]+)}/g;function W(e,t){if(e===t)return!0;for(var n=Object.keys(e),r=Object.keys(t),a=0,i=n;a<i.length;a++){var o=i[a];if(!r.includes(o))return!1;var s=e[o],u=t[o];if(j(s)&&j(u)){if(!W(s,u))return!1}else if(s!==u)return!1}for(var c=0,l=r;c<l.length;c++){var f=l[c];if(!n.includes(f))return!1}return!0}function j(e){return null!==e&&"object"===typeof e}function G(e){for(var t=[],n=function(){var e=o(a[r],2),n=e[0],i=e[1];Array.isArray(i)?i.forEach((function(e){t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(i))},r=0,a=Object.entries(e);r<a.length;r++)n();return t.length?"&"+t.join("&"):""}function H(e){var t={};return e.replace(/^\?/,"").split("&").forEach((function(e){if(e){var n=o(e.split("="),2),r=n[0],a=n[1];t[decodeURIComponent(r)]=decodeURIComponent(a)}})),t}function q(e){var t=e.indexOf("?");if(!t)return"";var n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}var K=function(){function e(t,n){var r=this;w(this,e),this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then((function(){t(r)})).catch((function(e){r.error(e)}))}return E(e,[{key:"next",value:function(e){this.forEachObserver((function(t){t.next(e)}))}},{key:"error",value:function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)}},{key:"complete",value:function(){this.forEachObserver((function(e){e.complete()})),this.close()}},{key:"subscribe",value:function(e,t,n){var r,a=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!==typeof e||null===e)return!1;var n,r=y(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a in e&&"function"===typeof e[a])return!0}}catch(i){r.e(i)}finally{r.f()}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=X),void 0===r.error&&(r.error=X),void 0===r.complete&&(r.complete=X);var i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{a.finalError?r.error(a.finalError):r.complete()}catch(LE){}})),this.observers.push(r),i}},{key:"unsubscribeOne",value:function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}},{key:"forEachObserver",value:function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)}},{key:"sendOne",value:function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(LE){"undefined"!==typeof console&&console.error&&console.error(LE)}}))}},{key:"close",value:function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))}}]),e}();function X(){}function $(e){return e&&e._delegate?e._delegate:e}var Q=function(){function e(t,n,r){w(this,e),this.name=t,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return E(e,[{key:"setInstantiationMode",value:function(e){return this.instantiationMode=e,this}},{key:"setMultipleInstances",value:function(e){return this.multipleInstances=e,this}},{key:"setServiceProps",value:function(e){return this.serviceProps=e,this}},{key:"setInstanceCreatedCallback",value:function(e){return this.onInstanceCreated=e,this}}]),e}(),Y="[DEFAULT]",J=function(){function e(t,n){w(this,e),this.name=t,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return E(e,[{key:"get",value:function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new D;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(LE){}}return this.instancesDeferred.get(t).promise}},{key:"getImmediate",value:function(e){var t,n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(LE){if(r)return null;throw LE}}},{key:"getComponent",value:function(){return this.component}},{key:"setComponent",value:function(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Y})}catch(LE){}var t,n=y(this.instancesDeferred.entries());try{for(n.s();!(t=n.n()).done;){var r=o(t.value,2),a=r[0],i=r[1],s=this.normalizeInstanceIdentifier(a);try{var u=this.getOrInitializeService({instanceIdentifier:s});i.resolve(u)}catch(LE){}}}catch(c){n.e(c)}finally{n.f()}}}},{key:"clearInstance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}},{key:"delete",value:function(){var e=x(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Array.from(this.instances.values()),e.next=3,Promise.all([].concat(S(t.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()}))),S(t.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isComponentSet",value:function(){return null!=this.component}},{key:"isInitialized",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y;return this.instances.has(e)}},{key:"getOptions",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y;return this.instancesOptions.get(e)||{}}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.options,n=void 0===t?{}:t,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error("".concat(this.name,"(").concat(r,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));var a,i=this.getOrInitializeService({instanceIdentifier:r,options:n}),s=y(this.instancesDeferred.entries());try{for(s.s();!(a=s.n()).done;){var u=o(a.value,2),c=u[0],l=u[1],f=this.normalizeInstanceIdentifier(c);r===f&&l.resolve(i)}}catch(h){s.e(h)}finally{s.f()}return i}},{key:"onInit",value:function(e,t){var n,r=this.normalizeInstanceIdentifier(t),a=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;a.add(e),this.onInitCallbacks.set(r,a);var i=this.instances.get(r);return i&&e(i,r),function(){a.delete(e)}}},{key:"invokeOnInitCallbacks",value:function(e,t){var n=this.onInitCallbacks.get(t);if(n){var r,a=y(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;try{i(e,t)}catch(gm){}}}catch(o){a.e(o)}finally{a.f()}}}},{key:"getOrInitializeService",value:function(e){var t=e.instanceIdentifier,n=e.options,r=void 0===n?{}:n,a=this.instances.get(t);if(!a&&this.component&&(a=this.component.instanceFactory(this.container,{instanceIdentifier:Z(t),options:r}),this.instances.set(t,a),this.instancesOptions.set(t,r),this.invokeOnInitCallbacks(a,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,a)}catch(gm){}return a||null}},{key:"normalizeInstanceIdentifier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y;return this.component?this.component.multipleInstances?e:Y:e}},{key:"shouldAutoInitialize",value:function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}]),e}();function Z(e){return e===Y?void 0:e}var ee,te,ne=function(){function e(t){w(this,e),this.name=t,this.providers=new Map}return E(e,[{key:"addComponent",value:function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}},{key:"addOrOverwriteComponent",value:function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}},{key:"getProvider",value:function(e){if(this.providers.has(e))return this.providers.get(e);var t=new J(e,this);return this.providers.set(e,t),t}},{key:"getProviders",value:function(){return Array.from(this.providers.values())}}]),e}(),re=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(te||(te={}));var ae={debug:te.DEBUG,verbose:te.VERBOSE,info:te.INFO,warn:te.WARN,error:te.ERROR,silent:te.SILENT},ie=te.INFO,oe=(C(ee={},te.DEBUG,"log"),C(ee,te.VERBOSE,"log"),C(ee,te.INFO,"info"),C(ee,te.WARN,"warn"),C(ee,te.ERROR,"error"),ee),se=function(e,t){if(!(t<e.logLevel)){var n=(new Date).toISOString(),r=oe[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var a,i=arguments.length,o=new Array(i>2?i-2:0),s=2;s<i;s++)o[s-2]=arguments[s];(a=console)[r].apply(a,["[".concat(n,"]  ").concat(e.name,":")].concat(o))}},ue=function(){function e(t){w(this,e),this.name=t,this._logLevel=ie,this._logHandler=se,this._userLogHandler=null,re.push(this)}return E(e,[{key:"logLevel",get:function(){return this._logLevel},set:function(e){if(!(e in te))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}},{key:"setLogLevel",value:function(e){this._logLevel="string"===typeof e?ae[e]:e}},{key:"logHandler",get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}},{key:"userLogHandler",get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e}},{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,te.DEBUG].concat(t)),this._logHandler.apply(this,[this,te.DEBUG].concat(t))}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,te.VERBOSE].concat(t)),this._logHandler.apply(this,[this,te.VERBOSE].concat(t))}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,te.INFO].concat(t)),this._logHandler.apply(this,[this,te.INFO].concat(t))}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,te.WARN].concat(t)),this._logHandler.apply(this,[this,te.WARN].concat(t))}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,[this,te.ERROR].concat(t)),this._logHandler.apply(this,[this,te.ERROR].concat(t))}}]),e}();function ce(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function le(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ce(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var fe,he;var pe=new WeakMap,de=new WeakMap,ve=new WeakMap,me=new WeakMap,ye=new WeakMap;var ge={get:function(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return de.get(e);if("objectStoreNames"===t)return e.objectStoreNames||ve.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return we(e[t])},set:function(e,t,n){return e[t]=n,!0},has:function(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function be(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(he||(he=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(ke(this),n),we(pe.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return we(e.apply(ke(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];var i=e.call.apply(e,[ke(this),t].concat(r));return ve.set(i,t.sort?t.sort():[t]),we(i)}}function xe(e){return"function"===typeof e?be(e):(e instanceof IDBTransaction&&function(e){if(!de.has(e)){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("complete",a),e.removeEventListener("error",i),e.removeEventListener("abort",i)},a=function(){t(),r()},i=function(){n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",a),e.addEventListener("error",i),e.addEventListener("abort",i)}));de.set(e,t)}}(e),t=e,(fe||(fe=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((function(e){return t instanceof e}))?new Proxy(e,ge):e);var t}function we(e){if(e instanceof IDBRequest)return function(e){var t=new Promise((function(t,n){var r=function(){e.removeEventListener("success",a),e.removeEventListener("error",i)},a=function(){t(we(e.result)),r()},i=function(){n(e.error),r()};e.addEventListener("success",a),e.addEventListener("error",i)}));return t.then((function(t){t instanceof IDBCursor&&pe.set(t,e)})).catch((function(){})),ye.set(t,e),t}(e);if(me.has(e))return me.get(e);var t=xe(e);return t!==e&&(me.set(e,t),ye.set(t,e)),t}var ke=function(e){return ye.get(e)};var Ee,Se,Ce=["get","getKey","getAll","getAllKeys","count"],Ie=["put","add","delete","clear"],Te=new Map;function Ne(e,t){if(e instanceof IDBDatabase&&!(t in e)&&"string"===typeof t){if(Te.get(t))return Te.get(t);var n=t.replace(/FromIndex$/,""),r=t!==n,a=Ie.includes(n);if(n in(r?IDBIndex:IDBObjectStore).prototype&&(a||Ce.includes(n))){var i=function(){var e=x(g().mark((function e(t){var i,o,s,u,c,l,f=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(o=this.transaction(t,a?"readwrite":"readonly"),s=o.store,u=f.length,c=new Array(u>1?u-1:0),l=1;l<u;l++)c[l-1]=f[l];return r&&(s=s.index(c.shift())),e.next=6,Promise.all([(i=s)[n].apply(i,c),a&&o.done]);case 6:return e.abrupt("return",e.sent[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}();return Te.set(t,i),i}}}ge=function(e){return le(le({},e),{},{get:function(t,n,r){return Ne(t,n)||e.get(t,n,r)},has:function(t,n){return!!Ne(t,n)||e.has(t,n)}})}(ge);var _e=function(){function e(t){w(this,e),this.container=t}return E(e,[{key:"getPlatformInfoString",value:function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((function(e){return e})).join(" ")}}]),e}();var Re="@firebase/app",Ae="0.7.29",De=new ue("@firebase/app"),Oe="[DEFAULT]",Me=(C(Ee={},Re,"fire-core"),C(Ee,"@firebase/app-compat","fire-core-compat"),C(Ee,"@firebase/analytics","fire-analytics"),C(Ee,"@firebase/analytics-compat","fire-analytics-compat"),C(Ee,"@firebase/app-check","fire-app-check"),C(Ee,"@firebase/app-check-compat","fire-app-check-compat"),C(Ee,"@firebase/auth","fire-auth"),C(Ee,"@firebase/auth-compat","fire-auth-compat"),C(Ee,"@firebase/database","fire-rtdb"),C(Ee,"@firebase/database-compat","fire-rtdb-compat"),C(Ee,"@firebase/functions","fire-fn"),C(Ee,"@firebase/functions-compat","fire-fn-compat"),C(Ee,"@firebase/installations","fire-iid"),C(Ee,"@firebase/installations-compat","fire-iid-compat"),C(Ee,"@firebase/messaging","fire-fcm"),C(Ee,"@firebase/messaging-compat","fire-fcm-compat"),C(Ee,"@firebase/performance","fire-perf"),C(Ee,"@firebase/performance-compat","fire-perf-compat"),C(Ee,"@firebase/remote-config","fire-rc"),C(Ee,"@firebase/remote-config-compat","fire-rc-compat"),C(Ee,"@firebase/storage","fire-gcs"),C(Ee,"@firebase/storage-compat","fire-gcs-compat"),C(Ee,"@firebase/firestore","fire-fst"),C(Ee,"@firebase/firestore-compat","fire-fst-compat"),C(Ee,"fire-js","fire-js"),C(Ee,"firebase","fire-js-all"),Ee),Fe=new Map,Pe=new Map;function Le(e,t){try{e.container.addComponent(t)}catch(LE){De.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),LE)}}function Be(e){var t=e.name;if(Pe.has(t))return De.debug("There were multiple attempts to register component ".concat(t,".")),!1;Pe.set(t,e);var n,r=y(Fe.values());try{for(r.s();!(n=r.n()).done;){Le(n.value,e)}}catch(a){r.e(a)}finally{r.f()}return!0}function Ve(e,t){var n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}var ze=(C(Se={},"no-app","No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()"),C(Se,"bad-app-name","Illegal App name: '{$appName}"),C(Se,"duplicate-app","Firebase App named '{$appName}' already exists with different options or config"),C(Se,"app-deleted","Firebase App named '{$appName}' already deleted"),C(Se,"invalid-app-argument","firebase.{$appName}() takes either no argument or a Firebase App instance."),C(Se,"invalid-log-argument","First argument to `onLog` must be null or a function."),C(Se,"storage-open","Error thrown when opening storage. Original error: {$originalErrorMessage}."),C(Se,"storage-get","Error thrown when reading from storage. Original error: {$originalErrorMessage}."),C(Se,"storage-set","Error thrown when writing to storage. Original error: {$originalErrorMessage}."),C(Se,"storage-delete","Error thrown when deleting from storage. Original error: {$originalErrorMessage}."),Se),Ue=new V("app","Firebase",ze),We=function(){function e(t,n,r){var a=this;w(this,e),this._isDeleted=!1,this._options=Object.assign({},t),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Q("app",(function(){return a}),"PUBLIC"))}return E(e,[{key:"automaticDataCollectionEnabled",get:function(){return this.checkDestroyed(),this._automaticDataCollectionEnabled},set:function(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}},{key:"name",get:function(){return this.checkDestroyed(),this._name}},{key:"options",get:function(){return this.checkDestroyed(),this._options}},{key:"config",get:function(){return this.checkDestroyed(),this._config}},{key:"container",get:function(){return this._container}},{key:"isDeleted",get:function(){return this._isDeleted},set:function(e){this._isDeleted=e}},{key:"checkDestroyed",value:function(){if(this.isDeleted)throw Ue.create("app-deleted",{appName:this._name})}}]),e}(),je="9.9.1";function Ge(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Oe,t=Fe.get(e);if(!t)throw Ue.create("no-app",{appName:e});return t}function He(e,t,n){var r,a=null!==(r=Me[e])&&void 0!==r?r:e;n&&(a+="-".concat(n));var i=a.match(/\s|\//),o=t.match(/\s|\//);if(i||o){var s=['Unable to register library "'.concat(a,'" with version "').concat(t,'":')];return i&&s.push('library name "'.concat(a,'" contains illegal characters (whitespace or "/")')),i&&o&&s.push("and"),o&&s.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void De.warn(s.join(" "))}Be(new Q("".concat(a,"-version"),(function(){return{library:a,version:t}}),"VERSION"))}var qe="firebase-heartbeat-store",Ke=null;function Xe(){return Ke||(Ke=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.blocked,a=n.upgrade,i=n.blocking,o=n.terminated,s=indexedDB.open(e,t),u=we(s);return a&&s.addEventListener("upgradeneeded",(function(e){a(we(s.result),e.oldVersion,e.newVersion,we(s.transaction))})),r&&s.addEventListener("blocked",(function(){return r()})),u.then((function(e){o&&e.addEventListener("close",(function(){return o()})),i&&e.addEventListener("versionchange",(function(){return i()}))})).catch((function(){})),u}("firebase-heartbeat-database",1,{upgrade:function(e,t){if(0===t)e.createObjectStore(qe)}}).catch((function(e){throw Ue.create("storage-open",{originalErrorMessage:e.message})}))),Ke}function $e(e){return Qe.apply(this,arguments)}function Qe(){return Qe=x(g().mark((function e(t){var n,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xe();case 3:return r=e.sent,e.abrupt("return",r.transaction(qe).objectStore(qe).get(Ze(t)));case 7:throw e.prev=7,e.t0=e.catch(0),Ue.create("storage-get",{originalErrorMessage:null===(n=e.t0)||void 0===n?void 0:n.message});case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),Qe.apply(this,arguments)}function Ye(e,t){return Je.apply(this,arguments)}function Je(){return Je=x(g().mark((function e(t,n){var r,a,i,o;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Xe();case 3:return a=e.sent,i=a.transaction(qe,"readwrite"),o=i.objectStore(qe),e.next=8,o.put(n,Ze(t));case 8:return e.abrupt("return",i.done);case 11:throw e.prev=11,e.t0=e.catch(0),Ue.create("storage-set",{originalErrorMessage:null===(r=e.t0)||void 0===r?void 0:r.message});case 14:case"end":return e.stop()}}),e,null,[[0,11]])}))),Je.apply(this,arguments)}function Ze(e){return"".concat(e.name,"!").concat(e.options.appId)}var et=function(){function e(t){var n=this;w(this,e),this.container=t,this._heartbeatsCache=null;var r=this.container.getProvider("app").getImmediate();this._storage=new at(r),this._heartbeatsCachePromise=this._storage.read().then((function(e){return n._heartbeatsCache=e,e}))}return E(e,[{key:"triggerHeartbeat",value:function(){var e=x(g().mark((function e(){var t,n,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.container.getProvider("platform-logger").getImmediate(),n=t.getPlatformInfoString(),r=tt(),null!==this._heartbeatsCache){e.next=7;break}return e.next=6,this._heartbeatsCachePromise;case 6:this._heartbeatsCache=e.sent;case 7:if(this._heartbeatsCache.lastSentHeartbeatDate!==r&&!this._heartbeatsCache.heartbeats.some((function(e){return e.date===r}))){e.next=11;break}return e.abrupt("return");case 11:this._heartbeatsCache.heartbeats.push({date:r,agent:n});case 12:return this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((function(e){var t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),e.abrupt("return",this._storage.overwrite(this._heartbeatsCache));case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getHeartbeatsHeader",value:function(){var e=x(g().mark((function e(){var t,n,r,a,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this._heartbeatsCache){e.next=3;break}return e.next=3,this._heartbeatsCachePromise;case 3:if(null!==this._heartbeatsCache&&0!==this._heartbeatsCache.heartbeats.length){e.next=5;break}return e.abrupt("return","");case 5:if(t=tt(),n=nt(this._heartbeatsCache.heartbeats),r=n.heartbeatsToSend,a=n.unsentEntries,i=R(JSON.stringify({version:2,heartbeats:r})),this._heartbeatsCache.lastSentHeartbeatDate=t,!(a.length>0)){e.next=15;break}return this._heartbeatsCache.heartbeats=a,e.next=13,this._storage.overwrite(this._heartbeatsCache);case 13:e.next=17;break;case 15:this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache);case 17:return e.abrupt("return",i);case 18:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function tt(){return(new Date).toISOString().substring(0,10)}function nt(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=[],a=e.slice(),i=y(e);try{var o=function(){var e=t.value,i=r.find((function(t){return t.agent===e.agent}));if(i){if(i.dates.push(e.date),it(r)>n)return i.dates.pop(),"break"}else if(r.push({agent:e.agent,dates:[e.date]}),it(r)>n)return r.pop(),"break";a=a.slice(1)};for(i.s();!(t=i.n()).done;){var s=o();if("break"===s)break}}catch(u){i.e(u)}finally{i.f()}return{heartbeatsToSend:r,unsentEntries:a}}var rt,at=function(){function e(t){w(this,e),this.app=t,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}return E(e,[{key:"runIndexedDBEnvironmentCheck",value:function(){var e=x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("object"===typeof indexedDB){e.next=4;break}return e.abrupt("return",!1);case 4:return e.abrupt("return",new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=function(){a.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},a.onupgradeneeded=function(){n=!1},a.onerror=function(){var e;t((null===(e=a.error)||void 0===e?void 0:e.message)||"")}}catch(i){t(i)}})).then((function(){return!0})).catch((function(){return!1})));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"read",value:function(){var e=x(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return",{heartbeats:[]});case 7:return e.next=9,$e(this.app);case 9:return t=e.sent,e.abrupt("return",t||{heartbeats:[]});case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"overwrite",value:function(){var e=x(g().mark((function e(t){var n,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Ye(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:t.heartbeats}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"add",value:function(){var e=x(g().mark((function e(t){var n,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._canUseIndexedDBPromise;case 2:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return e.next=9,this.read();case 9:return r=e.sent,e.abrupt("return",Ye(this.app,{lastSentHeartbeatDate:null!==(n=t.lastSentHeartbeatDate)&&void 0!==n?n:r.lastSentHeartbeatDate,heartbeats:[].concat(S(r.heartbeats),S(t.heartbeats))}));case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function it(e){return R(JSON.stringify({version:2,heartbeats:e})).length}rt="",Be(new Q("platform-logger",(function(e){return new _e(e)}),"PRIVATE")),Be(new Q("heartbeat",(function(e){return new et(e)}),"PRIVATE")),He(Re,Ae,rt),He(Re,Ae,"esm2017"),He("fire-js","");function ot(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}Object.create;var st;Object.create;function ut(){return C({},"dependent-sdk-initialized-before-auth","Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.")}var ct=ut,lt=new V("auth","Firebase",ut()),ft=new ue("@firebase/auth");function ht(e){if(ft.logLevel<=te.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];ft.error.apply(ft,["Auth (".concat(je,"): ").concat(e)].concat(n))}}function pt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw yt.apply(void 0,[e].concat(n))}function dt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return yt.apply(void 0,[e].concat(n))}function vt(e,t,n){var r=Object.assign(Object.assign({},ct()),C({},t,n));return new V("auth","Firebase",r).create(t,{appName:e.name})}function mt(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&pt(e,"argument-error"),vt(e,"argument-error","Type of ".concat(t.constructor.name," does not match expected instance.")+"Did you pass a reference from a different Auth SDK?")}function yt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){var a,i=n[0],o=S(n.slice(1));return o[0]&&(o[0].appName=e.name),(a=e._errorFactory).create.apply(a,[i].concat(S(o)))}return lt.create.apply(lt,[e].concat(n))}function gt(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];throw yt.apply(void 0,[t].concat(r))}}function bt(e){var t="INTERNAL ASSERTION FAILED: "+e;throw ht(t),new Error(t)}function xt(e,t){e||bt(t)}var wt=new Map;function kt(e){xt(e instanceof Function,"Expected a class definition");var t=wt.get(e);return t?(xt(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,wt.set(e,t),t)}function Et(e,t){var n=Ve(e,"auth");if(n.isInitialized()){var r=n.getImmediate();if(W(n.getOptions(),null!==t&&void 0!==t?t:{}))return r;pt(r,"already-initialized")}return n.initialize({options:t})}function St(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function Ct(){return"http:"===It()||"https:"===It()}function It(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}var Tt=function(){function e(t,n){w(this,e),this.shortDelay=t,this.longDelay=n,xt(n>t,"Short delay should be less than long delay!"),this.isMobile=M()||P()}return E(e,[{key:"get",value:function(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Ct()||F()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}]),e}();function Nt(e,t){xt(e.emulator,"Emulator should always be set here");var n=e.emulator.url;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}var _t=function(){function e(){w(this,e)}return E(e,null,[{key:"initialize",value:function(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}},{key:"fetch",value:function(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:void bt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"headers",value:function(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:void bt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}},{key:"response",value:function(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:void bt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}]),e}(),Rt=(C(st={},"CREDENTIAL_MISMATCH","custom-token-mismatch"),C(st,"MISSING_CUSTOM_TOKEN","internal-error"),C(st,"INVALID_IDENTIFIER","invalid-email"),C(st,"MISSING_CONTINUE_URI","internal-error"),C(st,"INVALID_PASSWORD","wrong-password"),C(st,"MISSING_PASSWORD","internal-error"),C(st,"EMAIL_EXISTS","email-already-in-use"),C(st,"PASSWORD_LOGIN_DISABLED","operation-not-allowed"),C(st,"INVALID_IDP_RESPONSE","invalid-credential"),C(st,"INVALID_PENDING_TOKEN","invalid-credential"),C(st,"FEDERATED_USER_ID_ALREADY_LINKED","credential-already-in-use"),C(st,"MISSING_REQ_TYPE","internal-error"),C(st,"EMAIL_NOT_FOUND","user-not-found"),C(st,"RESET_PASSWORD_EXCEED_LIMIT","too-many-requests"),C(st,"EXPIRED_OOB_CODE","expired-action-code"),C(st,"INVALID_OOB_CODE","invalid-action-code"),C(st,"MISSING_OOB_CODE","internal-error"),C(st,"CREDENTIAL_TOO_OLD_LOGIN_AGAIN","requires-recent-login"),C(st,"INVALID_ID_TOKEN","invalid-user-token"),C(st,"TOKEN_EXPIRED","user-token-expired"),C(st,"USER_NOT_FOUND","user-token-expired"),C(st,"TOO_MANY_ATTEMPTS_TRY_LATER","too-many-requests"),C(st,"INVALID_CODE","invalid-verification-code"),C(st,"INVALID_SESSION_INFO","invalid-verification-id"),C(st,"INVALID_TEMPORARY_PROOF","invalid-credential"),C(st,"MISSING_SESSION_INFO","missing-verification-id"),C(st,"SESSION_EXPIRED","code-expired"),C(st,"MISSING_ANDROID_PACKAGE_NAME","missing-android-pkg-name"),C(st,"UNAUTHORIZED_DOMAIN","unauthorized-continue-uri"),C(st,"INVALID_OAUTH_CLIENT_ID","invalid-oauth-client-id"),C(st,"ADMIN_ONLY_OPERATION","admin-restricted-operation"),C(st,"INVALID_MFA_PENDING_CREDENTIAL","invalid-multi-factor-session"),C(st,"MFA_ENROLLMENT_NOT_FOUND","multi-factor-info-not-found"),C(st,"MISSING_MFA_ENROLLMENT_ID","missing-multi-factor-info"),C(st,"MISSING_MFA_PENDING_CREDENTIAL","missing-multi-factor-session"),C(st,"SECOND_FACTOR_EXISTS","second-factor-already-in-use"),C(st,"SECOND_FACTOR_LIMIT_EXCEEDED","maximum-second-factor-count-exceeded"),C(st,"BLOCKING_FUNCTION_ERROR_RESPONSE","internal-error"),st),At=new Tt(3e4,6e4);function Dt(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}function Ot(e,t,n,r){return Mt.apply(this,arguments)}function Mt(){return Mt=x(g().mark((function e(t,n,r,a){var i,o=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=o.length>4&&void 0!==o[4]?o[4]:{},e.abrupt("return",Ft(t,i,x(g().mark((function e(){var i,o,s,u;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={},o={},a&&("GET"===n?o=a:i={body:JSON.stringify(a)}),s=G(Object.assign({key:t.config.apiKey},o)).slice(1),e.next=6,t._getAdditionalHeaders();case 6:return(u=e.sent)["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode),e.abrupt("return",_t.fetch()(Vt(t,t.config.apiHost,r,s),Object.assign({method:n,headers:u,referrerPolicy:"no-referrer"},i)));case 10:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e)}))),Mt.apply(this,arguments)}function Ft(e,t,n){return Pt.apply(this,arguments)}function Pt(){return Pt=x(g().mark((function e(t,n,r){var a,i,s,u,c,l,f,h,p,d;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t._canInitEmulator=!1,a=Object.assign(Object.assign({},Rt),n),e.prev=2,i=new zt(t),e.next=6,Promise.race([r(),i.promise]);case 6:return s=e.sent,i.clearNetworkTimeout(),e.next=10,s.json();case 10:if(!("needConfirmation"in(u=e.sent))){e.next=13;break}throw Ut(t,"account-exists-with-different-credential",u);case 13:if(!s.ok||"errorMessage"in u){e.next=17;break}return e.abrupt("return",u);case 17:if(c=s.ok?u.errorMessage:u.error.message,l=c.split(" : "),f=o(l,2),h=f[0],p=f[1],"FEDERATED_USER_ID_ALREADY_LINKED"!==h){e.next=23;break}throw Ut(t,"credential-already-in-use",u);case 23:if("EMAIL_EXISTS"!==h){e.next=27;break}throw Ut(t,"email-already-in-use",u);case 27:if("USER_DISABLED"!==h){e.next=29;break}throw Ut(t,"user-disabled",u);case 29:if(d=a[h]||h.toLowerCase().replace(/[_\s]+/g,"-"),!p){e.next=34;break}throw vt(t,d,p);case 34:pt(t,d);case 35:e.next=42;break;case 37:if(e.prev=37,e.t0=e.catch(2),!(e.t0 instanceof B)){e.next=41;break}throw e.t0;case 41:pt(t,"network-request-failed");case 42:case"end":return e.stop()}}),e,null,[[2,37]])}))),Pt.apply(this,arguments)}function Lt(e,t,n,r){return Bt.apply(this,arguments)}function Bt(){return Bt=x(g().mark((function e(t,n,r,a){var i,o,s=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=s.length>4&&void 0!==s[4]?s[4]:{},e.next=3,Ot(t,n,r,a,i);case 3:return"mfaPendingCredential"in(o=e.sent)&&pt(t,"multi-factor-auth-required",{_serverResponse:o}),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e)}))),Bt.apply(this,arguments)}function Vt(e,t,n,r){var a="".concat(t).concat(n,"?").concat(r);return e.config.emulator?Nt(e.config,a):"".concat(e.config.apiScheme,"://").concat(a)}var zt=function(){function e(t){var n=this;w(this,e),this.auth=t,this.timer=null,this.promise=new Promise((function(e,t){n.timer=setTimeout((function(){return t(dt(n.auth,"network-request-failed"))}),At.get())}))}return E(e,[{key:"clearNetworkTimeout",value:function(){clearTimeout(this.timer)}}]),e}();function Ut(e,t,n){var r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);var a=dt(e,t,r);return a.customData._tokenResponse=n,a}function Wt(e,t){return jt.apply(this,arguments)}function jt(){return jt=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ot(t,"POST","/v1/accounts:delete",n));case 1:case"end":return e.stop()}}),e)}))),jt.apply(this,arguments)}function Gt(e,t){return Ht.apply(this,arguments)}function Ht(){return Ht=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ot(t,"POST","/v1/accounts:lookup",n));case 1:case"end":return e.stop()}}),e)}))),Ht.apply(this,arguments)}function qt(e){if(e)try{var t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(LE){}}function Kt(){return Kt=x(g().mark((function e(t){var n,r,a,i,o,s,u=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]&&u[1],r=$(t),e.next=4,r.getIdToken(n);case 4:return a=e.sent,gt((i=$t(a))&&i.exp&&i.auth_time&&i.iat,r.auth,"internal-error"),o="object"===typeof i.firebase?i.firebase:void 0,s=null===o||void 0===o?void 0:o.sign_in_provider,e.abrupt("return",{claims:i,token:a,authTime:qt(Xt(i.auth_time)),issuedAtTime:qt(Xt(i.iat)),expirationTime:qt(Xt(i.exp)),signInProvider:s||null,signInSecondFactor:(null===o||void 0===o?void 0:o.sign_in_second_factor)||null});case 10:case"end":return e.stop()}}),e)}))),Kt.apply(this,arguments)}function Xt(e){return 1e3*Number(e)}function $t(e){var t,n=o(e.split("."),3),r=n[0],a=n[1],i=n[2];if(void 0===r||void 0===a||void 0===i)return ht("JWT malformed, contained fewer than 3 sections"),null;try{var s=A(a);return s?JSON.parse(s):(ht("Failed to decode base64 JWT payload"),null)}catch(LE){return ht("Caught error parsing JWT payload as JSON",null===(t=LE)||void 0===t?void 0:t.toString()),null}}function Qt(e,t){return Yt.apply(this,arguments)}function Yt(){return Yt=x(g().mark((function e(t,n){var r=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r.length>2&&void 0!==r[2]&&r[2])){e.next=3;break}return e.abrupt("return",n);case 3:return e.prev=3,e.next=6,n;case 6:return e.abrupt("return",e.sent);case 9:if(e.prev=9,e.t0=e.catch(3),!(e.t0 instanceof B&&Jt(e.t0))){e.next=15;break}if(t.auth.currentUser!==t){e.next=15;break}return e.next=15,t.auth.signOut();case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,null,[[3,9]])}))),Yt.apply(this,arguments)}function Jt(e){var t=e.code;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}var Zt=function(){function e(t){w(this,e),this.user=t,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}return E(e,[{key:"_start",value:function(){this.isRunning||(this.isRunning=!0,this.schedule())}},{key:"_stop",value:function(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}},{key:"getInterval",value:function(e){var t;if(e){var n=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),n}this.errorBackoff=3e4;var r=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,r)}},{key:"schedule",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.isRunning){var n=this.getInterval(t);this.timerId=setTimeout(x(g().mark((function t(){return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.iteration();case 2:case"end":return t.stop()}}),t)}))),n)}}},{key:"iteration",value:function(){var e=x(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.user.getIdToken(!0);case 3:e.next=9;break;case 5:return e.prev=5,e.t0=e.catch(0),(null===(t=e.t0)||void 0===t?void 0:t.code)==="auth/".concat("network-request-failed")&&this.schedule(!0),e.abrupt("return");case 9:this.schedule();case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(){return e.apply(this,arguments)}}()}]),e}(),en=function(){function e(t,n){w(this,e),this.createdAt=t,this.lastLoginAt=n,this._initializeTime()}return E(e,[{key:"_initializeTime",value:function(){this.lastSignInTime=qt(this.lastLoginAt),this.creationTime=qt(this.createdAt)}},{key:"_copy",value:function(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}},{key:"toJSON",value:function(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}]),e}();function tn(e){return nn.apply(this,arguments)}function nn(){return nn=x(g().mark((function e(t){var n,r,a,i,o,s,u,c,l,f,h;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.auth,e.next=3,t.getIdToken();case 3:return a=e.sent,e.next=6,Qt(t,Gt(r,{idToken:a}));case 6:gt(null===(i=e.sent)||void 0===i?void 0:i.users.length,r,"internal-error"),o=i.users[0],t._notifyReloadListener(o),s=(null===(n=o.providerUserInfo)||void 0===n?void 0:n.length)?on(o.providerUserInfo):[],u=an(t.providerData,s),c=t.isAnonymous,l=!(t.email&&o.passwordHash)&&!(null===u||void 0===u?void 0:u.length),f=!!c&&l,h={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:u,metadata:new en(o.createdAt,o.lastLoginAt),isAnonymous:f},Object.assign(t,h);case 17:case"end":return e.stop()}}),e)}))),nn.apply(this,arguments)}function rn(){return(rn=x(g().mark((function e(t){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=$(t),e.next=3,tn(n);case 3:return e.next=5,n.auth._persistUserIfCurrent(n);case 5:n.auth._notifyListenersIfCurrent(n);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function an(e,t){var n=e.filter((function(e){return!t.some((function(t){return t.providerId===e.providerId}))}));return[].concat(S(n),S(t))}function on(e){return e.map((function(e){var t=e.providerId,n=ot(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}function sn(e,t){return un.apply(this,arguments)}function un(){return un=x(g().mark((function e(t,n){var r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ft(t,{},x(g().mark((function e(){var r,a,i,o,s,u;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=G({grant_type:"refresh_token",refresh_token:n}).slice(1),a=t.config,i=a.tokenApiHost,o=a.apiKey,s=Vt(t,i,"/v1/token","key=".concat(o)),e.next=5,t._getAdditionalHeaders();case 5:return(u=e.sent)["Content-Type"]="application/x-www-form-urlencoded",e.abrupt("return",_t.fetch()(s,{method:"POST",headers:u,body:r}));case 8:case"end":return e.stop()}}),e)}))));case 2:return r=e.sent,e.abrupt("return",{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token});case 4:case"end":return e.stop()}}),e)}))),un.apply(this,arguments)}var cn=function(){function e(){w(this,e),this.refreshToken=null,this.accessToken=null,this.expirationTime=null}return E(e,[{key:"isExpired",get:function(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}},{key:"updateFromServerResponse",value:function(e){gt(e.idToken,"internal-error"),gt("undefined"!==typeof e.idToken,"internal-error"),gt("undefined"!==typeof e.refreshToken,"internal-error");var t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):function(e){var t=$t(e);return gt(t,"internal-error"),gt("undefined"!==typeof t.exp,"internal-error"),gt("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}},{key:"getToken",value:function(){var e=x(g().mark((function e(t){var n,r=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=r.length>1&&void 0!==r[1]&&r[1],gt(!this.accessToken||this.refreshToken,t,"user-token-expired"),n||!this.accessToken||this.isExpired){e.next=4;break}return e.abrupt("return",this.accessToken);case 4:if(!this.refreshToken){e.next=8;break}return e.next=7,this.refresh(t,this.refreshToken);case 7:return e.abrupt("return",this.accessToken);case 8:return e.abrupt("return",null);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"clearRefreshToken",value:function(){this.refreshToken=null}},{key:"refresh",value:function(){var e=x(g().mark((function e(t,n){var r,a,i,o;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,sn(t,n);case 2:r=e.sent,a=r.accessToken,i=r.refreshToken,o=r.expiresIn,this.updateTokensAndExpiration(a,i,Number(o));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"updateTokensAndExpiration",value:function(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}},{key:"toJSON",value:function(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}},{key:"_assign",value:function(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}},{key:"_clone",value:function(){return Object.assign(new e,this.toJSON())}},{key:"_performRefresh",value:function(){return bt("not implemented")}}],[{key:"fromJSON",value:function(t,n){var r=n.refreshToken,a=n.accessToken,i=n.expirationTime,o=new e;return r&&(gt("string"===typeof r,"internal-error",{appName:t}),o.refreshToken=r),a&&(gt("string"===typeof a,"internal-error",{appName:t}),o.accessToken=a),i&&(gt("number"===typeof i,"internal-error",{appName:t}),o.expirationTime=i),o}}]),e}();function ln(e,t){gt("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}var fn=function(){function e(t){w(this,e);var n=t.uid,r=t.auth,a=t.stsTokenManager,i=ot(t,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Zt(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=a,this.accessToken=a.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?S(i.providerData):[],this.metadata=new en(i.createdAt||void 0,i.lastLoginAt||void 0)}return E(e,[{key:"getIdToken",value:function(){var e=x(g().mark((function e(t){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qt(this,this.stsTokenManager.getToken(this.auth,t));case 2:if(gt(n=e.sent,this.auth,"internal-error"),this.accessToken===n){e.next=9;break}return this.accessToken=n,e.next=8,this.auth._persistUserIfCurrent(this);case 8:this.auth._notifyListenersIfCurrent(this);case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getIdTokenResult",value:function(e){return function(e){return Kt.apply(this,arguments)}(this,e)}},{key:"reload",value:function(){return function(e){return rn.apply(this,arguments)}(this)}},{key:"_assign",value:function(e){this!==e&&(gt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((function(e){return Object.assign({},e)})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}},{key:"_clone",value:function(t){return new e(Object.assign(Object.assign({},this),{auth:t,stsTokenManager:this.stsTokenManager._clone()}))}},{key:"_onReload",value:function(e){gt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}},{key:"_notifyReloadListener",value:function(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}},{key:"_startProactiveRefresh",value:function(){this.proactiveRefresh._start()}},{key:"_stopProactiveRefresh",value:function(){this.proactiveRefresh._stop()}},{key:"_updateTokensIfNecessary",value:function(){var e=x(g().mark((function e(t){var n,r,a=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]&&a[1],r=!1,t.idToken&&t.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(t),r=!0),!n){e.next=6;break}return e.next=6,tn(this);case 6:return e.next=8,this.auth._persistUserIfCurrent(this);case 8:r&&this.auth._notifyListenersIfCurrent(this);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=x(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getIdToken();case 2:return t=e.sent,e.next=5,Qt(this,Wt(this.auth,{idToken:t}));case 5:return this.stsTokenManager.clearRefreshToken(),e.abrupt("return",this.auth.signOut());case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toJSON",value:function(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((function(e){return Object.assign({},e)})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}},{key:"refreshToken",get:function(){return this.stsTokenManager.refreshToken||""}}],[{key:"_fromJSON",value:function(t,n){var r,a,i,o,s,u,c,l,f=null!==(r=n.displayName)&&void 0!==r?r:void 0,h=null!==(a=n.email)&&void 0!==a?a:void 0,p=null!==(i=n.phoneNumber)&&void 0!==i?i:void 0,d=null!==(o=n.photoURL)&&void 0!==o?o:void 0,v=null!==(s=n.tenantId)&&void 0!==s?s:void 0,m=null!==(u=n._redirectEventId)&&void 0!==u?u:void 0,y=null!==(c=n.createdAt)&&void 0!==c?c:void 0,g=null!==(l=n.lastLoginAt)&&void 0!==l?l:void 0,b=n.uid,x=n.emailVerified,w=n.isAnonymous,k=n.providerData,E=n.stsTokenManager;gt(b&&E,t,"internal-error");var S=cn.fromJSON(this.name,E);gt("string"===typeof b,t,"internal-error"),ln(f,t.name),ln(h,t.name),gt("boolean"===typeof x,t,"internal-error"),gt("boolean"===typeof w,t,"internal-error"),ln(p,t.name),ln(d,t.name),ln(v,t.name),ln(m,t.name),ln(y,t.name),ln(g,t.name);var C=new e({uid:b,auth:t,email:h,emailVerified:x,displayName:f,isAnonymous:w,photoURL:d,phoneNumber:p,tenantId:v,stsTokenManager:S,createdAt:y,lastLoginAt:g});return k&&Array.isArray(k)&&(C.providerData=k.map((function(e){return Object.assign({},e)}))),m&&(C._redirectEventId=m),C}},{key:"_fromIdTokenResponse",value:function(){var t=x(g().mark((function t(n,r){var a,i,o,s=arguments;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=s.length>2&&void 0!==s[2]&&s[2],(i=new cn).updateFromServerResponse(r),o=new e({uid:r.localId,auth:n,stsTokenManager:i,isAnonymous:a}),t.next=6,tn(o);case 6:return t.abrupt("return",o);case 7:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()}]),e}(),hn=function(){function e(){w(this,e),this.type="NONE",this.storage={}}return E(e,[{key:"_isAvailable",value:function(){var e=x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.storage[t]=n;case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=x(g().mark((function e(t){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.storage[t],e.abrupt("return",void 0===n?null:n);case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:delete this.storage[t];case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),e}();hn.type="NONE";var pn=hn;function dn(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}var vn=function(){function e(t,n,r){w(this,e),this.persistence=t,this.auth=n,this.userKey=r;var a=this.auth,i=a.config,o=a.name;this.fullUserKey=dn(this.userKey,i.apiKey,o),this.fullPersistenceKey=dn("persistence",i.apiKey,o),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}return E(e,[{key:"setCurrentUser",value:function(e){return this.persistence._set(this.fullUserKey,e.toJSON())}},{key:"getCurrentUser",value:function(){var e=x(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.persistence._get(this.fullUserKey);case 2:return t=e.sent,e.abrupt("return",t?fn._fromJSON(this.auth,t):null);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeCurrentUser",value:function(){return this.persistence._remove(this.fullUserKey)}},{key:"savePersistenceForRedirect",value:function(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}},{key:"setPersistence",value:function(){var e=x(g().mark((function e(t){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.persistence!==t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.getCurrentUser();case 4:return n=e.sent,e.next=7,this.removeCurrentUser();case 7:if(this.persistence=t,!n){e.next=10;break}return e.abrupt("return",this.setCurrentUser(n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"delete",value:function(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}}],[{key:"create",value:function(){var t=x(g().mark((function t(n,r){var a,i,o,s,u,c,l,f,h,p,d,v=arguments;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=v.length>2&&void 0!==v[2]?v[2]:"authUser",r.length){t.next=3;break}return t.abrupt("return",new e(kt(pn),n,a));case 3:return t.next=5,Promise.all(r.map(function(){var e=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._isAvailable();case 2:if(!e.sent){e.next=4;break}return e.abrupt("return",t);case 4:return e.abrupt("return",void 0);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:i=t.sent.filter((function(e){return e})),o=i[0]||kt(pn),s=dn(a,n.config.apiKey,n.name),u=null,c=y(r),t.prev=10,c.s();case 12:if((l=c.n()).done){t.next=29;break}return f=l.value,t.prev=14,t.next=17,f._get(s);case 17:if(!(h=t.sent)){t.next=23;break}return p=fn._fromJSON(n,h),f!==o&&(u=p),o=f,t.abrupt("break",29);case 23:t.next=27;break;case 25:t.prev=25,t.t0=t.catch(14);case 27:t.next=12;break;case 29:t.next=34;break;case 31:t.prev=31,t.t1=t.catch(10),c.e(t.t1);case 34:return t.prev=34,c.f(),t.finish(34);case 37:if(d=i.filter((function(e){return e._shouldAllowMigration})),o._shouldAllowMigration&&d.length){t.next=40;break}return t.abrupt("return",new e(o,n,a));case 40:if(o=d[0],!u){t.next=44;break}return t.next=44,o._set(s,u.toJSON());case 44:return t.next=46,Promise.all(r.map(function(){var e=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===o){e.next=8;break}return e.prev=1,e.next=4,t._remove(s);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()));case 46:return t.abrupt("return",new e(o,n,a));case 47:case"end":return t.stop()}}),t,null,[[10,31,34,37],[14,25]])})));return function(e,n){return t.apply(this,arguments)}}()}]),e}();function mn(e){var t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(xn(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(yn(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(kn(t))return"Blackberry";if(En(t))return"Webos";if(gn(t))return"Safari";if((t.includes("chrome/")||bn(t))&&!t.includes("edge/"))return"Chrome";if(wn(t))return"Android";var n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);return 2===(null===n||void 0===n?void 0:n.length)?n[1]:"Other"}function yn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O();return/firefox\//i.test(e)}function gn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O(),t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function bn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O();return/crios\//i.test(e)}function xn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O();return/iemobile/i.test(e)}function wn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O();return/android/i.test(e)}function kn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O();return/blackberry/i.test(e)}function En(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O();return/webos/i.test(e)}function Sn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Cn(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O();return Sn(t)&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}function In(){return L()&&10===document.documentMode}function Tn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O();return Sn(e)||wn(e)||En(e)||kn(e)||/windows phone/i.test(e)||xn(e)}function Nn(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=mn(O());break;case"Worker":t="".concat(mn(O()),"-").concat(e);break;default:t=e}var r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(je,"/").concat(r)}var _n=function(){function e(t){w(this,e),this.auth=t,this.queue=[]}return E(e,[{key:"pushCallback",value:function(e,t){var n=this,r=function(t){return new Promise((function(n,r){try{n(e(t))}catch(LE){r(LE)}}))};r.onAbort=t,this.queue.push(r);var a=this.queue.length-1;return function(){n.queue[a]=function(){return Promise.resolve()}}}},{key:"runMiddleware",value:function(){var e=x(g().mark((function e(t){var n,r,a,i,o,s,u,c;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.auth.currentUser!==t){e.next=2;break}return e.abrupt("return");case 2:r=[],e.prev=3,a=y(this.queue),e.prev=5,a.s();case 7:if((i=a.n()).done){e.next=14;break}return o=i.value,e.next=11,o(t);case 11:o.onAbort&&r.push(o.onAbort);case 12:e.next=7;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(5),a.e(e.t0);case 19:return e.prev=19,a.f(),e.finish(19);case 22:e.next=30;break;case 24:e.prev=24,e.t1=e.catch(3),r.reverse(),s=y(r);try{for(s.s();!(u=s.n()).done;){c=u.value;try{c()}catch(l){}}}catch(f){s.e(f)}finally{s.f()}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===(n=e.t1)||void 0===n?void 0:n.message});case 30:case"end":return e.stop()}}),e,this,[[3,24],[5,16,19,22]])})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Rn=function(){function e(t,n,r){w(this,e),this.app=t,this.heartbeatServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Dn(this),this.idTokenSubscription=new Dn(this),this.beforeStateQueue=new _n(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=lt,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=t.name,this.clientVersion=r.sdkClientVersion}return E(e,[{key:"_initializeWithPersistence",value:function(e,t){var n=this;return t&&(this._popupRedirectResolver=kt(t)),this._initializationPromise=this.queue(x(g().mark((function r(){var a,i;return g().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!n._deleted){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,vn.create(n,e);case 4:if(n.persistenceManager=r.sent,!n._deleted){r.next=7;break}return r.abrupt("return");case 7:if(!(null===(a=n._popupRedirectResolver)||void 0===a?void 0:a._shouldInitProactively)){r.next=15;break}return r.prev=8,r.next=11,n._popupRedirectResolver._initialize(n);case 11:r.next=15;break;case 13:r.prev=13,r.t0=r.catch(8);case 15:return r.next=17,n.initializeCurrentUser(t);case 17:if(n.lastNotifiedUid=(null===(i=n.currentUser)||void 0===i?void 0:i.uid)||null,!n._deleted){r.next=20;break}return r.abrupt("return");case 20:n._isInitialized=!0;case 21:case"end":return r.stop()}}),r,null,[[8,13]])})))),this._initializationPromise}},{key:"_onStorageEvent",value:function(){var e=x(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._deleted){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.assertedPersistence.getCurrentUser();case 4:if(t=e.sent,this.currentUser||t){e.next=7;break}return e.abrupt("return");case 7:if(!this.currentUser||!t||this.currentUser.uid!==t.uid){e.next=12;break}return this._currentUser._assign(t),e.next=11,this.currentUser.getIdToken();case 11:return e.abrupt("return");case 12:return e.next=14,this._updateCurrentUser(t,!0);case 14:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeCurrentUser",value:function(){var e=x(g().mark((function e(t){var n,r,a,i,o,s,u;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.assertedPersistence.getCurrentUser();case 2:if(r=e.sent,a=r,i=!1,!t||!this.config.authDomain){e.next=14;break}return e.next=8,this.getOrInitRedirectPersistenceManager();case 8:return o=null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId,s=null===a||void 0===a?void 0:a._redirectEventId,e.next=12,this.tryRedirectSignIn(t);case 12:u=e.sent,o&&o!==s||!(null===u||void 0===u?void 0:u.user)||(a=u.user,i=!0);case 14:if(a){e.next=16;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 16:if(a._redirectEventId){e.next=32;break}if(!i){e.next=27;break}return e.prev=18,e.next=21,this.beforeStateQueue.runMiddleware(a);case 21:e.next=27;break;case 23:e.prev=23,e.t0=e.catch(18),a=r,this._popupRedirectResolver._overrideRedirectResult(this,(function(){return Promise.reject(e.t0)}));case 27:if(!a){e.next=31;break}return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(a));case 31:return e.abrupt("return",this.directlySetCurrentUser(null));case 32:return gt(this._popupRedirectResolver,this,"argument-error"),e.next=35,this.getOrInitRedirectPersistenceManager();case 35:if(!this.redirectUser||this.redirectUser._redirectEventId!==a._redirectEventId){e.next=37;break}return e.abrupt("return",this.directlySetCurrentUser(a));case 37:return e.abrupt("return",this.reloadAndSetCurrentUserOrClear(a));case 38:case"end":return e.stop()}}),e,this,[[18,23]])})));return function(t){return e.apply(this,arguments)}}()},{key:"tryRedirectSignIn",value:function(){var e=x(g().mark((function e(t){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,e.prev=1,e.next=4,this._popupRedirectResolver._completeRedirectFn(this,t,!0);case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),e.next=11,this._setRedirectUser(null);case 11:return e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"reloadAndSetCurrentUserOrClear",value:function(){var e=x(g().mark((function e(t){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,tn(t);case 3:e.next=9;break;case 5:if(e.prev=5,e.t0=e.catch(0),(null===(n=e.t0)||void 0===n?void 0:n.code)==="auth/".concat("network-request-failed")){e.next=9;break}return e.abrupt("return",this.directlySetCurrentUser(null));case 9:return e.abrupt("return",this.directlySetCurrentUser(t));case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},{key:"useDeviceLanguage",value:function(){this.languageCode=function(){if("undefined"===typeof navigator)return null;var e=navigator;return e.languages&&e.languages[0]||e.language||null}()}},{key:"_delete",value:function(){var e=x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._deleted=!0;case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateCurrentUser",value:function(){var e=x(g().mark((function e(t){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t?$(t):null)&&gt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),e.abrupt("return",this._updateCurrentUser(n&&n._clone(this)));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_updateCurrentUser",value:function(){var e=x(g().mark((function e(t){var n,r=this,a=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]&&a[1],!this._deleted){e.next=3;break}return e.abrupt("return");case 3:if(t&&gt(this.tenantId===t.tenantId,this,"tenant-id-mismatch"),n){e.next=7;break}return e.next=7,this.beforeStateQueue.runMiddleware(t);case 7:return e.abrupt("return",this.queue(x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.directlySetCurrentUser(t);case 2:r.notifyAuthListeners();case 3:case"end":return e.stop()}}),e)})))));case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"signOut",value:function(){var e=x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.beforeStateQueue.runMiddleware(null);case 2:if(!this.redirectPersistenceManager&&!this._popupRedirectResolver){e.next=5;break}return e.next=5,this._setRedirectUser(null);case 5:return e.abrupt("return",this._updateCurrentUser(null,!0));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPersistence",value:function(e){var t=this;return this.queue(x(g().mark((function n(){return g().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.assertedPersistence.setPersistence(kt(e));case 2:case"end":return n.stop()}}),n)}))))}},{key:"_getPersistence",value:function(){return this.assertedPersistence.persistence.type}},{key:"_updateErrorMap",value:function(e){this._errorFactory=new V("auth","Firebase",e())}},{key:"onAuthStateChanged",value:function(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}},{key:"beforeAuthStateChanged",value:function(e,t){return this.beforeStateQueue.pushCallback(e,t)}},{key:"onIdTokenChanged",value:function(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}},{key:"toJSON",value:function(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}},{key:"_setRedirectUser",value:function(){var e=x(g().mark((function e(t,n){var r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOrInitRedirectPersistenceManager(n);case 2:return r=e.sent,e.abrupt("return",null===t?r.removeCurrentUser():r.setCurrentUser(t));case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getOrInitRedirectPersistenceManager",value:function(){var e=x(g().mark((function e(t){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.redirectPersistenceManager){e.next=9;break}return gt(n=t&&kt(t)||this._popupRedirectResolver,this,"argument-error"),e.next=5,vn.create(this,[kt(n._redirectPersistence)],"redirectUser");case 5:return this.redirectPersistenceManager=e.sent,e.next=8,this.redirectPersistenceManager.getCurrentUser();case 8:this.redirectUser=e.sent;case 9:return e.abrupt("return",this.redirectPersistenceManager);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_redirectUserForId",value:function(){var e=x(g().mark((function e(t){var n,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._isInitialized){e.next=3;break}return e.next=3,this.queue(x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))));case 3:if((null===(n=this._currentUser)||void 0===n?void 0:n._redirectEventId)!==t){e.next=5;break}return e.abrupt("return",this._currentUser);case 5:if((null===(r=this.redirectUser)||void 0===r?void 0:r._redirectEventId)!==t){e.next=7;break}return e.abrupt("return",this.redirectUser);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_persistUserIfCurrent",value:function(){var e=x(g().mark((function e(t){var n=this;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t!==this.currentUser){e.next=2;break}return e.abrupt("return",this.queue(x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",n.directlySetCurrentUser(t));case 1:case"end":return e.stop()}}),e)})))));case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_notifyListenersIfCurrent",value:function(e){e===this.currentUser&&this.notifyAuthListeners()}},{key:"_key",value:function(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}},{key:"_startProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}},{key:"_stopProactiveRefresh",value:function(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}},{key:"_currentUser",get:function(){return this.currentUser}},{key:"notifyAuthListeners",value:function(){var e,t;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);var n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}}},{key:"registerStateListener",value:function(e,t,n,r){var a=this;if(this._deleted)return function(){};var i="function"===typeof t?t:t.next.bind(t),o=this._isInitialized?Promise.resolve():this._initializationPromise;return gt(o,this,"internal-error"),o.then((function(){return i(a.currentUser)})),"function"===typeof t?e.addObserver(t,n,r):e.addObserver(t)}},{key:"directlySetCurrentUser",value:function(){var e=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.currentUser&&this.currentUser!==t&&(this._currentUser._stopProactiveRefresh(),t&&this.isProactiveRefreshEnabled&&t._startProactiveRefresh()),this.currentUser=t,!t){e.next=7;break}return e.next=5,this.assertedPersistence.setCurrentUser(t);case 5:e.next=9;break;case 7:return e.next=9,this.assertedPersistence.removeCurrentUser();case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"queue",value:function(e){return this.operations=this.operations.then(e,e),this.operations}},{key:"assertedPersistence",get:function(){return gt(this.persistenceManager,this,"internal-error"),this.persistenceManager}},{key:"_logFramework",value:function(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Nn(this.config.clientPlatform,this._getFrameworks()))}},{key:"_getFrameworks",value:function(){return this.frameworks}},{key:"_getAdditionalHeaders",value:function(){var e=x(g().mark((function e(){var t,n,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=C({},"X-Client-Version",this.clientVersion),this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId),e.next=4,null===(t=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===t?void 0:t.getHeartbeatsHeader();case 4:return(r=e.sent)&&(n["X-Firebase-Client"]=r),e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function An(e){return $(e)}var Dn=function(){function e(t){var n=this;w(this,e),this.auth=t,this.observer=null,this.addObserver=function(e,t){var n=new K(e,t);return n.subscribe.bind(n)}((function(e){return n.observer=e}))}return E(e,[{key:"next",get:function(){return gt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}]),e}();var On=function(){function e(t,n){w(this,e),this.providerId=t,this.signInMethod=n}return E(e,[{key:"toJSON",value:function(){return bt("not implemented")}},{key:"_getIdTokenResponse",value:function(e){return bt("not implemented")}},{key:"_linkToIdToken",value:function(e,t){return bt("not implemented")}},{key:"_getReauthenticationResolver",value:function(e){return bt("not implemented")}}]),e}();function Mn(e,t){return Fn.apply(this,arguments)}function Fn(){return Fn=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ot(t,"POST","/v1/accounts:update",n));case 1:case"end":return e.stop()}}),e)}))),Fn.apply(this,arguments)}function Pn(e,t){return Ln.apply(this,arguments)}function Ln(){return Ln=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Lt(t,"POST","/v1/accounts:signInWithPassword",Dt(t,n)));case 1:case"end":return e.stop()}}),e)}))),Ln.apply(this,arguments)}function Bn(e,t){return Vn.apply(this,arguments)}function Vn(){return Vn=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Lt(t,"POST","/v1/accounts:signInWithEmailLink",Dt(t,n)));case 1:case"end":return e.stop()}}),e)}))),Vn.apply(this,arguments)}function zn(e,t){return Un.apply(this,arguments)}function Un(){return Un=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Lt(t,"POST","/v1/accounts:signInWithEmailLink",Dt(t,n)));case 1:case"end":return e.stop()}}),e)}))),Un.apply(this,arguments)}var Wn=function(e){h(n,e);var t=m(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return w(this,n),(i=t.call(this,"password",a))._email=e,i._password=r,i._tenantId=o,i}return E(n,[{key:"toJSON",value:function(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}},{key:"_getIdTokenResponse",value:function(){var e=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",Pn(t,{returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",Bn(t,{email:this._email,oobCode:this._password}));case 5:pt(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_linkToIdToken",value:function(){var e=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.signInMethod,e.next="password"===e.t0?3:"emailLink"===e.t0?4:5;break;case 3:return e.abrupt("return",Mn(t,{idToken:n,returnSecureToken:!0,email:this._email,password:this._password}));case 4:return e.abrupt("return",zn(t,{idToken:n,email:this._email,oobCode:this._password}));case 5:pt(t,"internal-error");case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_getReauthenticationResolver",value:function(e){return this._getIdTokenResponse(e)}}],[{key:"_fromEmailAndPassword",value:function(e,t){return new n(e,t,"password")}},{key:"_fromEmailAndCode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new n(e,t,"emailLink",r)}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}}]),n}(On);function jn(e,t){return Gn.apply(this,arguments)}function Gn(){return Gn=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Lt(t,"POST","/v1/accounts:signInWithIdp",Dt(t,n)));case 1:case"end":return e.stop()}}),e)}))),Gn.apply(this,arguments)}var Hn=function(e){h(n,e);var t=m(n);function n(){var e;return w(this,n),(e=t.apply(this,arguments)).pendingToken=null,e}return E(n,[{key:"toJSON",value:function(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}},{key:"_getIdTokenResponse",value:function(e){return jn(e,this.buildRequest())}},{key:"_linkToIdToken",value:function(e,t){var n=this.buildRequest();return n.idToken=t,jn(e,n)}},{key:"_getReauthenticationResolver",value:function(e){var t=this.buildRequest();return t.autoCreate=!1,jn(e,t)}},{key:"buildRequest",value:function(){var e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{var t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=G(t)}return e}}],[{key:"_fromParams",value:function(e){var t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):pt("argument-error"),t}},{key:"fromJSON",value:function(e){var t="string"===typeof e?JSON.parse(e):e,r=t.providerId,a=t.signInMethod,i=ot(t,["providerId","signInMethod"]);if(!r||!a)return null;var o=new n(r,a);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}}]),n}(On);function qn(e,t){return Kn.apply(this,arguments)}function Kn(){return Kn=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Ot(t,"POST","/v1/accounts:sendVerificationCode",Dt(t,n)));case 1:case"end":return e.stop()}}),e)}))),Kn.apply(this,arguments)}function Xn(){return Xn=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Lt(t,"POST","/v1/accounts:signInWithPhoneNumber",Dt(t,n)));case 1:case"end":return e.stop()}}),e)}))),Xn.apply(this,arguments)}function $n(){return $n=x(g().mark((function e(t,n){var r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lt(t,"POST","/v1/accounts:signInWithPhoneNumber",Dt(t,n));case 2:if(!(r=e.sent).temporaryProof){e.next=5;break}throw Ut(t,"account-exists-with-different-credential",r);case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)}))),$n.apply(this,arguments)}var Qn=C({},"USER_NOT_FOUND","user-not-found");function Yn(){return Yn=x(g().mark((function e(t,n){var r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object.assign(Object.assign({},n),{operation:"REAUTH"}),e.abrupt("return",Lt(t,"POST","/v1/accounts:signInWithPhoneNumber",Dt(t,r),Qn));case 2:case"end":return e.stop()}}),e)}))),Yn.apply(this,arguments)}var Jn=function(e){h(n,e);var t=m(n);function n(e){var r;return w(this,n),(r=t.call(this,"phone","phone")).params=e,r}return E(n,[{key:"_getIdTokenResponse",value:function(e){return function(e,t){return Xn.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_linkToIdToken",value:function(e,t){return function(e,t){return $n.apply(this,arguments)}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}},{key:"_getReauthenticationResolver",value:function(e){return function(e,t){return Yn.apply(this,arguments)}(e,this._makeVerificationRequest())}},{key:"_makeVerificationRequest",value:function(){var e=this.params,t=e.temporaryProof,n=e.phoneNumber,r=e.verificationId,a=e.verificationCode;return t&&n?{temporaryProof:t,phoneNumber:n}:{sessionInfo:r,code:a}}},{key:"toJSON",value:function(){var e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}}],[{key:"_fromVerification",value:function(e,t){return new n({verificationId:e,verificationCode:t})}},{key:"_fromTokenResponse",value:function(e,t){return new n({phoneNumber:e,temporaryProof:t})}},{key:"fromJSON",value:function(e){"string"===typeof e&&(e=JSON.parse(e));var t=e,r=t.verificationId,a=t.verificationCode,i=t.phoneNumber,o=t.temporaryProof;return a||r||i||o?new n({verificationId:r,verificationCode:a,phoneNumber:i,temporaryProof:o}):null}}]),n}(On);var Zn=function(){function e(t){var n,r,a,i,o,s;w(this,e);var u=H(q(t)),c=null!==(n=u.apiKey)&&void 0!==n?n:null,l=null!==(r=u.oobCode)&&void 0!==r?r:null,f=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(a=u.mode)&&void 0!==a?a:null);gt(c&&l&&f,"argument-error"),this.apiKey=c,this.operation=f,this.code=l,this.continueUrl=null!==(i=u.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(o=u.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(s=u.tenantId)&&void 0!==s?s:null}return E(e,null,[{key:"parseLink",value:function(t){var n=function(e){var t=H(q(e)).link,n=t?H(q(t)).deep_link_id:null,r=H(q(e)).deep_link_id;return(r?H(q(r)).link:null)||r||n||t||e}(t);try{return new e(n)}catch(gm){return null}}}]),e}();var er=function(){function e(){w(this,e),this.providerId=e.PROVIDER_ID}return E(e,null,[{key:"credential",value:function(e,t){return Wn._fromEmailAndPassword(e,t)}},{key:"credentialWithLink",value:function(e,t){var n=Zn.parseLink(t);return gt(n,"argument-error"),Wn._fromEmailAndCode(e,n.code,n.tenantId)}}]),e}();er.PROVIDER_ID="password",er.EMAIL_PASSWORD_SIGN_IN_METHOD="password",er.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var tr=function(){function e(t){w(this,e),this.providerId=t,this.defaultLanguageCode=null,this.customParameters={}}return E(e,[{key:"setDefaultLanguage",value:function(e){this.defaultLanguageCode=e}},{key:"setCustomParameters",value:function(e){return this.customParameters=e,this}},{key:"getCustomParameters",value:function(){return this.customParameters}}]),e}(),nr=function(e){h(n,e);var t=m(n);function n(){var e;return w(this,n),(e=t.apply(this,arguments)).scopes=[],e}return E(n,[{key:"addScope",value:function(e){return this.scopes.includes(e)||this.scopes.push(e),this}},{key:"getScopes",value:function(){return S(this.scopes)}}]),n}(tr),rr=function(e){h(n,e);var t=m(n);function n(){return w(this,n),t.call(this,"facebook.com")}return E(n,null,[{key:"credential",value:function(e){return Hn._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(gm){return null}}}]),n}(nr);rr.FACEBOOK_SIGN_IN_METHOD="facebook.com",rr.PROVIDER_ID="facebook.com";var ar=function(e){h(n,e);var t=m(n);function n(){var e;return w(this,n),(e=t.call(this,"google.com")).addScope("profile"),e}return E(n,null,[{key:"credential",value:function(e,t){return Hn._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthIdToken,a=t.oauthAccessToken;if(!r&&!a)return null;try{return n.credential(r,a)}catch(gm){return null}}}]),n}(nr);ar.GOOGLE_SIGN_IN_METHOD="google.com",ar.PROVIDER_ID="google.com";var ir=function(e){h(n,e);var t=m(n);function n(){return w(this,n),t.call(this,"github.com")}return E(n,null,[{key:"credential",value:function(e){return Hn._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:e})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return n.credential(t.oauthAccessToken)}catch(gm){return null}}}]),n}(nr);ir.GITHUB_SIGN_IN_METHOD="github.com",ir.PROVIDER_ID="github.com";var or=function(e){h(n,e);var t=m(n);function n(){return w(this,n),t.call(this,"twitter.com")}return E(n,null,[{key:"credential",value:function(e,t){return Hn._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}},{key:"credentialFromResult",value:function(e){return n.credentialFromTaggedObject(e)}},{key:"credentialFromError",value:function(e){return n.credentialFromTaggedObject(e.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var r=t.oauthAccessToken,a=t.oauthTokenSecret;if(!r||!a)return null;try{return n.credential(r,a)}catch(gm){return null}}}]),n}(nr);or.TWITTER_SIGN_IN_METHOD="twitter.com",or.PROVIDER_ID="twitter.com";var sr=function(){function e(t){w(this,e),this.user=t.user,this.providerId=t.providerId,this._tokenResponse=t._tokenResponse,this.operationType=t.operationType}return E(e,null,[{key:"_fromIdTokenResponse",value:function(){var t=x(g().mark((function t(n,r,a){var i,o,s,u,c=arguments;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=c.length>3&&void 0!==c[3]&&c[3],t.next=3,fn._fromIdTokenResponse(n,a,i);case 3:return o=t.sent,s=ur(a),u=new e({user:o,providerId:s,_tokenResponse:a,operationType:r}),t.abrupt("return",u);case 7:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()},{key:"_forOperation",value:function(){var t=x(g().mark((function t(n,r,a){var i;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n._updateTokensIfNecessary(a,!0);case 2:return i=ur(a),t.abrupt("return",new e({user:n,providerId:i,_tokenResponse:a,operationType:r}));case 4:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}()}]),e}();function ur(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}var cr=function(e){h(n,e);var t=m(n);function n(e,r,a,i){var o,s;return w(this,n),(o=t.call(this,r.code,r.message)).operationType=a,o.user=i,Object.setPrototypeOf(l(o),n.prototype),o.customData={appName:e.name,tenantId:null!==(s=e.tenantId)&&void 0!==s?s:void 0,_serverResponse:r.customData._serverResponse,operationType:a},o}return E(n,null,[{key:"_fromErrorAndOperation",value:function(e,t,r,a){return new n(e,t,r,a)}}]),n}(B);function lr(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((function(n){if(n.code==="auth/".concat("multi-factor-auth-required"))throw cr._fromErrorAndOperation(e,n,t,r);throw n}))}function fr(e,t){return hr.apply(this,arguments)}function hr(){return hr=x(g().mark((function e(t,n){var r,a,i=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]&&i[2],e.t0=Qt,e.t1=t,e.t2=n,e.t3=t.auth,e.next=7,t.getIdToken();case 7:return e.t4=e.sent,e.t5=e.t2._linkToIdToken.call(e.t2,e.t3,e.t4),e.t6=r,e.next=12,(0,e.t0)(e.t1,e.t5,e.t6);case 12:return a=e.sent,e.abrupt("return",sr._forOperation(t,"link",a));case 14:case"end":return e.stop()}}),e)}))),hr.apply(this,arguments)}function pr(e,t){return dr.apply(this,arguments)}function dr(){return dr=x(g().mark((function e(t,n){var r,a,i,o,s,u,c,l=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=l.length>2&&void 0!==l[2]&&l[2],i=t.auth,o="reauthenticate",e.prev=3,e.next=6,Qt(t,lr(i,o,n,t),r);case 6:return gt((s=e.sent).idToken,i,"internal-error"),gt(u=$t(s.idToken),i,"internal-error"),c=u.sub,gt(t.uid===c,i,"user-mismatch"),e.abrupt("return",sr._forOperation(t,o,s));case 15:throw e.prev=15,e.t0=e.catch(3),(null===(a=e.t0)||void 0===a?void 0:a.code)==="auth/".concat("user-not-found")&&pt(i,"user-mismatch"),e.t0;case 19:case"end":return e.stop()}}),e,null,[[3,15]])}))),dr.apply(this,arguments)}function vr(e,t){return mr.apply(this,arguments)}function mr(){return mr=x(g().mark((function e(t,n){var r,a,i,o,s=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=s.length>2&&void 0!==s[2]&&s[2],a="signIn",e.next=4,lr(t,a,n);case 4:return i=e.sent,e.next=7,sr._fromIdTokenResponse(t,a,i);case 7:if(o=e.sent,r){e.next=11;break}return e.next=11,t._updateCurrentUser(o.user);case 11:return e.abrupt("return",o);case 12:case"end":return e.stop()}}),e)}))),mr.apply(this,arguments)}function yr(e,t){return Ot(e,"POST","/v2/accounts/mfaEnrollment:start",Dt(e,t))}new WeakMap;var gr="__sak",br=function(){function e(t,n){w(this,e),this.storageRetriever=t,this.type=n}return E(e,[{key:"_isAvailable",value:function(){try{return this.storage?(this.storage.setItem(gr,"1"),this.storage.removeItem(gr),Promise.resolve(!0)):Promise.resolve(!1)}catch(gm){return Promise.resolve(!1)}}},{key:"_set",value:function(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}},{key:"_get",value:function(e){var t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}},{key:"_remove",value:function(e){return this.storage.removeItem(e),Promise.resolve()}},{key:"storage",get:function(){return this.storageRetriever()}}]),e}();var xr=function(e){h(n,e);var t=m(n);function n(){var e;return w(this,n),(e=t.call(this,(function(){return window.localStorage}),"LOCAL")).boundEventHandler=function(t,n){return e.onStorageEvent(t,n)},e.listeners={},e.localCache={},e.pollTimer=null,e.safariLocalStorageNotSynced=function(){var e=O();return gn(e)||Sn(e)}()&&function(){try{return!(!window||window===window.top)}catch(LE){return!1}}(),e.fallbackToPolling=Tn(),e._shouldAllowMigration=!0,e}return E(n,[{key:"forAllChangedKeys",value:function(e){for(var t=0,n=Object.keys(this.listeners);t<n.length;t++){var r=n[t],a=this.storage.getItem(r),i=this.localCache[r];a!==i&&e(r,i,a)}}},{key:"onStorageEvent",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.key){var r=e.key;if(n?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){var a=this.storage.getItem(r);if(e.newValue!==a)null!==e.newValue?this.storage.setItem(r,e.newValue):this.storage.removeItem(r);else if(this.localCache[r]===e.newValue&&!n)return}var i=function(){var e=t.storage.getItem(r);(n||t.localCache[r]!==e)&&t.notifyListeners(r,e)},o=this.storage.getItem(r);In()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}else this.forAllChangedKeys((function(e,n,r){t.notifyListeners(e,r)}))}},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,a=Array.from(n);r<a.length;r++){(0,a[r])(t?JSON.parse(t):t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval((function(){e.forAllChangedKeys((function(t,n,r){e.onStorageEvent(new StorageEvent("storage",{key:t,oldValue:n,newValue:r}),!0)}))}),1e3)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"attachListener",value:function(){window.addEventListener("storage",this.boundEventHandler)}},{key:"detachListener",value:function(){window.removeEventListener("storage",this.boundEventHandler)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}},{key:"_set",value:function(){var e=x(g().mark((function e(t,r){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(s(n.prototype),"_set",this).call(this,t,r);case 2:this.localCache[t]=JSON.stringify(r);case 3:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=x(g().mark((function e(t){var r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(s(n.prototype),"_get",this).call(this,t);case 2:return r=e.sent,this.localCache[t]=JSON.stringify(r),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c(s(n.prototype),"_remove",this).call(this,t);case 2:delete this.localCache[t];case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),n}(br);xr.type="LOCAL";var wr=xr,kr=function(e){h(n,e);var t=m(n);function n(){return w(this,n),t.call(this,(function(){return window.sessionStorage}),"SESSION")}return E(n,[{key:"_addListener",value:function(e,t){}},{key:"_removeListener",value:function(e,t){}}]),n}(br);kr.type="SESSION";var Er=kr;function Sr(e){return Promise.all(e.map(function(){var e=x(g().mark((function e(t){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t;case 3:return n=e.sent,e.abrupt("return",{fulfilled:!0,value:n});case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",{fulfilled:!1,reason:e.t0});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))}var Cr=function(){function e(t){w(this,e),this.eventTarget=t,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}return E(e,[{key:"isListeningto",value:function(e){return this.eventTarget===e}},{key:"handleEvent",value:function(){var e=x(g().mark((function e(t){var n,r,a,i,o,s,u,c;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=t).data,a=r.eventId,i=r.eventType,o=r.data,null===(s=this.handlersMap[i])||void 0===s?void 0:s.size){e.next=5;break}return e.abrupt("return");case 5:return n.ports[0].postMessage({status:"ack",eventId:a,eventType:i}),u=Array.from(s).map(function(){var e=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t(n.origin,o));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),e.next=9,Sr(u);case 9:c=e.sent,n.ports[0].postMessage({status:"done",eventId:a,eventType:i,response:c});case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_subscribe",value:function(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}},{key:"_unsubscribe",value:function(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}],[{key:"_getInstance",value:function(t){var n=this.receivers.find((function(e){return e.isListeningto(t)}));if(n)return n;var r=new e(t);return this.receivers.push(r),r}}]),e}();function Ir(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="",r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Cr.receivers=[];var Tr=function(){function e(t){w(this,e),this.target=t,this.handlers=new Set}return E(e,[{key:"removeMessageHandler",value:function(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}},{key:"_send",value:function(){var e=x(g().mark((function e(t,n){var r,a,i,o,s=this,u=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=u.length>2&&void 0!==u[2]?u[2]:50,a="undefined"!==typeof MessageChannel?new MessageChannel:null){e.next=4;break}throw new Error("connection_unavailable");case 4:return e.abrupt("return",new Promise((function(e,u){var c=Ir("",20);a.port1.start();var l=setTimeout((function(){u(new Error("unsupported_event"))}),r);o={messageChannel:a,onMessage:function(t){var n=t;if(n.data.eventId===c)switch(n.data.status){case"ack":clearTimeout(l),i=setTimeout((function(){u(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),e(n.data.response);break;default:clearTimeout(l),clearTimeout(i),u(new Error("invalid_response"))}}},s.handlers.add(o),a.port1.addEventListener("message",o.onMessage),s.target.postMessage({eventType:t,eventId:c,data:n},[a.port2])})).finally((function(){o&&s.removeMessageHandler(o)})));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}();function Nr(){return window}function _r(){return"undefined"!==typeof Nr().WorkerGlobalScope&&"function"===typeof Nr().importScripts}function Rr(){return Ar.apply(this,arguments)}function Ar(){return(Ar=x(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===navigator||void 0===navigator?void 0:navigator.serviceWorker){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return t=e.sent,e.abrupt("return",t.active);case 9:return e.prev=9,e.t0=e.catch(2),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function Dr(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}var Or="firebaseLocalStorageDb",Mr="firebaseLocalStorage",Fr="fbase_key",Pr=function(){function e(t){w(this,e),this.request=t}return E(e,[{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.request.addEventListener("success",(function(){t(e.request.result)})),e.request.addEventListener("error",(function(){n(e.request.error)}))}))}}]),e}();function Lr(e,t){return e.transaction([Mr],t?"readwrite":"readonly").objectStore(Mr)}function Br(){var e=indexedDB.deleteDatabase(Or);return new Pr(e).toPromise()}function Vr(){var e=indexedDB.open(Or,1);return new Promise((function(t,n){e.addEventListener("error",(function(){n(e.error)})),e.addEventListener("upgradeneeded",(function(){var t=e.result;try{t.createObjectStore(Mr,{keyPath:Fr})}catch(LE){n(LE)}})),e.addEventListener("success",x(g().mark((function n(){var r;return g().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if((r=e.result).objectStoreNames.contains(Mr)){n.next=12;break}return r.close(),n.next=5,Br();case 5:return n.t0=t,n.next=8,Vr();case 8:n.t1=n.sent,(0,n.t0)(n.t1),n.next=13;break;case 12:t(r);case 13:case"end":return n.stop()}}),n)}))))}))}function zr(e,t,n){return Ur.apply(this,arguments)}function Ur(){return Ur=x(g().mark((function e(t,n,r){var a,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=Lr(t,!0).put((C(a={},Fr,n),C(a,"value",r),a)),e.abrupt("return",new Pr(i).toPromise());case 2:case"end":return e.stop()}}),e)}))),Ur.apply(this,arguments)}function Wr(e,t){return jr.apply(this,arguments)}function jr(){return jr=x(g().mark((function e(t,n){var r,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Lr(t,!1).get(n),e.next=3,new Pr(r).toPromise();case 3:return a=e.sent,e.abrupt("return",void 0===a?null:a.value);case 5:case"end":return e.stop()}}),e)}))),jr.apply(this,arguments)}function Gr(e,t){var n=Lr(e,!0).delete(t);return new Pr(n).toPromise()}var Hr=function(){function e(){w(this,e),this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((function(){}),(function(){}))}return E(e,[{key:"_openDb",value:function(){var e=x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.db){e.next=2;break}return e.abrupt("return",this.db);case 2:return e.next=4,Vr();case 4:return this.db=e.sent,e.abrupt("return",this.db);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_withRetries",value:function(){var e=x(g().mark((function e(t){var n,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:return e.prev=2,e.next=5,this._openDb();case 5:return r=e.sent,e.next=8,t(r);case 8:return e.abrupt("return",e.sent);case 11:if(e.prev=11,e.t0=e.catch(2),!(n++>3)){e.next=15;break}throw e.t0;case 15:this.db&&(this.db.close(),this.db=void 0);case 16:e.next=1;break;case 18:case"end":return e.stop()}}),e,this,[[2,11]])})));return function(t){return e.apply(this,arguments)}}()},{key:"initializeServiceWorkerMessaging",value:function(){var e=x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",_r()?this.initializeReceiver():this.initializeSender());case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeReceiver",value:function(){var e=x(g().mark((function e(){var t=this;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.receiver=Cr._getInstance(_r()?self:null),this.receiver._subscribe("keyChanged",function(){var e=x(g().mark((function e(n,r){var a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t._poll();case 2:return a=e.sent,e.abrupt("return",{keyProcessed:a.includes(r.key)});case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()),this.receiver._subscribe("ping",function(){var e=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",["keyChanged"]);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initializeSender",value:function(){var e=x(g().mark((function e(){var t,n,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Rr();case 2:if(this.activeServiceWorker=e.sent,this.activeServiceWorker){e.next=5;break}return e.abrupt("return");case 5:return this.sender=new Tr(this.activeServiceWorker),e.next=8,this.sender._send("ping",{},800);case 8:if(r=e.sent){e.next=11;break}return e.abrupt("return");case 11:(null===(t=r[0])||void 0===t?void 0:t.fulfilled)&&(null===(n=r[0])||void 0===n?void 0:n.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0);case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyServiceWorker",value:function(){var e=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.sender&&this.activeServiceWorker&&Dr()===this.activeServiceWorker){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,this.sender._send("keyChanged",{key:t},this.serviceWorkerReceiverAvailable?800:50);case 5:e.next=9;break;case 7:e.prev=7,e.t0=e.catch(2);case 9:case"end":return e.stop()}}),e,this,[[2,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_isAvailable",value:function(){var e=x(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,indexedDB){e.next=3;break}return e.abrupt("return",!1);case 3:return e.next=5,Vr();case 5:return t=e.sent,e.next=8,zr(t,gr,"1");case 8:return e.next=10,Gr(t,gr);case 10:return e.abrupt("return",!0);case 13:e.prev=13,e.t0=e.catch(0);case 15:return e.abrupt("return",!1);case 16:case"end":return e.stop()}}),e,null,[[0,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"_withPendingWrite",value:function(){var e=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.pendingWrites++,e.prev=1,e.next=4,t();case 4:return e.prev=4,this.pendingWrites--,e.finish(4);case 7:case"end":return e.stop()}}),e,this,[[1,,4,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"_set",value:function(){var e=x(g().mark((function e(t,n){var r=this;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._withRetries((function(e){return zr(e,t,n)}));case 2:return r.localCache[t]=n,e.abrupt("return",r.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_get",value:function(){var e=x(g().mark((function e(t){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){return Wr(e,t)}));case 2:return n=e.sent,this.localCache[t]=n,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_remove",value:function(){var e=x(g().mark((function e(t){var n=this;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._withPendingWrite(x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n._withRetries((function(e){return Gr(e,t)}));case 2:return delete n.localCache[t],e.abrupt("return",n.notifyServiceWorker(t));case 4:case"end":return e.stop()}}),e)})))));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_poll",value:function(){var e=x(g().mark((function e(){var t,n,r,a,i,o,s,u,c,l,f;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._withRetries((function(e){var t=Lr(e,!1).getAll();return new Pr(t).toPromise()}));case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return",[]);case 5:if(0===this.pendingWrites){e.next=7;break}return e.abrupt("return",[]);case 7:n=[],r=new Set,a=y(t);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.fbase_key,u=o.value,r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(u)&&(this.notifyListeners(s,u),n.push(s))}catch(h){a.e(h)}finally{a.f()}for(c=0,l=Object.keys(this.localCache);c<l.length;c++)f=l[c],this.localCache[f]&&!r.has(f)&&(this.notifyListeners(f,null),n.push(f));return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notifyListeners",value:function(e,t){this.localCache[e]=t;var n=this.listeners[e];if(n)for(var r=0,a=Array.from(n);r<a.length;r++){(0,a[r])(t)}}},{key:"startPolling",value:function(){var e=this;this.stopPolling(),this.pollTimer=setInterval(x(g().mark((function t(){return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e._poll());case 1:case"end":return t.stop()}}),t)}))),800)}},{key:"stopPolling",value:function(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}},{key:"_addListener",value:function(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}},{key:"_removeListener",value:function(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}]),e}();Hr.type="LOCAL";var qr=Hr;function Kr(e,t){return Ot(e,"POST","/v2/accounts/mfaSignIn:start",Dt(e,t))}function Xr(e){return new Promise((function(t,n){var r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=function(e){var t=dt("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)}))}function $r(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}$r("rcb"),new Tt(3e4,6e4);var Qr="recaptcha";function Yr(e,t,n){return Jr.apply(this,arguments)}function Jr(){return Jr=x(g().mark((function e(t,n,r){var a,i,o,s,u,c,l,f,h;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.verify();case 2:if(i=e.sent,e.prev=3,gt("string"===typeof i,t,"argument-error"),gt(r.type===Qr,t,"argument-error"),!("session"in(o="string"===typeof n?{phoneNumber:n}:n))){e.next=26;break}if(s=o.session,!("phoneNumber"in o)){e.next=17;break}return gt("enroll"===s.type,t,"internal-error"),e.next=13,yr(t,{idToken:s.credential,phoneEnrollmentInfo:{phoneNumber:o.phoneNumber,recaptchaToken:i}});case 13:return u=e.sent,e.abrupt("return",u.phoneSessionInfo.sessionInfo);case 17:return gt("signin"===s.type,t,"internal-error"),gt(c=(null===(a=o.multiFactorHint)||void 0===a?void 0:a.uid)||o.multiFactorUid,t,"missing-multi-factor-info"),e.next=22,Kr(t,{mfaPendingCredential:s.credential,mfaEnrollmentId:c,phoneSignInInfo:{recaptchaToken:i}});case 22:return l=e.sent,e.abrupt("return",l.phoneResponseInfo.sessionInfo);case 24:e.next=31;break;case 26:return e.next=28,qn(t,{phoneNumber:o.phoneNumber,recaptchaToken:i});case 28:return f=e.sent,h=f.sessionInfo,e.abrupt("return",h);case 31:return e.prev=31,r._reset(),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[3,,31,34]])}))),Jr.apply(this,arguments)}var Zr=function(){function e(t){w(this,e),this.providerId=e.PROVIDER_ID,this.auth=An(t)}return E(e,[{key:"verifyPhoneNumber",value:function(e,t){return Yr(this.auth,e,$(t))}}],[{key:"credential",value:function(e,t){return Jn._fromVerification(e,t)}},{key:"credentialFromResult",value:function(t){var n=t;return e.credentialFromTaggedObject(n)}},{key:"credentialFromError",value:function(t){return e.credentialFromTaggedObject(t.customData||{})}},{key:"credentialFromTaggedObject",value:function(e){var t=e._tokenResponse;if(!t)return null;var n=t.phoneNumber,r=t.temporaryProof;return n&&r?Jn._fromTokenResponse(n,r):null}}]),e}();function ea(e,t){return t?kt(t):(gt(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Zr.PROVIDER_ID="phone",Zr.PHONE_SIGN_IN_METHOD="phone";var ta=function(e){h(n,e);var t=m(n);function n(e){var r;return w(this,n),(r=t.call(this,"custom","custom")).params=e,r}return E(n,[{key:"_getIdTokenResponse",value:function(e){return jn(e,this._buildIdpRequest())}},{key:"_linkToIdToken",value:function(e,t){return jn(e,this._buildIdpRequest(t))}},{key:"_getReauthenticationResolver",value:function(e){return jn(e,this._buildIdpRequest())}},{key:"_buildIdpRequest",value:function(e){var t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}]),n}(On);function na(e){return vr(e.auth,new ta(e),e.bypassAuthState)}function ra(e){var t=e.auth,n=e.user;return gt(n,t,"internal-error"),pr(n,new ta(e),e.bypassAuthState)}function aa(e){return ia.apply(this,arguments)}function ia(){return ia=x(g().mark((function e(t){var n,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.auth,gt(r=t.user,n,"internal-error"),e.abrupt("return",fr(r,new ta(t),t.bypassAuthState));case 3:case"end":return e.stop()}}),e)}))),ia.apply(this,arguments)}var oa=function(){function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];w(this,e),this.auth=t,this.resolver=r,this.user=a,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}return E(e,[{key:"execute",value:function(){var e=this;return new Promise(function(){var t=x(g().mark((function t(n,r){return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.pendingPromise={resolve:n,reject:r},t.prev=1,t.next=4,e.resolver._initialize(e.auth);case 4:return e.eventManager=t.sent,t.next=7,e.onExecution();case 7:e.eventManager.registerConsumer(e),t.next=13;break;case 10:t.prev=10,t.t0=t.catch(1),e.reject(t.t0);case 13:case"end":return t.stop()}}),t,null,[[1,10]])})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"onAuthEvent",value:function(){var e=x(g().mark((function e(t){var n,r,a,i,o,s,u;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.urlResponse,r=t.sessionId,a=t.postBody,i=t.tenantId,o=t.error,s=t.type,!o){e.next=4;break}return this.reject(o),e.abrupt("return");case 4:return u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:a||void 0,user:this.user,bypassAuthState:this.bypassAuthState},e.prev=5,e.t0=this,e.next=9,this.getIdpTask(s)(u);case 9:e.t1=e.sent,e.t0.resolve.call(e.t0,e.t1),e.next=16;break;case 13:e.prev=13,e.t2=e.catch(5),this.reject(e.t2);case 16:case"end":return e.stop()}}),e,this,[[5,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"onError",value:function(e){this.reject(e)}},{key:"getIdpTask",value:function(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return na;case"linkViaPopup":case"linkViaRedirect":return aa;case"reauthViaPopup":case"reauthViaRedirect":return ra;default:pt(this.auth,"internal-error")}}},{key:"resolve",value:function(e){xt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}},{key:"reject",value:function(e){xt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}},{key:"unregisterAndCleanUp",value:function(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}]),e}(),sa=new Tt(2e3,1e4);function ua(){return ua=x(g().mark((function e(t,n,r){var a,i,o;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=An(t),mt(t,n,tr),i=ea(a,r),o=new ca(a,"signInViaPopup",n,i),e.abrupt("return",o.executeNotNull());case 5:case"end":return e.stop()}}),e)}))),ua.apply(this,arguments)}var ca=function(e){h(n,e);var t=m(n);function n(e,r,a,i,o){var s;return w(this,n),(s=t.call(this,e,r,i,o)).provider=a,s.authWindow=null,s.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=l(s),s}return E(n,[{key:"executeNotNull",value:function(){var e=x(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.execute();case 2:return gt(t=e.sent,this.auth,"internal-error"),e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=x(g().mark((function e(){var t,n=this;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return xt(1===this.filter.length,"Popup operations only handle one event"),t=Ir(),e.next=4,this.resolver._openPopup(this.auth,this.provider,this.filter[0],t);case 4:this.authWindow=e.sent,this.authWindow.associatedEvent=t,this.resolver._originValidation(this.auth).catch((function(e){n.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(function(e){e||n.reject(dt(n.auth,"web-storage-unsupported"))})),this.pollUserCancellation();case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"eventId",get:function(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}},{key:"cancel",value:function(){this.reject(dt(this.auth,"cancelled-popup-request"))}},{key:"cleanUp",value:function(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}},{key:"pollUserCancellation",value:function(){var e=this;!function t(){var n,r;(null===(r=null===(n=e.authWindow)||void 0===n?void 0:n.window)||void 0===r?void 0:r.closed)?e.pollId=window.setTimeout((function(){e.pollId=null,e.reject(dt(e.auth,"popup-closed-by-user"))}),2e3):e.pollId=window.setTimeout(t,sa.get())}()}}]),n}(oa);ca.currentPopupAction=null;var la=new Map,fa=function(e){h(n,e);var t=m(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return w(this,n),(a=t.call(this,e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,i)).eventId=null,a}return E(n,[{key:"execute",value:function(){var e=x(g().mark((function e(){var t,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=la.get(this.auth._key())){e.next=21;break}return e.prev=2,e.next=5,ha(this.resolver,this.auth);case 5:if(!e.sent){e.next=12;break}return e.next=9,c(s(n.prototype),"execute",this).call(this);case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=null;case 13:r=e.t0,t=function(){return Promise.resolve(r)},e.next=20;break;case 17:e.prev=17,e.t1=e.catch(2),t=function(){return Promise.reject(e.t1)};case 20:la.set(this.auth._key(),t);case 21:return this.bypassAuthState||la.set(this.auth._key(),(function(){return Promise.resolve(null)})),e.abrupt("return",t());case 23:case"end":return e.stop()}}),e,this,[[2,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"onAuthEvent",value:function(){var e=x(g().mark((function e(t){var r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("signInViaRedirect"!==t.type){e.next=4;break}return e.abrupt("return",c(s(n.prototype),"onAuthEvent",this).call(this,t));case 4:if("unknown"!==t.type){e.next=7;break}return this.resolve(null),e.abrupt("return");case 7:if(!t.eventId){e.next=17;break}return e.next=10,this.auth._redirectUserForId(t.eventId);case 10:if(!(r=e.sent)){e.next=16;break}return this.user=r,e.abrupt("return",c(s(n.prototype),"onAuthEvent",this).call(this,t));case 16:this.resolve(null);case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onExecution",value:function(){var e=x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"cleanUp",value:function(){}}]),n}(oa);function ha(e,t){return pa.apply(this,arguments)}function pa(){return pa=x(g().mark((function e(t,n){var r,a,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ma(n),a=va(t),e.next=4,a._isAvailable();case 4:if(e.sent){e.next=6;break}return e.abrupt("return",!1);case 6:return e.next=8,a._get(r);case 8:return e.t0=e.sent,i="true"===e.t0,e.next=12,a._remove(r);case 12:return e.abrupt("return",i);case 13:case"end":return e.stop()}}),e)}))),pa.apply(this,arguments)}function da(e,t){la.set(e._key(),t)}function va(e){return kt(e._redirectPersistence)}function ma(e){return dn("pendingRedirect",e.config.apiKey,e.name)}function ya(e,t){return ga.apply(this,arguments)}function ga(){return ga=x(g().mark((function e(t,n){var r,a,i,o,s,u=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.length>2&&void 0!==u[2]&&u[2],a=An(t),i=ea(a,n),o=new fa(a,i,r),e.next=6,o.execute();case 6:if(!(s=e.sent)||r){e.next=13;break}return delete s.user._redirectEventId,e.next=11,a._persistUserIfCurrent(s.user);case 11:return e.next=13,a._setRedirectUser(null,n);case 13:return e.abrupt("return",s);case 14:case"end":return e.stop()}}),e)}))),ga.apply(this,arguments)}var ba=function(){function e(t){w(this,e),this.auth=t,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}return E(e,[{key:"registerConsumer",value:function(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}},{key:"unregisterConsumer",value:function(e){this.consumers.delete(e)}},{key:"onEvent",value:function(e){var t=this;if(this.hasEventBeenHandled(e))return!1;var n=!1;return this.consumers.forEach((function(r){t.isEventForConsumer(e,r)&&(n=!0,t.sendToConsumer(e,r),t.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wa(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}},{key:"sendToConsumer",value:function(e,t){var n;if(e.error&&!wa(e)){var r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(dt(this.auth,r))}else t.onAuthEvent(e)}},{key:"isEventForConsumer",value:function(e,t){var n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}},{key:"hasEventBeenHandled",value:function(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(xa(e))}},{key:"saveEventToCache",value:function(e){this.cachedEventUids.add(xa(e)),this.lastProcessedEventTime=Date.now()}}]),e}();function xa(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((function(e){return e})).join("-")}function wa(e){var t=e.type,n=e.error;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}function ka(e){return Ea.apply(this,arguments)}function Ea(){return Ea=x(g().mark((function e(t){var n,r=arguments;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=r.length>1&&void 0!==r[1]?r[1]:{},e.abrupt("return",Ot(t,"GET","/v1/projects",n));case 2:case"end":return e.stop()}}),e)}))),Ea.apply(this,arguments)}var Sa=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ca=/^https?/;function Ia(){return Ia=x(g().mark((function e(t){var n,r,a,i,o;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.config.emulator){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,ka(t);case 4:n=e.sent,r=n.authorizedDomains,a=y(r),e.prev=7,a.s();case 9:if((i=a.n()).done){e.next=20;break}if(o=i.value,e.prev=11,!Ta(o)){e.next=14;break}return e.abrupt("return");case 14:e.next=18;break;case 16:e.prev=16,e.t0=e.catch(11);case 18:e.next=9;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(7),a.e(e.t1);case 25:return e.prev=25,a.f(),e.finish(25);case 28:pt(t,"unauthorized-domain");case 29:case"end":return e.stop()}}),e,null,[[7,22,25,28],[11,16]])}))),Ia.apply(this,arguments)}function Ta(e){var t=St(),n=new URL(t),r=n.protocol,a=n.hostname;if(e.startsWith("chrome-extension://")){var i=new URL(e);return""===i.hostname&&""===a?"chrome-extension:"===r&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===r&&i.hostname===a}if(!Ca.test(r))return!1;if(Sa.test(e))return a===e;var o=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)}var Na=new Tt(3e4,6e4);function _a(){var e=Nr().___jsl;if(null===e||void 0===e?void 0:e.H)for(var t=0,n=Object.keys(e.H);t<n.length;t++){var r=n[t];if(e.H[r].r=e.H[r].r||[],e.H[r].L=e.H[r].L||[],e.H[r].r=S(e.H[r].L),e.CP)for(var a=0;a<e.CP.length;a++)e.CP[a]=null}}var Ra=null;function Aa(e){return Ra=Ra||function(e){return new Promise((function(t,n){var r,a,i;function o(){_a(),gapi.load("gapi.iframes",{callback:function(){t(gapi.iframes.getContext())},ontimeout:function(){_a(),n(dt(e,"network-request-failed"))},timeout:Na.get()})}if(null===(a=null===(r=Nr().gapi)||void 0===r?void 0:r.iframes)||void 0===a?void 0:a.Iframe)t(gapi.iframes.getContext());else{if(!(null===(i=Nr().gapi)||void 0===i?void 0:i.load)){var s=$r("iframefcb");return Nr()[s]=function(){gapi.load?o():n(dt(e,"network-request-failed"))},Xr("https://apis.google.com/js/api.js?onload=".concat(s)).catch((function(e){return n(e)}))}o()}})).catch((function(e){throw Ra=null,e}))}(e),Ra}var Da=new Tt(5e3,15e3),Oa={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Ma=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Fa(e){var t=e.config;gt(t.authDomain,e,"auth-domain-config-required");var n=t.emulator?Nt(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:je},a=Ma.get(e.config.apiHost);a&&(r.eid=a);var i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),"".concat(n,"?").concat(G(r).slice(1))}function Pa(e){return La.apply(this,arguments)}function La(){return La=x(g().mark((function e(t){var n,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Aa(t);case 2:return n=e.sent,gt(r=Nr().gapi,t,"internal-error"),e.abrupt("return",n.open({where:document.body,url:Fa(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Oa,dontclear:!0},(function(e){return new Promise(function(){var n=x(g().mark((function n(r,a){var i,o,s;return g().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=function(){Nr().clearTimeout(o),r(e)},n.next=3,e.restyle({setHideOnLeave:!1});case 3:i=dt(t,"network-request-failed"),o=Nr().setTimeout((function(){a(i)}),Da.get()),e.ping(s).then(s,(function(){a(i)}));case 6:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())})));case 6:case"end":return e.stop()}}),e)}))),La.apply(this,arguments)}var Ba={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Va="_blank",za="http://localhost",Ua=function(){function e(t){w(this,e),this.window=t,this.associatedEvent=null}return E(e,[{key:"close",value:function(){if(this.window)try{this.window.close()}catch(LE){}}}]),e}();function Wa(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600,i=Math.max((window.screen.availHeight-a)/2,0).toString(),s=Math.max((window.screen.availWidth-r)/2,0).toString(),u="",c=Object.assign(Object.assign({},Ba),{width:r.toString(),height:a.toString(),top:i,left:s}),l=O().toLowerCase();n&&(u=bn(l)?Va:n),yn(l)&&(t=t||za,c.scrollbars="yes");var f=Object.entries(c).reduce((function(e,t){var n=o(t,2),r=n[0],a=n[1];return"".concat(e).concat(r,"=").concat(a,",")}),"");if(Cn(l)&&"_self"!==u)return ja(t||"",u),new Ua(null);var h=window.open(t||"",u,f);gt(h,e,"popup-blocked");try{h.focus()}catch(LE){}return new Ua(h)}function ja(e,t){var n=document.createElement("a");n.href=e,n.target=t;var r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}var Ga="__/auth/handler",Ha="emulator/auth/handler";function qa(e,t,n,r,a,i){gt(e.config.authDomain,e,"auth-domain-config-required"),gt(e.config.apiKey,e,"invalid-api-key");var s={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:je,eventId:a};if(t instanceof tr){t.setDefaultLanguage(e.languageCode),s.providerId=t.providerId||"",function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(s.customParameters=JSON.stringify(t.getCustomParameters()));for(var u=0,c=Object.entries(i||{});u<c.length;u++){var l=o(c[u],2),f=l[0],h=l[1];s[f]=h}}if(t instanceof nr){var p=t.getScopes().filter((function(e){return""!==e}));p.length>0&&(s.scopes=p.join(","))}e.tenantId&&(s.tid=e.tenantId);for(var d=s,v=0,m=Object.keys(d);v<m.length;v++){var y=m[v];void 0===d[y]&&delete d[y]}return"".concat(function(e){var t=e.config;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(Ga);return Nt(t,Ha)}(e),"?").concat(G(d).slice(1))}var Ka="webStorageSupport",Xa=function(){function e(){w(this,e),this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Er,this._completeRedirectFn=ya,this._overrideRedirectResult=da}return E(e,[{key:"_openPopup",value:function(){var e=x(g().mark((function e(t,n,r,a){var i,o;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return xt(null===(i=this.eventManagers[t._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()"),o=qa(t,n,r,St(),a),e.abrupt("return",Wa(t,o,Ir()));case 3:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_openRedirect",value:function(){var e=x(g().mark((function e(t,n,r,a){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._originValidation(t);case 2:return i=qa(t,n,r,St(),a),Nr().location.href=i,e.abrupt("return",new Promise((function(){})));case 4:case"end":return e.stop()}var i}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"_initialize",value:function(e){var t=this,n=e._key();if(this.eventManagers[n]){var r=this.eventManagers[n],a=r.manager,i=r.promise;return a?Promise.resolve(a):(xt(i,"If manager is not set, promise should be"),i)}var o=this.initAndGetManager(e);return this.eventManagers[n]={promise:o},o.catch((function(){delete t.eventManagers[n]})),o}},{key:"initAndGetManager",value:function(){var e=x(g().mark((function e(t){var n,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Pa(t);case 2:return n=e.sent,r=new ba(t),n.register("authEvent",(function(e){return gt(null===e||void 0===e?void 0:e.authEvent,t,"invalid-auth-event"),{status:r.onEvent(e.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[t._key()]={manager:r},this.iframes[t._key()]=n,e.abrupt("return",r);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_isIframeWebStorageSupported",value:function(e,t){this.iframes[e._key()].send(Ka,{type:Ka},(function(n){var r,a=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==a&&t(!!a),pt(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}},{key:"_originValidation",value:function(e){var t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=function(e){return Ia.apply(this,arguments)}(e)),this.originValidationPromises[t]}},{key:"_shouldInitProactively",get:function(){return Tn()||gn()||Sn()}}]),e}(),$a=Xa,Qa=function(){function e(t){w(this,e),this.factorId=t}return E(e,[{key:"_process",value:function(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return bt("unexpected MultiFactorSessionType")}}}]),e}(),Ya=function(e){h(n,e);var t=m(n);function n(e){var r;return w(this,n),(r=t.call(this,"phone")).credential=e,r}return E(n,[{key:"_finalizeEnroll",value:function(e,t,n){return function(e,t){return Ot(e,"POST","/v2/accounts/mfaEnrollment:finalize",Dt(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},{key:"_finalizeSignIn",value:function(e,t){return function(e,t){return Ot(e,"POST","/v2/accounts/mfaSignIn:finalize",Dt(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}],[{key:"_fromCredential",value:function(e){return new n(e)}}]),n}(Qa);(function(){function e(){w(this,e)}return E(e,null,[{key:"assertion",value:function(e){return Ya._fromCredential(e)}}]),e}()).FACTOR_ID="phone";var Ja,Za="@firebase/auth",ei="0.20.5",ti=function(){function e(t){w(this,e),this.auth=t,this.internalListeners=new Map}return E(e,[{key:"getUid",value:function(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}},{key:"getToken",value:function(){var e=x(g().mark((function e(t){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assertAuthConfigured(),e.next=3,this.auth._initializationPromise;case 3:if(this.auth.currentUser){e.next=5;break}return e.abrupt("return",null);case 5:return e.next=7,this.auth.currentUser.getIdToken(t);case 7:return n=e.sent,e.abrupt("return",{accessToken:n});case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addAuthTokenListener",value:function(e){if(this.assertAuthConfigured(),!this.internalListeners.has(e)){var t=this.auth.onIdTokenChanged((function(t){var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}}},{key:"removeAuthTokenListener",value:function(e){this.assertAuthConfigured();var t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}},{key:"assertAuthConfigured",value:function(){gt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}},{key:"updateProactiveRefresh",value:function(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}]),e}();function ni(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(LE){i(LE)}}function s(e){try{u(r.throw(e))}catch(LE){i(LE)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function ri(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(LE){i=[6,LE],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}Ja="Browser",Be(new Q("auth",(function(e,t){var n=t.options,r=e.getProvider("app").getImmediate(),a=e.getProvider("heartbeat"),i=r.options,o=i.apiKey,s=i.authDomain;return function(e,t){gt(o&&!o.includes(":"),"invalid-api-key",{appName:e.name}),gt(!(null===s||void 0===s?void 0:s.includes(":")),"argument-error",{appName:e.name});var r={apiKey:o,authDomain:s,clientPlatform:Ja,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Nn(Ja)},a=new Rn(e,t,r);return function(e,t){var n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(kt);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(a,n),a}(r,a)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((function(e,t,n){e.getProvider("auth-internal").initialize()}))),Be(new Q("auth-internal",(function(e){return function(e){return new ti(e)}(An(e.getProvider("auth").getImmediate()))}),"PRIVATE").setInstantiationMode("EXPLICIT")),He(Za,ei,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Ja)),He(Za,ei,"esm2017");var ai=function(){return ai=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ai.apply(this,arguments)},ii=function(e){return{loading:void 0===e||null===e,value:e}},oi=function(t){var n=t?t():void 0,r=(0,e.useReducer)((function(e,t){switch(t.type){case"error":return ai(ai({},e),{error:t.error,loading:!1,value:void 0});case"reset":return ii(t.defaultValue);case"value":return ai(ai({},e),{error:void 0,loading:!1,value:t.value});default:return e}}),ii(n)),a=r[0],i=r[1],o=function(){var e=t?t():void 0;i({type:"reset",defaultValue:e})},s=function(e){i({type:"error",error:e})},u=function(e){i({type:"value",value:e})};return(0,e.useMemo)((function(){return{error:a.error,loading:a.loading,reset:o,setError:s,setValue:u,value:a.value}}),[a.error,a.loading,o,s,u,a.value])},si=function(t,n){var r=oi((function(){return t.currentUser})),a=r.error,i=r.loading,o=r.setError,s=r.setValue,u=r.value;(0,e.useEffect)((function(){var e=function(e,t,n,r){return $(e).onAuthStateChanged(t,n,r)}(t,(function(e){return ni(void 0,void 0,void 0,(function(){var t;return ri(this,(function(r){switch(r.label){case 0:if(!(null===n||void 0===n?void 0:n.onUserChanged))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,n.onUserChanged(e)];case 2:return r.sent(),[3,4];case 3:return t=r.sent(),o(t),[3,4];case 4:return s(e),[2]}}))}))}),o);return function(){e()}}),[t]);var c=[u,i,a];return(0,e.useMemo)((function(){return c}),c)};He("firebase","9.9.1","app");var ui,ci="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof n.g?n.g:"undefined"!==typeof self?self:{},li={},fi=fi||{},hi=ci||self;function pi(){}function di(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function vi(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var mi="closure_uid_"+(1e9*Math.random()>>>0),yi=0;function gi(e,t,n){return e.call.apply(e.bind,arguments)}function bi(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function xi(e,t,n){return(xi=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?gi:bi).apply(null,arguments)}function wi(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function ki(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var a=Array(arguments.length-2),i=2;i<arguments.length;i++)a[i-2]=arguments[i];return t.prototype[n].apply(e,a)}}function Ei(){this.s=this.s,this.o=this.o}var Si={};Ei.prototype.s=!1,Ei.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,mi)&&e[mi]||(e[mi]=++yi)}(this);delete Si[e]}},Ei.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var Ci=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},Ii=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,a="string"===typeof e?e.split(""):e,i=0;i<r;i++)i in a&&t.call(n,a[i],i,e)};function Ti(e){return Array.prototype.concat.apply([],arguments)}function Ni(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function _i(e){return/^[\s\xa0]*$/.test(e)}var Ri,Ai=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function Di(e,t){return-1!=e.indexOf(t)}function Oi(e,t){return e<t?-1:e>t?1:0}e:{var Mi=hi.navigator;if(Mi){var Fi=Mi.userAgent;if(Fi){Ri=Fi;break e}}Ri=""}function Pi(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function Li(e){var t={};for(var n in e)t[n]=e[n];return t}var Bi="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Vi(e,t){for(var n,r,a=1;a<arguments.length;a++){for(n in r=arguments[a])e[n]=r[n];for(var i=0;i<Bi.length;i++)n=Bi[i],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function zi(e){return zi[" "](e),e}zi[" "]=pi;var Ui,Wi=Di(Ri,"Opera"),ji=Di(Ri,"Trident")||Di(Ri,"MSIE"),Gi=Di(Ri,"Edge"),Hi=Gi||ji,qi=Di(Ri,"Gecko")&&!(Di(Ri.toLowerCase(),"webkit")&&!Di(Ri,"Edge"))&&!(Di(Ri,"Trident")||Di(Ri,"MSIE"))&&!Di(Ri,"Edge"),Ki=Di(Ri.toLowerCase(),"webkit")&&!Di(Ri,"Edge");function Xi(){var e=hi.document;return e?e.documentMode:void 0}e:{var $i="",Qi=function(){var e=Ri;return qi?/rv:([^\);]+)(\)|;)/.exec(e):Gi?/Edge\/([\d\.]+)/.exec(e):ji?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):Ki?/WebKit\/(\S+)/.exec(e):Wi?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(Qi&&($i=Qi?Qi[1]:""),ji){var Yi=Xi();if(null!=Yi&&Yi>parseFloat($i)){Ui=String(Yi);break e}}Ui=$i}var Ji,Zi={};function eo(){return function(e){var t=Zi;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){for(var e=0,t=Ai(String(Ui)).split("."),n=Ai("9").split("."),r=Math.max(t.length,n.length),a=0;0==e&&a<r;a++){var i=t[a]||"",o=n[a]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],0==i[0].length&&0==o[0].length)break;e=Oi(0==i[1].length?0:parseInt(i[1],10),0==o[1].length?0:parseInt(o[1],10))||Oi(0==i[2].length,0==o[2].length)||Oi(i[2],o[2]),i=i[3],o=o[3]}while(0==e)}return 0<=e}))}if(hi.document&&ji){var to=Xi();Ji=to||(parseInt(Ui,10)||void 0)}else Ji=void 0;var no=Ji,ro=function(){if(!hi.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{hi.addEventListener("test",pi,t),hi.removeEventListener("test",pi,t)}catch(HE){}return e}();function ao(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function io(e,t){if(ao.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(qi){e:{try{zi(t.nodeName);var a=!0;break e}catch(XE){}a=!1}a||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:oo[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&io.Z.h.call(this)}}ao.prototype.h=function(){this.defaultPrevented=!0},ki(io,ao);var oo={2:"touch",3:"pen",4:"mouse"};io.prototype.h=function(){io.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var so="closure_listenable_"+(1e6*Math.random()|0),uo=0;function co(e,t,n,r,a){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=a,this.key=++uo,this.ca=this.fa=!1}function lo(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function fo(e){this.src=e,this.g={},this.h=0}function ho(e,t){var n=t.type;if(n in e.g){var r,a=e.g[n],i=Ci(a,t);(r=0<=i)&&Array.prototype.splice.call(a,i,1),r&&(lo(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function po(e,t,n,r){for(var a=0;a<e.length;++a){var i=e[a];if(!i.ca&&i.listener==t&&i.capture==!!n&&i.ia==r)return a}return-1}fo.prototype.add=function(e,t,n,r,a){var i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);var o=po(e,t,r,a);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new co(t,this.src,i,!!r,a)).fa=n,e.push(t)),t};var vo="closure_lm_"+(1e6*Math.random()|0),mo={};function yo(e,t,n,r,a){if(r&&r.once)return bo(e,t,n,r,a);if(Array.isArray(t)){for(var i=0;i<t.length;i++)yo(e,t[i],n,r,a);return null}return n=Io(n),e&&e[so]?e.N(t,n,vi(r)?!!r.capture:!!r,a):go(e,t,n,!1,r,a)}function go(e,t,n,r,a,i){if(!t)throw Error("Invalid event type");var o=vi(a)?!!a.capture:!!a,s=So(e);if(s||(e[vo]=s=new fo(e)),(n=s.add(t,n,r,o,i)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=Eo;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)ro||(a=o),void 0===a&&(a=!1),e.addEventListener(t.toString(),r,a);else if(e.attachEvent)e.attachEvent(ko(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function bo(e,t,n,r,a){if(Array.isArray(t)){for(var i=0;i<t.length;i++)bo(e,t[i],n,r,a);return null}return n=Io(n),e&&e[so]?e.O(t,n,vi(r)?!!r.capture:!!r,a):go(e,t,n,!0,r,a)}function xo(e,t,n,r,a){if(Array.isArray(t))for(var i=0;i<t.length;i++)xo(e,t[i],n,r,a);else r=vi(r)?!!r.capture:!!r,n=Io(n),e&&e[so]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=po(i=e.g[t],n,r,a))&&(lo(i[n]),Array.prototype.splice.call(i,n,1),0==i.length&&(delete e.g[t],e.h--)))):e&&(e=So(e))&&(t=e.g[t.toString()],e=-1,t&&(e=po(t,n,r,a)),(n=-1<e?t[e]:null)&&wo(n))}function wo(e){if("number"!==typeof e&&e&&!e.ca){var t=e.src;if(t&&t[so])ho(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(ko(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=So(t))?(ho(n,e),0==n.h&&(n.src=null,t[vo]=null)):lo(e)}}}function ko(e){return e in mo?mo[e]:mo[e]="on"+e}function Eo(e,t){if(e.ca)e=!0;else{t=new io(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&wo(e),e=n.call(r,t)}return e}function So(e){return(e=e[vo])instanceof fo?e:null}var Co="__closure_events_fn_"+(1e9*Math.random()>>>0);function Io(e){return"function"===typeof e?e:(e[Co]||(e[Co]=function(t){return e.handleEvent(t)}),e[Co])}function To(){Ei.call(this),this.i=new fo(this),this.P=this,this.I=null}function No(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"===typeof t)t=new ao(t,e);else if(t instanceof ao)t.target=t.target||e;else{var a=t;Vi(t=new ao(r,e),a)}if(a=!0,n)for(var i=n.length-1;0<=i;i--){var o=t.g=n[i];a=_o(o,r,!0,t)&&a}if(a=_o(o=t.g=e,r,!0,t)&&a,a=_o(o,r,!1,t)&&a,n)for(i=0;i<n.length;i++)a=_o(o=t.g=n[i],r,!1,t)&&a}function _o(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var a=!0,i=0;i<t.length;++i){var o=t[i];if(o&&!o.ca&&o.capture==n){var s=o.listener,u=o.ia||o.src;o.fa&&ho(e.i,o),a=!1!==s.call(u,r)&&a}}return a&&!r.defaultPrevented}ki(To,Ei),To.prototype[so]=!0,To.prototype.removeEventListener=function(e,t,n,r){xo(this,e,t,n,r)},To.prototype.M=function(){if(To.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)lo(n[r]);delete t.g[e],t.h--}}this.I=null},To.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},To.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Ro=hi.JSON.stringify;function Ao(){var e=Vo,t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var Do,Oo=function(){function e(){w(this,e),this.h=this.g=null}return E(e,[{key:"add",value:function(e,t){var n=Mo.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}}]),e}(),Mo=new(function(){function e(t,n){w(this,e),this.i=t,this.j=n,this.h=0,this.g=null}return E(e,[{key:"get",value:function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}]),e}())((function(){return new Fo}),(function(e){return e.reset()})),Fo=function(){function e(){w(this,e),this.next=this.g=this.h=null}return E(e,[{key:"set",value:function(e,t){this.h=e,this.g=t,this.next=null}},{key:"reset",value:function(){this.next=this.g=this.h=null}}]),e}();function Po(e){hi.setTimeout((function(){throw e}),0)}function Lo(e,t){Do||function(){var e=hi.Promise.resolve(void 0);Do=function(){e.then(zo)}}(),Bo||(Do(),Bo=!0),Vo.add(e,t)}var Bo=!1,Vo=new Oo;function zo(){for(var e;e=Ao();){try{e.h.call(e.g)}catch(HE){Po(HE)}var t=Mo;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Bo=!1}function Uo(e,t){To.call(this),this.h=e||1,this.g=t||hi,this.j=xi(this.kb,this),this.l=Date.now()}function Wo(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function jo(e,t,n){if("function"===typeof e)n&&(e=xi(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=xi(e.handleEvent,e)}return 2147483647<Number(t)?-1:hi.setTimeout(e,t||0)}function Go(e){e.g=jo((function(){e.g=null,e.i&&(e.i=!1,Go(e))}),e.j);var t=e.h;e.h=null,e.m.apply(null,t)}ki(Uo,To),(ui=Uo.prototype).da=!1,ui.S=null,ui.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),No(this,"tick"),this.da&&(Wo(this),this.start()))}},ui.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},ui.M=function(){Uo.Z.M.call(this),Wo(this),delete this.g};var Ho=function(e){h(n,e);var t=m(n);function n(e,r){var a;return w(this,n),(a=t.call(this)).m=e,a.j=r,a.h=null,a.i=!1,a.g=null,a}return E(n,[{key:"l",value:function(e){this.h=arguments,this.g?this.i=!0:Go(this)}},{key:"M",value:function(){c(s(n.prototype),"M",this).call(this),this.g&&(hi.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}]),n}(Ei);function qo(e){Ei.call(this),this.h=e,this.g={}}ki(qo,Ei);var Ko=[];function Xo(e,t,n,r){Array.isArray(n)||(n&&(Ko[0]=n.toString()),n=Ko);for(var a=0;a<n.length;a++){var i=yo(t,n[a],r||e.handleEvent,!1,e.h||e);if(!i)break;e.g[i.key]=i}}function $o(e){Pi(e.g,(function(e,t){this.g.hasOwnProperty(t)&&wo(e)}),e),e.g={}}function Qo(){this.g=!0}function Yo(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var a=r[1];if(Array.isArray(a)&&!(1>a.length)){var i=a[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(var o=1;o<a.length;o++)a[o]=""}}}return Ro(n)}catch(BE){return t}}(e,n)+(r?" "+r:"")}))}qo.prototype.M=function(){qo.Z.M.call(this),$o(this)},qo.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Qo.prototype.Aa=function(){this.g=!1},Qo.prototype.info=function(){};var Jo={},Zo=null;function es(){return Zo=Zo||new To}function ts(e){ao.call(this,Jo.Ma,e)}function ns(e){var t=es();No(t,new ts(t,e))}function rs(e,t){ao.call(this,Jo.STAT_EVENT,e),this.stat=t}function as(e){var t=es();No(t,new rs(t,e))}function is(e,t){ao.call(this,Jo.Na,e),this.size=t}function os(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return hi.setTimeout((function(){e()}),t)}Jo.Ma="serverreachability",ki(ts,ao),Jo.STAT_EVENT="statevent",ki(rs,ao),Jo.Na="timingevent",ki(is,ao);var ss={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},us={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function cs(){}function ls(e){return e.h||(e.h=e.i())}function fs(){}cs.prototype.h=null;var hs,ps={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ds(){ao.call(this,"d")}function vs(){ao.call(this,"c")}function ms(){}function ys(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new qo(this),this.P=bs,e=Hi?125:void 0,this.W=new Uo(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new gs}function gs(){this.i=null,this.g="",this.h=!1}ki(ds,ao),ki(vs,ao),ki(ms,cs),ms.prototype.g=function(){return new XMLHttpRequest},ms.prototype.i=function(){return{}},hs=new ms;var bs=45e3,xs={},ws={};function ks(e,t,n){e.K=1,e.v=Hs(Vs(t)),e.s=n,e.U=!0,Es(e,null)}function Es(e,t){e.F=Date.now(),Ts(e),e.A=Vs(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),au(n.h,"t",r),e.C=0,n=e.l.H,e.h=new gs,e.g=ic(e.l,n?t:null,!e.s),0<e.O&&(e.L=new Ho(xi(e.Ia,e,e.g),e.O)),Xo(e.V,e.g,"readystatechange",e.gb),t=e.H?Li(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),ns(1),function(e,t,n,r,a,i){e.info((function(){if(e.g)if(i)for(var o="",s=i.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var f=l.split("_");o=2<=f.length&&"type"==f[1]?o+(l+"=")+c+"&":o+(l+"=redacted&")}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+a+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.X,e.s)}function Ss(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Ba)}function Cs(e,t,n){for(var r,a=!0;!e.I&&e.C<n.length;){if((r=Is(e,n))==ws){4==t&&(e.o=4,as(14),a=!1),Yo(e.j,e.m,null,"[Incomplete Response]");break}if(r==xs){e.o=4,as(15),Yo(e.j,e.m,n,"[Invalid Chunk]"),a=!1;break}Yo(e.j,e.m,r,null),Ds(e,r)}Ss(e)&&r!=ws&&r!=xs&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,as(16),a=!1),e.i=e.i&&a,a?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Yu(t),t.L=!0,as(11))):(Yo(e.j,e.m,n,"[Invalid Chunked Response]"),As(e),Rs(e))}function Is(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?ws:(n=Number(t.substring(n,r)),isNaN(n)?xs:(r+=1)+n>t.length?ws:(t=t.substr(r,n),e.C=r+n,t))}function Ts(e){e.Y=Date.now()+e.P,Ns(e,e.P)}function Ns(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=os(xi(e.eb,e),t)}function _s(e){e.B&&(hi.clearTimeout(e.B),e.B=null)}function Rs(e){0==e.l.G||e.I||ec(e.l,e)}function As(e){_s(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,Wo(e.W),$o(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function Ds(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||fu(n.i,e)))if(n.I=e.N,!e.J&&fu(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(i){r=null}if(Array.isArray(r)&&3==r.length){var a=r;if(0==a[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;Zu(n),Wu(n)}Qu(n),as(18)}}else n.ta=a[1],0<n.ta-n.U&&37500>a[2]&&n.N&&0==n.A&&!n.v&&(n.v=os(xi(n.ab,n),6e3));if(1>=lu(n.i)&&n.ka){try{n.ka()}catch(i){}n.ka=void 0}}else nc(n,11)}else if((e.J||n.g==e)&&Zu(n),!_i(t))for(a=n.Ca.g.parse(t),t=0;t<a.length;t++){var i=a[t];if(n.U=i[0],i=i[1],2==n.G)if("c"==i[0]){n.J=i[1],n.la=i[2];var o=i[3];null!=o&&(n.ma=o,n.h.info("VER="+n.ma));var s=i[4];null!=s&&(n.za=s,n.h.info("SVER="+n.za));var u=i[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var c=e.g;if(c){var l=c.g?c.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var f=r.i;!f.g&&(Di(l,"spdy")||Di(l,"quic")||Di(l,"h2"))&&(f.j=f.l,f.g=new Set,f.h&&(hu(f,f.h),f.h=null))}if(r.D){var h=c.g?c.g.getResponseHeader("X-HTTP-Session-Id"):null;h&&(r.sa=h,Gs(r.F,r.D,h))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var p=e;if((r=n).oa=ac(r,r.H?r.la:null,r.W),p.J){pu(r.i,p);var d=p,v=r.K;v&&d.setTimeout(v),d.B&&(_s(d),Ts(d)),r.g=p}else $u(r);0<n.l.length&&Hu(n)}else"stop"!=i[0]&&"close"!=i[0]||nc(n,7);else 3==n.G&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?nc(n,7):Uu(n):"noop"!=i[0]&&n.j&&n.j.wa(i),n.A=0)}ns(4)}catch(i){}}function Os(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(di(e)||"string"===typeof e)Ii(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(di(e)||"string"===typeof e){n=[];for(var r=e.length,a=0;a<r;a++)n.push(a)}else for(a in n=[],r=0,e)n[r++]=a;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"===typeof e)return e.split("");if(di(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),a=r.length;for(var i=0;i<a;i++)t.call(void 0,r[i],n&&n[i],e)}}function Ms(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof Ms)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function Fs(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];Ps(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var a={};for(n=t=0;t<e.g.length;)Ps(a,r=e.g[t])||(e.g[n++]=r,a[r]=1),t++;e.g.length=n}}function Ps(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(ui=ys.prototype).setTimeout=function(e){this.P=e},ui.gb=function(e){e=e.target;var t=this.L;t&&3==Pu(e)?t.l():this.Ia(e)},ui.Ia=function(e){try{if(e==this.g)e:{var t=Pu(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>t)&&(3!=t||Hi||this.g&&(this.h.h||this.g.ga()||Lu(this.g)))){this.I||4!=t||7==n||ns(8==n||0>=r?3:2),_s(this);var a=this.g.ba();this.N=a;t:if(Ss(this)){var i=Lu(this.g);e="";var o=i.length,s=4==Pu(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){As(this),Rs(this);var u="";break t}this.h.i=new hi.TextDecoder}for(n=0;n<o;n++)this.h.h=!0,e+=this.h.i.decode(i[n],{stream:s&&n==o-1});i.splice(0,o),this.h.g+=e,this.C=0,u=this.h.g}else u=this.g.ga();if(this.i=200==a,function(e,t,n,r,a,i,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+a+"]: "+t+"\n"+n+"\n"+i+" "+o}))}(this.j,this.u,this.A,this.m,this.X,t,a),this.i){if(this.$&&!this.J){t:{if(this.g){var c,l=this.g;if((c=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_i(c)){var f=c;break t}}f=null}if(!(a=f)){this.i=!1,this.o=3,as(12),As(this),Rs(this);break e}Yo(this.j,this.m,a,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Ds(this,a)}this.U?(Cs(this,t,u),Hi&&this.i&&3==t&&(Xo(this.V,this.W,"tick",this.fb),this.W.start())):(Yo(this.j,this.m,u,null),Ds(this,u)),4==t&&As(this),this.i&&!this.I&&(4==t?ec(this.l,this):(this.i=!1,Ts(this)))}else 400==a&&0<u.indexOf("Unknown SID")?(this.o=3,as(12)):(this.o=0,as(13)),As(this),Rs(this)}}}catch(t){}},ui.fb=function(){if(this.g){var e=Pu(this.g),t=this.g.ga();this.C<t.length&&(_s(this),Cs(this,e,t),this.i&&4!=e&&Ts(this))}},ui.cancel=function(){this.I=!0,As(this)},ui.eb=function(){this.B=null;var e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(ns(3),as(17)),As(this),this.o=2,Rs(this)):Ns(this,this.Y-e)},(ui=Ms.prototype).R=function(){Fs(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},ui.T=function(){return Fs(this),this.g.concat()},ui.get=function(e,t){return Ps(this.h,e)?this.h[e]:t},ui.set=function(e,t){Ps(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},ui.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var a=n[r],i=this.get(a);e.call(t,i,a,this)}};var Ls=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Bs(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof Bs){this.g=void 0!==t?t:e.g,zs(this,e.j),this.s=e.s,Us(this,e.i),Ws(this,e.m),this.l=e.l,t=e.h;var n=new eu;n.i=t.i,t.g&&(n.g=new Ms(t.g),n.h=t.h),js(this,n),this.o=e.o}else e&&(n=String(e).match(Ls))?(this.g=!!t,zs(this,n[1]||"",!0),this.s=qs(n[2]||""),Us(this,n[3]||"",!0),Ws(this,n[4]),this.l=qs(n[5]||"",!0),js(this,n[6]||"",!0),this.o=qs(n[7]||"")):(this.g=!!t,this.h=new eu(null,this.g))}function Vs(e){return new Bs(e)}function zs(e,t,n){e.j=n?qs(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Us(e,t,n){e.i=n?qs(t,!0):t}function Ws(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function js(e,t,n){t instanceof eu?(e.h=t,function(e,t){t&&!e.j&&(tu(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(nu(this,t),au(this,n,e))}),e)),e.j=t}(e.h,e.g)):(n||(t=Ks(t,Js)),e.h=new eu(t,e.g))}function Gs(e,t,n){e.h.set(t,n)}function Hs(e){return Gs(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function qs(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Ks(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Xs),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Xs(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Bs.prototype.toString=function(){var e=[],t=this.j;t&&e.push(Ks(t,$s,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(Ks(t,$s,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push(Ks(n,"/"==n.charAt(0)?Ys:Qs,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",Ks(n,Zs)),e.join("")};var $s=/[#\/\?@]/g,Qs=/[#\?:]/g,Ys=/[#\?]/g,Js=/[#\?@]/g,Zs=/#/g;function eu(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function tu(e){e.g||(e.g=new Ms,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),a=null;if(0<=r){var i=e[n].substring(0,r);a=e[n].substring(r+1)}else i=e[n];t(i,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function nu(e,t){tu(e),t=iu(e,t),Ps(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,Ps((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&Fs(e)))}function ru(e,t){return tu(e),t=iu(e,t),Ps(e.g.h,t)}function au(e,t,n){nu(e,t),0<n.length&&(e.i=null,e.g.set(iu(e,t),Ni(n)),e.h+=n.length)}function iu(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(ui=eu.prototype).add=function(e,t){tu(this),this.i=null,e=iu(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},ui.forEach=function(e,t){tu(this),this.g.forEach((function(n,r){Ii(n,(function(n){e.call(t,n,r,this)}),this)}),this)},ui.T=function(){tu(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var a=e[r],i=0;i<a.length;i++)n.push(t[r]);return n},ui.R=function(e){tu(this);var t=[];if("string"===typeof e)ru(this,e)&&(t=Ti(t,this.g.get(iu(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=Ti(t,e[n])}return t},ui.set=function(e,t){return tu(this),this.i=null,ru(this,e=iu(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},ui.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},ui.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],a=encodeURIComponent(String(r));r=this.R(r);for(var i=0;i<r.length;i++){var o=a;""!==r[i]&&(o+="="+encodeURIComponent(String(r[i]))),e.push(o)}}return this.i=e.join("&")};var ou=E((function e(t,n){w(this,e),this.h=t,this.g=n}));function su(e){this.l=e||uu,hi.PerformanceNavigationTiming?e=0<(e=hi.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(hi.g&&hi.g.Ea&&hi.g.Ea()&&hi.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var uu=10;function cu(e){return!!e.h||!!e.g&&e.g.size>=e.j}function lu(e){return e.h?1:e.g?e.g.size:0}function fu(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function hu(e,t){e.g?e.g.add(t):e.h=t}function pu(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function du(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){var t,n=e.i,r=y(e.g.values());try{for(r.s();!(t=r.n()).done;){var a=t.value;n=n.concat(a.D)}}catch(i){r.e(i)}finally{r.f()}return n}return Ni(e.i)}function vu(){}function mu(){this.g=new vu}function yu(e,t,n){var r=n||"";try{Os(e,(function(e,n){var a=e;vi(e)&&(a=Ro(e)),t.push(r+n+"="+encodeURIComponent(a))}))}catch(LE){throw t.push(r+"type="+encodeURIComponent("_badmap")),LE}}function gu(e,t,n,r,a){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,a(r)}catch(XE){}}function bu(e){this.l=e.$b||null,this.j=e.ib||!1}function xu(e,t){To.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=wu,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}su.prototype.cancel=function(){if(this.i=du(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){var e,t=y(this.g.values());try{for(t.s();!(e=t.n()).done;){e.value.cancel()}}catch(n){t.e(n)}finally{t.f()}this.g.clear()}},vu.prototype.stringify=function(e){return hi.JSON.stringify(e,void 0)},vu.prototype.parse=function(e){return hi.JSON.parse(e,void 0)},ki(bu,cs),bu.prototype.g=function(){return new xu(this.l,this.j)},bu.prototype.i=function(e){return function(){return e}}({}),ki(xu,To);var wu=0;function ku(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function Eu(e){e.readyState=4,e.l=null,e.j=null,e.A=null,Su(e)}function Su(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(ui=xu.prototype).open=function(e,t){if(this.readyState!=wu)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,Su(this)},ui.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||hi).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},ui.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Eu(this)),this.readyState=wu},ui.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Su(this)),this.g&&(this.readyState=3,Su(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if("undefined"!==typeof hi.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ku(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},ui.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Eu(this):Su(this),3==this.readyState&&ku(this)}},ui.Ua=function(e){this.g&&(this.response=this.responseText=e,Eu(this))},ui.Ta=function(e){this.g&&(this.response=e,Eu(this))},ui.ha=function(){this.g&&Eu(this)},ui.setRequestHeader=function(e,t){this.v.append(e,t)},ui.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},ui.getAllResponseHeaders=function(){if(!this.h)return"";for(var e=[],t=this.h.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(xu.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Cu=hi.JSON.parse;function Iu(e){To.call(this),this.headers=new Ms,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Tu,this.K=this.L=!1}ki(Iu,To);var Tu="",Nu=/^https?$/i,_u=["POST","PUT"];function Ru(e){return"content-type"==e.toLowerCase()}function Au(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,Du(e),Mu(e)}function Du(e){e.D||(e.D=!0,No(e,"complete"),No(e,"error"))}function Ou(e){if(e.h&&"undefined"!=typeof fi&&(!e.C[1]||4!=Pu(e)||2!=e.ba()))if(e.v&&4==Pu(e))jo(e.Fa,0,e);else if(No(e,"readystatechange"),4==Pu(e)){e.h=!1;try{var t,n=e.ba();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var a;if(a=0===n){var i=String(e.H).match(Ls)[1]||null;if(!i&&hi.self&&hi.self.location){var o=hi.self.location.protocol;i=o.substr(0,o.length-1)}a=!Nu.test(i?i.toLowerCase():"")}t=a}if(t)No(e,"complete"),No(e,"success");else{e.m=6;try{var s=2<Pu(e)?e.g.statusText:""}catch(GE){s=""}e.j=s+" ["+e.ba()+"]",Du(e)}}finally{Mu(e)}}}function Mu(e,t){if(e.g){Fu(e);var n=e.g,r=e.C[0]?pi:null;e.g=null,e.C=null,t||No(e,"ready");try{n.onreadystatechange=r}catch(LE){}}}function Fu(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(hi.clearTimeout(e.A),e.A=null)}function Pu(e){return e.g?e.g.readyState:0}function Lu(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case Tu:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(eS){return null}}function Bu(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return Pi(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Gs(e,t,n))}function Vu(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function zu(e){this.za=0,this.l=[],this.h=new Qo,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Vu("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Vu("baseRetryDelayMs",5e3,e),this.$a=Vu("retryDelaySeedMs",1e4,e),this.Ya=Vu("forwardChannelMaxRetries",2,e),this.ra=Vu("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new su(e&&e.concurrentRequestLimit),this.Ca=new mu,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function Uu(e){if(ju(e),3==e.G){var t=e.V++,n=Vs(e.F);Gs(n,"SID",e.J),Gs(n,"RID",t),Gs(n,"TYPE","terminate"),Ku(e,n),(t=new ys(e,e.h,t,void 0)).K=2,t.v=Hs(Vs(n)),n=!1,hi.navigator&&hi.navigator.sendBeacon&&(n=hi.navigator.sendBeacon(t.v.toString(),"")),!n&&hi.Image&&((new Image).src=t.v,n=!0),n||(t.g=ic(t.l,null),t.g.ea(t.v)),t.F=Date.now(),Ts(t)}rc(e)}function Wu(e){e.g&&(Yu(e),e.g.cancel(),e.g=null)}function ju(e){Wu(e),e.u&&(hi.clearTimeout(e.u),e.u=null),Zu(e),e.i.cancel(),e.m&&("number"===typeof e.m&&hi.clearTimeout(e.m),e.m=null)}function Gu(e,t){e.l.push(new ou(e.Za++,t)),3==e.G&&Hu(e)}function Hu(e){cu(e.i)||e.m||(e.m=!0,Lo(e.Ha,e),e.C=0)}function qu(e,t){var n;n=t?t.m:e.V++;var r=Vs(e.F);Gs(r,"SID",e.J),Gs(r,"RID",n),Gs(r,"AID",e.U),Ku(e,r),e.o&&e.s&&Bu(r,e.o,e.s),n=new ys(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=Xu(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),hu(e.i,n),ks(n,r,t)}function Ku(e,t){e.j&&Os({},(function(e,n){Gs(t,n,e)}))}function Xu(e,t,n){n=Math.min(e.l.length,n);var r=e.j?xi(e.j.Oa,e.j,e):null;e:for(var a=e.l,i=-1;;){var o=["count="+n];-1==i?0<n?(i=a[0].h,o.push("ofs="+i)):i=0:o.push("ofs="+i);for(var s=!0,u=0;u<n;u++){var c=a[u].h,l=a[u].g;if(0>(c-=i))i=Math.max(0,a[u].h-100),s=!1;else try{yu(l,o,"req"+c+"_")}catch(Oc){r&&r(l)}}if(s){r=o.join("&");break e}}return e=e.l.splice(0,n),t.D=e,r}function $u(e){e.g||e.u||(e.Y=1,Lo(e.Ga,e),e.A=0)}function Qu(e){return!(e.g||e.u||3<=e.A)&&(e.Y++,e.u=os(xi(e.Ga,e),tc(e,e.A)),e.A++,!0)}function Yu(e){null!=e.B&&(hi.clearTimeout(e.B),e.B=null)}function Ju(e){e.g=new ys(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=Vs(e.oa);Gs(t,"RID","rpc"),Gs(t,"SID",e.J),Gs(t,"CI",e.N?"0":"1"),Gs(t,"AID",e.U),Ku(e,t),Gs(t,"TYPE","xmlhttp"),e.o&&e.s&&Bu(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=Hs(Vs(t)),n.s=null,n.U=!0,Es(n,e)}function Zu(e){null!=e.v&&(hi.clearTimeout(e.v),e.v=null)}function ec(e,t){var n=null;if(e.g==t){Zu(e),Yu(e),e.g=null;var r=2}else{if(!fu(e.i,t))return;n=t.D,pu(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var a=e.C;No(r=es(),new is(r,n,t,a)),Hu(e)}else $u(e);else if(3==(a=t.o)||0==a&&0<e.I||!(1==r&&function(e,t){return!(lu(e.i)>=e.i.j-(e.m?1:0))&&(e.m?(e.l=t.D.concat(e.l),!0):!(1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya))&&(e.m=os(xi(e.Ha,e,t),tc(e,e.C)),e.C++,!0))}(e,t)||2==r&&Qu(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),a){case 1:nc(e,5);break;case 4:nc(e,10);break;case 3:nc(e,6);break;default:nc(e,2)}}function tc(e,t){var n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function nc(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=xi(e.jb,e);n||(n=new Bs("//www.google.com/images/cleardot.gif"),hi.location&&"http"==hi.location.protocol||zs(n,"https"),Hs(n)),function(e,t){var n=new Qo;if(hi.Image){var r=new Image;r.onload=wi(gu,n,r,"TestLoadImage: loaded",!0,t),r.onerror=wi(gu,n,r,"TestLoadImage: error",!1,t),r.onabort=wi(gu,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=wi(gu,n,r,"TestLoadImage: timeout",!1,t),hi.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else as(2);e.G=0,e.j&&e.j.va(t),rc(e),ju(e)}function rc(e){e.G=0,e.I=-1,e.j&&(0==du(e.i).length&&0==e.l.length||(e.i.i.length=0,Ni(e.l),e.l.length=0),e.j.ua())}function ac(e,t,n){var r=function(e){return e instanceof Bs?Vs(e):new Bs(e,void 0)}(n);if(""!=r.i)t&&Us(r,t+"."+r.i),Ws(r,r.m);else{var a=hi.location;r=function(e,t,n,r){var a=new Bs(null,void 0);return e&&zs(a,e),t&&Us(a,t),n&&Ws(a,n),r&&(a.l=r),a}(a.protocol,t?t+"."+a.hostname:a.hostname,+a.port,n)}return e.aa&&Pi(e.aa,(function(e,t){Gs(r,t,e)})),t=e.D,n=e.sa,t&&n&&Gs(r,t,n),Gs(r,"VER",e.ma),Ku(e,r),r}function ic(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ba&&!e.qa?new Iu(new bu({ib:!0})):new Iu(e.qa)).L=e.H,t}function oc(){}function sc(){if(ji&&!(10<=Number(no)))throw Error("Environmental error: no available transport.")}function uc(e,t){To.call(this),this.g=new zu(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!_i(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!_i(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new fc(this)}function cc(e){ds.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function lc(){vs.call(this),this.status=1}function fc(e){this.g=e}(ui=Iu.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():hs.g(),this.C=this.u?ls(this.u):ls(hs),this.g.onreadystatechange=xi(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(XE){return void Au(this,XE)}e=n||"";var a=new Ms(this.headers);r&&Os(r,(function(e,t){a.set(t,e)})),r=function(e){e:{for(var t=Ru,n=e.length,r="string"===typeof e?e.split(""):e,a=0;a<n;a++)if(a in r&&t.call(void 0,r[a],a,e)){t=a;break e}t=-1}return 0>t?null:"string"===typeof e?e.charAt(t):e[t]}(a.T()),n=hi.FormData&&e instanceof hi.FormData,!(0<=Ci(_u,t))||r||n||a.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),a.forEach((function(e,t){this.g.setRequestHeader(t,e)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{Fu(this),0<this.B&&((this.K=function(e){return ji&&eo()&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=xi(this.pa,this)):this.A=jo(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(XE){Au(this,XE)}},ui.pa=function(){"undefined"!=typeof fi&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,No(this,"timeout"),this.abort(8))},ui.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,No(this,"complete"),No(this,"abort"),Mu(this))},ui.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Mu(this,!0)),Iu.Z.M.call(this)},ui.Fa=function(){this.s||(this.F||this.v||this.l?Ou(this):this.cb())},ui.cb=function(){Ou(this)},ui.ba=function(){try{return 2<Pu(this)?this.g.status:-1}catch(UE){return-1}},ui.ga=function(){try{return this.g?this.g.responseText:""}catch(UE){return""}},ui.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Cu(t)}},ui.Da=function(){return this.m},ui.La=function(){return"string"===typeof this.j?this.j:String(this.j)},(ui=zu.prototype).ma=8,ui.G=1,ui.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(eS){}},ui.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;var t=new ys(this,this.h,e,void 0),n=this.s;if(this.P&&(n?Vi(n=Li(n),this.P):n=this.P),null===this.o&&(t.H=n),this.ja)e:{for(var r=0,a=0;a<this.l.length;a++){var i=this.l[a];if(void 0===(i="__data__"in i.g&&"string"===typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(r+=i)){r=a;break e}if(4096===r||a===this.l.length-1){r=a+1;break e}}r=1e3}else r=1e3;r=Xu(this,t,r),Gs(a=Vs(this.F),"RID",e),Gs(a,"CVER",22),this.D&&Gs(a,"X-HTTP-Session-Id",this.D),Ku(this,a),this.o&&n&&Bu(a,this.o,n),hu(this.i,t),this.Ra&&Gs(a,"TYPE","init"),this.ja?(Gs(a,"$req",r),Gs(a,"SID","null"),t.$=!0,ks(t,a,null)):ks(t,a,r),this.G=2}}else 3==this.G&&(e?qu(this,e):0==this.l.length||cu(this.i)||qu(this))},ui.Ga=function(){if(this.u=null,Ju(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=os(xi(this.bb,this),e)}},ui.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,as(10),Wu(this),Ju(this))},ui.ab=function(){null!=this.v&&(this.v=null,Wu(this),Qu(this),as(19))},ui.jb=function(e){e?(this.h.info("Successfully pinged google.com"),as(2)):(this.h.info("Failed to ping google.com"),as(1))},(ui=oc.prototype).xa=function(){},ui.wa=function(){},ui.va=function(){},ui.ua=function(){},ui.Oa=function(){},sc.prototype.g=function(e,t){return new uc(e,t)},ki(uc,To),uc.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),Lo(xi(e.hb,e,t))),as(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=ac(e,null,e.W),Hu(e)},uc.prototype.close=function(){Uu(this.g)},uc.prototype.u=function(e){if("string"===typeof e){var t={};t.__data__=e,Gu(this.g,t)}else this.v?((t={}).__data__=Ro(e),Gu(this.g,t)):Gu(this.g,e)},uc.prototype.M=function(){this.g.j=null,delete this.j,Uu(this.g),delete this.g,uc.Z.M.call(this)},ki(cc,ds),ki(lc,vs),ki(fc,oc),fc.prototype.xa=function(){No(this.g,"a")},fc.prototype.wa=function(e){No(this.g,new cc(e))},fc.prototype.va=function(e){No(this.g,new lc(e))},fc.prototype.ua=function(){No(this.g,"b")},sc.prototype.createWebChannel=sc.prototype.g,uc.prototype.send=uc.prototype.u,uc.prototype.open=uc.prototype.m,uc.prototype.close=uc.prototype.close,ss.NO_ERROR=0,ss.TIMEOUT=8,ss.HTTP_ERROR=6,us.COMPLETE="complete",fs.EventType=ps,ps.OPEN="a",ps.CLOSE="b",ps.ERROR="c",ps.MESSAGE="d",To.prototype.listen=To.prototype.N,Iu.prototype.listenOnce=Iu.prototype.O,Iu.prototype.getLastError=Iu.prototype.La,Iu.prototype.getLastErrorCode=Iu.prototype.Da,Iu.prototype.getStatus=Iu.prototype.ba,Iu.prototype.getResponseJson=Iu.prototype.Qa,Iu.prototype.getResponseText=Iu.prototype.ga,Iu.prototype.send=Iu.prototype.ea;var hc=li.createWebChannelTransport=function(){return new sc},pc=li.getStatEventTarget=function(){return es()},dc=li.ErrorCode=ss,vc=li.EventType=us,mc=li.Event=Jo,yc=li.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},gc=li.FetchXmlHttpFactory=bu,bc=li.WebChannel=fs,xc=li.XhrIo=Iu,wc="@firebase/firestore",kc=function(){function e(t){w(this,e),this.uid=t}return E(e,[{key:"isAuthenticated",value:function(){return null!=this.uid}},{key:"toKey",value:function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}},{key:"isEqual",value:function(e){return e.uid===this.uid}}]),e}();kc.UNAUTHENTICATED=new kc(null),kc.GOOGLE_CREDENTIALS=new kc("google-credentials-uid"),kc.FIRST_PARTY=new kc("first-party-uid"),kc.MOCK_USER=new kc("mock-user");var Ec="9.9.1",Sc=new ue("@firebase/firestore");function Cc(){return Sc.logLevel}function Ic(e){if(Sc.logLevel<=te.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(_c);Sc.debug.apply(Sc,["Firestore (".concat(Ec,"): ").concat(e)].concat(S(a)))}}function Tc(e){if(Sc.logLevel<=te.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(_c);Sc.error.apply(Sc,["Firestore (".concat(Ec,"): ").concat(e)].concat(S(a)))}}function Nc(e){if(Sc.logLevel<=te.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=n.map(_c);Sc.warn.apply(Sc,["Firestore (".concat(Ec,"): ").concat(e)].concat(S(a)))}}function _c(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function Rc(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state",t="FIRESTORE (".concat(Ec,") INTERNAL ASSERTION FAILED: ")+e;throw Tc(t),new Error(t)}function Ac(e,t){e||Rc()}function Dc(e,t){return e}var Oc={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Mc=function(e){h(n,e);var t=m(n);function n(e,r){var a;return w(this,n),(a=t.call(this,e,r)).code=e,a.message=r,a.toString=function(){return"".concat(a.name,": [code=").concat(a.code,"]: ").concat(a.message)},a}return E(n)}(B),Fc=E((function e(){var t=this;w(this,e),this.promise=new Promise((function(e,n){t.resolve=e,t.reject=n}))})),Pc=E((function e(t,n){w(this,e),this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(t))})),Lc=function(){function e(){w(this,e)}return E(e,[{key:"getToken",value:function(){return Promise.resolve(null)}},{key:"invalidateToken",value:function(){}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(kc.UNAUTHENTICATED)}))}},{key:"shutdown",value:function(){}}]),e}(),Bc=function(){function e(t){w(this,e),this.t=t,this.currentUser=kc.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}return E(e,[{key:"start",value:function(e,t){var n=this,r=this.i,a=function(e){return n.i!==r?(r=n.i,t(e)):Promise.resolve()},i=new Fc;this.o=function(){n.i++,n.currentUser=n.u(),i.resolve(),i=new Fc,e.enqueueRetryable((function(){return a(n.currentUser)}))};var o=function(){var t=i;e.enqueueRetryable(x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.promise;case 2:return e.next=4,a(n.currentUser);case 4:case"end":return e.stop()}}),e)}))))},s=function(e){Ic("FirebaseAuthCredentialsProvider","Auth detected"),n.auth=e,n.auth.addAuthTokenListener(n.o),o()};this.t.onInit((function(e){return s(e)})),setTimeout((function(){if(!n.auth){var e=n.t.getImmediate({optional:!0});e?s(e):(Ic("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Fc)}}),0),o()}},{key:"getToken",value:function(){var e=this,t=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.i!==t?(Ic("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(Ac("string"==typeof n.accessToken),new Pc(n.accessToken,e.currentUser)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.auth&&this.auth.removeAuthTokenListener(this.o)}},{key:"u",value:function(){var e=this.auth&&this.auth.getUid();return Ac(null===e||"string"==typeof e),new kc(e)}}]),e}(),Vc=E((function e(t,n,r){w(this,e),this.type="FirstParty",this.user=kc.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",n);var a=t.auth.getAuthHeaderValueForFirstParty([]);a&&this.headers.set("Authorization",a),r&&this.headers.set("X-Goog-Iam-Authorization-Token",r)})),zc=function(){function e(t,n,r){w(this,e),this.h=t,this.l=n,this.m=r}return E(e,[{key:"getToken",value:function(){return Promise.resolve(new Vc(this.h,this.l,this.m))}},{key:"start",value:function(e,t){e.enqueueRetryable((function(){return t(kc.FIRST_PARTY)}))}},{key:"shutdown",value:function(){}},{key:"invalidateToken",value:function(){}}]),e}(),Uc=E((function e(t){w(this,e),this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)})),Wc=function(){function e(t){w(this,e),this.g=t,this.forceRefresh=!1,this.appCheck=null,this.p=null}return E(e,[{key:"start",value:function(e,t){var n=this,r=function(e){null!=e.error&&Ic("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));var r=e.token!==n.p;return n.p=e.token,Ic("FirebaseAppCheckTokenProvider","Received ".concat(r?"new":"existing"," token.")),r?t(e.token):Promise.resolve()};this.o=function(t){e.enqueueRetryable((function(){return r(t)}))};var a=function(e){Ic("FirebaseAppCheckTokenProvider","AppCheck detected"),n.appCheck=e,n.appCheck.addTokenListener(n.o)};this.g.onInit((function(e){return a(e)})),setTimeout((function(){if(!n.appCheck){var e=n.g.getImmediate({optional:!0});e?a(e):Ic("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}},{key:"getToken",value:function(){var e=this,t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then((function(t){return t?(Ac("string"==typeof t.token),e.p=t.token,new Uc(t.token)):null})):Promise.resolve(null)}},{key:"invalidateToken",value:function(){this.forceRefresh=!0}},{key:"shutdown",value:function(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}]),e}();function jc(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var Gc=function(){function e(){w(this,e)}return E(e,null,[{key:"I",value:function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=jc(40),a=0;a<r.length;++a)n.length<20&&r[a]<t&&(n+=e.charAt(r[a]%e.length));return n}}]),e}();function Hc(e,t){return e<t?-1:e>t?1:0}function qc(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}var Kc=function(){function e(t,n){if(w(this,e),this.seconds=t,this.nanoseconds=n,n<0)throw new Mc(Oc.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new Mc(Oc.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(t<-62135596800)throw new Mc(Oc.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new Mc(Oc.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return E(e,[{key:"toDate",value:function(){return new Date(this.toMillis())}},{key:"toMillis",value:function(){return 1e3*this.seconds+this.nanoseconds/1e6}},{key:"_compareTo",value:function(e){return this.seconds===e.seconds?Hc(this.nanoseconds,e.nanoseconds):Hc(this.seconds,e.seconds)}},{key:"isEqual",value:function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}},{key:"toString",value:function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}},{key:"toJSON",value:function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}},{key:"valueOf",value:function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}],[{key:"now",value:function(){return e.fromMillis(Date.now())}},{key:"fromDate",value:function(t){return e.fromMillis(t.getTime())}},{key:"fromMillis",value:function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))}}]),e}(),Xc=function(){function e(t){w(this,e),this.timestamp=t}return E(e,[{key:"compareTo",value:function(e){return this.timestamp._compareTo(e.timestamp)}},{key:"isEqual",value:function(e){return this.timestamp.isEqual(e.timestamp)}},{key:"toMicroseconds",value:function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}},{key:"toString",value:function(){return"SnapshotVersion("+this.timestamp.toString()+")"}},{key:"toTimestamp",value:function(){return this.timestamp}}],[{key:"fromTimestamp",value:function(t){return new e(t)}},{key:"min",value:function(){return new e(new Kc(0,0))}},{key:"max",value:function(){return new e(new Kc(253402300799,999999999))}}]),e}(),$c=function(){function e(t,n,r){w(this,e),void 0===n?n=0:n>t.length&&Rc(),void 0===r?r=t.length-n:r>t.length-n&&Rc(),this.segments=t,this.offset=n,this.len=r}return E(e,[{key:"length",get:function(){return this.len}},{key:"isEqual",value:function(t){return 0===e.comparator(this,t)}},{key:"child",value:function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)}},{key:"limit",value:function(){return this.offset+this.length}},{key:"popFirst",value:function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}},{key:"popLast",value:function(){return this.construct(this.segments,this.offset,this.length-1)}},{key:"firstSegment",value:function(){return this.segments[this.offset]}},{key:"lastSegment",value:function(){return this.get(this.length-1)}},{key:"get",value:function(e){return this.segments[this.offset+e]}},{key:"isEmpty",value:function(){return 0===this.length}},{key:"isPrefixOf",value:function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"isImmediateParentOf",value:function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}},{key:"forEach",value:function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}},{key:"toArray",value:function(){return this.segments.slice(this.offset,this.limit())}}],[{key:"comparator",value:function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var a=e.get(r),i=t.get(r);if(a<i)return-1;if(a>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}]),e}(),Qc=function(e){h(n,e);var t=m(n);function n(){return w(this,n),t.apply(this,arguments)}return E(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().join("/")}},{key:"toString",value:function(){return this.canonicalString()}}],[{key:"fromString",value:function(){for(var e=[],t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];for(var i=0,o=r;i<o.length;i++){var s=o[i];if(s.indexOf("//")>=0)throw new Mc(Oc.INVALID_ARGUMENT,"Invalid segment (".concat(s,"). Paths must not contain // in them."));e.push.apply(e,S(s.split("/").filter((function(e){return e.length>0}))))}return new n(e)}},{key:"emptyPath",value:function(){return new n([])}}]),n}($c),Yc=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Jc=function(e){h(n,e);var t=m(n);function n(){return w(this,n),t.apply(this,arguments)}return E(n,[{key:"construct",value:function(e,t,r){return new n(e,t,r)}},{key:"canonicalString",value:function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")}},{key:"toString",value:function(){return this.canonicalString()}},{key:"isKeyField",value:function(){return 1===this.length&&"__name__"===this.get(0)}}],[{key:"isValidIdentifier",value:function(e){return Yc.test(e)}},{key:"keyField",value:function(){return new n(["__name__"])}},{key:"fromServerFormat",value:function(e){for(var t=[],r="",a=0,i=function(){if(0===r.length)throw new Mc(Oc.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(r),r=""},o=!1;a<e.length;){var s=e[a];if("\\"===s){if(a+1===e.length)throw new Mc(Oc.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var u=e[a+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Mc(Oc.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,a+=2}else"`"===s?(o=!o,a++):"."!==s||o?(r+=s,a++):(i(),a++)}if(i(),o)throw new Mc(Oc.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}},{key:"emptyPath",value:function(){return new n([])}}]),n}($c),Zc=function(){function e(t){w(this,e),this.path=t}return E(e,[{key:"collectionGroup",get:function(){return this.path.popLast().lastSegment()}},{key:"hasCollectionId",value:function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}},{key:"getCollectionGroup",value:function(){return this.path.get(this.path.length-2)}},{key:"getCollectionPath",value:function(){return this.path.popLast()}},{key:"isEqual",value:function(e){return null!==e&&0===Qc.comparator(this.path,e.path)}},{key:"toString",value:function(){return this.path.toString()}}],[{key:"fromPath",value:function(t){return new e(Qc.fromString(t))}},{key:"fromName",value:function(t){return new e(Qc.fromString(t).popFirst(5))}},{key:"empty",value:function(){return new e(Qc.emptyPath())}},{key:"comparator",value:function(e,t){return Qc.comparator(e.path,t.path)}},{key:"isDocumentKey",value:function(e){return e.length%2==0}},{key:"fromSegments",value:function(t){return new e(new Qc(t.slice()))}}]),e}(),el=E((function e(t,n,r,a){w(this,e),this.indexId=t,this.collectionGroup=n,this.fields=r,this.indexState=a}));el.UNKNOWN_ID=-1;function tl(e,t){var n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,a=Xc.fromTimestamp(1e9===r?new Kc(n+1,0):new Kc(n,r));return new rl(a,Zc.empty(),t)}function nl(e){return new rl(e.readTime,e.key,-1)}var rl=function(){function e(t,n,r){w(this,e),this.readTime=t,this.documentKey=n,this.largestBatchId=r}return E(e,null,[{key:"min",value:function(){return new e(Xc.min(),Zc.empty(),-1)}},{key:"max",value:function(){return new e(Xc.max(),Zc.empty(),-1)}}]),e}();function al(e,t){var n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=Zc.comparator(e.documentKey,t.documentKey))?n:Hc(e.largestBatchId,t.largestBatchId)}var il="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",ol=function(){function e(){w(this,e),this.onCommittedListeners=[]}return E(e,[{key:"addOnCommittedListener",value:function(e){this.onCommittedListeners.push(e)}},{key:"raiseOnCommittedEvent",value:function(){this.onCommittedListeners.forEach((function(e){return e()}))}}]),e}();function sl(e){return ul.apply(this,arguments)}function ul(){return ul=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.code===Oc.FAILED_PRECONDITION&&t.message===il){e.next=2;break}throw t;case 2:Ic("LocalStore","Unexpectedly lost primary lease");case 3:case"end":return e.stop()}}),e)}))),ul.apply(this,arguments)}var cl=function(){function e(t){var n=this;w(this,e),this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t((function(e){n.isDone=!0,n.result=e,n.nextCallback&&n.nextCallback(e)}),(function(e){n.isDone=!0,n.error=e,n.catchCallback&&n.catchCallback(e)}))}return E(e,[{key:"catch",value:function(e){return this.next(void 0,e)}},{key:"next",value:function(t,n){var r=this;return this.callbackAttached&&Rc(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,a){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,a)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,a)}}))}},{key:"toPromise",value:function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))}},{key:"wrapUserFunction",value:function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}}},{key:"wrapSuccess",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)}},{key:"wrapFailure",value:function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)}}],[{key:"resolve",value:function(t){return new e((function(e,n){e(t)}))}},{key:"reject",value:function(t){return new e((function(e,n){n(t)}))}},{key:"waitFor",value:function(t){return new e((function(e,n){var r=0,a=0,i=!1;t.forEach((function(t){++r,t.next((function(){++a,i&&a===r&&e()}),(function(e){return n(e)}))})),i=!0,a===r&&e()}))}},{key:"or",value:function(t){var n,r=e.resolve(!1),a=y(t);try{var i=function(){var t=n.value;r=r.next((function(n){return n?e.resolve(n):t()}))};for(a.s();!(n=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}return r}},{key:"forEach",value:function(e,t){var n=this,r=[];return e.forEach((function(e,a){r.push(t.call(n,e,a))})),this.waitFor(r)}},{key:"mapArray",value:function(t,n){return new e((function(e,r){for(var a=t.length,i=new Array(a),o=0,s=function(s){var u=s;n(t[u]).next((function(t){i[u]=t,++o===a&&e(i)}),(function(e){return r(e)}))},u=0;u<a;u++)s(u)}))}},{key:"doWhile",value:function(t,n){return new e((function(e,r){!function a(){!0===t()?n().next((function(){a()}),r):e()}()}))}}]),e}();function ll(e){return"IndexedDbTransactionError"===e.name}var fl=function(){function e(t,n){var r=this;w(this,e),this.previousValue=t,n&&(n.sequenceNumberHandler=function(e){return r.it(e)},this.rt=function(e){return n.writeSequenceNumber(e)})}return E(e,[{key:"it",value:function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}},{key:"next",value:function(){var e=++this.previousValue;return this.rt&&this.rt(e),e}}]),e}();function hl(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function pl(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function dl(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}fl.ot=-1;var vl=function(){function e(t,n){w(this,e),this.comparator=t,this.root=n||yl.EMPTY}return E(e,[{key:"insert",value:function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,yl.BLACK,null,null))}},{key:"remove",value:function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,yl.BLACK,null,null))}},{key:"get",value:function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}},{key:"indexOf",value:function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}},{key:"isEmpty",value:function(){return this.root.isEmpty()}},{key:"size",get:function(){return this.root.size}},{key:"minKey",value:function(){return this.root.minKey()}},{key:"maxKey",value:function(){return this.root.maxKey()}},{key:"inorderTraversal",value:function(e){return this.root.inorderTraversal(e)}},{key:"forEach",value:function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))}},{key:"toString",value:function(){var e=[];return this.inorderTraversal((function(t,n){return e.push("".concat(t,":").concat(n)),!1})),"{".concat(e.join(", "),"}")}},{key:"reverseTraversal",value:function(e){return this.root.reverseTraversal(e)}},{key:"getIterator",value:function(){return new ml(this.root,null,this.comparator,!1)}},{key:"getIteratorFrom",value:function(e){return new ml(this.root,e,this.comparator,!1)}},{key:"getReverseIterator",value:function(){return new ml(this.root,null,this.comparator,!0)}},{key:"getReverseIteratorFrom",value:function(e){return new ml(this.root,e,this.comparator,!0)}}]),e}(),ml=function(){function e(t,n,r,a){w(this,e),this.isReverse=a,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=n?r(t.key,n):1,n&&a&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return E(e,[{key:"getNext",value:function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}},{key:"hasNext",value:function(){return this.nodeStack.length>0}},{key:"peek",value:function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}]),e}(),yl=function(){function e(t,n,r,a,i){w(this,e),this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=a?a:e.EMPTY,this.right=null!=i?i:e.EMPTY,this.size=this.left.size+1+this.right.size}return E(e,[{key:"copy",value:function(t,n,r,a,i){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=a?a:this.left,null!=i?i:this.right)}},{key:"isEmpty",value:function(){return!1}},{key:"inorderTraversal",value:function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}},{key:"reverseTraversal",value:function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}},{key:"min",value:function(){return this.left.isEmpty()?this:this.left.min()}},{key:"minKey",value:function(){return this.min().key}},{key:"maxKey",value:function(){return this.right.isEmpty()?this.key:this.right.maxKey()}},{key:"insert",value:function(e,t,n){var r=this,a=n(e,r.key);return(r=a<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===a?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}},{key:"removeMin",value:function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()}},{key:"remove",value:function(t,n){var r,a=this;if(n(t,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(t,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),0===n(t,a.key)){if(a.right.isEmpty())return e.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(t,n))}return a.fixUp()}},{key:"isRed",value:function(){return this.color}},{key:"fixUp",value:function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}},{key:"moveRedLeft",value:function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}},{key:"moveRedRight",value:function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}},{key:"rotateLeft",value:function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}},{key:"rotateRight",value:function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}},{key:"colorFlip",value:function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}},{key:"checkMaxDepth",value:function(){var e=this.check();return Math.pow(2,e)<=this.size+1}},{key:"check",value:function(){if(this.isRed()&&this.left.isRed())throw Rc();if(this.right.isRed())throw Rc();var e=this.left.check();if(e!==this.right.check())throw Rc();return e+(this.isRed()?0:1)}}]),e}();yl.EMPTY=null,yl.RED=!0,yl.BLACK=!1,yl.EMPTY=new(function(){function e(){w(this,e),this.size=0}return E(e,[{key:"key",get:function(){throw Rc()}},{key:"value",get:function(){throw Rc()}},{key:"color",get:function(){throw Rc()}},{key:"left",get:function(){throw Rc()}},{key:"right",get:function(){throw Rc()}},{key:"copy",value:function(e,t,n,r,a){return this}},{key:"insert",value:function(e,t,n){return new yl(e,t)}},{key:"remove",value:function(e,t){return this}},{key:"isEmpty",value:function(){return!0}},{key:"inorderTraversal",value:function(e){return!1}},{key:"reverseTraversal",value:function(e){return!1}},{key:"minKey",value:function(){return null}},{key:"maxKey",value:function(){return null}},{key:"isRed",value:function(){return!1}},{key:"checkMaxDepth",value:function(){return!0}},{key:"check",value:function(){return 0}}]),e}());var gl=function(){function e(t){w(this,e),this.comparator=t,this.data=new vl(this.comparator)}return E(e,[{key:"has",value:function(e){return null!==this.data.get(e)}},{key:"first",value:function(){return this.data.minKey()}},{key:"last",value:function(){return this.data.maxKey()}},{key:"size",get:function(){return this.data.size}},{key:"indexOf",value:function(e){return this.data.indexOf(e)}},{key:"forEach",value:function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"forEachInRange",value:function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}},{key:"forEachWhile",value:function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}},{key:"firstAfterOrEqual",value:function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}},{key:"getIterator",value:function(){return new bl(this.data.getIterator())}},{key:"getIteratorFrom",value:function(e){return new bl(this.data.getIteratorFrom(e))}},{key:"add",value:function(e){return this.copy(this.data.remove(e).insert(e,!0))}},{key:"delete",value:function(e){return this.has(e)?this.copy(this.data.remove(e)):this}},{key:"isEmpty",value:function(){return this.data.isEmpty()}},{key:"unionWith",value:function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var a=n.getNext().key,i=r.getNext().key;if(0!==this.comparator(a,i))return!1}return!0}},{key:"toArray",value:function(){var e=[];return this.forEach((function(t){e.push(t)})),e}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"}},{key:"copy",value:function(t){var n=new e(this.comparator);return n.data=t,n}}]),e}(),bl=function(){function e(t){w(this,e),this.iter=t}return E(e,[{key:"getNext",value:function(){return this.iter.getNext().key}},{key:"hasNext",value:function(){return this.iter.hasNext()}}]),e}();var xl=function(){function e(t){w(this,e),this.fields=t,t.sort(Jc.comparator)}return E(e,[{key:"unionWith",value:function(t){var n,r=new gl(Jc.comparator),a=y(this.fields);try{for(a.s();!(n=a.n()).done;){var i=n.value;r=r.add(i)}}catch(c){a.e(c)}finally{a.f()}var o,s=y(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;r=r.add(u)}}catch(c){s.e(c)}finally{s.f()}return new e(r.toArray())}},{key:"covers",value:function(e){var t,n=y(this.fields);try{for(n.s();!(t=n.n()).done;){if(t.value.isPrefixOf(e))return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"isEqual",value:function(e){return qc(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))}}],[{key:"empty",value:function(){return new e([])}}]),e}();var wl=function(e){function t(e){w(this,t),this.binaryString=e}return E(t,[{key:Symbol.iterator,value:function(){var e=this,t=0;return{next:function(){return t<e.binaryString.length?{value:e.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}}},{key:"toBase64",value:function(){return e=this.binaryString,btoa(e);var e}},{key:"toUint8Array",value:function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}},{key:"approximateByteSize",value:function(){return 2*this.binaryString.length}},{key:"compareTo",value:function(e){return Hc(this.binaryString,e.binaryString)}},{key:"isEqual",value:function(e){return this.binaryString===e.binaryString}}],[{key:"fromBase64String",value:function(e){return new t(atob(e))}},{key:"fromUint8Array",value:function(e){var n=function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new t(n)}}]),t}();wl.EMPTY_BYTE_STRING=new wl("");var kl=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function El(e){if(Ac(!!e),"string"==typeof e){var t=0,n=kl.exec(e);if(Ac(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var a=new Date(e);return{seconds:Math.floor(a.getTime()/1e3),nanos:t}}return{seconds:Sl(e.seconds),nanos:Sl(e.nanos)}}function Sl(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Cl(e){return"string"==typeof e?wl.fromBase64String(e):wl.fromUint8Array(e)}function Il(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Tl(e){var t=e.mapValue.fields.__previous_value__;return Il(t)?Tl(t):t}function Nl(e){var t=El(e.mapValue.fields.__local_write_time__.timestampValue);return new Kc(t.seconds,t.nanos)}var _l=E((function e(t,n,r,a,i,o,s,u){w(this,e),this.databaseId=t,this.appId=n,this.persistenceKey=r,this.host=a,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=s,this.useFetchStreams=u})),Rl=function(){function e(t,n){w(this,e),this.projectId=t,this.database=n||"(default)"}return E(e,[{key:"isDefaultDatabase",get:function(){return"(default)"===this.database}},{key:"isEqual",value:function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database}}],[{key:"empty",value:function(){return new e("","")}}]),e}();function Al(e){return null==e}function Dl(e){return 0===e&&1/e==-1/0}function Ol(e){return"number"==typeof e&&Number.isInteger(e)&&!Dl(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}var Ml={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Fl(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Il(e)?4:Xl(e)?9007199254740991:10:Rc()}function Pl(e,t){if(e===t)return!0;var n=Fl(e);if(n!==Fl(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Nl(e).isEqual(Nl(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=El(e.timestampValue),r=El(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Cl(e.bytesValue).isEqual(Cl(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Sl(e.geoPointValue.latitude)===Sl(t.geoPointValue.latitude)&&Sl(e.geoPointValue.longitude)===Sl(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Sl(e.integerValue)===Sl(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=Sl(e.doubleValue),r=Sl(t.doubleValue);return n===r?Dl(n)===Dl(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return qc(e.arrayValue.values||[],t.arrayValue.values||[],Pl);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(hl(n)!==hl(r))return!1;for(var a in n)if(n.hasOwnProperty(a)&&(void 0===r[a]||!Pl(n[a],r[a])))return!1;return!0}(e,t);default:return Rc()}}function Ll(e,t){return void 0!==(e.values||[]).find((function(e){return Pl(e,t)}))}function Bl(e,t){if(e===t)return 0;var n=Fl(e),r=Fl(t);if(n!==r)return Hc(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Hc(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=Sl(e.integerValue||e.doubleValue),r=Sl(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Vl(e.timestampValue,t.timestampValue);case 4:return Vl(Nl(e),Nl(t));case 5:return Hc(e.stringValue,t.stringValue);case 6:return function(e,t){var n=Cl(e),r=Cl(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),a=0;a<n.length&&a<r.length;a++){var i=Hc(n[a],r[a]);if(0!==i)return i}return Hc(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=Hc(Sl(e.latitude),Sl(t.latitude));return 0!==n?n:Hc(Sl(e.longitude),Sl(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],a=0;a<n.length&&a<r.length;++a){var i=Bl(n[a],r[a]);if(i)return i}return Hc(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===Ml.mapValue&&t===Ml.mapValue)return 0;if(e===Ml.mapValue)return 1;if(t===Ml.mapValue)return-1;var n=e.fields||{},r=Object.keys(n),a=t.fields||{},i=Object.keys(a);r.sort(),i.sort();for(var o=0;o<r.length&&o<i.length;++o){var s=Hc(r[o],i[o]);if(0!==s)return s;var u=Bl(n[r[o]],a[i[o]]);if(0!==u)return u}return Hc(r.length,i.length)}(e.mapValue,t.mapValue);default:throw Rc()}}function Vl(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return Hc(e,t);var n=El(e),r=El(t),a=Hc(n.seconds,r.seconds);return 0!==a?a:Hc(n.nanos,r.nanos)}function zl(e){return Ul(e)}function Ul(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=El(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Cl(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,Zc.fromName(n).toString()):"geoPointValue"in e?"geo(".concat((t=e.geoPointValue).latitude,",").concat(t.longitude,")"):"arrayValue"in e?function(e){var t,n="[",r=!0,a=y(e.values||[]);try{for(a.s();!(t=a.n()).done;){var i=t.value;r?r=!1:n+=",",n+=Ul(i)}}catch(o){a.e(o)}finally{a.f()}return n+"]"}(e.arrayValue):"mapValue"in e?function(e){var t,n="{",r=!0,a=y(Object.keys(e.fields||{}).sort());try{for(a.s();!(t=a.n()).done;){var i=t.value;r?r=!1:n+=",",n+="".concat(i,":").concat(Ul(e.fields[i]))}}catch(o){a.e(o)}finally{a.f()}return n+"}"}(e.mapValue):Rc();var t,n}function Wl(e){return!!e&&"integerValue"in e}function jl(e){return!!e&&"arrayValue"in e}function Gl(e){return!!e&&"nullValue"in e}function Hl(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ql(e){return!!e&&"mapValue"in e}function Kl(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){var t={mapValue:{fields:{}}};return pl(e.mapValue.fields,(function(e,n){return t.mapValue.fields[e]=Kl(n)})),t}if(e.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(e.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Kl(e.arrayValue.values[r]);return n}return Object.assign({},e)}function Xl(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}var $l=function(){function e(t){w(this,e),this.value=t}return E(e,[{key:"field",value:function(e){if(e.isEmpty())return this.value;for(var t=this.value,n=0;n<e.length-1;++n)if(!ql(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}},{key:"set",value:function(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Kl(t)}},{key:"setAll",value:function(e){var t=this,n=Jc.emptyPath(),r={},a=[];e.forEach((function(e,i){if(!n.isImmediateParentOf(i)){var o=t.getFieldsMap(n);t.applyChanges(o,r,a),r={},a=[],n=i.popLast()}e?r[i.lastSegment()]=Kl(e):a.push(i.lastSegment())}));var i=this.getFieldsMap(n);this.applyChanges(i,r,a)}},{key:"delete",value:function(e){var t=this.field(e.popLast());ql(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}},{key:"isEqual",value:function(e){return Pl(this.value,e.value)}},{key:"getFieldsMap",value:function(e){var t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(var n=0;n<e.length;++n){var r=t.mapValue.fields[e.get(n)];ql(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}},{key:"applyChanges",value:function(e,t,n){pl(t,(function(t,n){return e[t]=n}));var r,a=y(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;delete e[i]}}catch(o){a.e(o)}finally{a.f()}}},{key:"clone",value:function(){return new e(Kl(this.value))}}],[{key:"empty",value:function(){return new e({mapValue:{}})}}]),e}();function Ql(e){var t=[];return pl(e.fields,(function(e,n){var r=new Jc([e]);if(ql(n)){var a=Ql(n.mapValue).fields;if(0===a.length)t.push(r);else{var i,o=y(a);try{for(o.s();!(i=o.n()).done;){var s=i.value;t.push(r.child(s))}}catch(u){o.e(u)}finally{o.f()}}}else t.push(r)})),new xl(t)}var Yl=function(){function e(t,n,r,a,i,o){w(this,e),this.key=t,this.documentType=n,this.version=r,this.readTime=a,this.data=i,this.documentState=o}return E(e,[{key:"convertToFoundDocument",value:function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}},{key:"convertToNoDocument",value:function(e){return this.version=e,this.documentType=2,this.data=$l.empty(),this.documentState=0,this}},{key:"convertToUnknownDocument",value:function(e){return this.version=e,this.documentType=3,this.data=$l.empty(),this.documentState=2,this}},{key:"setHasCommittedMutations",value:function(){return this.documentState=2,this}},{key:"setHasLocalMutations",value:function(){return this.documentState=1,this.version=Xc.min(),this}},{key:"setReadTime",value:function(e){return this.readTime=e,this}},{key:"hasLocalMutations",get:function(){return 1===this.documentState}},{key:"hasCommittedMutations",get:function(){return 2===this.documentState}},{key:"hasPendingWrites",get:function(){return this.hasLocalMutations||this.hasCommittedMutations}},{key:"isValidDocument",value:function(){return 0!==this.documentType}},{key:"isFoundDocument",value:function(){return 1===this.documentType}},{key:"isNoDocument",value:function(){return 2===this.documentType}},{key:"isUnknownDocument",value:function(){return 3===this.documentType}},{key:"isEqual",value:function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}},{key:"mutableCopy",value:function(){return new e(this.key,this.documentType,this.version,this.readTime,this.data.clone(),this.documentState)}},{key:"toString",value:function(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}],[{key:"newInvalidDocument",value:function(t){return new e(t,0,Xc.min(),Xc.min(),$l.empty(),0)}},{key:"newFoundDocument",value:function(t,n,r){return new e(t,1,n,Xc.min(),r,0)}},{key:"newNoDocument",value:function(t,n){return new e(t,2,n,Xc.min(),$l.empty(),0)}},{key:"newUnknownDocument",value:function(t,n){return new e(t,3,n,Xc.min(),$l.empty(),2)}}]),e}(),Jl=E((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;w(this,e),this.path=t,this.collectionGroup=n,this.orderBy=r,this.filters=a,this.limit=i,this.startAt=o,this.endAt=s,this.ut=null}));function Zl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;return new Jl(e,t,n,r,a,i,o)}function ef(e){var t=Dc(e);if(null===t.ut){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return(t=e).field.canonicalString()+t.op.toString()+zl(t.value);var t})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return function(e){return e.field.canonicalString()+e.dir}(e)})).join(","),Al(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map((function(e){return zl(e)})).join(",")),t.endAt&&(n+="|ub:",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map((function(e){return zl(e)})).join(",")),t.ut=n}return t.ut}function tf(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!vf(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(a=e.filters[r],i=t.filters[r],a.op!==i.op||!a.field.isEqual(i.field)||!Pl(a.value,i.value))return!1;var a,i;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!yf(e.startAt,t.startAt)&&yf(e.endAt,t.endAt)}function nf(e){return Zc.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var rf=function(e){h(n,e);var t=m(n);function n(e,r,a){var i;return w(this,n),(i=t.call(this)).field=e,i.op=r,i.value=a,i}return E(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.at(Bl(t,this.value)):null!==t&&Fl(this.value)===Fl(t)&&this.at(Bl(t,this.value))}},{key:"at",value:function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Rc()}}},{key:"ht",value:function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}],[{key:"create",value:function(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.ct(e,t,r):new af(e,t,r):"array-contains"===t?new cf(e,r):"in"===t?new lf(e,r):"not-in"===t?new ff(e,r):"array-contains-any"===t?new hf(e,r):new n(e,t,r)}},{key:"ct",value:function(e,t,n){return"in"===t?new of(e,n):new sf(e,n)}}]),n}(function(){return E((function e(){w(this,e)}))}()),af=function(e){h(n,e);var t=m(n);function n(e,r,a){var i;return w(this,n),(i=t.call(this,e,r,a)).key=Zc.fromName(a.referenceValue),i}return E(n,[{key:"matches",value:function(e){var t=Zc.comparator(e.key,this.key);return this.at(t)}}]),n}(rf),of=function(e){h(n,e);var t=m(n);function n(e,r){var a;return w(this,n),(a=t.call(this,e,"in",r)).keys=uf("in",r),a}return E(n,[{key:"matches",value:function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(rf),sf=function(e){h(n,e);var t=m(n);function n(e,r){var a;return w(this,n),(a=t.call(this,e,"not-in",r)).keys=uf("not-in",r),a}return E(n,[{key:"matches",value:function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))}}]),n}(rf);function uf(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return Zc.fromName(e.referenceValue)}))}var cf=function(e){h(n,e);var t=m(n);function n(e,r){return w(this,n),t.call(this,e,"array-contains",r)}return E(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return jl(t)&&Ll(t.arrayValue,this.value)}}]),n}(rf),lf=function(e){h(n,e);var t=m(n);function n(e,r){return w(this,n),t.call(this,e,"in",r)}return E(n,[{key:"matches",value:function(e){var t=e.data.field(this.field);return null!==t&&Ll(this.value.arrayValue,t)}}]),n}(rf),ff=function(e){h(n,e);var t=m(n);function n(e,r){return w(this,n),t.call(this,e,"not-in",r)}return E(n,[{key:"matches",value:function(e){if(Ll(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!Ll(this.value.arrayValue,t)}}]),n}(rf),hf=function(e){h(n,e);var t=m(n);function n(e,r){return w(this,n),t.call(this,e,"array-contains-any",r)}return E(n,[{key:"matches",value:function(e){var t=this,n=e.data.field(this.field);return!(!jl(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return Ll(t.value.arrayValue,e)}))}}]),n}(rf),pf=E((function e(t,n){w(this,e),this.position=t,this.inclusive=n})),df=E((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";w(this,e),this.field=t,this.dir=n}));function vf(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function mf(e,t,n){for(var r=0,a=0;a<e.position.length;a++){var i=t[a],o=e.position[a];if(r=i.field.isKeyField()?Zc.comparator(Zc.fromName(o.referenceValue),n.key):Bl(o,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function yf(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!Pl(e.position[n],t.position[n]))return!1;return!0}var gf=E((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;w(this,e),this.path=t,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=a,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.lt=null,this.ft=null,this.startAt,this.endAt}));function bf(e,t,n,r,a,i,o,s){return new gf(e,t,n,r,a,i,o,s)}function xf(e){return new gf(e)}function wf(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function kf(e){var t,n=y(e.filters);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.ht())return r.field}}catch(a){n.e(a)}finally{n.f()}return null}function Ef(e){return null!==e.collectionGroup}function Sf(e){var t=Dc(e);if(null===t.lt){t.lt=[];var n=kf(t),r=wf(t);if(null!==n&&null===r)n.isKeyField()||t.lt.push(new df(n)),t.lt.push(new df(Jc.keyField(),"asc"));else{var a,i=!1,o=y(t.explicitOrderBy);try{for(o.s();!(a=o.n()).done;){var s=a.value;t.lt.push(s),s.field.isKeyField()&&(i=!0)}}catch(c){o.e(c)}finally{o.f()}if(!i){var u=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.lt.push(new df(Jc.keyField(),u))}}}return t.lt}function Cf(e){var t=Dc(e);if(!t.ft)if("F"===t.limitType)t.ft=Zl(t.path,t.collectionGroup,Sf(t),t.filters,t.limit,t.startAt,t.endAt);else{var n,r=[],a=y(Sf(t));try{for(a.s();!(n=a.n()).done;){var i=n.value,o="desc"===i.dir?"asc":"desc";r.push(new df(i.field,o))}}catch(c){a.e(c)}finally{a.f()}var s=t.endAt?new pf(t.endAt.position,t.endAt.inclusive):null,u=t.startAt?new pf(t.startAt.position,t.startAt.inclusive):null;t.ft=Zl(t.path,t.collectionGroup,r,t.filters,t.limit,s,u)}return t.ft}function If(e,t,n){return new gf(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Tf(e,t){return tf(Cf(e),Cf(t))&&e.limitType===t.limitType}function Nf(e){return"".concat(ef(Cf(e)),"|lt:").concat(e.limitType)}function _f(e){return"Query(target=".concat(function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((function(e){return"".concat((t=e).field.canonicalString()," ").concat(t.op," ").concat(zl(t.value));var t})).join(", "),"]")),Al(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((function(e){return function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e)})).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((function(e){return zl(e)})).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((function(e){return zl(e)})).join(",")),"Target(".concat(t,")")}(Cf(e)),"; limitType=").concat(e.limitType,")")}function Rf(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Zc.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){var n,r=y(e.explicitOrderBy);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(!a.field.isKeyField()&&null===t.data.field(a.field))return!1}}catch(i){r.e(i)}finally{r.f()}return!0}(e,t)&&function(e,t){var n,r=y(e.filters);try{for(r.s();!(n=r.n()).done;){if(!n.value.matches(t))return!1}}catch(a){r.e(a)}finally{r.f()}return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){var r=mf(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Sf(e),t))&&!(e.endAt&&!function(e,t,n){var r=mf(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Sf(e),t))}(e,t)}function Af(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Df(e){return function(t,n){var r,a=!1,i=y(Sf(e));try{for(i.s();!(r=i.n()).done;){var o=r.value,s=Of(o,t,n);if(0!==s)return s;a=a||o.field.isKeyField()}}catch(u){i.e(u)}finally{i.f()}return 0}}function Of(e,t,n){var r=e.field.isKeyField()?Zc.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),a=n.data.field(e);return null!==r&&null!==a?Bl(r,a):Rc()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Rc()}}function Mf(e,t){if(e.dt){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Dl(t)?"-0":t}}function Ff(e){return{integerValue:""+e}}function Pf(e,t){return Ol(t)?Ff(t):Mf(e,t)}var Lf=E((function e(){w(this,e),this._=void 0}));function Bf(e,t,n){return e instanceof Uf?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Wf?jf(e,t):e instanceof Gf?Hf(e,t):function(e,t){var n=zf(e,t),r=Kf(n)+Kf(e._t);return Wl(n)&&Wl(e._t)?Ff(r):Mf(e.wt,r)}(e,t)}function Vf(e,t,n){return e instanceof Wf?jf(e,t):e instanceof Gf?Hf(e,t):n}function zf(e,t){return e instanceof qf?Wl(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}var Uf=function(e){h(n,e);var t=m(n);function n(){return w(this,n),t.apply(this,arguments)}return E(n)}(Lf),Wf=function(e){h(n,e);var t=m(n);function n(e){var r;return w(this,n),(r=t.call(this)).elements=e,r}return E(n)}(Lf);function jf(e,t){var n,r=Xf(t),a=y(e.elements);try{var i=function(){var e=n.value;r.some((function(t){return Pl(t,e)}))||r.push(e)};for(a.s();!(n=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}return{arrayValue:{values:r}}}var Gf=function(e){h(n,e);var t=m(n);function n(e){var r;return w(this,n),(r=t.call(this)).elements=e,r}return E(n)}(Lf);function Hf(e,t){var n,r=Xf(t),a=y(e.elements);try{var i=function(){var e=n.value;r=r.filter((function(t){return!Pl(t,e)}))};for(a.s();!(n=a.n()).done;)i()}catch(o){a.e(o)}finally{a.f()}return{arrayValue:{values:r}}}var qf=function(e){h(n,e);var t=m(n);function n(e,r){var a;return w(this,n),(a=t.call(this)).wt=e,a._t=r,a}return E(n)}(Lf);function Kf(e){return Sl(e.integerValue||e.doubleValue)}function Xf(e){return jl(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var $f=E((function e(t,n){w(this,e),this.version=t,this.transformResults=n})),Qf=function(){function e(t,n){w(this,e),this.updateTime=t,this.exists=n}return E(e,[{key:"isNone",get:function(){return void 0===this.updateTime&&void 0===this.exists}},{key:"isEqual",value:function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}],[{key:"none",value:function(){return new e}},{key:"exists",value:function(t){return new e(void 0,t)}},{key:"updateTime",value:function(t){return new e(t)}}]),e}();function Yf(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var Jf=E((function e(){w(this,e)}));function Zf(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new fh(e.key,Qf.none()):new ah(e.key,e.data,Qf.none());var n,r=e.data,a=$l.empty(),i=new gl(Jc.comparator),o=y(t.fields);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(!i.has(s)){var u=r.field(s);null===u&&s.length>1&&(s=s.popLast(),u=r.field(s)),null===u?a.delete(s):a.set(s,u),i=i.add(s)}}}catch(c){o.e(c)}finally{o.f()}return new ih(e.key,a,new xl(i.toArray()),Qf.none())}function eh(e,t,n){e instanceof ah?function(e,t,n){var r=e.value.clone(),a=sh(e.fieldTransforms,t,n.transformResults);r.setAll(a),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof ih?function(e,t,n){if(Yf(e.precondition,t)){var r=sh(e.fieldTransforms,t,n.transformResults),a=t.data;a.setAll(oh(e)),a.setAll(r),t.convertToFoundDocument(n.version,a).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function th(e,t,n,r){return e instanceof ah?function(e,t,n,r){if(!Yf(e.precondition,t))return n;var a=e.value.clone(),i=uh(e.fieldTransforms,r,t);return a.setAll(i),t.convertToFoundDocument(t.version,a).setHasLocalMutations(),null}(e,t,n,r):e instanceof ih?function(e,t,n,r){if(!Yf(e.precondition,t))return n;var a=uh(e.fieldTransforms,r,t),i=t.data;return i.setAll(oh(e)),i.setAll(a),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((function(e){return e.field})))}(e,t,n,r):function(e,t,n){return Yf(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function nh(e,t){var n,r=null,a=y(e.fieldTransforms);try{for(a.s();!(n=a.n()).done;){var i=n.value,o=t.data.field(i.field),s=zf(i.transform,o||null);null!=s&&(null===r&&(r=$l.empty()),r.set(i.field,s))}}catch(u){a.e(u)}finally{a.f()}return r||null}function rh(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&qc(e,t,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Wf&&t instanceof Wf||e instanceof Gf&&t instanceof Gf?qc(e.elements,t.elements,Pl):e instanceof qf&&t instanceof qf?Pl(e._t,t._t):e instanceof Uf&&t instanceof Uf}(e.transform,t.transform)}(e,t)}))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}var ah=function(e){h(n,e);var t=m(n);function n(e,r,a){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return w(this,n),(i=t.call(this)).key=e,i.value=r,i.precondition=a,i.fieldTransforms=o,i.type=0,i}return E(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Jf),ih=function(e){h(n,e);var t=m(n);function n(e,r,a,i){var o,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];return w(this,n),(o=t.call(this)).key=e,o.data=r,o.fieldMask=a,o.precondition=i,o.fieldTransforms=s,o.type=1,o}return E(n,[{key:"getFieldMask",value:function(){return this.fieldMask}}]),n}(Jf);function oh(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function sh(e,t,n){var r=new Map;Ac(e.length===n.length);for(var a=0;a<n.length;a++){var i=e[a],o=i.transform,s=t.data.field(i.field);r.set(i.field,Vf(o,s,n[a]))}return r}function uh(e,t,n){var r,a=new Map,i=y(e);try{for(i.s();!(r=i.n()).done;){var o=r.value,s=o.transform,u=n.data.field(o.field);a.set(o.field,Bf(s,u,t))}}catch(c){i.e(c)}finally{i.f()}return a}var ch,lh,fh=function(e){h(n,e);var t=m(n);function n(e,r){var a;return w(this,n),(a=t.call(this)).key=e,a.precondition=r,a.type=2,a.fieldTransforms=[],a}return E(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Jf),hh=function(e){h(n,e);var t=m(n);function n(e,r){var a;return w(this,n),(a=t.call(this)).key=e,a.precondition=r,a.type=3,a.fieldTransforms=[],a}return E(n,[{key:"getFieldMask",value:function(){return null}}]),n}(Jf),ph=E((function e(t){w(this,e),this.count=t}));function dh(e){switch(e){default:return Rc();case Oc.CANCELLED:case Oc.UNKNOWN:case Oc.DEADLINE_EXCEEDED:case Oc.RESOURCE_EXHAUSTED:case Oc.INTERNAL:case Oc.UNAVAILABLE:case Oc.UNAUTHENTICATED:return!1;case Oc.INVALID_ARGUMENT:case Oc.NOT_FOUND:case Oc.ALREADY_EXISTS:case Oc.PERMISSION_DENIED:case Oc.FAILED_PRECONDITION:case Oc.ABORTED:case Oc.OUT_OF_RANGE:case Oc.UNIMPLEMENTED:case Oc.DATA_LOSS:return!0}}function vh(e){if(void 0===e)return Tc("GRPC error has no .code"),Oc.UNKNOWN;switch(e){case ch.OK:return Oc.OK;case ch.CANCELLED:return Oc.CANCELLED;case ch.UNKNOWN:return Oc.UNKNOWN;case ch.DEADLINE_EXCEEDED:return Oc.DEADLINE_EXCEEDED;case ch.RESOURCE_EXHAUSTED:return Oc.RESOURCE_EXHAUSTED;case ch.INTERNAL:return Oc.INTERNAL;case ch.UNAVAILABLE:return Oc.UNAVAILABLE;case ch.UNAUTHENTICATED:return Oc.UNAUTHENTICATED;case ch.INVALID_ARGUMENT:return Oc.INVALID_ARGUMENT;case ch.NOT_FOUND:return Oc.NOT_FOUND;case ch.ALREADY_EXISTS:return Oc.ALREADY_EXISTS;case ch.PERMISSION_DENIED:return Oc.PERMISSION_DENIED;case ch.FAILED_PRECONDITION:return Oc.FAILED_PRECONDITION;case ch.ABORTED:return Oc.ABORTED;case ch.OUT_OF_RANGE:return Oc.OUT_OF_RANGE;case ch.UNIMPLEMENTED:return Oc.UNIMPLEMENTED;case ch.DATA_LOSS:return Oc.DATA_LOSS;default:return Rc()}}(lh=ch||(ch={}))[lh.OK=0]="OK",lh[lh.CANCELLED=1]="CANCELLED",lh[lh.UNKNOWN=2]="UNKNOWN",lh[lh.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",lh[lh.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",lh[lh.NOT_FOUND=5]="NOT_FOUND",lh[lh.ALREADY_EXISTS=6]="ALREADY_EXISTS",lh[lh.PERMISSION_DENIED=7]="PERMISSION_DENIED",lh[lh.UNAUTHENTICATED=16]="UNAUTHENTICATED",lh[lh.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",lh[lh.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",lh[lh.ABORTED=10]="ABORTED",lh[lh.OUT_OF_RANGE=11]="OUT_OF_RANGE",lh[lh.UNIMPLEMENTED=12]="UNIMPLEMENTED",lh[lh.INTERNAL=13]="INTERNAL",lh[lh.UNAVAILABLE=14]="UNAVAILABLE",lh[lh.DATA_LOSS=15]="DATA_LOSS";var mh=function(){function e(t,n){w(this,e),this.mapKeyFn=t,this.equalsFn=n,this.inner={},this.innerSize=0}return E(e,[{key:"get",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){var r,a=y(n);try{for(a.s();!(r=a.n()).done;){var i=o(r.value,2),s=i[0],u=i[1];if(this.equalsFn(s,e))return u}}catch(c){a.e(c)}finally{a.f()}}}},{key:"has",value:function(e){return void 0!==this.get(e)}},{key:"set",value:function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(var a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return void(r[a]=[e,t]);r.push([e,t]),this.innerSize++}},{key:"delete",value:function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}},{key:"forEach",value:function(e){pl(this.inner,(function(t,n){var r,a=y(n);try{for(a.s();!(r=a.n()).done;){var i=o(r.value,2),s=i[0],u=i[1];e(s,u)}}catch(c){a.e(c)}finally{a.f()}}))}},{key:"isEmpty",value:function(){return dl(this.inner)}},{key:"size",value:function(){return this.innerSize}}]),e}(),yh=new vl(Zc.comparator);function gh(){return yh}var bh=new vl(Zc.comparator);function xh(){for(var e=bh,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];e=e.insert(o.key,o)}return e}function wh(e){var t=bh;return e.forEach((function(e,n){return t=t.insert(e,n.overlayedDocument)})),t}function kh(){return Sh()}function Eh(){return Sh()}function Sh(){return new mh((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)}))}var Ch=new vl(Zc.comparator),Ih=new gl(Zc.comparator);function Th(){for(var e=Ih,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=n;a<i.length;a++){var o=i[a];e=e.add(o)}return e}var Nh=new gl(Hc);function _h(){return Nh}var Rh=function(){function e(t,n,r,a,i){w(this,e),this.snapshotVersion=t,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=i}return E(e,null,[{key:"createSynthesizedRemoteEventForCurrentChange",value:function(t,n){var r=new Map;return r.set(t,Ah.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(Xc.min(),r,_h(),gh(),Th())}}]),e}(),Ah=function(){function e(t,n,r,a,i){w(this,e),this.resumeToken=t,this.current=n,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=i}return E(e,null,[{key:"createSynthesizedTargetChangeForCurrentChange",value:function(t,n){return new e(wl.EMPTY_BYTE_STRING,n,Th(),Th(),Th())}}]),e}(),Dh=E((function e(t,n,r,a){w(this,e),this.gt=t,this.removedTargetIds=n,this.key=r,this.yt=a})),Oh=E((function e(t,n){w(this,e),this.targetId=t,this.It=n})),Mh=E((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wl.EMPTY_BYTE_STRING,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;w(this,e),this.state=t,this.targetIds=n,this.resumeToken=r,this.cause=a})),Fh=function(){function e(){w(this,e),this.Tt=0,this.Et=Bh(),this.At=wl.EMPTY_BYTE_STRING,this.Rt=!1,this.bt=!0}return E(e,[{key:"current",get:function(){return this.Rt}},{key:"resumeToken",get:function(){return this.At}},{key:"Pt",get:function(){return 0!==this.Tt}},{key:"vt",get:function(){return this.bt}},{key:"Vt",value:function(e){e.approximateByteSize()>0&&(this.bt=!0,this.At=e)}},{key:"St",value:function(){var e=Th(),t=Th(),n=Th();return this.Et.forEach((function(r,a){switch(a){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Rc()}})),new Ah(this.At,this.Rt,e,t,n)}},{key:"Dt",value:function(){this.bt=!1,this.Et=Bh()}},{key:"Ct",value:function(e,t){this.bt=!0,this.Et=this.Et.insert(e,t)}},{key:"xt",value:function(e){this.bt=!0,this.Et=this.Et.remove(e)}},{key:"Nt",value:function(){this.Tt+=1}},{key:"kt",value:function(){this.Tt-=1}},{key:"Ot",value:function(){this.bt=!0,this.Rt=!0}}]),e}(),Ph=function(){function e(t){w(this,e),this.Mt=t,this.Ft=new Map,this.$t=gh(),this.Bt=Lh(),this.Lt=new gl(Hc)}return E(e,[{key:"Ut",value:function(e){var t,n=y(e.gt);try{for(n.s();!(t=n.n()).done;){var r=t.value;e.yt&&e.yt.isFoundDocument()?this.qt(r,e.yt):this.Kt(r,e.key,e.yt)}}catch(s){n.e(s)}finally{n.f()}var a,i=y(e.removedTargetIds);try{for(i.s();!(a=i.n()).done;){var o=a.value;this.Kt(o,e.key,e.yt)}}catch(s){i.e(s)}finally{i.f()}}},{key:"Gt",value:function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.Qt(n);switch(e.state){case 0:t.jt(n)&&r.Vt(e.resumeToken);break;case 1:r.kt(),r.Pt||r.Dt(),r.Vt(e.resumeToken);break;case 2:r.kt(),r.Pt||t.removeTarget(n);break;case 3:t.jt(n)&&(r.Ot(),r.Vt(e.resumeToken));break;case 4:t.jt(n)&&(t.Wt(n),r.Vt(e.resumeToken));break;default:Rc()}}))}},{key:"forEachTarget",value:function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.Ft.forEach((function(e,r){n.jt(r)&&t(r)}))}},{key:"zt",value:function(e){var t=e.targetId,n=e.It.count,r=this.Ht(t);if(r){var a=r.target;if(nf(a))if(0===n){var i=new Zc(a.path);this.Kt(t,i,Yl.newNoDocument(i,Xc.min()))}else Ac(1===n);else this.Jt(t)!==n&&(this.Wt(t),this.Lt=this.Lt.add(t))}}},{key:"Yt",value:function(e){var t=this,n=new Map;this.Ft.forEach((function(r,a){var i=t.Ht(a);if(i){if(r.current&&nf(i.target)){var o=new Zc(i.target.path);null!==t.$t.get(o)||t.Xt(a,o)||t.Kt(a,o,Yl.newNoDocument(o,e))}r.vt&&(n.set(a,r.St()),r.Dt())}}));var r=Th();this.Bt.forEach((function(e,n){var a=!0;n.forEachWhile((function(e){var n=t.Ht(e);return!n||2===n.purpose||(a=!1,!1)})),a&&(r=r.add(e))})),this.$t.forEach((function(t,n){return n.setReadTime(e)}));var a=new Rh(e,n,this.Lt,this.$t,r);return this.$t=gh(),this.Bt=Lh(),this.Lt=new gl(Hc),a}},{key:"qt",value:function(e,t){if(this.jt(e)){var n=this.Xt(e,t.key)?2:0;this.Qt(e).Ct(t.key,n),this.$t=this.$t.insert(t.key,t),this.Bt=this.Bt.insert(t.key,this.Zt(t.key).add(e))}}},{key:"Kt",value:function(e,t,n){if(this.jt(e)){var r=this.Qt(e);this.Xt(e,t)?r.Ct(t,1):r.xt(t),this.Bt=this.Bt.insert(t,this.Zt(t).delete(e)),n&&(this.$t=this.$t.insert(t,n))}}},{key:"removeTarget",value:function(e){this.Ft.delete(e)}},{key:"Jt",value:function(e){var t=this.Qt(e).St();return this.Mt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}},{key:"Nt",value:function(e){this.Qt(e).Nt()}},{key:"Qt",value:function(e){var t=this.Ft.get(e);return t||(t=new Fh,this.Ft.set(e,t)),t}},{key:"Zt",value:function(e){var t=this.Bt.get(e);return t||(t=new gl(Hc),this.Bt=this.Bt.insert(e,t)),t}},{key:"jt",value:function(e){var t=null!==this.Ht(e);return t||Ic("WatchChangeAggregator","Detected inactive target",e),t}},{key:"Ht",value:function(e){var t=this.Ft.get(e);return t&&t.Pt?null:this.Mt.te(e)}},{key:"Wt",value:function(e){var t=this;this.Ft.set(e,new Fh),this.Mt.getRemoteKeysForTarget(e).forEach((function(n){t.Kt(e,n,null)}))}},{key:"Xt",value:function(e,t){return this.Mt.getRemoteKeysForTarget(e).has(t)}}]),e}();function Lh(){return new vl(Zc.comparator)}function Bh(){return new vl(Zc.comparator)}var Vh={asc:"ASCENDING",desc:"DESCENDING"},zh={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Uh=E((function e(t,n){w(this,e),this.databaseId=t,this.dt=n}));function Wh(e,t){return e.dt?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function jh(e,t){return e.dt?t.toBase64():t.toUint8Array()}function Gh(e,t){return Wh(e,t.toTimestamp())}function Hh(e){return Ac(!!e),Xc.fromTimestamp(function(e){var t=El(e);return new Kc(t.seconds,t.nanos)}(e))}function qh(e,t){return function(e){return new Qc(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Kh(e){var t=Qc.fromString(e);return Ac(pp(t)),t}function Xh(e,t){return qh(e.databaseId,t.path)}function $h(e,t){var n=Kh(t);if(n.get(1)!==e.databaseId.projectId)throw new Mc(Oc.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Mc(Oc.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Zc(Zh(n))}function Qh(e,t){return qh(e.databaseId,t)}function Yh(e){var t=Kh(e);return 4===t.length?Qc.emptyPath():Zh(t)}function Jh(e){return new Qc(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Zh(e){return Ac(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function ep(e,t,n){return{name:Xh(e,t),fields:n.value.mapValue.fields}}function tp(e,t){var n;if(t instanceof ah)n={update:ep(e,t.key,t.value)};else if(t instanceof fh)n={delete:Xh(e,t.key)};else if(t instanceof ih)n={update:ep(e,t.key,t.data),updateMask:hp(t.fieldMask)};else{if(!(t instanceof hh))return Rc();n={verify:Xh(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof Uf)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Wf)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Gf)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof qf)return{fieldPath:t.field.canonicalString(),increment:n._t};throw Rc()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Gh(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Rc()}(e,t.precondition)),n}function np(e,t){return{documents:[Qh(e,t.path)]}}function rp(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Qh(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Qh(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var a=function(e){if(0!==e.length){var t=e.map((function(e){return function(e){if("=="===e.op){if(Hl(e.value))return{unaryFilter:{field:up(e.field),op:"IS_NAN"}};if(Gl(e.value))return{unaryFilter:{field:up(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Hl(e.value))return{unaryFilter:{field:up(e.field),op:"IS_NOT_NAN"}};if(Gl(e.value))return{unaryFilter:{field:up(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:up(e.field),op:sp(e.op),value:e.value}}}(e)}));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);a&&(n.structuredQuery.where=a);var i=function(e){if(0!==e.length)return e.map((function(e){return function(e){return{field:up(e.field),direction:op(e.dir)}}(e)}))}(t.orderBy);i&&(n.structuredQuery.orderBy=i);var o,s=function(e,t){return e.dt||Al(t)?t:{value:t}}(e,t.limit);return null!==s&&(n.structuredQuery.limit=s),t.startAt&&(n.structuredQuery.startAt={before:(o=t.startAt).inclusive,values:o.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),n}function ap(e){var t=Yh(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,a=null;if(r>0){Ac(1===r);var i=n.from[0];i.allDescendants?a=i.collectionId:t=t.child(i.collectionId)}var o=[];n.where&&(o=ip(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(e){return function(e){return new df(cp(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)})));var u=null;n.limit&&(u=function(e){var t;return Al(t="object"==typeof e?e.value:e)?null:t}(n.limit));var c=null;n.startAt&&(c=function(e){var t=!!e.before,n=e.values||[];return new pf(n,t)}(n.startAt));var l=null;return n.endAt&&(l=function(e){var t=!e.before,n=e.values||[];return new pf(n,t)}(n.endAt)),bf(t,a,s,o,u,"F",c,l)}function ip(e){return e?void 0!==e.unaryFilter?[fp(e)]:void 0!==e.fieldFilter?[lp(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return ip(e)})).reduce((function(e,t){return e.concat(t)})):Rc():[]}function op(e){return Vh[e]}function sp(e){return zh[e]}function up(e){return{fieldPath:e.canonicalString()}}function cp(e){return Jc.fromServerFormat(e.fieldPath)}function lp(e){return rf.create(cp(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Rc()}}(e.fieldFilter.op),e.fieldFilter.value)}function fp(e){switch(e.unaryFilter.op){case"IS_NAN":var t=cp(e.unaryFilter.field);return rf.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=cp(e.unaryFilter.field);return rf.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=cp(e.unaryFilter.field);return rf.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var a=cp(e.unaryFilter.field);return rf.create(a,"!=",{nullValue:"NULL_VALUE"});default:return Rc()}}function hp(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}}function pp(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}var dp=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments"].concat(["clientMetadata"]).concat(["remoteDocumentGlobal"]).concat(["collectionParents"]).concat(["bundles","namedQueries"]),vp=([].concat(S(dp),["documentOverlays"]),["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"]),mp=vp;[].concat(mp,["indexConfiguration","indexState","indexEntries"]);var yp=function(){function e(t,n,r,a){w(this,e),this.batchId=t,this.localWriteTime=n,this.baseMutations=r,this.mutations=a}return E(e,[{key:"applyToRemoteDocument",value:function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var a=this.mutations[r];a.key.isEqual(e.key)&&eh(a,e,n[r])}}},{key:"applyToLocalView",value:function(e,t){var n,r=y(this.baseMutations);try{for(r.s();!(n=r.n()).done;){var a=n.value;a.key.isEqual(e.key)&&(t=th(a,e,t,this.localWriteTime))}}catch(u){r.e(u)}finally{r.f()}var i,o=y(this.mutations);try{for(o.s();!(i=o.n()).done;){var s=i.value;s.key.isEqual(e.key)&&(t=th(s,e,t,this.localWriteTime))}}catch(u){o.e(u)}finally{o.f()}return t}},{key:"applyToLocalDocumentSet",value:function(e,t){var n=this,r=Eh();return this.mutations.forEach((function(a){var i=e.get(a.key),o=i.overlayedDocument,s=n.applyToLocalView(o,i.mutatedFields),u=Zf(o,s=t.has(a.key)?null:s);null!==u&&r.set(a.key,u),o.isValidDocument()||o.convertToNoDocument(Xc.min())})),r}},{key:"keys",value:function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),Th())}},{key:"isEqual",value:function(e){return this.batchId===e.batchId&&qc(this.mutations,e.mutations,(function(e,t){return rh(e,t)}))&&qc(this.baseMutations,e.baseMutations,(function(e,t){return rh(e,t)}))}}]),e}(),gp=function(){function e(t,n,r,a){w(this,e),this.batch=t,this.commitVersion=n,this.mutationResults=r,this.docVersions=a}return E(e,null,[{key:"from",value:function(t,n,r){Ac(t.mutations.length===r.length);for(var a=Ch,i=t.mutations,o=0;o<i.length;o++)a=a.insert(i[o].key,r[o].version);return new e(t,n,r,a)}}]),e}(),bp=function(){function e(t,n){w(this,e),this.largestBatchId=t,this.mutation=n}return E(e,[{key:"getKey",value:function(){return this.mutation.key}},{key:"isEqual",value:function(e){return null!==e&&this.mutation===e.mutation}},{key:"toString",value:function(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}]),e}(),xp=function(){function e(t,n,r,a){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Xc.min(),o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Xc.min(),s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:wl.EMPTY_BYTE_STRING;w(this,e),this.target=t,this.targetId=n,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}return E(e,[{key:"withSequenceNumber",value:function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}},{key:"withResumeToken",value:function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)}},{key:"withLastLimboFreeSnapshotVersion",value:function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)}}]),e}(),wp=E((function e(t){w(this,e),this.ne=t}));function kp(e){var t=ap({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?If(t,t.limit,"L"):t}var Ep=function(){function e(){w(this,e)}return E(e,[{key:"re",value:function(e,t){this.oe(e,t),t.ue()}},{key:"oe",value:function(e,t){if("nullValue"in e)this.ce(t,5);else if("booleanValue"in e)this.ce(t,10),t.ae(e.booleanValue?1:0);else if("integerValue"in e)this.ce(t,15),t.ae(Sl(e.integerValue));else if("doubleValue"in e){var n=Sl(e.doubleValue);isNaN(n)?this.ce(t,13):(this.ce(t,15),Dl(n)?t.ae(0):t.ae(n))}else if("timestampValue"in e){var r=e.timestampValue;this.ce(t,20),"string"==typeof r?t.he(r):(t.he("".concat(r.seconds||"")),t.ae(r.nanos||0))}else if("stringValue"in e)this.le(e.stringValue,t),this.fe(t);else if("bytesValue"in e)this.ce(t,30),t.de(Cl(e.bytesValue)),this.fe(t);else if("referenceValue"in e)this._e(e.referenceValue,t);else if("geoPointValue"in e){var a=e.geoPointValue;this.ce(t,45),t.ae(a.latitude||0),t.ae(a.longitude||0)}else"mapValue"in e?Xl(e)?this.ce(t,Number.MAX_SAFE_INTEGER):(this.we(e.mapValue,t),this.fe(t)):"arrayValue"in e?(this.me(e.arrayValue,t),this.fe(t)):Rc()}},{key:"le",value:function(e,t){this.ce(t,25),this.ge(e,t)}},{key:"ge",value:function(e,t){t.he(e)}},{key:"we",value:function(e,t){var n=e.fields||{};this.ce(t,55);for(var r=0,a=Object.keys(n);r<a.length;r++){var i=a[r];this.le(i,t),this.oe(n[i],t)}}},{key:"me",value:function(e,t){var n=e.values||[];this.ce(t,50);var r,a=y(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;this.oe(i,t)}}catch(o){a.e(o)}finally{a.f()}}},{key:"_e",value:function(e,t){var n=this;this.ce(t,37),Zc.fromName(e).path.forEach((function(e){n.ce(t,60),n.ge(e,t)}))}},{key:"ce",value:function(e,t){e.ae(t)}},{key:"fe",value:function(e){e.ae(2)}}]),e}();Ep.ye=new Ep;var Sp=function(){function e(){w(this,e),this.ze=new Cp}return E(e,[{key:"addToCollectionParentIndex",value:function(e,t){return this.ze.add(t),cl.resolve()}},{key:"getCollectionParents",value:function(e,t){return cl.resolve(this.ze.getEntries(t))}},{key:"addFieldIndex",value:function(e,t){return cl.resolve()}},{key:"deleteFieldIndex",value:function(e,t){return cl.resolve()}},{key:"getDocumentsMatchingTarget",value:function(e,t){return cl.resolve(null)}},{key:"getIndexType",value:function(e,t){return cl.resolve(0)}},{key:"getFieldIndexes",value:function(e,t){return cl.resolve([])}},{key:"getNextCollectionGroupToUpdate",value:function(e){return cl.resolve(null)}},{key:"getMinOffset",value:function(e,t){return cl.resolve(rl.min())}},{key:"getMinOffsetFromCollectionGroup",value:function(e,t){return cl.resolve(rl.min())}},{key:"updateCollectionGroup",value:function(e,t,n){return cl.resolve()}},{key:"updateIndexEntries",value:function(e,t){return cl.resolve()}}]),e}(),Cp=function(){function e(){w(this,e),this.index={}}return E(e,[{key:"add",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new gl(Qc.comparator),a=!r.has(n);return this.index[t]=r.add(n),a}},{key:"has",value:function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}},{key:"getEntries",value:function(e){return(this.index[e]||new gl(Qc.comparator)).toArray()}}]),e}();new Uint8Array(0);var Ip=function(){function e(t,n,r){w(this,e),this.cacheSizeCollectionThreshold=t,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return E(e,null,[{key:"withCacheSize",value:function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}]),e}();Ip.DEFAULT_COLLECTION_PERCENTILE=10,Ip.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ip.DEFAULT=new Ip(41943040,Ip.DEFAULT_COLLECTION_PERCENTILE,Ip.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ip.DISABLED=new Ip(-1,0,0);var Tp=function(){function e(t){w(this,e),this.En=t}return E(e,[{key:"next",value:function(){return this.En+=2,this.En}}],[{key:"An",value:function(){return new e(0)}},{key:"Rn",value:function(){return new e(-1)}}]),e}();var Np=function(){function e(){w(this,e),this.changes=new mh((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return E(e,[{key:"addEntry",value:function(e){this.assertNotApplied(),this.changes.set(e.key,e)}},{key:"removeEntry",value:function(e,t){this.assertNotApplied(),this.changes.set(e,Yl.newInvalidDocument(e).setReadTime(t))}},{key:"getEntry",value:function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?cl.resolve(n):this.getFromCache(e,t)}},{key:"getEntries",value:function(e,t){return this.getAllFromCache(e,t)}},{key:"apply",value:function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}},{key:"assertNotApplied",value:function(){}}]),e}();var _p=E((function e(t,n){w(this,e),this.overlayedDocument=t,this.mutatedFields=n})),Rp=function(){function e(t,n,r,a){w(this,e),this.remoteDocumentCache=t,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=a}return E(e,[{key:"getDocument",value:function(e,t){var n=this,r=null;return this.documentOverlayCache.getOverlay(e,t).next((function(a){return r=a,n.getBaseDocument(e,t,r)})).next((function(e){return null!==r&&th(r.mutation,e,xl.empty(),Kc.now()),e}))}},{key:"getDocuments",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.getLocalViewOfDocuments(e,t,Th()).next((function(){return t}))}))}},{key:"getLocalViewOfDocuments",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Th(),a=kh();return this.populateOverlays(e,a,t).next((function(){return n.computeViews(e,t,a,r).next((function(e){var t=xh();return e.forEach((function(e,n){t=t.insert(e,n.overlayedDocument)})),t}))}))}},{key:"getOverlayedDocuments",value:function(e,t){var n=this,r=kh();return this.populateOverlays(e,r,t).next((function(){return n.computeViews(e,t,r,Th())}))}},{key:"populateOverlays",value:function(e,t,n){var r=[];return n.forEach((function(e){t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((function(e){e.forEach((function(e,n){t.set(e,n)}))}))}},{key:"computeViews",value:function(e,t,n,r){var a=gh(),i=Sh(),o=Sh();return t.forEach((function(e,t){var o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof ih)?a=a.insert(t.key,t):void 0!==o&&(i.set(t.key,o.mutation.getFieldMask()),th(o.mutation,t,o.mutation.getFieldMask(),Kc.now()))})),this.recalculateAndSaveOverlays(e,a).next((function(e){return e.forEach((function(e,t){return i.set(e,t)})),t.forEach((function(e,t){var n;return o.set(e,new _p(t,null!==(n=i.get(e))&&void 0!==n?n:null))})),o}))}},{key:"recalculateAndSaveOverlays",value:function(e,t){var n=this,r=Sh(),a=new vl((function(e,t){return e-t})),i=Th();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){var n,i=y(e);try{var o=function(){var e=n.value;e.keys().forEach((function(n){var i=t.get(n);if(null!==i){var o=r.get(n)||xl.empty();o=e.applyToLocalView(i,o),r.set(n,o);var s=(a.get(e.batchId)||Th()).add(n);a=a.insert(e.batchId,s)}}))};for(i.s();!(n=i.n()).done;)o()}catch(s){i.e(s)}finally{i.f()}})).next((function(){for(var o=[],s=a.getReverseIterator(),u=function(){var a=s.getNext(),u=a.key,c=a.value,l=Eh();c.forEach((function(e){if(!i.has(e)){var n=Zf(t.get(e),r.get(e));null!==n&&l.set(e,n),i=i.add(e)}})),o.push(n.documentOverlayCache.saveOverlays(e,u,l))};s.hasNext();)u();return cl.waitFor(o)})).next((function(){return r}))}},{key:"recalculateAndSaveOverlaysForDocumentKeys",value:function(e,t){var n=this;return this.remoteDocumentCache.getEntries(e,t).next((function(t){return n.recalculateAndSaveOverlays(e,t)}))}},{key:"getDocumentsMatchingQuery",value:function(e,t,n){return function(e){return Zc.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ef(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}},{key:"getNextDocuments",value:function(e,t,n,r){var a=this;return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((function(i){var o=r-i.size>0?a.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):cl.resolve(kh()),s=-1,u=i;return o.next((function(t){return cl.forEach(t,(function(t,n){return s<n.largestBatchId&&(s=n.largestBatchId),i.get(t)?cl.resolve():a.getBaseDocument(e,t,n).next((function(e){u=u.insert(t,e)}))})).next((function(){return a.populateOverlays(e,t,i)})).next((function(){return a.computeViews(e,u,t,Th())})).next((function(e){return{batchId:s,changes:wh(e)}}))}))}))}},{key:"getDocumentsMatchingDocumentQuery",value:function(e,t){return this.getDocument(e,new Zc(t)).next((function(e){var t=xh();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}},{key:"getDocumentsMatchingCollectionGroupQuery",value:function(e,t,n){var r=this,a=t.collectionGroup,i=xh();return this.indexManager.getCollectionParents(e,a).next((function(o){return cl.forEach(o,(function(o){var s=function(e,t){return new gf(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(a));return r.getDocumentsMatchingCollectionQuery(e,s,n).next((function(e){e.forEach((function(e,t){i=i.insert(e,t)}))}))})).next((function(){return i}))}))}},{key:"getDocumentsMatchingCollectionQuery",value:function(e,t,n){var r,a=this;return this.remoteDocumentCache.getAllFromCollection(e,t.path,n).next((function(i){return r=i,a.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId)})).next((function(e){e.forEach((function(e,t){var n=t.getKey();null===r.get(n)&&(r=r.insert(n,Yl.newInvalidDocument(n)))}));var n=xh();return r.forEach((function(r,a){var i=e.get(r);void 0!==i&&th(i.mutation,a,xl.empty(),Kc.now()),Rf(t,a)&&(n=n.insert(r,a))})),n}))}},{key:"getBaseDocument",value:function(e,t,n){return null===n||1===n.mutation.type?this.remoteDocumentCache.getEntry(e,t):cl.resolve(Yl.newInvalidDocument(t))}}]),e}(),Ap=function(){function e(t){w(this,e),this.wt=t,this.Jn=new Map,this.Yn=new Map}return E(e,[{key:"getBundleMetadata",value:function(e,t){return cl.resolve(this.Jn.get(t))}},{key:"saveBundleMetadata",value:function(e,t){var n;return this.Jn.set(t.id,{id:(n=t).id,version:n.version,createTime:Hh(n.createTime)}),cl.resolve()}},{key:"getNamedQuery",value:function(e,t){return cl.resolve(this.Yn.get(t))}},{key:"saveNamedQuery",value:function(e,t){return this.Yn.set(t.name,function(e){return{name:e.name,query:kp(e.bundledQuery),readTime:Hh(e.readTime)}}(t)),cl.resolve()}}]),e}(),Dp=function(){function e(){w(this,e),this.overlays=new vl(Zc.comparator),this.Xn=new Map}return E(e,[{key:"getOverlay",value:function(e,t){return cl.resolve(this.overlays.get(t))}},{key:"getOverlays",value:function(e,t){var n=this,r=kh();return cl.forEach(t,(function(t){return n.getOverlay(e,t).next((function(e){null!==e&&r.set(t,e)}))})).next((function(){return r}))}},{key:"saveOverlays",value:function(e,t,n){var r=this;return n.forEach((function(n,a){r.ie(e,t,a)})),cl.resolve()}},{key:"removeOverlaysForBatchId",value:function(e,t,n){var r=this,a=this.Xn.get(n);return void 0!==a&&(a.forEach((function(e){return r.overlays=r.overlays.remove(e)})),this.Xn.delete(n)),cl.resolve()}},{key:"getOverlaysForCollection",value:function(e,t,n){for(var r=kh(),a=t.length+1,i=new Zc(t.child("")),o=this.overlays.getIteratorFrom(i);o.hasNext();){var s=o.getNext().value,u=s.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===a&&s.largestBatchId>n&&r.set(s.getKey(),s)}return cl.resolve(r)}},{key:"getOverlaysForCollectionGroup",value:function(e,t,n,r){for(var a=new vl((function(e,t){return e-t})),i=this.overlays.getIterator();i.hasNext();){var o=i.getNext().value;if(o.getKey().getCollectionGroup()===t&&o.largestBatchId>n){var s=a.get(o.largestBatchId);null===s&&(s=kh(),a=a.insert(o.largestBatchId,s)),s.set(o.getKey(),o)}}for(var u=kh(),c=a.getIterator();c.hasNext()&&(c.getNext().value.forEach((function(e,t){return u.set(e,t)})),!(u.size()>=r)););return cl.resolve(u)}},{key:"ie",value:function(e,t,n){var r=this.overlays.get(n.key);if(null!==r){var a=this.Xn.get(r.largestBatchId).delete(n.key);this.Xn.set(r.largestBatchId,a)}this.overlays=this.overlays.insert(n.key,new bp(t,n));var i=this.Xn.get(t);void 0===i&&(i=Th(),this.Xn.set(t,i)),this.Xn.set(t,i.add(n.key))}}]),e}(),Op=function(){function e(){w(this,e),this.Zn=new gl(Mp.ts),this.es=new gl(Mp.ns)}return E(e,[{key:"isEmpty",value:function(){return this.Zn.isEmpty()}},{key:"addReference",value:function(e,t){var n=new Mp(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}},{key:"ss",value:function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))}},{key:"removeReference",value:function(e,t){this.rs(new Mp(e,t))}},{key:"os",value:function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))}},{key:"us",value:function(e){var t=this,n=new Zc(new Qc([])),r=new Mp(n,e),a=new Mp(n,e+1),i=[];return this.es.forEachInRange([r,a],(function(e){t.rs(e),i.push(e.key)})),i}},{key:"cs",value:function(){var e=this;this.Zn.forEach((function(t){return e.rs(t)}))}},{key:"rs",value:function(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}},{key:"hs",value:function(e){var t=new Zc(new Qc([])),n=new Mp(t,e),r=new Mp(t,e+1),a=Th();return this.es.forEachInRange([n,r],(function(e){a=a.add(e.key)})),a}},{key:"containsKey",value:function(e){var t=new Mp(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}]),e}(),Mp=function(){function e(t,n){w(this,e),this.key=t,this.ls=n}return E(e,null,[{key:"ts",value:function(e,t){return Zc.comparator(e.key,t.key)||Hc(e.ls,t.ls)}},{key:"ns",value:function(e,t){return Hc(e.ls,t.ls)||Zc.comparator(e.key,t.key)}}]),e}(),Fp=function(){function e(t,n){w(this,e),this.indexManager=t,this.referenceDelegate=n,this.mutationQueue=[],this.fs=1,this.ds=new gl(Mp.ts)}return E(e,[{key:"checkEmpty",value:function(e){return cl.resolve(0===this.mutationQueue.length)}},{key:"addMutationBatch",value:function(e,t,n,r){var a=this.fs;this.fs++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];var i=new yp(a,t,n,r);this.mutationQueue.push(i);var o,s=y(r);try{for(s.s();!(o=s.n()).done;){var u=o.value;this.ds=this.ds.add(new Mp(u.key,a)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast())}}catch(c){s.e(c)}finally{s.f()}return cl.resolve(i)}},{key:"lookupMutationBatch",value:function(e,t){return cl.resolve(this._s(t))}},{key:"getNextMutationBatchAfterBatchId",value:function(e,t){var n=t+1,r=this.ws(n),a=r<0?0:r;return cl.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}},{key:"getHighestUnacknowledgedBatchId",value:function(){return cl.resolve(0===this.mutationQueue.length?-1:this.fs-1)}},{key:"getAllMutationBatches",value:function(e){return cl.resolve(this.mutationQueue.slice())}},{key:"getAllMutationBatchesAffectingDocumentKey",value:function(e,t){var n=this,r=new Mp(t,0),a=new Mp(t,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([r,a],(function(e){var t=n._s(e.ls);i.push(t)})),cl.resolve(i)}},{key:"getAllMutationBatchesAffectingDocumentKeys",value:function(e,t){var n=this,r=new gl(Hc);return t.forEach((function(e){var t=new Mp(e,0),a=new Mp(e,Number.POSITIVE_INFINITY);n.ds.forEachInRange([t,a],(function(e){r=r.add(e.ls)}))})),cl.resolve(this.gs(r))}},{key:"getAllMutationBatchesAffectingQuery",value:function(e,t){var n=t.path,r=n.length+1,a=n;Zc.isDocumentKey(a)||(a=a.child(""));var i=new Mp(new Zc(a),0),o=new gl(Hc);return this.ds.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)}),i),cl.resolve(this.gs(o))}},{key:"gs",value:function(e){var t=this,n=[];return e.forEach((function(e){var r=t._s(e);null!==r&&n.push(r)})),n}},{key:"removeMutationBatch",value:function(e,t){var n=this;Ac(0===this.ys(t.batchId,"removed")),this.mutationQueue.shift();var r=this.ds;return cl.forEach(t.mutations,(function(a){var i=new Mp(a.key,t.batchId);return r=r.delete(i),n.referenceDelegate.markPotentiallyOrphaned(e,a.key)})).next((function(){n.ds=r}))}},{key:"In",value:function(e){}},{key:"containsKey",value:function(e,t){var n=new Mp(t,0),r=this.ds.firstAfterOrEqual(n);return cl.resolve(t.isEqual(r&&r.key))}},{key:"performConsistencyCheck",value:function(e){return this.mutationQueue.length,cl.resolve()}},{key:"ys",value:function(e,t){return this.ws(e)}},{key:"ws",value:function(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}},{key:"_s",value:function(e){var t=this.ws(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}]),e}(),Pp=function(){function e(t){w(this,e),this.ps=t,this.docs=new vl(Zc.comparator),this.size=0}return E(e,[{key:"setIndexManager",value:function(e){this.indexManager=e}},{key:"addEntry",value:function(e,t){var n=t.key,r=this.docs.get(n),a=r?r.size:0,i=this.ps(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-a,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}},{key:"removeEntry",value:function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}},{key:"getEntry",value:function(e,t){var n=this.docs.get(t);return cl.resolve(n?n.document.mutableCopy():Yl.newInvalidDocument(t))}},{key:"getEntries",value:function(e,t){var n=this,r=gh();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():Yl.newInvalidDocument(e))})),cl.resolve(r)}},{key:"getAllFromCollection",value:function(e,t,n){for(var r=gh(),a=new Zc(t.child("")),i=this.docs.getIteratorFrom(a);i.hasNext();){var o=i.getNext(),s=o.key,u=o.value.document;if(!t.isPrefixOf(s.path))break;s.path.length>t.length+1||al(nl(u),n)<=0||(r=r.insert(u.key,u.mutableCopy()))}return cl.resolve(r)}},{key:"getAllFromCollectionGroup",value:function(e,t,n,r){Rc()}},{key:"Is",value:function(e,t){return cl.forEach(this.docs,(function(e){return t(e)}))}},{key:"newChangeBuffer",value:function(e){return new Lp(this)}},{key:"getSize",value:function(e){return cl.resolve(this.size)}}]),e}(),Lp=function(e){h(n,e);var t=m(n);function n(e){var r;return w(this,n),(r=t.call(this)).zn=e,r}return E(n,[{key:"applyChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,a){a.isValidDocument()?n.push(t.zn.addEntry(e,a)):t.zn.removeEntry(r)})),cl.waitFor(n)}},{key:"getFromCache",value:function(e,t){return this.zn.getEntry(e,t)}},{key:"getAllFromCache",value:function(e,t){return this.zn.getEntries(e,t)}}]),n}(Np),Bp=function(){function e(t){w(this,e),this.persistence=t,this.Ts=new mh((function(e){return ef(e)}),tf),this.lastRemoteSnapshotVersion=Xc.min(),this.highestTargetId=0,this.Es=0,this.As=new Op,this.targetCount=0,this.Rs=Tp.An()}return E(e,[{key:"forEachTarget",value:function(e,t){return this.Ts.forEach((function(e,n){return t(n)})),cl.resolve()}},{key:"getLastRemoteSnapshotVersion",value:function(e){return cl.resolve(this.lastRemoteSnapshotVersion)}},{key:"getHighestSequenceNumber",value:function(e){return cl.resolve(this.Es)}},{key:"allocateTargetId",value:function(e){return this.highestTargetId=this.Rs.next(),cl.resolve(this.highestTargetId)}},{key:"setTargetsMetadata",value:function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Es&&(this.Es=t),cl.resolve()}},{key:"vn",value:function(e){this.Ts.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.Rs=new Tp(t),this.highestTargetId=t),e.sequenceNumber>this.Es&&(this.Es=e.sequenceNumber)}},{key:"addTargetData",value:function(e,t){return this.vn(t),this.targetCount+=1,cl.resolve()}},{key:"updateTargetData",value:function(e,t){return this.vn(t),cl.resolve()}},{key:"removeTargetData",value:function(e,t){return this.Ts.delete(t.target),this.As.us(t.targetId),this.targetCount-=1,cl.resolve()}},{key:"removeTargets",value:function(e,t,n){var r=this,a=0,i=[];return this.Ts.forEach((function(o,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.Ts.delete(o),i.push(r.removeMatchingKeysForTargetId(e,s.targetId)),a++)})),cl.waitFor(i).next((function(){return a}))}},{key:"getTargetCount",value:function(e){return cl.resolve(this.targetCount)}},{key:"getTargetData",value:function(e,t){var n=this.Ts.get(t)||null;return cl.resolve(n)}},{key:"addMatchingKeys",value:function(e,t,n){return this.As.ss(t,n),cl.resolve()}},{key:"removeMatchingKeys",value:function(e,t,n){this.As.os(t,n);var r=this.persistence.referenceDelegate,a=[];return r&&t.forEach((function(t){a.push(r.markPotentiallyOrphaned(e,t))})),cl.waitFor(a)}},{key:"removeMatchingKeysForTargetId",value:function(e,t){return this.As.us(t),cl.resolve()}},{key:"getMatchingKeysForTargetId",value:function(e,t){var n=this.As.hs(t);return cl.resolve(n)}},{key:"containsKey",value:function(e,t){return cl.resolve(this.As.containsKey(t))}}]),e}(),Vp=function(){function e(t,n){var r=this;w(this,e),this.bs={},this.overlays={},this.Ps=new fl(0),this.vs=!1,this.vs=!0,this.referenceDelegate=t(this),this.Vs=new Bp(this),this.indexManager=new Sp,this.remoteDocumentCache=new Pp((function(e){return r.referenceDelegate.Ss(e)})),this.wt=new wp(n),this.Ds=new Ap(this.wt)}return E(e,[{key:"start",value:function(){return Promise.resolve()}},{key:"shutdown",value:function(){return this.vs=!1,Promise.resolve()}},{key:"started",get:function(){return this.vs}},{key:"setDatabaseDeletedListener",value:function(){}},{key:"setNetworkEnabled",value:function(){}},{key:"getIndexManager",value:function(e){return this.indexManager}},{key:"getDocumentOverlayCache",value:function(e){var t=this.overlays[e.toKey()];return t||(t=new Dp,this.overlays[e.toKey()]=t),t}},{key:"getMutationQueue",value:function(e,t){var n=this.bs[e.toKey()];return n||(n=new Fp(t,this.referenceDelegate),this.bs[e.toKey()]=n),n}},{key:"getTargetCache",value:function(){return this.Vs}},{key:"getRemoteDocumentCache",value:function(){return this.remoteDocumentCache}},{key:"getBundleCache",value:function(){return this.Ds}},{key:"runTransaction",value:function(e,t,n){var r=this;Ic("MemoryPersistence","Starting transaction:",e);var a=new zp(this.Ps.next());return this.referenceDelegate.Cs(),n(a).next((function(e){return r.referenceDelegate.xs(a).next((function(){return e}))})).toPromise().then((function(e){return a.raiseOnCommittedEvent(),e}))}},{key:"Ns",value:function(e,t){return cl.or(Object.values(this.bs).map((function(n){return function(){return n.containsKey(e,t)}})))}}]),e}(),zp=function(e){h(n,e);var t=m(n);function n(e){var r;return w(this,n),(r=t.call(this)).currentSequenceNumber=e,r}return E(n)}(ol),Up=function(){function e(t){w(this,e),this.persistence=t,this.ks=new Op,this.Os=null}return E(e,[{key:"Fs",get:function(){if(this.Os)return this.Os;throw Rc()}},{key:"addReference",value:function(e,t,n){return this.ks.addReference(n,t),this.Fs.delete(n.toString()),cl.resolve()}},{key:"removeReference",value:function(e,t,n){return this.ks.removeReference(n,t),this.Fs.add(n.toString()),cl.resolve()}},{key:"markPotentiallyOrphaned",value:function(e,t){return this.Fs.add(t.toString()),cl.resolve()}},{key:"removeTarget",value:function(e,t){var n=this;this.ks.us(t.targetId).forEach((function(e){return n.Fs.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.Fs.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))}},{key:"Cs",value:function(){this.Os=new Set}},{key:"xs",value:function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return cl.forEach(this.Fs,(function(r){var a=Zc.fromPath(r);return t.$s(e,a).next((function(e){e||n.removeEntry(a,Xc.min())}))})).next((function(){return t.Os=null,n.apply(e)}))}},{key:"updateLimboDocument",value:function(e,t){var n=this;return this.$s(e,t).next((function(e){e?n.Fs.delete(t.toString()):n.Fs.add(t.toString())}))}},{key:"Ss",value:function(e){return 0}},{key:"$s",value:function(e,t){var n=this;return cl.or([function(){return cl.resolve(n.ks.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Ns(e,t)}])}}],[{key:"Ms",value:function(t){return new e(t)}}]),e}();var Wp=function(){function e(t,n,r,a){w(this,e),this.targetId=t,this.fromCache=n,this.Pi=r,this.vi=a}return E(e,null,[{key:"Vi",value:function(t,n){var r,a=Th(),i=Th(),o=y(n.docChanges);try{for(o.s();!(r=o.n()).done;){var s=r.value;switch(s.type){case 0:a=a.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}}catch(u){o.e(u)}finally{o.f()}return new e(t,n.fromCache,a,i)}}]),e}(),jp=function(){function e(){w(this,e),this.Si=!1}return E(e,[{key:"initialize",value:function(e,t){this.Di=e,this.indexManager=t,this.Si=!0}},{key:"getDocumentsMatchingQuery",value:function(e,t,n,r){var a=this;return this.Ci(e,t).next((function(i){return i||a.xi(e,t,r,n)})).next((function(n){return n||a.Ni(e,t)}))}},{key:"Ci",value:function(e,t){return cl.resolve(null)}},{key:"xi",value:function(e,t,n,r){var a=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||r.isEqual(Xc.min())?this.Ni(e,t):this.Di.getDocuments(e,n).next((function(i){var o=a.ki(t,i);return a.Oi(t,o,n,r)?a.Ni(e,t):(Cc()<=te.DEBUG&&Ic("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),_f(t)),a.Mi(e,o,t,tl(r,-1)))}))}},{key:"ki",value:function(e,t){var n=new gl(Df(e));return t.forEach((function(t,r){Rf(e,r)&&(n=n.add(r))})),n}},{key:"Oi",value:function(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;var a="F"===e.limitType?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(r)>0)}},{key:"Ni",value:function(e,t){return Cc()<=te.DEBUG&&Ic("QueryEngine","Using full collection scan to execute query:",_f(t)),this.Di.getDocumentsMatchingQuery(e,t,rl.min())}},{key:"Mi",value:function(e,t,n,r){return this.Di.getDocumentsMatchingQuery(e,n,r).next((function(e){return t.forEach((function(t){e=e.insert(t.key,t)})),e}))}}]),e}(),Gp=function(){function e(t,n,r,a){w(this,e),this.persistence=t,this.Fi=n,this.wt=a,this.$i=new vl(Hc),this.Bi=new mh((function(e){return ef(e)}),tf),this.Li=new Map,this.Ui=t.getRemoteDocumentCache(),this.Vs=t.getTargetCache(),this.Ds=t.getBundleCache(),this.qi(r)}return E(e,[{key:"qi",value:function(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Rp(this.Ui,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ui.setIndexManager(this.indexManager),this.Fi.initialize(this.localDocuments,this.indexManager)}},{key:"collectGarbage",value:function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.$i)}))}}]),e}();function Hp(e,t,n,r){return new Gp(e,t,n,r)}function qp(e,t){return Kp.apply(this,arguments)}function Kp(){return Kp=x(g().mark((function e(t,n){var r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Dc(t),e.next=3,r.persistence.runTransaction("Handle user change","readonly",(function(e){var t;return r.mutationQueue.getAllMutationBatches(e).next((function(a){return t=a,r.qi(n),r.mutationQueue.getAllMutationBatches(e)})).next((function(n){var a,i=[],o=[],s=Th(),u=y(t);try{for(u.s();!(a=u.n()).done;){var c=a.value;i.push(c.batchId);var l,f=y(c.mutations);try{for(f.s();!(l=f.n()).done;){var h=l.value;s=s.add(h.key)}}catch(x){f.e(x)}finally{f.f()}}}catch(x){u.e(x)}finally{u.f()}var p,d=y(n);try{for(d.s();!(p=d.n()).done;){var v=p.value;o.push(v.batchId);var m,g=y(v.mutations);try{for(g.s();!(m=g.n()).done;){var b=m.value;s=s.add(b.key)}}catch(x){g.e(x)}finally{g.f()}}}catch(x){d.e(x)}finally{d.f()}return r.localDocuments.getDocuments(e,s).next((function(e){return{Ki:e,removedBatchIds:i,addedBatchIds:o}}))}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)}))),Kp.apply(this,arguments)}function Xp(e,t){var n=Dc(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),a=n.Ui.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var a=n.batch,i=a.keys(),o=cl.resolve();return i.forEach((function(e){o=o.next((function(){return r.getEntry(t,e)})).next((function(t){var i=n.docVersions.get(e);Ac(null!==i),t.version.compareTo(i)<0&&(a.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((function(){return e.mutationQueue.removeMutationBatch(t,a)}))}(n,e,t,a).next((function(){return a.apply(e)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){for(var t=Th(),n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}function $p(e){var t=Dc(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.Vs.getLastRemoteSnapshotVersion(e)}))}function Qp(e,t){var n=Dc(e),r=t.snapshotVersion,a=n.$i;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var i=n.Ui.newChangeBuffer({trackRemovals:!0});a=n.$i;var o=[];t.targetChanges.forEach((function(i,s){var u=a.get(s);if(u){o.push(n.Vs.removeMatchingKeys(e,i.removedDocuments,s).next((function(){return n.Vs.addMatchingKeys(e,i.addedDocuments,s)})));var c=u.withSequenceNumber(e.currentSequenceNumber);t.targetMismatches.has(s)?c=c.withResumeToken(wl.EMPTY_BYTE_STRING,Xc.min()).withLastLimboFreeSnapshotVersion(Xc.min()):i.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(i.resumeToken,r)),a=a.insert(s,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(u,c,i)&&o.push(n.Vs.updateTargetData(e,c))}}));var s=gh(),u=Th();if(t.documentUpdates.forEach((function(r){t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(Yp(e,i,t.documentUpdates).next((function(e){s=e.Gi,u=e.Qi}))),!r.isEqual(Xc.min())){var c=n.Vs.getLastRemoteSnapshotVersion(e).next((function(t){return n.Vs.setTargetsMetadata(e,e.currentSequenceNumber,r)}));o.push(c)}return cl.waitFor(o).next((function(){return i.apply(e)})).next((function(){return n.localDocuments.getLocalViewOfDocuments(e,s,u)})).next((function(){return s}))})).then((function(e){return n.$i=a,e}))}function Yp(e,t,n){var r=Th(),a=Th();return n.forEach((function(e){return r=r.add(e)})),t.getEntries(e,r).next((function(e){var r=gh();return n.forEach((function(n,i){var o=e.get(n);i.isFoundDocument()!==o.isFoundDocument()&&(a=a.add(n)),i.isNoDocument()&&i.version.isEqual(Xc.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!o.isValidDocument()||i.version.compareTo(o.version)>0||0===i.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):Ic("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",i.version)})),{Gi:r,Qi:a}}))}function Jp(e,t){var n=Dc(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)}))}function Zp(e,t){var n=Dc(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.Vs.getTargetData(e,t).next((function(a){return a?(r=a,cl.resolve(r)):n.Vs.allocateTargetId(e).next((function(a){return r=new xp(t,a,0,e.currentSequenceNumber),n.Vs.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.$i.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.$i=n.$i.insert(e.targetId,e),n.Bi.set(t,e.targetId)),e}))}function ed(e,t,n){return td.apply(this,arguments)}function td(){return td=x(g().mark((function e(t,n,r){var a,i,o;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Dc(t),i=a.$i.get(n),o=r?"readwrite":"readwrite-primary",e.prev=1,e.t0=r,e.t0){e.next=6;break}return e.next=6,a.persistence.runTransaction("Release target",o,(function(e){return a.persistence.referenceDelegate.removeTarget(e,i)}));case 6:e.next=13;break;case 8:if(e.prev=8,e.t1=e.catch(1),ll(e.t1)){e.next=12;break}throw e.t1;case 12:Ic("LocalStore","Failed to update sequence numbers for target ".concat(n,": ").concat(e.t1));case 13:a.$i=a.$i.remove(n),a.Bi.delete(i.target);case 14:case"end":return e.stop()}}),e,null,[[1,8]])}))),td.apply(this,arguments)}function nd(e,t,n){var r=Dc(e),a=Xc.min(),i=Th();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=Dc(e),a=r.Bi.get(n);return void 0!==a?cl.resolve(r.$i.get(a)):r.Vs.getTargetData(t,n)}(r,e,Cf(t)).next((function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,r.Vs.getMatchingKeysForTargetId(e,t.targetId).next((function(e){i=e}))})).next((function(){return r.Fi.getDocumentsMatchingQuery(e,t,n?a:Xc.min(),n?i:Th())})).next((function(e){return rd(r,Af(t),e),{documents:e,ji:i}}))}))}function rd(e,t,n){var r=Xc.min();n.forEach((function(e,t){t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Li.set(t,r)}var ad=function(){function e(){w(this,e),this.activeTargetIds=_h()}return E(e,[{key:"Xi",value:function(e){this.activeTargetIds=this.activeTargetIds.add(e)}},{key:"Zi",value:function(e){this.activeTargetIds=this.activeTargetIds.delete(e)}},{key:"Yi",value:function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}]),e}(),id=function(){function e(){w(this,e),this.Fr=new ad,this.$r={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return E(e,[{key:"addPendingMutation",value:function(e){}},{key:"updateMutationState",value:function(e,t,n){}},{key:"addLocalQueryTarget",value:function(e){return this.Fr.Xi(e),this.$r[e]||"not-current"}},{key:"updateQueryState",value:function(e,t,n){this.$r[e]=t}},{key:"removeLocalQueryTarget",value:function(e){this.Fr.Zi(e)}},{key:"isLocalQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"clearQueryState",value:function(e){delete this.$r[e]}},{key:"getAllActiveQueryTargets",value:function(){return this.Fr.activeTargetIds}},{key:"isActiveQueryTarget",value:function(e){return this.Fr.activeTargetIds.has(e)}},{key:"start",value:function(){return this.Fr=new ad,Promise.resolve()}},{key:"handleUserChange",value:function(e,t,n){}},{key:"setOnlineState",value:function(e){}},{key:"shutdown",value:function(){}},{key:"writeSequenceNumber",value:function(e){}},{key:"notifyBundleLoaded",value:function(e){}}]),e}(),od=function(){function e(){w(this,e)}return E(e,[{key:"Br",value:function(e){}},{key:"shutdown",value:function(){}}]),e}(),sd=function(){function e(){var t=this;w(this,e),this.Lr=function(){return t.Ur()},this.qr=function(){return t.Kr()},this.Gr=[],this.Qr()}return E(e,[{key:"Br",value:function(e){this.Gr.push(e)}},{key:"shutdown",value:function(){window.removeEventListener("online",this.Lr),window.removeEventListener("offline",this.qr)}},{key:"Qr",value:function(){window.addEventListener("online",this.Lr),window.addEventListener("offline",this.qr)}},{key:"Ur",value:function(){Ic("ConnectivityMonitor","Network connectivity changed: AVAILABLE");var e,t=y(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(0)}}catch(n){t.e(n)}finally{t.f()}}},{key:"Kr",value:function(){Ic("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");var e,t=y(this.Gr);try{for(t.s();!(e=t.n()).done;){(0,e.value)(1)}}catch(n){t.e(n)}finally{t.f()}}}],[{key:"V",value:function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}]),e}(),ud={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},cd=function(){function e(t){w(this,e),this.jr=t.jr,this.Wr=t.Wr}return E(e,[{key:"zr",value:function(e){this.Hr=e}},{key:"Jr",value:function(e){this.Yr=e}},{key:"onMessage",value:function(e){this.Xr=e}},{key:"close",value:function(){this.Wr()}},{key:"send",value:function(e){this.jr(e)}},{key:"Zr",value:function(){this.Hr()}},{key:"eo",value:function(e){this.Yr(e)}},{key:"no",value:function(e){this.Xr(e)}}]),e}(),ld=function(e){h(n,e);var t=m(n);function n(e){var r;return w(this,n),(r=t.call(this,e)).forceLongPolling=e.forceLongPolling,r.autoDetectLongPolling=e.autoDetectLongPolling,r.useFetchStreams=e.useFetchStreams,r}return E(n,[{key:"co",value:function(e,t,n,r){return new Promise((function(a,i){var o=new xc;o.listenOnce(vc.COMPLETE,(function(){try{switch(o.getLastErrorCode()){case dc.NO_ERROR:var t=o.getResponseJson();Ic("Connection","XHR received:",JSON.stringify(t)),a(t);break;case dc.TIMEOUT:Ic("Connection",'RPC "'+e+'" timed out'),i(new Mc(Oc.DEADLINE_EXCEEDED,"Request time out"));break;case dc.HTTP_ERROR:var n=o.getStatus();if(Ic("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){var r=o.getResponseJson().error;if(r&&r.status&&r.message){var s=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(Oc).indexOf(t)>=0?t:Oc.UNKNOWN}(r.status);i(new Mc(s,r.message))}else i(new Mc(Oc.UNKNOWN,"Server responded with status "+o.getStatus()))}else i(new Mc(Oc.UNAVAILABLE,"Connection failed."));break;default:Rc()}}finally{Ic("Connection",'RPC "'+e+'" completed.')}}));var s=JSON.stringify(r);o.send(t,"POST",s,n,15)}))}},{key:"ho",value:function(e,t,n){var r=[this.so,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=hc(),i=pc(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new gc({})),this.uo(o.initMessageHeaders,t,n),M()||P()||O().indexOf("Electron/")>=0||L()||O().indexOf("MSAppHost/")>=0||F()||(o.httpHeadersOverwriteParam="$httpHeaders");var s=r.join("");Ic("Connection","Creating WebChannel: "+s,o);var u=a.createWebChannel(s,o),c=!1,l=!1,f=new cd({jr:function(e){l?Ic("Connection","Not sending because WebChannel is closed:",e):(c||(Ic("Connection","Opening WebChannel transport."),u.open(),c=!0),Ic("Connection","WebChannel sending:",e),u.send(e))},Wr:function(){return u.close()}}),h=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return h(u,bc.EventType.OPEN,(function(){l||Ic("Connection","WebChannel transport opened.")})),h(u,bc.EventType.CLOSE,(function(){l||(l=!0,Ic("Connection","WebChannel transport closed"),f.eo())})),h(u,bc.EventType.ERROR,(function(e){l||(l=!0,Nc("Connection","WebChannel transport errored:",e),f.eo(new Mc(Oc.UNAVAILABLE,"The operation could not be completed")))})),h(u,bc.EventType.MESSAGE,(function(e){var t;if(!l){var n=e.data[0];Ac(!!n);var r=n,a=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(a){Ic("Connection","WebChannel received error:",a);var i=a.status,o=function(e){var t=ch[e];if(void 0!==t)return vh(t)}(i),s=a.message;void 0===o&&(o=Oc.INTERNAL,s="Unknown error status: "+i+" with message "+a.message),l=!0,f.eo(new Mc(o,s)),u.close()}else Ic("Connection","WebChannel received:",n),f.no(n)}})),h(i,mc.STAT_EVENT,(function(e){e.stat===yc.PROXY?Ic("Connection","Detected buffering proxy"):e.stat===yc.NOPROXY&&Ic("Connection","Detected no buffering proxy")})),setTimeout((function(){f.Zr()}),0),f}}]),n}(function(){function e(t){w(this,e),this.databaseInfo=t,this.databaseId=t.databaseId;var n=t.ssl?"https":"http";this.so=n+"://"+t.host,this.io="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return E(e,[{key:"ro",value:function(e,t,n,r,a){var i=this.oo(e,t);Ic("RestConnection","Sending: ",i,n);var o={};return this.uo(o,r,a),this.co(e,i,o,n).then((function(e){return Ic("RestConnection","Received: ",e),e}),(function(t){throw Nc("RestConnection","".concat(e," failed with error: "),t,"url: ",i,"request:",n),t}))}},{key:"ao",value:function(e,t,n,r,a,i){return this.ro(e,t,n,r,a)}},{key:"uo",value:function(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Ec,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((function(t,n){return e[n]=t})),n&&n.headers.forEach((function(t,n){return e[n]=t}))}},{key:"oo",value:function(e,t){var n=ud[e];return"".concat(this.so,"/v1/").concat(t,":").concat(n)}}]),e}());function fd(){return"undefined"!=typeof document?document:null}function hd(e){return new Uh(e,!0)}var pd=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;w(this,e),this.js=t,this.timerId=n,this.lo=r,this.fo=a,this._o=i,this.wo=0,this.mo=null,this.yo=Date.now(),this.reset()}return E(e,[{key:"reset",value:function(){this.wo=0}},{key:"po",value:function(){this.wo=this._o}},{key:"Io",value:function(e){var t=this;this.cancel();var n=Math.floor(this.wo+this.To()),r=Math.max(0,Date.now()-this.yo),a=Math.max(0,n-r);a>0&&Ic("ExponentialBackoff","Backing off for ".concat(a," ms (base delay: ").concat(this.wo," ms, delay with jitter: ").concat(n," ms, last attempt: ").concat(r," ms ago)")),this.mo=this.js.enqueueAfterDelay(this.timerId,a,(function(){return t.yo=Date.now(),e()})),this.wo*=this.fo,this.wo<this.lo&&(this.wo=this.lo),this.wo>this._o&&(this.wo=this._o)}},{key:"Eo",value:function(){null!==this.mo&&(this.mo.skipDelay(),this.mo=null)}},{key:"cancel",value:function(){null!==this.mo&&(this.mo.cancel(),this.mo=null)}},{key:"To",value:function(){return(Math.random()-.5)*this.wo}}]),e}(),dd=function(){function e(t,n,r,a,i,o,s,u){w(this,e),this.js=t,this.Ao=r,this.Ro=a,this.bo=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=s,this.listener=u,this.state=0,this.Po=0,this.vo=null,this.Vo=null,this.stream=null,this.So=new pd(t,n)}return E(e,[{key:"Do",value:function(){return 1===this.state||5===this.state||this.Co()}},{key:"Co",value:function(){return 2===this.state||3===this.state}},{key:"start",value:function(){4!==this.state?this.auth():this.xo()}},{key:"stop",value:function(){var e=x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.Do(),!e.t0){e.next=4;break}return e.next=4,this.close(0);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"No",value:function(){this.state=0,this.So.reset()}},{key:"ko",value:function(){var e=this;this.Co()&&null===this.vo&&(this.vo=this.js.enqueueAfterDelay(this.Ao,6e4,(function(){return e.Oo()})))}},{key:"Mo",value:function(e){this.Fo(),this.stream.send(e)}},{key:"Oo",value:function(){var e=x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.Co()){e.next=2;break}return e.abrupt("return",this.close(0));case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Fo",value:function(){this.vo&&(this.vo.cancel(),this.vo=null)}},{key:"$o",value:function(){this.Vo&&(this.Vo.cancel(),this.Vo=null)}},{key:"close",value:function(){var e=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.Fo(),this.$o(),this.So.cancel(),this.Po++,4!==t?this.So.reset():n&&n.code===Oc.RESOURCE_EXHAUSTED?(Tc(n.toString()),Tc("Using maximum backoff delay to prevent overloading the backend."),this.So.po()):n&&n.code===Oc.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Bo(),this.stream.close(),this.stream=null),this.state=t,e.next=9,this.listener.Jr(n);case 9:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"Bo",value:function(){}},{key:"auth",value:function(){var e=this;this.state=1;var t=this.Lo(this.Po),n=this.Po;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((function(t){var r=o(t,2),a=r[0],i=r[1];e.Po===n&&e.Uo(a,i)}),(function(n){t((function(){var t=new Mc(Oc.UNKNOWN,"Fetching auth token failed: "+n.message);return e.qo(t)}))}))}},{key:"Uo",value:function(e,t){var n=this,r=this.Lo(this.Po);this.stream=this.Ko(e,t),this.stream.zr((function(){r((function(){return n.state=2,n.Vo=n.js.enqueueAfterDelay(n.Ro,1e4,(function(){return n.Co()&&(n.state=3),Promise.resolve()})),n.listener.zr()}))})),this.stream.Jr((function(e){r((function(){return n.qo(e)}))})),this.stream.onMessage((function(e){r((function(){return n.onMessage(e)}))}))}},{key:"xo",value:function(){var e=this;this.state=5,this.So.Io(x(g().mark((function t(){return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.state=0,e.start();case 1:case"end":return t.stop()}}),t)}))))}},{key:"qo",value:function(e){return Ic("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}},{key:"Lo",value:function(e){var t=this;return function(n){t.js.enqueueAndForget((function(){return t.Po===e?n():(Ic("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}}}]),e}(),vd=function(e){h(n,e);var t=m(n);function n(e,r,a,i,o,s){var u;return w(this,n),(u=t.call(this,e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",r,a,i,s)).wt=o,u}return E(n,[{key:"Ko",value:function(e,t){return this.bo.ho("Listen",e,t)}},{key:"onMessage",value:function(e){this.So.reset();var t=function(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Rc()}(t.targetChange.targetChangeType||"NO_CHANGE"),a=t.targetChange.targetIds||[],i=function(e,t){return e.dt?(Ac(void 0===t||"string"==typeof t),wl.fromBase64String(t||"")):(Ac(void 0===t||t instanceof Uint8Array),wl.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,s=o&&function(e){var t=void 0===e.code?Oc.UNKNOWN:vh(e.code);return new Mc(t,e.message||"")}(o);n=new Mh(r,a,i,s||null)}else if("documentChange"in t){t.documentChange;var u=t.documentChange;u.document,u.document.name,u.document.updateTime;var c=$h(e,u.document.name),l=Hh(u.document.updateTime),f=new $l({mapValue:{fields:u.document.fields}}),h=Yl.newFoundDocument(c,l,f),p=u.targetIds||[],d=u.removedTargetIds||[];n=new Dh(p,d,h.key,h)}else if("documentDelete"in t){t.documentDelete;var v=t.documentDelete;v.document;var m=$h(e,v.document),y=v.readTime?Hh(v.readTime):Xc.min(),g=Yl.newNoDocument(m,y),b=v.removedTargetIds||[];n=new Dh([],b,g.key,g)}else if("documentRemove"in t){t.documentRemove;var x=t.documentRemove;x.document;var w=$h(e,x.document),k=x.removedTargetIds||[];n=new Dh([],k,w,null)}else{if(!("filter"in t))return Rc();t.filter;var E=t.filter;E.targetId;var S=E.count||0,C=new ph(S),I=E.targetId;n=new Oh(I,C)}return n}(this.wt,e),n=function(e){if(!("targetChange"in e))return Xc.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?Xc.min():t.readTime?Hh(t.readTime):Xc.min()}(e);return this.listener.Go(t,n)}},{key:"Qo",value:function(e){var t={};t.database=Jh(this.wt),t.addTarget=function(e,t){var n,r=t.target;return(n=nf(r)?{documents:np(e,r)}:{query:rp(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=jh(e,t.resumeToken):t.snapshotVersion.compareTo(Xc.min())>0&&(n.readTime=Wh(e,t.snapshotVersion.toTimestamp())),n}(this.wt,e);var n=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Rc()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.wt,e);n&&(t.labels=n),this.Mo(t)}},{key:"jo",value:function(e){var t={};t.database=Jh(this.wt),t.removeTarget=e,this.Mo(t)}}]),n}(dd),md=function(e){h(n,e);var t=m(n);function n(e,r,a,i,o,s){var u;return w(this,n),(u=t.call(this,e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",r,a,i,s)).wt=o,u.Wo=!1,u}return E(n,[{key:"zo",get:function(){return this.Wo}},{key:"start",value:function(){this.Wo=!1,this.lastStreamToken=void 0,c(s(n.prototype),"start",this).call(this)}},{key:"Bo",value:function(){this.Wo&&this.Ho([])}},{key:"Ko",value:function(e,t){return this.bo.ho("Write",e,t)}},{key:"onMessage",value:function(e){if(Ac(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Wo){this.So.reset();var t=function(e,t){return e&&e.length>0?(Ac(void 0!==t),e.map((function(e){return function(e,t){var n=e.updateTime?Hh(e.updateTime):Hh(t);return n.isEqual(Xc.min())&&(n=Hh(t)),new $f(n,e.transformResults||[])}(e,t)}))):[]}(e.writeResults,e.commitTime),n=Hh(e.commitTime);return this.listener.Jo(n,t)}return Ac(!e.writeResults||0===e.writeResults.length),this.Wo=!0,this.listener.Yo()}},{key:"Xo",value:function(){var e={};e.database=Jh(this.wt),this.Mo(e)}},{key:"Ho",value:function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return tp(t.wt,e)}))};this.Mo(n)}}]),n}(dd),yd=function(e){h(n,e);var t=m(n);function n(e,r,a,i){var o;return w(this,n),(o=t.call(this)).authCredentials=e,o.appCheckCredentials=r,o.bo=a,o.wt=i,o.Zo=!1,o}return E(n,[{key:"tu",value:function(){if(this.Zo)throw new Mc(Oc.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"ro",value:function(e,t,n){var r=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(a){var i=o(a,2),s=i[0],u=i[1];return r.bo.ro(e,t,n,s,u)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===Oc.UNAUTHENTICATED&&(r.authCredentials.invalidateToken(),r.appCheckCredentials.invalidateToken()),e):new Mc(Oc.UNKNOWN,e.toString())}))}},{key:"ao",value:function(e,t,n,r){var a=this;return this.tu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((function(i){var s=o(i,2),u=s[0],c=s[1];return a.bo.ao(e,t,n,u,c,r)})).catch((function(e){throw"FirebaseError"===e.name?(e.code===Oc.UNAUTHENTICATED&&(a.authCredentials.invalidateToken(),a.appCheckCredentials.invalidateToken()),e):new Mc(Oc.UNKNOWN,e.toString())}))}},{key:"terminate",value:function(){this.Zo=!0}}]),n}(function(){return E((function e(){w(this,e)}))}()),gd=function(){function e(t,n){w(this,e),this.asyncQueue=t,this.onlineStateHandler=n,this.state="Unknown",this.eu=0,this.nu=null,this.su=!0}return E(e,[{key:"iu",value:function(){var e=this;0===this.eu&&(this.ru("Unknown"),this.nu=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e.nu=null,e.ou("Backend didn't respond within 10 seconds."),e.ru("Offline"),Promise.resolve()})))}},{key:"uu",value:function(e){"Online"===this.state?this.ru("Unknown"):(this.eu++,this.eu>=1&&(this.cu(),this.ou("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.ru("Offline")))}},{key:"set",value:function(e){this.cu(),this.eu=0,"Online"===e&&(this.su=!1),this.ru(e)}},{key:"ru",value:function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}},{key:"ou",value:function(e){var t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.su?(Tc(t),this.su=!1):Ic("OnlineStateTracker",t)}},{key:"cu",value:function(){null!==this.nu&&(this.nu.cancel(),this.nu=null)}}]),e}(),bd=E((function e(t,n,r,a,i){var o=this;w(this,e),this.localStore=t,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.au=[],this.hu=new Map,this.lu=new Set,this.fu=[],this.du=i,this.du.Br((function(e){r.enqueueAndForget(x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=Rd(o),!e.t0){e.next=5;break}return Ic("RemoteStore","Restarting streams for network reachability change."),e.next=5,function(){var e=x(g().mark((function e(t){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=Dc(t)).lu.add(4),e.next=4,kd(n);case 4:return n._u.set("Unknown"),n.lu.delete(4),e.next=8,xd(n);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(o);case 5:case"end":return e.stop()}}),e)}))))})),this._u=new gd(r,a)}));function xd(e){return wd.apply(this,arguments)}function wd(){return wd=x(g().mark((function e(t){var n,r,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Rd(t)){e.next=18;break}n=y(t.fu),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return a=r.value,e.next=8,a(!0);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[2,12,15,18]])}))),wd.apply(this,arguments)}function kd(e){return Ed.apply(this,arguments)}function Ed(){return Ed=x(g().mark((function e(t){var n,r,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=y(t.fu),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return a=r.value,e.next=7,a(!1);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,null,[[1,11,14,17]])}))),Ed.apply(this,arguments)}function Sd(e,t){var n=Dc(e);n.hu.has(t.targetId)||(n.hu.set(t.targetId,t),_d(n)?Nd(n):iv(n).Co()&&Id(n,t))}function Cd(e,t){var n=Dc(e),r=iv(n);n.hu.delete(t),r.Co()&&Td(n,t),0===n.hu.size&&(r.Co()?r.ko():Rd(n)&&n._u.set("Unknown"))}function Id(e,t){e.wu.Nt(t.targetId),iv(e).Qo(t)}function Td(e,t){e.wu.Nt(t),iv(e).jo(t)}function Nd(e){e.wu=new Ph({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},te:function(t){return e.hu.get(t)||null}}),iv(e).start(),e._u.iu()}function _d(e){return Rd(e)&&!iv(e).Do()&&e.hu.size>0}function Rd(e){return 0===Dc(e).lu.size}function Ad(e){e.wu=void 0}function Dd(e){return Od.apply(this,arguments)}function Od(){return Od=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.hu.forEach((function(e,n){Id(t,e)}));case 1:case"end":return e.stop()}}),e)}))),Od.apply(this,arguments)}function Md(e,t){return Fd.apply(this,arguments)}function Fd(){return Fd=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Ad(t),_d(t)?(t._u.uu(n),Nd(t)):t._u.set("Unknown");case 1:case"end":return e.stop()}}),e)}))),Fd.apply(this,arguments)}function Pd(e,t,n){return Ld.apply(this,arguments)}function Ld(){return Ld=x(g().mark((function e(t,n,r){var a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t._u.set("Online"),!(n instanceof Mh&&2===n.state&&n.cause)){e.next=13;break}return e.prev=1,e.next=4,function(){var e=x(g().mark((function e(t,n){var r,a,i,o;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=n.cause,a=y(n.targetIds),e.prev=2,a.s();case 4:if((i=a.n()).done){e.next=14;break}if(o=i.value,e.t0=t.hu.has(o),!e.t0){e.next=12;break}return e.next=10,t.remoteSyncer.rejectListen(o,r);case 10:t.hu.delete(o),t.wu.removeTarget(o);case 12:e.next=4;break;case 14:e.next=19;break;case 16:e.prev=16,e.t1=e.catch(2),a.e(e.t1);case 19:return e.prev=19,a.f(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[2,16,19,22]])})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),Ic("RemoteStore","Failed to remove targets %s: %s ",n.targetIds.join(","),e.t0),e.next=11,Bd(t,e.t0);case 11:case 22:e.next=29;break;case 13:if(n instanceof Dh?t.wu.Ut(n):n instanceof Oh?t.wu.zt(n):t.wu.Gt(n),r.isEqual(Xc.min())){e.next=29;break}return e.prev=14,e.next=17,$p(t.localStore);case 17:if(a=e.sent,e.t1=r.compareTo(a)>=0,!e.t1){e.next=22;break}return e.next=22,function(e,t){var n=e.wu.Yt(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var a=e.hu.get(r);a&&e.hu.set(r,a.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.hu.get(t);if(n){e.hu.set(t,n.withResumeToken(wl.EMPTY_BYTE_STRING,n.snapshotVersion)),Td(e,t);var r=new xp(n.target,t,1,n.sequenceNumber);Id(e,r)}})),e.remoteSyncer.applyRemoteEvent(n)}(t,r);case 24:return e.prev=24,e.t2=e.catch(14),Ic("RemoteStore","Failed to raise snapshot:",e.t2),e.next=29,Bd(t,e.t2);case 29:case"end":return e.stop()}}),e,null,[[1,6],[14,24]])}))),Ld.apply(this,arguments)}function Bd(e,t,n){return Vd.apply(this,arguments)}function Vd(){return Vd=x(g().mark((function e(t,n,r){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ll(n)){e.next=2;break}throw n;case 2:return t.lu.add(1),e.next=5,kd(t);case 5:t._u.set("Offline"),r||(r=function(){return $p(t.localStore)}),t.asyncQueue.enqueueRetryable(x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ic("RemoteStore","Retrying IndexedDB access"),e.next=3,r();case 3:return t.lu.delete(1),e.next=6,xd(t);case 6:case"end":return e.stop()}}),e)}))));case 8:case"end":return e.stop()}}),e)}))),Vd.apply(this,arguments)}function zd(e,t){return t().catch((function(n){return Bd(e,n,t)}))}function Ud(e){return Wd.apply(this,arguments)}function Wd(){return Wd=x(g().mark((function e(t){var n,r,a,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Dc(t),r=ov(n),a=n.au.length>0?n.au[n.au.length-1].batchId:-1;case 2:if(!jd(n)){e.next=19;break}return e.prev=3,e.next=6,Jp(n.localStore,a);case 6:if(null!==(i=e.sent)){e.next=10;break}return 0===n.au.length&&r.ko(),e.abrupt("break",19);case 10:a=i.batchId,Gd(n,i),e.next=17;break;case 13:return e.prev=13,e.t0=e.catch(3),e.next=17,Bd(n,e.t0);case 17:e.next=2;break;case 19:Hd(n)&&qd(n);case 20:case"end":return e.stop()}}),e,null,[[3,13]])}))),Wd.apply(this,arguments)}function jd(e){return Rd(e)&&e.au.length<10}function Gd(e,t){e.au.push(t);var n=ov(e);n.Co()&&n.zo&&n.Ho(t.mutations)}function Hd(e){return Rd(e)&&!ov(e).Do()&&e.au.length>0}function qd(e){ov(e).start()}function Kd(e){return Xd.apply(this,arguments)}function Xd(){return Xd=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:ov(t).Xo();case 1:case"end":return e.stop()}}),e)}))),Xd.apply(this,arguments)}function $d(e){return Qd.apply(this,arguments)}function Qd(){return Qd=x(g().mark((function e(t){var n,r,a,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=ov(t),r=y(t.au);try{for(r.s();!(a=r.n()).done;)i=a.value,n.Ho(i.mutations)}catch(o){r.e(o)}finally{r.f()}case 3:case"end":return e.stop()}}),e)}))),Qd.apply(this,arguments)}function Yd(e,t,n){return Jd.apply(this,arguments)}function Jd(){return Jd=x(g().mark((function e(t,n,r){var a,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.au.shift(),i=gp.from(a,n,r),e.next=3,zd(t,(function(){return t.remoteSyncer.applySuccessfulWrite(i)}));case 3:return e.next=5,Ud(t);case 5:case"end":return e.stop()}}),e)}))),Jd.apply(this,arguments)}function Zd(e,t){return ev.apply(this,arguments)}function ev(){return ev=x(g().mark((function e(t,n){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=n&&ov(t).zo,!e.t0){e.next=4;break}return e.next=4,function(){var e=x(g().mark((function e(t,n){var r,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!dh(a=n.code)||a===Oc.ABORTED){e.next=7;break}return r=t.au.shift(),ov(t).No(),e.next=5,zd(t,(function(){return t.remoteSyncer.rejectFailedWrite(r.batchId,n)}));case 5:return e.next=7,Ud(t);case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()(t,n);case 4:Hd(t)&&qd(t);case 5:case"end":return e.stop()}}),e)}))),ev.apply(this,arguments)}function tv(e,t){return nv.apply(this,arguments)}function nv(){return nv=x(g().mark((function e(t,n){var r,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Dc(t)).asyncQueue.verifyOperationInProgress(),Ic("RemoteStore","RemoteStore received new credentials"),a=Rd(r),r.lu.add(3),e.next=6,kd(r);case 6:return a&&r._u.set("Unknown"),e.next=9,r.remoteSyncer.handleCredentialChange(n);case 9:return r.lu.delete(3),e.next=12,xd(r);case 12:case"end":return e.stop()}}),e)}))),nv.apply(this,arguments)}function rv(e,t){return av.apply(this,arguments)}function av(){return av=x(g().mark((function e(t,n){var r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Dc(t),!n){e.next=7;break}return r.lu.delete(2),e.next=5,xd(r);case 5:e.next=13;break;case 7:if(e.t0=n,e.t0){e.next=13;break}return r.lu.add(2),e.next=12,kd(r);case 12:r._u.set("Unknown");case 13:case"end":return e.stop()}}),e)}))),av.apply(this,arguments)}function iv(e){return e.mu||(e.mu=function(e,t,n){var r=Dc(e);return r.tu(),new vd(t,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,n)}(e.datastore,e.asyncQueue,{zr:Dd.bind(null,e),Jr:Md.bind(null,e),Go:Pd.bind(null,e)}),e.fu.push(function(){var t=x(g().mark((function t(n){return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=4;break}e.mu.No(),_d(e)?Nd(e):e._u.set("Unknown"),t.next=7;break;case 4:return t.next=6,e.mu.stop();case 6:Ad(e);case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.mu}function ov(e){return e.gu||(e.gu=function(e,t,n){var r=Dc(e);return r.tu(),new md(t,r.bo,r.authCredentials,r.appCheckCredentials,r.wt,n)}(e.datastore,e.asyncQueue,{zr:Kd.bind(null,e),Jr:Zd.bind(null,e),Yo:$d.bind(null,e),Jo:Yd.bind(null,e)}),e.fu.push(function(){var t=x(g().mark((function t(n){return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!n){t.next=6;break}return e.gu.No(),t.next=4,Ud(e);case 4:t.next=9;break;case 6:return t.next=8,e.gu.stop();case 8:e.au.length>0&&(Ic("RemoteStore","Stopping write stream with ".concat(e.au.length," pending writes")),e.au=[]);case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),e.gu}var sv=function(){function e(t,n,r,a,i){w(this,e),this.asyncQueue=t,this.timerId=n,this.targetTimeMs=r,this.op=a,this.removalCallback=i,this.deferred=new Fc,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return E(e,[{key:"start",value:function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)}},{key:"skipDelay",value:function(){return this.handleDelayElapsed()}},{key:"cancel",value:function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Mc(Oc.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}},{key:"handleDelayElapsed",value:function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))}},{key:"clearTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}))}],[{key:"createAndSchedule",value:function(t,n,r,a,i){var o=new e(t,n,Date.now()+r,a,i);return o.start(r),o}}]),e}();function uv(e,t){if(Tc("AsyncQueue","".concat(t,": ").concat(e)),ll(e))return new Mc(Oc.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}var cv=function(){function e(t){w(this,e),this.comparator=t?function(e,n){return t(e,n)||Zc.comparator(e.key,n.key)}:function(e,t){return Zc.comparator(e.key,t.key)},this.keyedMap=xh(),this.sortedSet=new vl(this.comparator)}return E(e,[{key:"has",value:function(e){return null!=this.keyedMap.get(e)}},{key:"get",value:function(e){return this.keyedMap.get(e)}},{key:"first",value:function(){return this.sortedSet.minKey()}},{key:"last",value:function(){return this.sortedSet.maxKey()}},{key:"isEmpty",value:function(){return this.sortedSet.isEmpty()}},{key:"indexOf",value:function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}},{key:"size",get:function(){return this.sortedSet.size}},{key:"forEach",value:function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))}},{key:"add",value:function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}},{key:"delete",value:function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}},{key:"isEqual",value:function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var a=n.getNext().key,i=r.getNext().key;if(!a.isEqual(i))return!1}return!0}},{key:"toString",value:function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}},{key:"copy",value:function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r}}],[{key:"emptySet",value:function(t){return new e(t.comparator)}}]),e}(),lv=function(){function e(){w(this,e),this.yu=new vl(Zc.comparator)}return E(e,[{key:"track",value:function(e){var t=e.doc.key,n=this.yu.get(t);n?0!==e.type&&3===n.type?this.yu=this.yu.insert(t,e):3===e.type&&1!==n.type?this.yu=this.yu.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.yu=this.yu.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.yu=this.yu.remove(t):1===e.type&&2===n.type?this.yu=this.yu.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.yu=this.yu.insert(t,{type:2,doc:e.doc}):Rc():this.yu=this.yu.insert(t,e)}},{key:"pu",value:function(){var e=[];return this.yu.inorderTraversal((function(t,n){e.push(n)})),e}}]),e}(),fv=function(){function e(t,n,r,a,i,o,s,u){w(this,e),this.query=t,this.docs=n,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=s,this.excludesMetadataChanges=u}return E(e,[{key:"hasPendingWrites",get:function(){return!this.mutatedKeys.isEmpty()}},{key:"isEqual",value:function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Tf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}],[{key:"fromInitialDocuments",value:function(t,n,r,a){var i=[];return n.forEach((function(e){i.push({type:0,doc:e})})),new e(t,n,cv.emptySet(n),i,r,a,!0,!1)}}]),e}(),hv=E((function e(){w(this,e),this.Iu=void 0,this.listeners=[]})),pv=E((function e(){w(this,e),this.queries=new mh((function(e){return Nf(e)}),Tf),this.onlineState="Unknown",this.Tu=new Set}));function dv(e,t){return vv.apply(this,arguments)}function vv(){return vv=x(g().mark((function e(t,n){var r,a,i,o,s;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Dc(t),a=n.query,i=!1,(o=r.queries.get(a))||(i=!0,o=new hv),!i){e.next=13;break}return e.prev=3,e.next=6,r.onListen(a);case 6:o.Iu=e.sent,e.next=13;break;case 9:return e.prev=9,e.t0=e.catch(3),s=uv(e.t0,"Initialization of query '".concat(_f(n.query),"' failed")),e.abrupt("return",void n.onError(s));case 13:r.queries.set(a,o),o.listeners.push(n),n.Eu(r.onlineState),o.Iu&&n.Au(o.Iu)&&gv(r);case 14:case"end":return e.stop()}}),e,null,[[3,9]])}))),vv.apply(this,arguments)}function mv(e,t){var n,r=Dc(e),a=!1,i=y(t);try{for(i.s();!(n=i.n()).done;){var o=n.value,s=o.query,u=r.queries.get(s);if(u){var c,l=y(u.listeners);try{for(l.s();!(c=l.n()).done;){c.value.Au(o)&&(a=!0)}}catch(f){l.e(f)}finally{l.f()}u.Iu=o}}}catch(f){i.e(f)}finally{i.f()}a&&gv(r)}function yv(e,t,n){var r=Dc(e),a=r.queries.get(t);if(a){var i,o=y(a.listeners);try{for(o.s();!(i=o.n()).done;){i.value.onError(n)}}catch(s){o.e(s)}finally{o.f()}}r.queries.delete(t)}function gv(e){e.Tu.forEach((function(e){e.next()}))}var bv=function(){function e(t,n,r){w(this,e),this.query=t,this.Ru=n,this.bu=!1,this.Pu=null,this.onlineState="Unknown",this.options=r||{}}return E(e,[{key:"Au",value:function(e){if(!this.options.includeMetadataChanges){var t,n=[],r=y(e.docChanges);try{for(r.s();!(t=r.n()).done;){var a=t.value;3!==a.type&&n.push(a)}}catch(o){r.e(o)}finally{r.f()}e=new fv(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var i=!1;return this.bu?this.vu(e)&&(this.Ru.next(e),i=!0):this.Vu(e,this.onlineState)&&(this.Su(e),i=!0),this.Pu=e,i}},{key:"onError",value:function(e){this.Ru.error(e)}},{key:"Eu",value:function(e){this.onlineState=e;var t=!1;return this.Pu&&!this.bu&&this.Vu(this.Pu,e)&&(this.Su(this.Pu),t=!0),t}},{key:"Vu",value:function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return(!this.options.Du||!n)&&(!e.docs.isEmpty()||"Offline"===t)}},{key:"vu",value:function(e){if(e.docChanges.length>0)return!0;var t=this.Pu&&this.Pu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}},{key:"Su",value:function(e){e=fv.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.bu=!0,this.Ru.next(e)}}]),e}();var xv=E((function e(t){w(this,e),this.key=t})),wv=E((function e(t){w(this,e),this.key=t})),kv=function(){function e(t,n){w(this,e),this.query=t,this.Fu=n,this.$u=null,this.current=!1,this.Bu=Th(),this.mutatedKeys=Th(),this.Lu=Df(t),this.Uu=new cv(this.Lu)}return E(e,[{key:"qu",get:function(){return this.Fu}},{key:"Ku",value:function(e,t){var n=this,r=t?t.Gu:new lv,a=t?t.Uu:this.Uu,i=t?t.mutatedKeys:this.mutatedKeys,o=a,s=!1,u="F"===this.query.limitType&&a.size===this.query.limit?a.last():null,c="L"===this.query.limitType&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((function(e,t){var l=a.get(e),f=Rf(n.query,t)?t:null,h=!!l&&n.mutatedKeys.has(l.key),p=!!f&&(f.hasLocalMutations||n.mutatedKeys.has(f.key)&&f.hasCommittedMutations),d=!1;l&&f?l.data.isEqual(f.data)?h!==p&&(r.track({type:3,doc:f}),d=!0):n.Qu(l,f)||(r.track({type:2,doc:f}),d=!0,(u&&n.Lu(f,u)>0||c&&n.Lu(f,c)<0)&&(s=!0)):!l&&f?(r.track({type:0,doc:f}),d=!0):l&&!f&&(r.track({type:1,doc:l}),d=!0,(u||c)&&(s=!0)),d&&(f?(o=o.add(f),i=p?i.add(e):i.delete(e)):(o=o.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;o.size>this.query.limit;){var l="F"===this.query.limitType?o.last():o.first();o=o.delete(l.key),i=i.delete(l.key),r.track({type:1,doc:l})}return{Uu:o,Gu:r,Oi:s,mutatedKeys:i}}},{key:"Qu",value:function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}},{key:"applyChanges",value:function(e,t,n){var r=this,a=this.Uu;this.Uu=e.Uu,this.mutatedKeys=e.mutatedKeys;var i=e.Gu.pu();i.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Rc()}};return n(e)-n(t)}(e.type,t.type)||r.Lu(e.doc,t.doc)})),this.ju(n);var o=t?this.Wu():[],s=0===this.Bu.size&&this.current?1:0,u=s!==this.$u;return this.$u=s,0!==i.length||u?{snapshot:new fv(this.query,e.Uu,a,i,e.mutatedKeys,0===s,u,!1),zu:o}:{zu:o}}},{key:"Eu",value:function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Uu:this.Uu,Gu:new lv,mutatedKeys:this.mutatedKeys,Oi:!1},!1)):{zu:[]}}},{key:"Hu",value:function(e){return!this.Fu.has(e)&&!!this.Uu.has(e)&&!this.Uu.get(e).hasLocalMutations}},{key:"ju",value:function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.Fu=t.Fu.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.Fu=t.Fu.delete(e)})),this.current=e.current)}},{key:"Wu",value:function(){var e=this;if(!this.current)return[];var t=this.Bu;this.Bu=Th(),this.Uu.forEach((function(t){e.Hu(t.key)&&(e.Bu=e.Bu.add(t.key))}));var n=[];return t.forEach((function(t){e.Bu.has(t)||n.push(new wv(t))})),this.Bu.forEach((function(e){t.has(e)||n.push(new xv(e))})),n}},{key:"Ju",value:function(e){this.Fu=e.ji,this.Bu=Th();var t=this.Ku(e.documents);return this.applyChanges(t,!0)}},{key:"Yu",value:function(){return fv.fromInitialDocuments(this.query,this.Uu,this.mutatedKeys,0===this.$u)}}]),e}(),Ev=E((function e(t,n,r){w(this,e),this.query=t,this.targetId=n,this.view=r})),Sv=E((function e(t){w(this,e),this.key=t,this.Xu=!1})),Cv=function(){function e(t,n,r,a,i,o){w(this,e),this.localStore=t,this.remoteStore=n,this.eventManager=r,this.sharedClientState=a,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Zu={},this.tc=new mh((function(e){return Nf(e)}),Tf),this.ec=new Map,this.nc=new Set,this.sc=new vl(Zc.comparator),this.ic=new Map,this.rc=new Op,this.oc={},this.uc=new Map,this.cc=Tp.Rn(),this.onlineState="Unknown",this.ac=void 0}return E(e,[{key:"isPrimaryClient",get:function(){return!0===this.ac}}]),e}();function Iv(e,t){return Tv.apply(this,arguments)}function Tv(){return Tv=x(g().mark((function e(t,n){var r,a,i,o,s,u;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=tm(t),!(o=r.tc.get(n))){e.next=6;break}a=o.targetId,r.sharedClientState.addLocalQueryTarget(a),i=o.view.Yu(),e.next=15;break;case 6:return e.next=8,Zp(r.localStore,Cf(n));case 8:return s=e.sent,r.isPrimaryClient&&Sd(r.remoteStore,s),u=r.sharedClientState.addLocalQueryTarget(s.targetId),a=s.targetId,e.next=14,Nv(r,n,a,"current"===u);case 14:i=e.sent;case 15:return e.abrupt("return",i);case 16:case"end":return e.stop()}}),e)}))),Tv.apply(this,arguments)}function Nv(e,t,n,r){return _v.apply(this,arguments)}function _v(){return _v=x(g().mark((function e(t,n,r,a){var i,o,s,u,c,l;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.hc=function(e,n,r){return function(){var e=x(g().mark((function e(t,n,r,a){var i,o,s;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.view.Ku(r),e.t0=i.Oi,!e.t0){e.next=6;break}return e.next=5,nd(t.localStore,n.query,!1).then((function(e){var t=e.documents;return n.view.Ku(t,i)}));case 5:i=e.sent;case 6:return o=a&&a.targetChanges.get(n.targetId),s=n.view.applyChanges(i,t.isPrimaryClient,o),e.abrupt("return",(Kv(t,n.targetId,s.zu),s.snapshot));case 8:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}()(t,e,n,r)},e.next=3,nd(t.localStore,n,!0);case 3:return i=e.sent,o=new kv(n,i.ji),s=o.Ku(i.documents),u=Ah.createSynthesizedTargetChangeForCurrentChange(r,a&&"Offline"!==t.onlineState),c=o.applyChanges(s,t.isPrimaryClient,u),Kv(t,r,c.zu),l=new Ev(n,r,o),e.abrupt("return",(t.tc.set(n,l),t.ec.has(r)?t.ec.get(r).push(n):t.ec.set(r,[n]),c.snapshot));case 11:case"end":return e.stop()}}),e)}))),_v.apply(this,arguments)}function Rv(e,t){return Av.apply(this,arguments)}function Av(){return Av=x(g().mark((function e(t,n){var r,a,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Dc(t),a=r.tc.get(n),!((i=r.ec.get(a.targetId)).length>1)){e.next=3;break}return e.abrupt("return",(r.ec.set(a.targetId,i.filter((function(e){return!Tf(e,n)}))),void r.tc.delete(n)));case 3:if(!r.isPrimaryClient){e.next=11;break}if(r.sharedClientState.removeLocalQueryTarget(a.targetId),e.t0=r.sharedClientState.isActiveQueryTarget(a.targetId),e.t0){e.next=9;break}return e.next=9,ed(r.localStore,a.targetId,!1).then((function(){r.sharedClientState.clearQueryState(a.targetId),Cd(r.remoteStore,a.targetId),Hv(r,a.targetId)})).catch(sl);case 9:e.next=14;break;case 11:return Hv(r,a.targetId),e.next=14,ed(r.localStore,a.targetId,!0);case 14:case"end":return e.stop()}}),e)}))),Av.apply(this,arguments)}function Dv(e,t,n){return Ov.apply(this,arguments)}function Ov(){return Ov=x(g().mark((function e(t,n,r){var a,i,o;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=nm(t),e.prev=1,e.next=4,function(e,t){var n,r,a=Dc(e),i=Kc.now(),o=t.reduce((function(e,t){return e.add(t.key)}),Th());return a.persistence.runTransaction("Locally write mutations","readwrite",(function(e){var s=gh(),u=Th();return a.Ui.getEntries(e,o).next((function(e){(s=e).forEach((function(e,t){t.isValidDocument()||(u=u.add(e))}))})).next((function(){return a.localDocuments.getOverlayedDocuments(e,s)})).next((function(r){n=r;var o,s=[],u=y(t);try{for(u.s();!(o=u.n()).done;){var c=o.value,l=nh(c,n.get(c.key).overlayedDocument);null!=l&&s.push(new ih(c.key,l,Ql(l.value.mapValue),Qf.exists(!0)))}}catch(f){u.e(f)}finally{u.f()}return a.mutationQueue.addMutationBatch(e,i,s,t)})).next((function(t){r=t;var i=t.applyToLocalDocumentSet(n,u);return a.documentOverlayCache.saveOverlays(e,t.batchId,i)}))})).then((function(){return{batchId:r.batchId,changes:wh(n)}}))}(a.localStore,n);case 4:return i=e.sent,a.sharedClientState.addPendingMutation(i.batchId),function(e,t,n){var r=e.oc[e.currentUser.toKey()];r||(r=new vl(Hc)),r=r.insert(t,n),e.oc[e.currentUser.toKey()]=r}(a,i.batchId,r),e.next=9,Qv(a,i.changes);case 9:return e.next=11,Ud(a.remoteStore);case 11:e.next=17;break;case 13:e.prev=13,e.t0=e.catch(1),o=uv(e.t0,"Failed to persist write"),r.reject(o);case 17:case"end":return e.stop()}}),e,null,[[1,13]])}))),Ov.apply(this,arguments)}function Mv(e,t){return Fv.apply(this,arguments)}function Fv(){return Fv=x(g().mark((function e(t,n){var r,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Dc(t),e.prev=1,e.next=4,Qp(r.localStore,n);case 4:return a=e.sent,n.targetChanges.forEach((function(e,t){var n=r.ic.get(t);n&&(Ac(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?n.Xu=!0:e.modifiedDocuments.size>0?Ac(n.Xu):e.removedDocuments.size>0&&(Ac(n.Xu),n.Xu=!1))})),e.next=8,Qv(r,a,n);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(1),e.next=14,sl(e.t0);case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),Fv.apply(this,arguments)}function Pv(e,t,n){var r=Dc(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var a=[];r.tc.forEach((function(e,n){var r=n.view.Eu(t);r.snapshot&&a.push(r.snapshot)})),function(e,t){var n=Dc(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){var a,i=y(n.listeners);try{for(i.s();!(a=i.n()).done;){a.value.Eu(t)&&(r=!0)}}catch(o){i.e(o)}finally{i.f()}})),r&&gv(n)}(r.eventManager,t),a.length&&r.Zu.Go(a),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function Lv(e,t,n){return Bv.apply(this,arguments)}function Bv(){return Bv=x(g().mark((function e(t,n,r){var a,i,o,s,u,c;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((a=Dc(t)).sharedClientState.updateQueryState(n,"rejected",r),i=a.ic.get(n),!(o=i&&i.key)){e.next=14;break}return s=(s=new vl(Zc.comparator)).insert(o,Yl.newNoDocument(o,Xc.min())),u=Th().add(o),c=new Rh(Xc.min(),new Map,new gl(Hc),s,u),e.next=9,Mv(a,c);case 9:a.sc=a.sc.remove(o),a.ic.delete(n),$v(a),e.next=16;break;case 14:return e.next=16,ed(a.localStore,n,!1).then((function(){return Hv(a,n,r)})).catch(sl);case 16:case"end":return e.stop()}}),e)}))),Bv.apply(this,arguments)}function Vv(e,t){return zv.apply(this,arguments)}function zv(){return zv=x(g().mark((function e(t,n){var r,a,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Dc(t),a=n.batch.batchId,e.prev=1,e.next=4,Xp(r.localStore,n);case 4:return i=e.sent,Gv(r,a,null),jv(r,a),r.sharedClientState.updateMutationState(a,"acknowledged"),e.next=10,Qv(r,i);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,sl(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),zv.apply(this,arguments)}function Uv(e,t,n){return Wv.apply(this,arguments)}function Wv(){return Wv=x(g().mark((function e(t,n,r){var a,i;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Dc(t),e.prev=1,e.next=4,function(e,t){var n=Dc(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n.mutationQueue.lookupMutationBatch(e,t).next((function(t){return Ac(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)})).next((function(){return n.mutationQueue.performConsistencyCheck(e)})).next((function(){return n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)})).next((function(){return n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)})).next((function(){return n.localDocuments.getDocuments(e,r)}))}))}(a.localStore,n);case 4:return i=e.sent,Gv(a,n,r),jv(a,n),a.sharedClientState.updateMutationState(n,"rejected",r),e.next=10,Qv(a,i);case 10:e.next=16;break;case 12:return e.prev=12,e.t0=e.catch(1),e.next=16,sl(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])}))),Wv.apply(this,arguments)}function jv(e,t){(e.uc.get(t)||[]).forEach((function(e){e.resolve()})),e.uc.delete(t)}function Gv(e,t,n){var r=Dc(e),a=r.oc[r.currentUser.toKey()];if(a){var i=a.get(t);i&&(n?i.reject(n):i.resolve(),a=a.remove(t)),r.oc[r.currentUser.toKey()]=a}}function Hv(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);var r,a=y(e.ec.get(t));try{for(a.s();!(r=a.n()).done;){var i=r.value;e.tc.delete(i),n&&e.Zu.lc(i,n)}}catch(o){a.e(o)}finally{a.f()}e.ec.delete(t),e.isPrimaryClient&&e.rc.us(t).forEach((function(t){e.rc.containsKey(t)||qv(e,t)}))}function qv(e,t){e.nc.delete(t.path.canonicalString());var n=e.sc.get(t);null!==n&&(Cd(e.remoteStore,n),e.sc=e.sc.remove(t),e.ic.delete(n),$v(e))}function Kv(e,t,n){var r,a=y(n);try{for(a.s();!(r=a.n()).done;){var i=r.value;i instanceof xv?(e.rc.addReference(i.key,t),Xv(e,i)):i instanceof wv?(Ic("SyncEngine","Document no longer in limbo: "+i.key),e.rc.removeReference(i.key,t),e.rc.containsKey(i.key)||qv(e,i.key)):Rc()}}catch(o){a.e(o)}finally{a.f()}}function Xv(e,t){var n=t.key,r=n.path.canonicalString();e.sc.get(n)||e.nc.has(r)||(Ic("SyncEngine","New document in limbo: "+n),e.nc.add(r),$v(e))}function $v(e){for(;e.nc.size>0&&e.sc.size<e.maxConcurrentLimboResolutions;){var t=e.nc.values().next().value;e.nc.delete(t);var n=new Zc(Qc.fromString(t)),r=e.cc.next();e.ic.set(r,new Sv(n)),e.sc=e.sc.insert(n,r),Sd(e.remoteStore,new xp(Cf(xf(n.path)),r,2,fl.ot))}}function Qv(e,t,n){return Yv.apply(this,arguments)}function Yv(){return Yv=x(g().mark((function e(t,n,r){var a,i,o,s;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=Dc(t),i=[],o=[],s=[],e.t0=a.tc.isEmpty(),e.t0){e.next=9;break}return a.tc.forEach((function(e,t){s.push(a.hc(t,n,r).then((function(e){if(e){a.isPrimaryClient&&a.sharedClientState.updateQueryState(t.targetId,e.fromCache?"not-current":"current"),i.push(e);var n=Wp.Vi(t.targetId,e);o.push(n)}})))})),e.next=6,Promise.all(s);case 6:return a.Zu.Go(i),e.next=9,function(){var e=x(g().mark((function e(t,n){var r,a,i,o,s,u,c,l;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Dc(t),e.prev=1,e.next=4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return cl.forEach(n,(function(t){return cl.forEach(t.Pi,(function(n){return r.persistence.referenceDelegate.addReference(e,t.targetId,n)})).next((function(){return cl.forEach(t.vi,(function(n){return r.persistence.referenceDelegate.removeReference(e,t.targetId,n)}))}))}))}));case 4:e.next=11;break;case 6:if(e.prev=6,e.t0=e.catch(1),ll(e.t0)){e.next=10;break}throw e.t0;case 10:Ic("LocalStore","Failed to update sequence numbers: "+e.t0);case 11:a=y(n);try{for(a.s();!(i=a.n()).done;)o=i.value,s=o.targetId,o.fromCache||(u=r.$i.get(s),c=u.snapshotVersion,l=u.withLastLimboFreeSnapshotVersion(c),r.$i=r.$i.insert(s,l))}catch(f){a.e(f)}finally{a.f()}case 13:case"end":return e.stop()}}),e,null,[[1,6]])})));return function(t,n){return e.apply(this,arguments)}}()(a.localStore,o);case 9:case"end":return e.stop()}}),e)}))),Yv.apply(this,arguments)}function Jv(e,t){return Zv.apply(this,arguments)}function Zv(){return Zv=x(g().mark((function e(t,n){var r,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((r=Dc(t)).currentUser.isEqual(n)){e.next=11;break}return Ic("SyncEngine","User change. New user:",n.toKey()),e.next=5,qp(r.localStore,n);case 5:return a=e.sent,r.currentUser=n,function(e,t){e.uc.forEach((function(e){e.forEach((function(e){e.reject(new Mc(Oc.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.uc.clear()}(r),r.sharedClientState.handleUserChange(n,a.removedBatchIds,a.addedBatchIds),e.next=11,Qv(r,a.Ki);case 11:case"end":return e.stop()}}),e)}))),Zv.apply(this,arguments)}function em(e,t){var n=Dc(e),r=n.ic.get(t);if(r&&r.Xu)return Th().add(r.key);var a=Th(),i=n.ec.get(t);if(!i)return a;var o,s=y(i);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=n.tc.get(u);a=a.unionWith(c.view.qu)}}catch(l){s.e(l)}finally{s.f()}return a}function tm(e){var t=Dc(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Mv.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=em.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Lv.bind(null,t),t.Zu.Go=mv.bind(null,t.eventManager),t.Zu.lc=yv.bind(null,t.eventManager),t}function nm(e){var t=Dc(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Vv.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Uv.bind(null,t),t}var rm=function(){function e(){w(this,e),this.synchronizeTabs=!1}return E(e,[{key:"initialize",value:function(){var e=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.wt=hd(t.databaseInfo.databaseId),this.sharedClientState=this.dc(t),this.persistence=this._c(t),e.next=5,this.persistence.start();case 5:this.localStore=this.wc(t),this.gcScheduler=this.mc(t,this.localStore),this.indexBackfillerScheduler=this.gc(t,this.localStore);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"mc",value:function(e,t){return null}},{key:"gc",value:function(e,t){return null}},{key:"wc",value:function(e){return Hp(this.persistence,new jp,e.initialUser,this.wt)}},{key:"_c",value:function(e){return new Vp(Up.Ms,this.wt)}},{key:"dc",value:function(e){return new id}},{key:"terminate",value:function(){var e=x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.gcScheduler&&this.gcScheduler.stop(),e.next=3,this.sharedClientState.shutdown();case 3:return e.next=5,this.persistence.shutdown();case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),am=function(){function e(){w(this,e)}return E(e,[{key:"initialize",value:function(){var e=x(g().mark((function e(t,n){var r=this;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.localStore,e.t0){e.next=12;break}return this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return Pv(r.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Jv.bind(null,this.syncEngine),e.next=12,rv(this.remoteStore,this.syncEngine.isPrimaryClient);case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"createEventManager",value:function(e){return new pv}},{key:"createDatastore",value:function(e){var t,n=hd(e.databaseInfo.databaseId),r=(t=e.databaseInfo,new ld(t));return function(e,t,n,r){return new yd(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,r,n)}},{key:"createRemoteStore",value:function(e){var t,n,r,a,i,o=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,a=function(e){return Pv(o.syncEngine,e,0)},i=sd.V()?new sd:new od,new bd(t,n,r,a,i)}},{key:"createSyncEngine",value:function(e,t){return function(e,t,n,r,a,i,o){var s=new Cv(e,t,n,r,a,i);return o&&(s.ac=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}},{key:"terminate",value:function(){return function(){var e=x(g().mark((function e(t){var n;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Dc(t),Ic("RemoteStore","RemoteStore shutting down."),n.lu.add(5),e.next=5,kd(n);case 5:n.du.shutdown(),n._u.set("Unknown");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()(this.remoteStore)}}]),e}();var im=function(){function e(t){w(this,e),this.observer=t,this.muted=!1}return E(e,[{key:"next",value:function(e){this.observer.next&&this.Ic(this.observer.next,e)}},{key:"error",value:function(e){this.observer.error?this.Ic(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}},{key:"Tc",value:function(){this.muted=!0}},{key:"Ic",value:function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)}}]),e}(),om=function(){function e(t,n,r,a){var i=this;w(this,e),this.authCredentials=t,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=a,this.user=kc.UNAUTHENTICATED,this.clientId=Gc.I(),this.authCredentialListener=function(){return Promise.resolve()},this.appCheckCredentialListener=function(){return Promise.resolve()},this.authCredentials.start(r,function(){var e=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Ic("FirestoreClient","Received user=",t.uid),e.next=3,i.authCredentialListener(t);case 3:i.user=t;case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.appCheckCredentials.start(r,(function(e){return Ic("FirestoreClient","Received new app check token=",e),i.appCheckCredentialListener(e,i.user)}))}return E(e,[{key:"getConfiguration",value:function(){var e=x(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100});case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setCredentialChangeListener",value:function(e){this.authCredentialListener=e}},{key:"setAppCheckTokenChangeListener",value:function(e){this.appCheckCredentialListener=e}},{key:"verifyNotTerminated",value:function(){if(this.asyncQueue.isShuttingDown)throw new Mc(Oc.FAILED_PRECONDITION,"The client has already been terminated.")}},{key:"terminate",value:function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new Fc;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(x(g().mark((function n(){var r;return g().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,n.t0=e.onlineComponents,!n.t0){n.next=5;break}return n.next=5,e.onlineComponents.terminate();case 5:if(n.t1=e.offlineComponents,!n.t1){n.next=9;break}return n.next=9,e.offlineComponents.terminate();case 9:e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve(),n.next=18;break;case 14:n.prev=14,n.t2=n.catch(0),r=uv(n.t2,"Failed to shutdown persistence"),t.reject(r);case 18:case"end":return n.stop()}}),n,null,[[0,14]])})))),t.promise}}]),e}();function sm(e,t){return um.apply(this,arguments)}function um(){return um=x(g().mark((function e(t,n){var r,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),Ic("FirestoreClient","Initializing OfflineComponentProvider"),e.next=3,t.getConfiguration();case 3:return r=e.sent,e.next=6,n.initialize(r);case 6:a=r.initialUser,t.setCredentialChangeListener(function(){var e=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=a.isEqual(t),e.t0){e.next=5;break}return e.next=4,qp(n.localStore,t);case 4:a=t;case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),n.persistence.setDatabaseDeletedListener((function(){return t.terminate()})),t.offlineComponents=n;case 8:case"end":return e.stop()}}),e)}))),um.apply(this,arguments)}function cm(e,t){return lm.apply(this,arguments)}function lm(){return lm=x(g().mark((function e(t,n){var r,a;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.asyncQueue.verifyOperationInProgress(),e.next=3,fm(t);case 3:return r=e.sent,Ic("FirestoreClient","Initializing OnlineComponentProvider"),e.next=7,t.getConfiguration();case 7:return a=e.sent,e.next=10,n.initialize(r,a);case 10:t.setCredentialChangeListener((function(e){return tv(n.remoteStore,e)})),t.setAppCheckTokenChangeListener((function(e,t){return tv(n.remoteStore,t)})),t.onlineComponents=n;case 13:case"end":return e.stop()}}),e)}))),lm.apply(this,arguments)}function fm(e){return hm.apply(this,arguments)}function hm(){return hm=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.offlineComponents,e.t0){e.next=5;break}return Ic("FirestoreClient","Using default OfflineComponentProvider"),e.next=5,sm(t,new rm);case 5:return e.abrupt("return",t.offlineComponents);case 6:case"end":return e.stop()}}),e)}))),hm.apply(this,arguments)}function pm(e){return dm.apply(this,arguments)}function dm(){return dm=x(g().mark((function e(t){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t.onlineComponents,e.t0){e.next=5;break}return Ic("FirestoreClient","Using default OnlineComponentProvider"),e.next=5,cm(t,new am);case 5:return e.abrupt("return",t.onlineComponents);case 6:case"end":return e.stop()}}),e)}))),dm.apply(this,arguments)}function vm(e){return pm(e).then((function(e){return e.syncEngine}))}function mm(e){return ym.apply(this,arguments)}function ym(){return ym=x(g().mark((function e(t){var n,r;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pm(t);case 2:return n=e.sent,r=n.eventManager,e.abrupt("return",(r.onListen=Iv.bind(null,n.syncEngine),r.onUnlisten=Rv.bind(null,n.syncEngine),r));case 5:case"end":return e.stop()}}),e)}))),ym.apply(this,arguments)}var gm=new Map;function bm(e,t,n){if(!n)throw new Mc(Oc.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function xm(e){if(!Zc.isDocumentKey(e))throw new Mc(Oc.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function wm(e){if(Zc.isDocumentKey(e))throw new Mc(Oc.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function km(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}return"function"==typeof e?"a function":Rc()}function Em(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Mc(Oc.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=km(e);throw new Mc(Oc.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}return e}function Sm(e,t){if(t<=0)throw new Mc(Oc.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}var Cm=function(){function e(t){var n;if(w(this,e),void 0===t.host){if(void 0!==t.ssl)throw new Mc(Oc.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(n=t.ssl)||void 0===n||n;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Mc(Oc.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.useFetchStreams=!!t.useFetchStreams,function(e,t,n,r){if(!0===t&&!0===r)throw new Mc(Oc.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))}("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}return E(e,[{key:"isEqual",value:function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}]),e}(),Im=function(){function e(t,n,r){w(this,e),this._authCredentials=n,this._appCheckCredentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Cm({}),this._settingsFrozen=!1,t instanceof Rl?this._databaseId=t:(this._app=t,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Mc(Oc.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rl(e.options.projectId)}(t))}return E(e,[{key:"app",get:function(){if(!this._app)throw new Mc(Oc.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}},{key:"_initialized",get:function(){return this._settingsFrozen}},{key:"_terminated",get:function(){return void 0!==this._terminateTask}},{key:"_setSettings",value:function(e){if(this._settingsFrozen)throw new Mc(Oc.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Cm(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new Lc;switch(e.type){case"gapi":var t=e.client;return Ac(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new zc(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new Mc(Oc.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}},{key:"_getSettings",value:function(){return this._settings}},{key:"_freezeSettings",value:function(){return this._settingsFrozen=!0,this._settings}},{key:"_delete",value:function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}},{key:"toJSON",value:function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}},{key:"_terminate",value:function(){return function(e){var t=gm.get(e);t&&(Ic("ComponentProvider","Removing Datastore"),gm.delete(e),t.terminate())}(this),Promise.resolve()}}]),e}();var Tm=function(){function e(t,n,r){w(this,e),this.converter=n,this._key=r,this.type="document",this.firestore=t}return E(e,[{key:"_path",get:function(){return this._key.path}},{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"path",get:function(){return this._key.path.canonicalString()}},{key:"parent",get:function(){return new _m(this.firestore,this.converter,this._key.path.popLast())}},{key:"withConverter",value:function(t){return new e(this.firestore,t,this._key)}}]),e}(),Nm=function(){function e(t,n,r){w(this,e),this.converter=n,this._query=r,this.type="query",this.firestore=t}return E(e,[{key:"withConverter",value:function(t){return new e(this.firestore,t,this._query)}}]),e}(),_m=function(e){h(n,e);var t=m(n);function n(e,r,a){var i;return w(this,n),(i=t.call(this,e,r,xf(a)))._path=a,i.type="collection",i}return E(n,[{key:"id",get:function(){return this._query.path.lastSegment()}},{key:"path",get:function(){return this._query.path.canonicalString()}},{key:"parent",get:function(){var e=this._path.popLast();return e.isEmpty()?null:new Tm(this.firestore,null,new Zc(e))}},{key:"withConverter",value:function(e){return new n(this.firestore,e,this._path)}}]),n}(Nm);function Rm(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=$(e),bm("collection","path",t),e instanceof Im){var i=Qc.fromString.apply(Qc,[t].concat(r));return wm(i),new _m(e,null,i)}if(!(e instanceof Tm||e instanceof _m))throw new Mc(Oc.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(Qc.fromString.apply(Qc,[t].concat(r)));return wm(o),new _m(e.firestore,null,o)}var Am=function(){function e(){var t=this;w(this,e),this.Oc=Promise.resolve(),this.Mc=[],this.Fc=!1,this.$c=[],this.Bc=null,this.Lc=!1,this.Uc=!1,this.qc=[],this.So=new pd(this,"async_queue_retry"),this.Kc=function(){var e=fd();e&&Ic("AsyncQueue","Visibility state changed to "+e.visibilityState),t.So.Eo()};var n=fd();n&&"function"==typeof n.addEventListener&&n.addEventListener("visibilitychange",this.Kc)}return E(e,[{key:"isShuttingDown",get:function(){return this.Fc}},{key:"enqueueAndForget",value:function(e){this.enqueue(e)}},{key:"enqueueAndForgetEvenWhileRestricted",value:function(e){this.Gc(),this.Qc(e)}},{key:"enterRestrictedMode",value:function(e){if(!this.Fc){this.Fc=!0,this.Uc=e||!1;var t=fd();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Kc)}}},{key:"enqueue",value:function(e){var t=this;if(this.Gc(),this.Fc)return new Promise((function(){}));var n=new Fc;return this.Qc((function(){return t.Fc&&t.Uc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)})).then((function(){return n.promise}))}},{key:"enqueueRetryable",value:function(e){var t=this;this.enqueueAndForget((function(){return t.Mc.push(e),t.jc()}))}},{key:"jc",value:function(){var e=x(g().mark((function e(){var t=this;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===this.Mc.length){e.next=14;break}return e.prev=1,e.next=4,this.Mc[0]();case 4:this.Mc.shift(),this.So.reset(),e.next=13;break;case 8:if(e.prev=8,e.t0=e.catch(1),ll(e.t0)){e.next=12;break}throw e.t0;case 12:Ic("AsyncQueue","Operation failed with retryable error: "+e.t0);case 13:this.Mc.length>0&&this.So.Io((function(){return t.jc()}));case 14:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"Qc",value:function(e){var t=this,n=this.Oc.then((function(){return t.Lc=!0,e().catch((function(e){t.Bc=e,t.Lc=!1;var n=function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw Tc("INTERNAL UNHANDLED ERROR: ",n),e})).then((function(e){return t.Lc=!1,e}))}));return this.Oc=n,n}},{key:"enqueueAfterDelay",value:function(e,t,n){var r=this;this.Gc(),this.qc.indexOf(e)>-1&&(t=0);var a=sv.createAndSchedule(this,e,t,n,(function(e){return r.Wc(e)}));return this.$c.push(a),a}},{key:"Gc",value:function(){this.Bc&&Rc()}},{key:"verifyOperationInProgress",value:function(){}},{key:"zc",value:function(){var e=x(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.Oc,e.next=3,t;case 3:if(t!==this.Oc){e.next=0;break}case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"Hc",value:function(e){var t,n=y(this.$c);try{for(n.s();!(t=n.n()).done;){if(t.value.timerId===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}},{key:"Jc",value:function(e){var t=this;return this.zc().then((function(){t.$c.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));var n,r=y(t.$c);try{for(r.s();!(n=r.n()).done;){var a=n.value;if(a.skipDelay(),"all"!==e&&a.timerId===e)break}}catch(i){r.e(i)}finally{r.f()}return t.zc()}))}},{key:"Yc",value:function(e){this.qc.push(e)}},{key:"Wc",value:function(e){var t=this.$c.indexOf(e);this.$c.splice(t,1)}}]),e}();function Dm(e){return function(e,t){if("object"!=typeof e||null===e)return!1;var n,r=e,a=y(["next","error","complete"]);try{for(a.s();!(n=a.n()).done;){var i=n.value;if(i in r&&"function"==typeof r[i])return!0}}catch(o){a.e(o)}finally{a.f()}return!1}(e)}var Om=function(e){h(n,e);var t=m(n);function n(e,r,a){var i;return w(this,n),(i=t.call(this,e,r,a)).type="firestore",i._queue=new Am,i._persistenceKey="name"in e?e.name:"[DEFAULT]",i}return E(n,[{key:"_terminate",value:function(){return this._firestoreClient||Fm(this),this._firestoreClient.terminate()}}]),n}(Im);function Mm(e){return e._firestoreClient||Fm(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Fm(e){var t,n=e._freezeSettings(),r=function(e,t,n,r){return new _l(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new om(e._authCredentials,e._appCheckCredentials,e._queue,r)}var Pm=function(){function e(){w(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0;a<n.length;++a)if(0===n[a].length)throw new Mc(Oc.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Jc(n)}return E(e,[{key:"isEqual",value:function(e){return this._internalPath.isEqual(e._internalPath)}}]),e}();var Lm=function(){function e(t){w(this,e),this._byteString=t}return E(e,[{key:"toBase64",value:function(){return this._byteString.toBase64()}},{key:"toUint8Array",value:function(){return this._byteString.toUint8Array()}},{key:"toString",value:function(){return"Bytes(base64: "+this.toBase64()+")"}},{key:"isEqual",value:function(e){return this._byteString.isEqual(e._byteString)}}],[{key:"fromBase64String",value:function(t){try{return new e(wl.fromBase64String(t))}catch(t){throw new Mc(Oc.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}},{key:"fromUint8Array",value:function(t){return new e(wl.fromUint8Array(t))}}]),e}(),Bm=E((function e(t){w(this,e),this._methodName=t})),Vm=function(){function e(t,n){if(w(this,e),!isFinite(t)||t<-90||t>90)throw new Mc(Oc.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(n)||n<-180||n>180)throw new Mc(Oc.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=t,this._long=n}return E(e,[{key:"latitude",get:function(){return this._lat}},{key:"longitude",get:function(){return this._long}},{key:"isEqual",value:function(e){return this._lat===e._lat&&this._long===e._long}},{key:"toJSON",value:function(){return{latitude:this._lat,longitude:this._long}}},{key:"_compareTo",value:function(e){return Hc(this._lat,e._lat)||Hc(this._long,e._long)}}]),e}(),zm=/^__.*__$/,Um=function(){function e(t,n,r){w(this,e),this.data=t,this.fieldMask=n,this.fieldTransforms=r}return E(e,[{key:"toMutation",value:function(e,t){return null!==this.fieldMask?new ih(e,this.data,this.fieldMask,t,this.fieldTransforms):new ah(e,this.data,t,this.fieldTransforms)}}]),e}();function Wm(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Rc()}}var jm=function(){function e(t,n,r,a,i,o){w(this,e),this.settings=t,this.databaseId=n,this.wt=r,this.ignoreUndefinedProperties=a,void 0===i&&this.Xc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return E(e,[{key:"path",get:function(){return this.settings.path}},{key:"Zc",get:function(){return this.settings.Zc}},{key:"ta",value:function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.wt,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}},{key:"ea",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.sa(e),r}},{key:"ia",value:function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ta({path:n,na:!1});return r.Xc(),r}},{key:"ra",value:function(e){return this.ta({path:void 0,na:!0})}},{key:"oa",value:function(e){return ey(e,this.settings.methodName,this.settings.ua||!1,this.path,this.settings.ca)}},{key:"contains",value:function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))}},{key:"Xc",value:function(){if(this.path)for(var e=0;e<this.path.length;e++)this.sa(this.path.get(e))}},{key:"sa",value:function(e){if(0===e.length)throw this.oa("Document fields must not be empty");if(Wm(this.Zc)&&zm.test(e))throw this.oa('Document fields cannot begin and end with "__"')}}]),e}(),Gm=function(){function e(t,n,r){w(this,e),this.databaseId=t,this.ignoreUndefinedProperties=n,this.wt=r||hd(t)}return E(e,[{key:"aa",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new jm({Zc:e,methodName:t,ca:n,path:Jc.emptyPath(),na:!1,ua:r},this.databaseId,this.wt,this.ignoreUndefinedProperties)}}]),e}();function Hm(e){var t=e._freezeSettings(),n=hd(e._databaseId);return new Gm(e._databaseId,!!t.ignoreUndefinedProperties,n)}function qm(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=e.aa(i.merge||i.mergeFields?2:0,t,n,a);Qm("Data must be an object, but it was:",o,r);var s,u,c=Xm(r,o);if(i.merge)s=new xl(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){var l,f=[],h=y(i.mergeFields);try{for(h.s();!(l=h.n()).done;){var p=l.value,d=Ym(t,p,n);if(!o.contains(d))throw new Mc(Oc.INVALID_ARGUMENT,"Field '".concat(d,"' is specified in your field mask but missing from your input data."));ty(f,d)||f.push(d)}}catch(v){h.e(v)}finally{h.f()}s=new xl(f),u=o.fieldTransforms.filter((function(e){return s.covers(e.field)}))}else s=null,u=o.fieldTransforms;return new Um(new $l(c),s,u)}function Km(e,t){if($m(e=$(e)))return Qm("Unsupported field value:",t,e),Xm(e,t);if(e instanceof Bm)return function(e,t){if(!Wm(t.Zc))throw t.oa("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.oa("".concat(e._methodName,"() is not currently supported inside arrays"));var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.na&&4!==t.Zc)throw t.oa("Nested arrays are not supported");return function(e,t){var n,r=[],a=0,i=y(e);try{for(i.s();!(n=i.n()).done;){var o=Km(n.value,t.ra(a));null==o&&(o={nullValue:"NULL_VALUE"}),r.push(o),a++}}catch(s){i.e(s)}finally{i.f()}return{arrayValue:{values:r}}}(e,t)}return function(e,t){if(null===(e=$(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Pf(t.wt,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=Kc.fromDate(e);return{timestampValue:Wh(t.wt,n)}}if(e instanceof Kc){var r=new Kc(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Wh(t.wt,r)}}if(e instanceof Vm)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Lm)return{bytesValue:jh(t.wt,e._byteString)};if(e instanceof Tm){var a=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(a))throw t.oa("Document reference is for database ".concat(i.projectId,"/").concat(i.database," but should be for database ").concat(a.projectId,"/").concat(a.database));return{referenceValue:qh(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.oa("Unsupported field value: ".concat(km(e)))}(e,t)}function Xm(e,t){var n={};return dl(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):pl(e,(function(e,r){var a=Km(r,t.ea(e));null!=a&&(n[e]=a)})),{mapValue:{fields:n}}}function $m(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Kc||e instanceof Vm||e instanceof Lm||e instanceof Tm||e instanceof Bm)}function Qm(e,t,n){if(!$m(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=km(n);throw"an object"===r?t.oa(e+" a custom object"):t.oa(e+" "+r)}}function Ym(e,t,n){if((t=$(t))instanceof Pm)return t._internalPath;if("string"==typeof t)return Zm(e,t);throw ey("Field path arguments must be of type string or ",e,!1,void 0,n)}var Jm=new RegExp("[~\\*/\\[\\]]");function Zm(e,t,n){if(t.search(Jm)>=0)throw ey("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return I(Pm,S(t.split(".")))._internalPath}catch(jE){throw ey("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function ey(e,t,n,r,a){var i=r&&!r.isEmpty(),o=void 0!==a,s="Function ".concat(t,"() called with invalid data");n&&(s+=" (via `toFirestore()`)"),s+=". ";var u="";return(i||o)&&(u+=" (found",i&&(u+=" in field ".concat(r)),o&&(u+=" in document ".concat(a)),u+=")"),new Mc(Oc.INVALID_ARGUMENT,s+e+u)}function ty(e,t){return e.some((function(e){return e.isEqual(t)}))}var ny=function(){function e(t,n,r,a,i){w(this,e),this._firestore=t,this._userDataWriter=n,this._key=r,this._document=a,this._converter=i}return E(e,[{key:"id",get:function(){return this._key.path.lastSegment()}},{key:"ref",get:function(){return new Tm(this._firestore,this._converter,this._key)}},{key:"exists",value:function(){return null!==this._document}},{key:"data",value:function(){if(this._document){if(this._converter){var e=new ry(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}},{key:"get",value:function(e){if(this._document){var t=this._document.data.field(ay("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}]),e}(),ry=function(e){h(n,e);var t=m(n);function n(){return w(this,n),t.apply(this,arguments)}return E(n,[{key:"data",value:function(){return c(s(n.prototype),"data",this).call(this)}}]),n}(ny);function ay(e,t){return"string"==typeof t?Zm(e,t):t instanceof Pm?t._internalPath:t._delegate._internalPath}var iy=function(){function e(t,n){w(this,e),this.hasPendingWrites=t,this.fromCache=n}return E(e,[{key:"isEqual",value:function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}]),e}(),oy=function(e){h(n,e);var t=m(n);function n(e,r,a,i,o,s){var u;return w(this,n),(u=t.call(this,e,r,a,i,s))._firestore=e,u._firestoreImpl=e,u.metadata=o,u}return E(n,[{key:"exists",value:function(){return c(s(n.prototype),"exists",this).call(this)}},{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){var t=new sy(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){var n=this._document.data.field(ay("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}]),n}(ny),sy=function(e){h(n,e);var t=m(n);function n(){return w(this,n),t.apply(this,arguments)}return E(n,[{key:"data",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c(s(n.prototype),"data",this).call(this,e)}}]),n}(oy),uy=function(){function e(t,n,r,a){w(this,e),this._firestore=t,this._userDataWriter=n,this._snapshot=a,this.metadata=new iy(a.hasPendingWrites,a.fromCache),this.query=r}return E(e,[{key:"docs",get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e}},{key:"size",get:function(){return this._snapshot.docs.size}},{key:"empty",get:function(){return 0===this.size}},{key:"forEach",value:function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new sy(n._firestore,n._userDataWriter,r.key,r,new iy(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query.converter))}))}},{key:"docChanges",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Mc(Oc.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){return{type:"added",doc:new sy(e._firestore,e._userDataWriter,t.doc.key,t.doc,new iy(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new sy(e._firestore,e._userDataWriter,t.doc.key,t.doc,new iy(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),a=-1,i=-1;return 0!==t.type&&(a=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(i=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:cy(t.type),doc:n,oldIndex:a,newIndex:i}}))}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}]),e}();function cy(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Rc()}}function ly(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new Mc(Oc.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var fy=E((function e(){w(this,e)}));var hy=function(e){h(n,e);var t=m(n);function n(e,r){var a;return w(this,n),(a=t.call(this)).fa=e,a.wa=r,a.type="orderBy",a}return E(n,[{key:"_apply",value:function(e){var t=function(e,t,n){if(null!==e.startAt)throw new Mc(Oc.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Mc(Oc.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new df(t,n);return function(e,t){if(null===wf(e)){var n=kf(e);null!==n&&dy(e,n,t.field)}}(e,r),r}(e._query,this.fa,this.wa);return new Nm(e.firestore,e.converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new gf(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}]),n}(fy);var py=function(e){h(n,e);var t=m(n);function n(e,r,a){var i;return w(this,n),(i=t.call(this)).type=e,i.ma=r,i.ga=a,i}return E(n,[{key:"_apply",value:function(e){return new Nm(e.firestore,e.converter,If(e._query,this.ma,this.ga))}}]),n}(fy);function dy(e,t,n){if(!n.isEqual(t))throw new Mc(Oc.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '".concat(t.toString(),"' and so you must also use '").concat(t.toString(),"' as your first argument to orderBy(), but your first orderBy() is on field '").concat(n.toString(),"' instead."))}var vy=function(){function e(){w(this,e)}return E(e,[{key:"convertValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Fl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Sl(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Cl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Rc()}}},{key:"convertObject",value:function(e,t){var n=this,r={};return pl(e.fields,(function(e,a){r[e]=n.convertValue(a,t)})),r}},{key:"convertGeoPoint",value:function(e){return new Vm(Sl(e.latitude),Sl(e.longitude))}},{key:"convertArray",value:function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))}},{key:"convertServerTimestamp",value:function(e,t){switch(t){case"previous":var n=Tl(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Nl(e));default:return null}}},{key:"convertTimestamp",value:function(e){var t=El(e);return new Kc(t.seconds,t.nanos)}},{key:"convertDocumentKey",value:function(e,t){var n=Qc.fromString(e);Ac(pp(n));var r=new Rl(n.get(1),n.get(3)),a=new Zc(n.popFirst(5));return r.isEqual(t)||Tc("Document ".concat(a," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),a}}]),e}();function my(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var yy=function(e){h(n,e);var t=m(n);function n(e){var r;return w(this,n),(r=t.call(this)).firestore=e,r}return E(n,[{key:"convertBytes",value:function(e){return new Lm(e)}},{key:"convertReference",value:function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Tm(this.firestore,null,t)}}]),n}(vy);function gy(e,t){var n=Em(e.firestore,Om),r=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];if(e=$(e),1===arguments.length&&(t=Gc.I()),bm("doc","path",t),e instanceof Im){var i=Qc.fromString.apply(Qc,[t].concat(r));return xm(i),new Tm(e,null,new Zc(i))}if(!(e instanceof Tm||e instanceof _m))throw new Mc(Oc.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");var o=e._path.child(Qc.fromString.apply(Qc,[t].concat(r)));return xm(o),new Tm(e.firestore,e instanceof _m?e.converter:null,new Zc(o))}(e),a=my(e.converter,t);return by(n,[qm(Hm(e.firestore),"addDoc",r._key,a,null!==e.converter,{}).toMutation(r._key,Qf.exists(!1))]).then((function(){return r}))}function by(e,t){return function(e,t){var n=new Fc;return e.asyncQueue.enqueueAndForget(x(g().mark((function r(){return g().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.t0=Dv,r.next=3,vm(e);case 3:return r.t1=r.sent,r.t2=t,r.t3=n,r.abrupt("return",(0,r.t0)(r.t1,r.t2,r.t3));case 7:case"end":return r.stop()}}),r)})))),n.promise}(Mm(e),t)}function xy(e,t,n){var r=n.docs.get(t._key),a=new yy(e);return new oy(e,a,t._key,r,new iy(n.hasPendingWrites,n.fromCache),t.converter)}!function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];Ec="9.9.1",Be(new Q("firestore",(function(e,n){var r=n.options,a=e.getProvider("app").getImmediate(),i=new Om(a,new Bc(e.getProvider("auth-internal")),new Wc(e.getProvider("app-check-internal")));return r=Object.assign({useFetchStreams:t},r),i._setSettings(r),i}),"PUBLIC")),He(wc,"3.4.13",e),He(wc,"3.4.13","esm2017")}();var wy=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!==typeof t){var n=t;t={name:n}}var r=Object.assign({name:Oe,automaticDataCollectionEnabled:!1},t),a=r.name;if("string"!==typeof a||!a)throw Ue.create("bad-app-name",{appName:String(a)});var i=Fe.get(a);if(i){if(W(e,i.options)&&W(r,i.config))return i;throw Ue.create("duplicate-app",{appName:a})}var o,s=new ne(a),u=y(Pe.values());try{for(u.s();!(o=u.n()).done;){var c=o.value;s.addComponent(c)}}catch(f){u.e(f)}finally{u.f()}var l=new We(e,r,s);return Fe.set(a,l),l}({apiKey:"AIzaSyBI6V7jlrpyifLAHbeqdlITq3ZLjPqyI5w",authDomain:"chatr-84b53.firebaseapp.com",projectId:"chatr-84b53",storageBucket:"chatr-84b53.appspot.com",messagingSenderId:"577163722593",appId:"1:577163722593:web:8b298410dcecbf20560f20",measurementId:"G-3554T2G2YG"}),ky=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge();return Ve(e,"firestore").getImmediate()}(wy),Ey=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ge(),t=Ve(e,"auth");return t.isInitialized()?t.getImmediate():Et(e,{popupRedirectResolver:$a,persistence:[qr,wr,Er]})}(wy);function Sy(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}function Cy(){return Cy=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Cy.apply(this,arguments)}function Iy(e){var t,n,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(n=Iy(e[t]))&&(r&&(r+=" "),r+=n);else for(t in e)e[t]&&(r&&(r+=" "),r+=t);return r}var Ty=function(){for(var e,t,n=0,r="";n<arguments.length;)(e=arguments[n++])&&(t=Iy(e))&&(r&&(r+=" "),r+=t);return r};function Ny(e,t){var n=Cy({},t);return Object.keys(e).forEach((function(t){void 0===n[t]&&(n[t]=e[t])})),n}function _y(e,t,n){var r={};return Object.keys(e).forEach((function(a){r[a]=e[a].reduce((function(e,r){return r&&(n&&n[r]&&e.push(n[r]),e.push(t(r))),e}),[]).join(" ")})),r}function Ry(e){for(var t="https://mui.com/production-error/?code="+e,n=1;n<arguments.length;n+=1)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+e+"; visit "+t+" for the full message."}function Ay(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return Math.min(Math.max(t,e),n)}function Dy(e){if(e.type)return e;if("#"===e.charAt(0))return Dy(function(e){e=e.slice(1);var t=new RegExp(".{1,".concat(e.length>=6?2:1,"}"),"g"),n=e.match(t);return n&&1===n[0].length&&(n=n.map((function(e){return e+e}))),n?"rgb".concat(4===n.length?"a":"","(").concat(n.map((function(e,t){return t<3?parseInt(e,16):Math.round(parseInt(e,16)/255*1e3)/1e3})).join(", "),")"):""}(e));var t=e.indexOf("("),n=e.substring(0,t);if(-1===["rgb","rgba","hsl","hsla","color"].indexOf(n))throw new Error(Ry(9,e));var r,a=e.substring(t+1,e.length-1);if("color"===n){if(r=(a=a.split(" ")).shift(),4===a.length&&"/"===a[3].charAt(0)&&(a[3]=a[3].slice(1)),-1===["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r))throw new Error(Ry(10,r))}else a=a.split(",");return{type:n,values:a=a.map((function(e){return parseFloat(e)})),colorSpace:r}}function Oy(e){var t=e.type,n=e.colorSpace,r=e.values;return-1!==t.indexOf("rgb")?r=r.map((function(e,t){return t<3?parseInt(e,10):e})):-1!==t.indexOf("hsl")&&(r[1]="".concat(r[1],"%"),r[2]="".concat(r[2],"%")),r=-1!==t.indexOf("color")?"".concat(n," ").concat(r.join(" ")):"".concat(r.join(", ")),"".concat(t,"(").concat(r,")")}function My(e){var t="hsl"===(e=Dy(e)).type?Dy(function(e){var t=(e=Dy(e)).values,n=t[0],r=t[1]/100,a=t[2]/100,i=r*Math.min(a,1-a),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+n/30)%12;return a-i*Math.max(Math.min(t-3,9-t,1),-1)},s="rgb",u=[Math.round(255*o(0)),Math.round(255*o(8)),Math.round(255*o(4))];return"hsla"===e.type&&(s+="a",u.push(t[3])),Oy({type:s,values:u})}(e)).values:e.values;return t=t.map((function(t){return"color"!==e.type&&(t/=255),t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)})),Number((.2126*t[0]+.7152*t[1]+.0722*t[2]).toFixed(3))}function Fy(e,t){return e=Dy(e),t=Ay(t),"rgb"!==e.type&&"hsl"!==e.type||(e.type+="a"),"color"===e.type?e.values[3]="/".concat(t):e.values[3]=t,Oy(e)}function Py(e,t){if(e=Dy(e),t=Ay(t),-1!==e.type.indexOf("hsl"))e.values[2]*=1-t;else if(-1!==e.type.indexOf("rgb")||-1!==e.type.indexOf("color"))for(var n=0;n<3;n+=1)e.values[n]*=1-t;return Oy(e)}function Ly(e,t){if(e=Dy(e),t=Ay(t),-1!==e.type.indexOf("hsl"))e.values[2]+=(100-e.values[2])*t;else if(-1!==e.type.indexOf("rgb"))for(var n=0;n<3;n+=1)e.values[n]+=(255-e.values[n])*t;else if(-1!==e.type.indexOf("color"))for(var r=0;r<3;r+=1)e.values[r]+=(1-e.values[r])*t;return Oy(e)}var By=function(e){var t=Object.create(null);return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}},Vy=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|enterKeyHint|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,zy=By((function(e){return Vy.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));var Uy=function(){function e(e){var t=this;this._insertTag=function(e){var n;n=0===t.tags.length?t.insertionPoint?t.insertionPoint.nextSibling:t.prepend?t.container.firstChild:t.before:t.tags[t.tags.length-1].nextSibling,t.container.insertBefore(e,n),t.tags.push(e)},this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.prepend=e.prepend,this.insertionPoint=e.insertionPoint,this.before=null}var t=e.prototype;return t.hydrate=function(e){e.forEach(this._insertTag)},t.insert=function(e){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t.setAttribute("data-s",""),t}(this));var t=this.tags[this.tags.length-1];if(this.isSpeedy){var n=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(t);try{n.insertRule(e,n.cssRules.length)}catch(LE){0}}else t.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode&&e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}(),Wy=Math.abs,jy=String.fromCharCode,Gy=Object.assign;function Hy(e){return e.trim()}function qy(e,t,n){return e.replace(t,n)}function Ky(e,t){return e.indexOf(t)}function Xy(e,t){return 0|e.charCodeAt(t)}function $y(e,t,n){return e.slice(t,n)}function Qy(e){return e.length}function Yy(e){return e.length}function Jy(e,t){return t.push(e),e}var Zy=1,eg=1,tg=0,ng=0,rg=0,ag="";function ig(e,t,n,r,a,i,o){return{value:e,root:t,parent:n,type:r,props:a,children:i,line:Zy,column:eg,length:o,return:""}}function og(e,t){return Gy(ig("",null,null,"",null,null,0),e,{length:-e.length},t)}function sg(){return rg=ng>0?Xy(ag,--ng):0,eg--,10===rg&&(eg=1,Zy--),rg}function ug(){return rg=ng<tg?Xy(ag,ng++):0,eg++,10===rg&&(eg=1,Zy++),rg}function cg(){return Xy(ag,ng)}function lg(){return ng}function fg(e,t){return $y(ag,e,t)}function hg(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function pg(e){return Zy=eg=1,tg=Qy(ag=e),ng=0,[]}function dg(e){return ag="",e}function vg(e){return Hy(fg(ng-1,gg(91===e?e+2:40===e?e+1:e)))}function mg(e){for(;(rg=cg())&&rg<33;)ug();return hg(e)>2||hg(rg)>3?"":" "}function yg(e,t){for(;--t&&ug()&&!(rg<48||rg>102||rg>57&&rg<65||rg>70&&rg<97););return fg(e,lg()+(t<6&&32==cg()&&32==ug()))}function gg(e){for(;ug();)switch(rg){case e:return ng;case 34:case 39:34!==e&&39!==e&&gg(rg);break;case 40:41===e&&gg(e);break;case 92:ug()}return ng}function bg(e,t){for(;ug()&&e+rg!==57&&(e+rg!==84||47!==cg()););return"/*"+fg(t,ng-1)+"*"+jy(47===e?e:ug())}function xg(e){for(;!hg(cg());)ug();return fg(e,ng)}var wg="-ms-",kg="-moz-",Eg="-webkit-",Sg="comm",Cg="rule",Ig="decl",Tg="@keyframes";function Ng(e,t){for(var n="",r=Yy(e),a=0;a<r;a++)n+=t(e[a],a,e,t)||"";return n}function _g(e,t,n,r){switch(e.type){case"@import":case Ig:return e.return=e.return||e.value;case Sg:return"";case Tg:return e.return=e.value+"{"+Ng(e.children,r)+"}";case Cg:e.value=e.props.join(",")}return Qy(n=Ng(e.children,r))?e.return=e.value+"{"+n+"}":""}function Rg(e,t){switch(function(e,t){return(((t<<2^Xy(e,0))<<2^Xy(e,1))<<2^Xy(e,2))<<2^Xy(e,3)}(e,t)){case 5103:return Eg+"print-"+e+e;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Eg+e+e;case 5349:case 4246:case 4810:case 6968:case 2756:return Eg+e+kg+e+wg+e+e;case 6828:case 4268:return Eg+e+wg+e+e;case 6165:return Eg+e+wg+"flex-"+e+e;case 5187:return Eg+e+qy(e,/(\w+).+(:[^]+)/,"-webkit-box-$1$2-ms-flex-$1$2")+e;case 5443:return Eg+e+wg+"flex-item-"+qy(e,/flex-|-self/,"")+e;case 4675:return Eg+e+wg+"flex-line-pack"+qy(e,/align-content|flex-|-self/,"")+e;case 5548:return Eg+e+wg+qy(e,"shrink","negative")+e;case 5292:return Eg+e+wg+qy(e,"basis","preferred-size")+e;case 6060:return Eg+"box-"+qy(e,"-grow","")+Eg+e+wg+qy(e,"grow","positive")+e;case 4554:return Eg+qy(e,/([^-])(transform)/g,"$1-webkit-$2")+e;case 6187:return qy(qy(qy(e,/(zoom-|grab)/,Eg+"$1"),/(image-set)/,Eg+"$1"),e,"")+e;case 5495:case 3959:return qy(e,/(image-set\([^]*)/,Eg+"$1$`$1");case 4968:return qy(qy(e,/(.+:)(flex-)?(.*)/,"-webkit-box-pack:$3-ms-flex-pack:$3"),/s.+-b[^;]+/,"justify")+Eg+e+e;case 4095:case 3583:case 4068:case 2532:return qy(e,/(.+)-inline(.+)/,Eg+"$1$2")+e;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Qy(e)-1-t>6)switch(Xy(e,t+1)){case 109:if(45!==Xy(e,t+4))break;case 102:return qy(e,/(.+:)(.+)-([^]+)/,"$1-webkit-$2-$3$1"+kg+(108==Xy(e,t+3)?"$3":"$2-$3"))+e;case 115:return~Ky(e,"stretch")?Rg(qy(e,"stretch","fill-available"),t)+e:e}break;case 4949:if(115!==Xy(e,t+1))break;case 6444:switch(Xy(e,Qy(e)-3-(~Ky(e,"!important")&&10))){case 107:return qy(e,":",":"+Eg)+e;case 101:return qy(e,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Eg+(45===Xy(e,14)?"inline-":"")+"box$3$1"+Eg+"$2$3$1"+wg+"$2box$3")+e}break;case 5936:switch(Xy(e,t+11)){case 114:return Eg+e+wg+qy(e,/[svh]\w+-[tblr]{2}/,"tb")+e;case 108:return Eg+e+wg+qy(e,/[svh]\w+-[tblr]{2}/,"tb-rl")+e;case 45:return Eg+e+wg+qy(e,/[svh]\w+-[tblr]{2}/,"lr")+e}return Eg+e+wg+e+e}return e}function Ag(e){return function(t){t.root||(t=t.return)&&e(t)}}function Dg(e){return dg(Og("",null,null,null,[""],e=pg(e),0,[0],e))}function Og(e,t,n,r,a,i,o,s,u){for(var c=0,l=0,f=o,h=0,p=0,d=0,v=1,m=1,y=1,g=0,b="",x=a,w=i,k=r,E=b;m;)switch(d=g,g=ug()){case 40:if(108!=d&&58==E.charCodeAt(f-1)){-1!=Ky(E+=qy(vg(g),"&","&\f"),"&\f")&&(y=-1);break}case 34:case 39:case 91:E+=vg(g);break;case 9:case 10:case 13:case 32:E+=mg(d);break;case 92:E+=yg(lg()-1,7);continue;case 47:switch(cg()){case 42:case 47:Jy(Fg(bg(ug(),lg()),t,n),u);break;default:E+="/"}break;case 123*v:s[c++]=Qy(E)*y;case 125*v:case 59:case 0:switch(g){case 0:case 125:m=0;case 59+l:p>0&&Qy(E)-f&&Jy(p>32?Pg(E+";",r,n,f-1):Pg(qy(E," ","")+";",r,n,f-2),u);break;case 59:E+=";";default:if(Jy(k=Mg(E,t,n,c,l,a,s,b,x=[],w=[],f),i),123===g)if(0===l)Og(E,t,k,k,x,i,f,s,w);else switch(h){case 100:case 109:case 115:Og(e,k,k,r&&Jy(Mg(e,k,k,0,0,a,s,b,a,x=[],f),w),a,w,f,s,r?x:w);break;default:Og(E,k,k,k,[""],w,0,s,w)}}c=l=p=0,v=y=1,b=E="",f=o;break;case 58:f=1+Qy(E),p=d;default:if(v<1)if(123==g)--v;else if(125==g&&0==v++&&125==sg())continue;switch(E+=jy(g),g*v){case 38:y=l>0?1:(E+="\f",-1);break;case 44:s[c++]=(Qy(E)-1)*y,y=1;break;case 64:45===cg()&&(E+=vg(ug())),h=cg(),l=f=Qy(b=E+=xg(lg())),g++;break;case 45:45===d&&2==Qy(E)&&(v=0)}}return i}function Mg(e,t,n,r,a,i,o,s,u,c,l){for(var f=a-1,h=0===a?i:[""],p=Yy(h),d=0,v=0,m=0;d<r;++d)for(var y=0,g=$y(e,f+1,f=Wy(v=o[d])),b=e;y<p;++y)(b=Hy(v>0?h[y]+" "+g:qy(g,/&\f/g,h[y])))&&(u[m++]=b);return ig(e,t,n,0===a?Cg:s,u,c,l)}function Fg(e,t,n){return ig(e,t,n,Sg,jy(rg),$y(e,2,-2),0)}function Pg(e,t,n,r){return ig(e,t,n,Ig,$y(e,0,r),$y(e,r+1,-1),r)}var Lg=function(e,t,n){for(var r=0,a=0;r=a,a=cg(),38===r&&12===a&&(t[n]=1),!hg(a);)ug();return fg(e,ng)},Bg=function(e,t){return dg(function(e,t){var n=-1,r=44;do{switch(hg(r)){case 0:38===r&&12===cg()&&(t[n]=1),e[n]+=Lg(ng-1,t,n);break;case 2:e[n]+=vg(r);break;case 4:if(44===r){e[++n]=58===cg()?"&\f":"",t[n]=e[n].length;break}default:e[n]+=jy(r)}}while(r=ug());return e}(pg(e),t))},Vg=new WeakMap,zg=function(e){if("rule"===e.type&&e.parent&&!(e.length<1)){for(var t=e.value,n=e.parent,r=e.column===n.column&&e.line===n.line;"rule"!==n.type;)if(!(n=n.parent))return;if((1!==e.props.length||58===t.charCodeAt(0)||Vg.get(n))&&!r){Vg.set(e,!0);for(var a=[],i=Bg(t,a),o=n.props,s=0,u=0;s<i.length;s++)for(var c=0;c<o.length;c++,u++)e.props[u]=a[s]?i[s].replace(/&\f/g,o[c]):o[c]+" "+i[s]}}},Ug=function(e){if("decl"===e.type){var t=e.value;108===t.charCodeAt(0)&&98===t.charCodeAt(2)&&(e.return="",e.value="")}},Wg=[function(e,t,n,r){if(e.length>-1&&!e.return)switch(e.type){case Ig:e.return=Rg(e.value,e.length);break;case Tg:return Ng([og(e,{value:qy(e.value,"@","@"+Eg)})],r);case Cg:if(e.length)return function(e,t){return e.map(t).join("")}(e.props,(function(t){switch(function(e,t){return(e=t.exec(e))?e[0]:e}(t,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Ng([og(e,{props:[qy(t,/:(read-\w+)/,":-moz-$1")]})],r);case"::placeholder":return Ng([og(e,{props:[qy(t,/:(plac\w+)/,":-webkit-input-$1")]}),og(e,{props:[qy(t,/:(plac\w+)/,":-moz-$1")]}),og(e,{props:[qy(t,/:(plac\w+)/,wg+"input-$1")]})],r)}return""}))}}],jg=function(e){var t=e.key;if("css"===t){var n=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(n,(function(e){-1!==e.getAttribute("data-emotion").indexOf(" ")&&(document.head.appendChild(e),e.setAttribute("data-s",""))}))}var r=e.stylisPlugins||Wg;var a,i,o={},s=[];a=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+t+' "]'),(function(e){for(var t=e.getAttribute("data-emotion").split(" "),n=1;n<t.length;n++)o[t[n]]=!0;s.push(e)}));var u=[zg,Ug];var c,l=[_g,Ag((function(e){c.insert(e)}))],f=function(e){var t=Yy(e);return function(n,r,a,i){for(var o="",s=0;s<t;s++)o+=e[s](n,r,a,i)||"";return o}}(u.concat(r,l));i=function(e,t,n,r){c=n,function(e){Ng(Dg(e),f)}(e?e+"{"+t.styles+"}":t.styles),r&&(h.inserted[t.name]=!0)};var h={key:t,sheet:new Uy({key:t,container:a,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:i};return h.sheet.hydrate(s),h};var Gg=function(e){for(var t,n=0,r=0,a=e.length;a>=4;++r,a-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(a){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)},Hg={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},qg=/[A-Z]|^ms/g,Kg=/_EMO_([^_]+?)_([^]*?)_EMO_/g,Xg=function(e){return 45===e.charCodeAt(1)},$g=function(e){return null!=e&&"boolean"!==typeof e},Qg=By((function(e){return Xg(e)?e:e.replace(qg,"-$&").toLowerCase()})),Yg=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(Kg,(function(e,t,n){return Zg={name:t,styles:n,next:Zg},t}))}return 1===Hg[e]||Xg(e)||"number"!==typeof t||0===t?t:t+"px"};function Jg(e,t,n){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return Zg={name:n.name,styles:n.styles,next:Zg},n.name;if(void 0!==n.styles){var r=n.next;if(void 0!==r)for(;void 0!==r;)Zg={name:r.name,styles:r.styles,next:Zg},r=r.next;return n.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var a=0;a<n.length;a++)r+=Jg(e,t,n[a])+";";else for(var i in n){var o=n[i];if("object"!==typeof o)null!=t&&void 0!==t[o]?r+=i+"{"+t[o]+"}":$g(o)&&(r+=Qg(i)+":"+Yg(i,o)+";");else if(!Array.isArray(o)||"string"!==typeof o[0]||null!=t&&void 0!==t[o[0]]){var s=Jg(e,t,o);switch(i){case"animation":case"animationName":r+=Qg(i)+":"+s+";";break;default:r+=i+"{"+s+"}"}}else for(var u=0;u<o.length;u++)$g(o[u])&&(r+=Qg(i)+":"+Yg(i,o[u])+";")}return r}(e,t,n);case"function":if(void 0!==e){var a=Zg,i=n(e);return Zg=a,Jg(e,t,i)}}if(null==t)return n;var o=t[n];return void 0!==o?o:n}var Zg,eb=/label:\s*([^\s;\n{]+)\s*(;|$)/g;var tb=function(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,a="";Zg=void 0;var i=e[0];null==i||void 0===i.raw?(r=!1,a+=Jg(n,t,i)):a+=i[0];for(var o=1;o<e.length;o++)a+=Jg(n,t,e[o]),r&&(a+=i[o]);eb.lastIndex=0;for(var s,u="";null!==(s=eb.exec(a));)u+="-"+s[1];return{name:Gg(a)+u,styles:a,next:Zg}},nb=(0,e.createContext)("undefined"!==typeof HTMLElement?jg({key:"css"}):null);nb.Provider;var rb=function(t){return(0,e.forwardRef)((function(n,r){var a=(0,e.useContext)(nb);return t(n,a,r)}))},ab=(0,e.createContext)({});t.useInsertionEffect&&t.useInsertionEffect;function ib(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]+";"):r+=n+" "})),r}var ob=function(e,t,n){var r=e.key+"-"+t.name;!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles)},sb=function(e,t,n){ob(e,t,n);var r=e.key+"-"+t.name;if(void 0===e.inserted[t.name]){var a=t;do{e.insert(t===a?"."+r:"",a,e.sheet,!0);a=a.next}while(void 0!==a)}},ub=zy,cb=function(e){return"theme"!==e},lb=function(e){return"string"===typeof e&&e.charCodeAt(0)>96?ub:cb},fb=function(e,t,n){var r;if(t){var a=t.shouldForwardProp;r=e.__emotion_forwardProp&&a?function(t){return e.__emotion_forwardProp(t)&&a(t)}:a}return"function"!==typeof r&&n&&(r=e.__emotion_forwardProp),r},hb=t.useInsertionEffect?t.useInsertionEffect:function(e){e()};var pb=function(e){var t=e.cache,n=e.serialized,r=e.isStringTag;ob(t,n,r);hb((function(){return sb(t,n,r)}));return null},db=function t(n,r){var a,i,o=n.__emotion_real===n,s=o&&n.__emotion_base||n;void 0!==r&&(a=r.label,i=r.target);var u=fb(n,r,o),c=u||lb(s),l=!c("as");return function(){var f=arguments,h=o&&void 0!==n.__emotion_styles?n.__emotion_styles.slice(0):[];if(void 0!==a&&h.push("label:"+a+";"),null==f[0]||void 0===f[0].raw)h.push.apply(h,f);else{0,h.push(f[0][0]);for(var p=f.length,d=1;d<p;d++)h.push(f[d],f[0][d])}var v=rb((function(t,n,r){var a=l&&t.as||s,o="",f=[],p=t;if(null==t.theme){for(var d in p={},t)p[d]=t[d];p.theme=(0,e.useContext)(ab)}"string"===typeof t.className?o=ib(n.registered,f,t.className):null!=t.className&&(o=t.className+" ");var v=tb(h.concat(f),n.registered,p);o+=n.key+"-"+v.name,void 0!==i&&(o+=" "+i);var m=l&&void 0===u?lb(a):c,y={};for(var g in t)l&&"as"===g||m(g)&&(y[g]=t[g]);return y.className=o,y.ref=r,(0,e.createElement)(e.Fragment,null,(0,e.createElement)(pb,{cache:n,serialized:v,isStringTag:"string"===typeof a}),(0,e.createElement)(a,y))}));return v.displayName=void 0!==a?a:"Styled("+("string"===typeof s?s:s.displayName||s.name||"Component")+")",v.defaultProps=n.defaultProps,v.__emotion_real=v,v.__emotion_base=s,v.__emotion_styles=h,v.__emotion_forwardProp=u,Object.defineProperty(v,"toString",{value:function(){return"."+i}}),v.withComponent=function(e,n){return t(e,Cy({},r,n,{shouldForwardProp:fb(v,n,!0)})).apply(void 0,h)},v}},vb=db.bind();["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){vb[e]=vb(e)}));var mb=vb;function yb(e,t){return mb(e,t)}function gb(e){return null!==e&&"object"===typeof e&&e.constructor===Object}function bb(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clone:!0},r=n.clone?Cy({},e):e;return gb(e)&&gb(t)&&Object.keys(t).forEach((function(a){"__proto__"!==a&&(gb(t[a])&&a in e&&gb(e[a])?r[a]=bb(e[a],t[a],n):r[a]=t[a])})),r}var xb=["values","unit","step"];function wb(e){var t=e.values,n=void 0===t?{xs:0,sm:600,md:900,lg:1200,xl:1536}:t,r=e.unit,a=void 0===r?"px":r,i=e.step,o=void 0===i?5:i,s=Sy(e,xb),u=function(e){var t=Object.keys(e).map((function(t){return{key:t,val:e[t]}}))||[];return t.sort((function(e,t){return e.val-t.val})),t.reduce((function(e,t){return Cy({},e,C({},t.key,t.val))}),{})}(n),c=Object.keys(u);function l(e){var t="number"===typeof n[e]?n[e]:e;return"@media (min-width:".concat(t).concat(a,")")}function f(e){var t="number"===typeof n[e]?n[e]:e;return"@media (max-width:".concat(t-o/100).concat(a,")")}function h(e,t){var r=c.indexOf(t);return"@media (min-width:".concat("number"===typeof n[e]?n[e]:e).concat(a,") and ")+"(max-width:".concat((-1!==r&&"number"===typeof n[c[r]]?n[c[r]]:t)-o/100).concat(a,")")}return Cy({keys:c,values:u,up:l,down:f,between:h,only:function(e){return c.indexOf(e)+1<c.length?h(e,c[c.indexOf(e)+1]):l(e)},not:function(e){var t=c.indexOf(e);return 0===t?l(c[1]):t===c.length-1?f(c[t]):h(e,c[c.indexOf(e)+1]).replace("@media","@media not all and")},unit:a},s)}var kb={borderRadius:4},Eb={xs:0,sm:600,md:900,lg:1200,xl:1536},Sb={keys:["xs","sm","md","lg","xl"],up:function(e){return"@media (min-width:".concat(Eb[e],"px)")}};function Cb(e,t,n){var r=e.theme||{};if(Array.isArray(t)){var a=r.breakpoints||Sb;return t.reduce((function(e,r,i){return e[a.up(a.keys[i])]=n(t[i]),e}),{})}if("object"===typeof t){var i=r.breakpoints||Sb;return Object.keys(t).reduce((function(e,r){if(-1!==Object.keys(i.values||Eb).indexOf(r)){e[i.up(r)]=n(t[r],r)}else{var a=r;e[a]=t[a]}return e}),{})}return n(t)}function Ib(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=null==(e=t.keys)?void 0:e.reduce((function(e,n){return e[t.up(n)]={},e}),{});return n||{}}function Tb(e,t){return e.reduce((function(e,t){var n=e[t];return(!n||0===Object.keys(n).length)&&delete e[t],e}),t)}function Nb(e){if("string"!==typeof e)throw new Error(Ry(7));return e.charAt(0).toUpperCase()+e.slice(1)}function _b(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t||"string"!==typeof t)return null;if(e&&e.vars&&n){var r="vars.".concat(t).split(".").reduce((function(e,t){return e&&e[t]?e[t]:null}),e);if(null!=r)return r}return t.split(".").reduce((function(e,t){return e&&null!=e[t]?e[t]:null}),e)}function Rb(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;return r="function"===typeof e?e(n):Array.isArray(e)?e[n]||a:_b(e,n)||a,t&&(r=t(r)),r}var Ab=function(e){var t=e.prop,n=e.cssProperty,r=void 0===n?e.prop:n,a=e.themeKey,i=e.transform,o=function(e){if(null==e[t])return null;var n=e[t],o=_b(e.theme,a)||{};return Cb(e,n,(function(e){var n=Rb(o,i,e);return e===n&&"string"===typeof e&&(n=Rb(o,i,"".concat(t).concat("default"===e?"":Nb(e)),e)),!1===r?n:C({},r,n)}))};return o.propTypes={},o.filterProps=[t],o};var Db=function(e,t){return t?bb(e,t,{clone:!1}):e};var Ob={m:"margin",p:"padding"},Mb={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},Fb={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Pb=function(e){var t={};return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}((function(e){if(e.length>2){if(!Fb[e])return[e];e=Fb[e]}var t=o(e.split(""),2),n=t[0],r=t[1],a=Ob[n],i=Mb[r]||"";return Array.isArray(i)?i.map((function(e){return a+e})):[a+i]})),Lb=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],Bb=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],Vb=[].concat(Lb,Bb);function zb(e,t,n,r){var a,i=null!=(a=_b(e,t,!1))?a:n;return"number"===typeof i?function(e){return"string"===typeof e?e:i*e}:Array.isArray(i)?function(e){return"string"===typeof e?e:i[e]}:"function"===typeof i?i:function(){}}function Ub(e){return zb(e,"spacing",8)}function Wb(e,t){if("string"===typeof t||null==t)return t;var n=e(Math.abs(t));return t>=0?n:"number"===typeof n?-n:"-".concat(n)}function jb(e,t,n,r){if(-1===t.indexOf(n))return null;var a=function(e,t){return function(n){return e.reduce((function(e,r){return e[r]=Wb(t,n),e}),{})}}(Pb(n),r);return Cb(e,e[n],a)}function Gb(e,t){var n=Ub(e.theme);return Object.keys(e).map((function(r){return jb(e,t,r,n)})).reduce(Db,{})}function Hb(e){return Gb(e,Lb)}function qb(e){return Gb(e,Bb)}function Kb(e){return Gb(e,Vb)}Hb.propTypes={},Hb.filterProps=Lb,qb.propTypes={},qb.filterProps=Bb,Kb.propTypes={},Kb.filterProps=Vb;var Xb=Kb;function $b(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8;if(e.mui)return e;var t=Ub({spacing:e}),n=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var a=0===n.length?[1]:n;return a.map((function(e){var n=t(e);return"number"===typeof n?"".concat(n,"px"):n})).join(" ")};return n.mui=!0,n}var Qb=["breakpoints","palette","spacing","shape"];var Yb=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.breakpoints,n=void 0===t?{}:t,r=e.palette,a=void 0===r?{}:r,i=e.spacing,o=e.shape,s=void 0===o?{}:o,u=Sy(e,Qb),c=wb(n),l=$b(i),f=bb({breakpoints:c,direction:"ltr",components:{},palette:Cy({mode:"light"},a),spacing:l,shape:Cy({},kb,s)},u),h=arguments.length,p=new Array(h>1?h-1:0),d=1;d<h;d++)p[d-1]=arguments[d];return f=p.reduce((function(e,t){return bb(e,t)}),f)},Jb=["variant"];function Zb(e){return 0===e.length}function ex(e){var t=e.variant,n=Sy(e,Jb),r=t||"";return Object.keys(n).sort().forEach((function(t){r+="color"===t?Zb(r)?e[t]:Nb(e[t]):"".concat(Zb(r)?t:Nb(t)).concat(Nb(e[t].toString()))})),r}var tx=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce((function(e,t){return t.filterProps.forEach((function(n){e[n]=t})),e}),{}),a=function(e){return Object.keys(e).reduce((function(t,n){return r[n]?Db(t,r[n](e)):t}),{})};return a.propTypes={},a.filterProps=t.reduce((function(e,t){return e.concat(t.filterProps)}),[]),a};function nx(e){return"number"!==typeof e?e:"".concat(e,"px solid")}var rx=Ab({prop:"border",themeKey:"borders",transform:nx}),ax=Ab({prop:"borderTop",themeKey:"borders",transform:nx}),ix=Ab({prop:"borderRight",themeKey:"borders",transform:nx}),ox=Ab({prop:"borderBottom",themeKey:"borders",transform:nx}),sx=Ab({prop:"borderLeft",themeKey:"borders",transform:nx}),ux=Ab({prop:"borderColor",themeKey:"palette"}),cx=Ab({prop:"borderTopColor",themeKey:"palette"}),lx=Ab({prop:"borderRightColor",themeKey:"palette"}),fx=Ab({prop:"borderBottomColor",themeKey:"palette"}),hx=Ab({prop:"borderLeftColor",themeKey:"palette"}),px=function(e){if(void 0!==e.borderRadius&&null!==e.borderRadius){var t=zb(e.theme,"shape.borderRadius",4);return Cb(e,e.borderRadius,(function(e){return{borderRadius:Wb(t,e)}}))}return null};px.propTypes={},px.filterProps=["borderRadius"];var dx=tx(rx,ax,ix,ox,sx,ux,cx,lx,fx,hx,px),vx=tx(Ab({prop:"displayPrint",cssProperty:!1,transform:function(e){return{"@media print":{display:e}}}}),Ab({prop:"display"}),Ab({prop:"overflow"}),Ab({prop:"textOverflow"}),Ab({prop:"visibility"}),Ab({prop:"whiteSpace"})),mx=tx(Ab({prop:"flexBasis"}),Ab({prop:"flexDirection"}),Ab({prop:"flexWrap"}),Ab({prop:"justifyContent"}),Ab({prop:"alignItems"}),Ab({prop:"alignContent"}),Ab({prop:"order"}),Ab({prop:"flex"}),Ab({prop:"flexGrow"}),Ab({prop:"flexShrink"}),Ab({prop:"alignSelf"}),Ab({prop:"justifyItems"}),Ab({prop:"justifySelf"})),yx=function(e){if(void 0!==e.gap&&null!==e.gap){var t=zb(e.theme,"spacing",8);return Cb(e,e.gap,(function(e){return{gap:Wb(t,e)}}))}return null};yx.propTypes={},yx.filterProps=["gap"];var gx=function(e){if(void 0!==e.columnGap&&null!==e.columnGap){var t=zb(e.theme,"spacing",8);return Cb(e,e.columnGap,(function(e){return{columnGap:Wb(t,e)}}))}return null};gx.propTypes={},gx.filterProps=["columnGap"];var bx=function(e){if(void 0!==e.rowGap&&null!==e.rowGap){var t=zb(e.theme,"spacing",8);return Cb(e,e.rowGap,(function(e){return{rowGap:Wb(t,e)}}))}return null};bx.propTypes={},bx.filterProps=["rowGap"];var xx=tx(yx,gx,bx,Ab({prop:"gridColumn"}),Ab({prop:"gridRow"}),Ab({prop:"gridAutoFlow"}),Ab({prop:"gridAutoColumns"}),Ab({prop:"gridAutoRows"}),Ab({prop:"gridTemplateColumns"}),Ab({prop:"gridTemplateRows"}),Ab({prop:"gridTemplateAreas"}),Ab({prop:"gridArea"})),wx=tx(Ab({prop:"position"}),Ab({prop:"zIndex",themeKey:"zIndex"}),Ab({prop:"top"}),Ab({prop:"right"}),Ab({prop:"bottom"}),Ab({prop:"left"})),kx=tx(Ab({prop:"color",themeKey:"palette"}),Ab({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette"}),Ab({prop:"backgroundColor",themeKey:"palette"})),Ex=Ab({prop:"boxShadow",themeKey:"shadows"});function Sx(e){return e<=1&&0!==e?"".concat(100*e,"%"):e}var Cx=Ab({prop:"width",transform:Sx}),Ix=function(e){if(void 0!==e.maxWidth&&null!==e.maxWidth){return Cb(e,e.maxWidth,(function(t){var n,r,a;return{maxWidth:(null==(n=e.theme)||null==(r=n.breakpoints)||null==(a=r.values)?void 0:a[t])||Eb[t]||Sx(t)}}))}return null};Ix.filterProps=["maxWidth"];var Tx=Ab({prop:"minWidth",transform:Sx}),Nx=Ab({prop:"height",transform:Sx}),_x=Ab({prop:"maxHeight",transform:Sx}),Rx=Ab({prop:"minHeight",transform:Sx}),Ax=(Ab({prop:"size",cssProperty:"width",transform:Sx}),Ab({prop:"size",cssProperty:"height",transform:Sx}),tx(Cx,Ix,Tx,Nx,_x,Rx,Ab({prop:"boxSizing"}))),Dx=Ab({prop:"fontFamily",themeKey:"typography"}),Ox=Ab({prop:"fontSize",themeKey:"typography"}),Mx=Ab({prop:"fontStyle",themeKey:"typography"}),Fx=Ab({prop:"fontWeight",themeKey:"typography"}),Px=Ab({prop:"letterSpacing"}),Lx=Ab({prop:"textTransform"}),Bx=Ab({prop:"lineHeight"}),Vx=Ab({prop:"textAlign"}),zx=tx(Ab({prop:"typography",cssProperty:!1,themeKey:"typography"}),Dx,Ox,Mx,Fx,Px,Bx,Vx,Lx),Ux={borders:dx.filterProps,display:vx.filterProps,flexbox:mx.filterProps,grid:xx.filterProps,positions:wx.filterProps,palette:kx.filterProps,shadows:Ex.filterProps,sizing:Ax.filterProps,spacing:Xb.filterProps,typography:zx.filterProps},Wx={borders:dx,display:vx,flexbox:mx,grid:xx,positions:wx,palette:kx,shadows:Ex,sizing:Ax,spacing:Xb,typography:zx};Object.keys(Ux).reduce((function(e,t){return Ux[t].forEach((function(n){e[n]=Wx[t]})),e}),{});function jx(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.reduce((function(e,t){return e.concat(Object.keys(t))}),[]),a=new Set(r);return t.every((function(e){return a.size===Object.keys(e).length}))}function Gx(e,t){return"function"===typeof e?e(t):e}var Hx=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Wx,t=Object.keys(e).reduce((function(t,n){return e[n].filterProps.forEach((function(r){t[r]=e[n]})),t}),{});function n(e,n,r){var a,i=(C(a={},e,n),C(a,"theme",r),a),o=t[e];return o?o(i):C({},e,n)}function r(e){var a=e||{},i=a.sx,o=a.theme,s=void 0===o?{}:o;if(!i)return null;function u(e){var a=e;if("function"===typeof e)a=e(s);else if("object"!==typeof e)return e;if(!a)return null;var i=Ib(s.breakpoints),o=Object.keys(i),u=i;return Object.keys(a).forEach((function(e){var i=Gx(a[e],s);if(null!==i&&void 0!==i)if("object"===typeof i)if(t[e])u=Db(u,n(e,i,s));else{var o=Cb({theme:s},i,(function(t){return C({},e,t)}));jx(o,i)?u[e]=r({sx:i,theme:s}):u=Db(u,o)}else u=Db(u,n(e,i,s))})),Tb(o,u)}return Array.isArray(i)?i.map(u):u(i)}return r}();Hx.filterProps=["sx"];var qx=Hx,Kx=["name","slot","skipVariantsResolver","skipSx","overridesResolver"],Xx=["theme"],$x=["theme"];function Qx(e){return 0===Object.keys(e).length}var Yx=function(e,t){return t.components&&t.components[e]&&t.components[e].styleOverrides?t.components[e].styleOverrides:null},Jx=function(e,t){var n=[];t&&t.components&&t.components[e]&&t.components[e].variants&&(n=t.components[e].variants);var r={};return n.forEach((function(e){var t=ex(e.props);r[t]=e.style})),r},Zx=function(e,t,n,r){var a,i,o=e.ownerState,s=void 0===o?{}:o,u=[],c=null==n||null==(a=n.components)||null==(i=a[r])?void 0:i.variants;return c&&c.forEach((function(n){var r=!0;Object.keys(n.props).forEach((function(t){s[t]!==n.props[t]&&e[t]!==n.props[t]&&(r=!1)})),r&&u.push(t[ex(n.props)])})),u};function ew(e){return"ownerState"!==e&&"theme"!==e&&"sx"!==e&&"as"!==e}var tw=Yb();function nw(e,t){var n;return Cy({toolbar:(n={minHeight:56},C(n,e.up("xs"),{"@media (orientation: landscape)":{minHeight:48}}),C(n,e.up("sm"),{minHeight:64}),n)},t)}var rw={black:"#000",white:"#fff"},aw={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},iw={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},ow={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},sw={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},uw={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},cw={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},lw={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},fw=["mode","contrastThreshold","tonalOffset"],hw={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:rw.white,default:rw.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},pw={text:{primary:rw.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:rw.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function dw(e,t,n,r){var a=r.light||r,i=r.dark||1.5*r;e[t]||(e.hasOwnProperty(n)?e[t]=e[n]:"light"===t?e.light=Ly(e.main,a):"dark"===t&&(e.dark=Py(e.main,i)))}function vw(e){var t=e.mode,n=void 0===t?"light":t,r=e.contrastThreshold,a=void 0===r?3:r,i=e.tonalOffset,o=void 0===i?.2:i,s=Sy(e,fw),u=e.primary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:uw[200],light:uw[50],dark:uw[400]}:{main:uw[700],light:uw[400],dark:uw[800]}}(n),c=e.secondary||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:iw[200],light:iw[50],dark:iw[400]}:{main:iw[500],light:iw[300],dark:iw[700]}}(n),l=e.error||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:ow[500],light:ow[300],dark:ow[700]}:{main:ow[700],light:ow[400],dark:ow[800]}}(n),f=e.info||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:cw[400],light:cw[300],dark:cw[700]}:{main:cw[700],light:cw[500],dark:cw[900]}}(n),h=e.success||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:lw[400],light:lw[300],dark:lw[700]}:{main:lw[800],light:lw[500],dark:lw[900]}}(n),p=e.warning||function(){return"dark"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"light")?{main:sw[400],light:sw[300],dark:sw[700]}:{main:"#ed6c02",light:sw[500],dark:sw[900]}}(n);function d(e){var t=function(e,t){var n=My(e),r=My(t);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}(e,pw.text.primary)>=a?pw.text.primary:hw.text.primary;return t}var v=function(e){var t=e.color,n=e.name,r=e.mainShade,a=void 0===r?500:r,i=e.lightShade,s=void 0===i?300:i,u=e.darkShade,c=void 0===u?700:u;if(!(t=Cy({},t)).main&&t[a]&&(t.main=t[a]),!t.hasOwnProperty("main"))throw new Error(Ry(11,n?" (".concat(n,")"):"",a));if("string"!==typeof t.main)throw new Error(Ry(12,n?" (".concat(n,")"):"",JSON.stringify(t.main)));return dw(t,"light",s,o),dw(t,"dark",c,o),t.contrastText||(t.contrastText=d(t.main)),t},m={dark:pw,light:hw};return bb(Cy({common:Cy({},rw),mode:n,primary:v({color:u,name:"primary"}),secondary:v({color:c,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:v({color:l,name:"error"}),warning:v({color:p,name:"warning"}),info:v({color:f,name:"info"}),success:v({color:h,name:"success"}),grey:aw,contrastThreshold:a,getContrastText:d,augmentColor:v,tonalOffset:o},m[n]),s)}var mw=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];var yw={textTransform:"uppercase"},gw='"Roboto", "Helvetica", "Arial", sans-serif';function bw(e,t){var n="function"===typeof t?t(e):t,r=n.fontFamily,a=void 0===r?gw:r,i=n.fontSize,o=void 0===i?14:i,s=n.fontWeightLight,u=void 0===s?300:s,c=n.fontWeightRegular,l=void 0===c?400:c,f=n.fontWeightMedium,h=void 0===f?500:f,p=n.fontWeightBold,d=void 0===p?700:p,v=n.htmlFontSize,m=void 0===v?16:v,y=n.allVariants,g=n.pxToRem,b=Sy(n,mw);var x=o/14,w=g||function(e){return"".concat(e/m*x,"rem")},k=function(e,t,n,r,i){return Cy({fontFamily:a,fontWeight:e,fontSize:w(t),lineHeight:n},a===gw?{letterSpacing:"".concat((o=r/t,Math.round(1e5*o)/1e5),"em")}:{},i,y);var o},E={h1:k(u,96,1.167,-1.5),h2:k(u,60,1.2,-.5),h3:k(l,48,1.167,0),h4:k(l,34,1.235,.25),h5:k(l,24,1.334,0),h6:k(h,20,1.6,.15),subtitle1:k(l,16,1.75,.15),subtitle2:k(h,14,1.57,.1),body1:k(l,16,1.5,.15),body2:k(l,14,1.43,.15),button:k(h,14,1.75,.4,yw),caption:k(l,12,1.66,.4),overline:k(l,12,2.66,1,yw)};return bb(Cy({htmlFontSize:m,pxToRem:w,fontFamily:a,fontSize:o,fontWeightLight:u,fontWeightRegular:l,fontWeightMedium:h,fontWeightBold:d},E),b,{clone:!1})}function xw(){return["".concat(arguments.length<=0?void 0:arguments[0],"px ").concat(arguments.length<=1?void 0:arguments[1],"px ").concat(arguments.length<=2?void 0:arguments[2],"px ").concat(arguments.length<=3?void 0:arguments[3],"px rgba(0,0,0,").concat(.2,")"),"".concat(arguments.length<=4?void 0:arguments[4],"px ").concat(arguments.length<=5?void 0:arguments[5],"px ").concat(arguments.length<=6?void 0:arguments[6],"px ").concat(arguments.length<=7?void 0:arguments[7],"px rgba(0,0,0,").concat(.14,")"),"".concat(arguments.length<=8?void 0:arguments[8],"px ").concat(arguments.length<=9?void 0:arguments[9],"px ").concat(arguments.length<=10?void 0:arguments[10],"px ").concat(arguments.length<=11?void 0:arguments[11],"px rgba(0,0,0,").concat(.12,")")].join(",")}var ww=["none",xw(0,2,1,-1,0,1,1,0,0,1,3,0),xw(0,3,1,-2,0,2,2,0,0,1,5,0),xw(0,3,3,-2,0,3,4,0,0,1,8,0),xw(0,2,4,-1,0,4,5,0,0,1,10,0),xw(0,3,5,-1,0,5,8,0,0,1,14,0),xw(0,3,5,-1,0,6,10,0,0,1,18,0),xw(0,4,5,-2,0,7,10,1,0,2,16,1),xw(0,5,5,-3,0,8,10,1,0,3,14,2),xw(0,5,6,-3,0,9,12,1,0,3,16,2),xw(0,6,6,-3,0,10,14,1,0,4,18,3),xw(0,6,7,-4,0,11,15,1,0,4,20,3),xw(0,7,8,-4,0,12,17,2,0,5,22,4),xw(0,7,8,-4,0,13,19,2,0,5,24,4),xw(0,7,9,-4,0,14,21,2,0,5,26,4),xw(0,8,9,-5,0,15,22,2,0,6,28,5),xw(0,8,10,-5,0,16,24,2,0,6,30,5),xw(0,8,11,-5,0,17,26,2,0,6,32,5),xw(0,9,11,-5,0,18,28,2,0,7,34,6),xw(0,9,12,-6,0,19,29,2,0,7,36,6),xw(0,10,13,-6,0,20,31,3,0,8,38,7),xw(0,10,13,-6,0,21,33,3,0,8,40,7),xw(0,10,14,-6,0,22,35,3,0,8,42,7),xw(0,11,14,-7,0,23,36,3,0,9,44,8),xw(0,11,15,-7,0,24,38,3,0,9,46,8)],kw=["duration","easing","delay"],Ew={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},Sw={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function Cw(e){return"".concat(Math.round(e),"ms")}function Iw(e){if(!e)return 0;var t=e/36;return Math.round(10*(4+15*Math.pow(t,.25)+t/5))}function Tw(e){var t=Cy({},Ew,e.easing),n=Cy({},Sw,e.duration);return Cy({getAutoHeightDuration:Iw,create:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["all"],r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=r.duration,i=void 0===a?n.standard:a,o=r.easing,s=void 0===o?t.easeInOut:o,u=r.delay,c=void 0===u?0:u;Sy(r,kw);return(Array.isArray(e)?e:[e]).map((function(e){return"".concat(e," ").concat("string"===typeof i?i:Cw(i)," ").concat(s," ").concat("string"===typeof c?c:Cw(c))})).join(",")}},e,{easing:t,duration:n})}var Nw={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},_w=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function Rw(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mixins,n=void 0===t?{}:t,r=e.palette,a=void 0===r?{}:r,i=e.transitions,o=void 0===i?{}:i,s=e.typography,u=void 0===s?{}:s,c=Sy(e,_w),l=vw(a),f=Yb(e),h=bb(f,{mixins:nw(f.breakpoints,n),palette:l,shadows:ww.slice(),typography:bw(l,u),transitions:Tw(o),zIndex:Cy({},Nw)});h=bb(h,c);for(var p=arguments.length,d=new Array(p>1?p-1:0),v=1;v<p;v++)d[v-1]=arguments[v];return h=d.reduce((function(e,t){return bb(e,t)}),h)}var Aw=Rw(),Dw=function(e){return ew(e)&&"classes"!==e},Ow=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.defaultTheme,n=void 0===t?tw:t,r=e.rootShouldForwardProp,a=void 0===r?ew:r,i=e.slotShouldForwardProp,s=void 0===i?ew:i,u=e.styleFunctionSx,c=void 0===u?qx:u;return function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=r.name,u=r.slot,l=r.skipVariantsResolver,f=r.skipSx,h=r.overridesResolver,p=Sy(r,Kx),d=void 0!==l?l:u&&"Root"!==u||!1,v=f||!1;var m=ew;"Root"===u?m=a:u&&(m=s);var y=yb(e,Cy({shouldForwardProp:m,label:t},p)),g=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];var s=r?r.map((function(e){return"function"===typeof e&&e.__emotion_real!==e?function(t){var r=t.theme,a=Sy(t,Xx);return e(Cy({theme:Qx(r)?n:r},a))}:e})):[],u=e;i&&h&&s.push((function(e){var t=Qx(e.theme)?n:e.theme,r=Yx(i,t);if(r){var a={};return Object.entries(r).forEach((function(n){var r=o(n,2),i=r[0],s=r[1];a[i]="function"===typeof s?s(Cy({},e,{theme:t})):s})),h(e,a)}return null})),i&&!d&&s.push((function(e){var t=Qx(e.theme)?n:e.theme;return Zx(e,Jx(i,t),t,i)})),v||s.push((function(e){var t=Qx(e.theme)?n:e.theme;return c(Cy({},e,{theme:t}))}));var l=s.length-r.length;if(Array.isArray(e)&&l>0){var f=new Array(l).fill("");(u=[].concat(S(e),S(f))).raw=[].concat(S(e.raw),S(f))}else"function"===typeof e&&e.__emotion_real!==e&&(u=function(t){var r=t.theme,a=Sy(t,$x);return e(Cy({theme:Qx(r)?n:r},a))});var p=y.apply(void 0,[u].concat(S(s)));return p};return y.withConfig&&(g.withConfig=y.withConfig),g}}({defaultTheme:Aw,rootShouldForwardProp:Dw}),Mw=Ow;var Fw=e.createContext(null);function Pw(){return e.useContext(Fw)}function Lw(e){return 0===Object.keys(e).length}var Bw=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=Pw();return!t||Lw(t)?e:t},Vw=Yb();var zw=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Vw;return Bw(e)};function Uw(e){var t=e.props,n=e.name,r=e.defaultTheme,a=function(e){var t=e.theme,n=e.name,r=e.props;return t&&t.components&&t.components[n]&&t.components[n].defaultProps?Ny(t.components[n].defaultProps,r):r}({theme:zw(r),name:n,props:t});return a}function Ww(e){return Uw({props:e.props,name:e.name,defaultTheme:Aw})}function jw(e,t){"function"===typeof e?e(t):e&&(e.current=t)}function Gw(t,n){return e.useMemo((function(){return null==t&&null==n?null:function(e){jw(t,e),jw(n,e)}}),[t,n])}var Hw=Gw,qw="undefined"!==typeof window?e.useLayoutEffect:e.useEffect;var Kw,Xw=function(t){var n=e.useRef(t);return qw((function(){n.current=t})),e.useCallback((function(){return n.current.apply(void 0,arguments)}),[])},$w=!0,Qw=!1,Yw={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function Jw(e){e.metaKey||e.altKey||e.ctrlKey||($w=!0)}function Zw(){$w=!1}function ek(){"hidden"===this.visibilityState&&Qw&&($w=!0)}function tk(e){var t=e.target;try{return t.matches(":focus-visible")}catch(n){}return $w||function(e){var t=e.type,n=e.tagName;return!("INPUT"!==n||!Yw[t]||e.readOnly)||"TEXTAREA"===n&&!e.readOnly||!!e.isContentEditable}(t)}var nk=function(){var t=e.useCallback((function(e){var t;null!=e&&((t=e.ownerDocument).addEventListener("keydown",Jw,!0),t.addEventListener("mousedown",Zw,!0),t.addEventListener("pointerdown",Zw,!0),t.addEventListener("touchstart",Zw,!0),t.addEventListener("visibilitychange",ek,!0))}),[]),n=e.useRef(!1);return{isFocusVisibleRef:n,onFocus:function(e){return!!tk(e)&&(n.current=!0,!0)},onBlur:function(){return!!n.current&&(Qw=!0,window.clearTimeout(Kw),Kw=window.setTimeout((function(){Qw=!1}),100),n.current=!1,!0)},ref:t}};function rk(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var ak=e.createContext(null);function ik(t,n){var r=Object.create(null);return t&&e.Children.map(t,(function(e){return e})).forEach((function(t){r[t.key]=function(t){return n&&(0,e.isValidElement)(t)?n(t):t}(t)})),r}function ok(e,t,n){return null!=n[t]?n[t]:e.props[t]}function sk(t,n,r){var a=ik(t.children),i=function(e,t){function n(n){return n in t?t[n]:e[n]}e=e||{},t=t||{};var r,a=Object.create(null),i=[];for(var o in e)o in t?i.length&&(a[o]=i,i=[]):i.push(o);var s={};for(var u in t){if(a[u])for(r=0;r<a[u].length;r++){var c=a[u][r];s[a[u][r]]=n(c)}s[u]=n(u)}for(r=0;r<i.length;r++)s[i[r]]=n(i[r]);return s}(n,a);return Object.keys(i).forEach((function(o){var s=i[o];if((0,e.isValidElement)(s)){var u=o in n,c=o in a,l=n[o],f=(0,e.isValidElement)(l)&&!l.props.in;!c||u&&!f?c||!u||f?c&&u&&(0,e.isValidElement)(l)&&(i[o]=(0,e.cloneElement)(s,{onExited:r.bind(null,s),in:l.props.in,exit:ok(s,"exit",t),enter:ok(s,"enter",t)})):i[o]=(0,e.cloneElement)(s,{in:!1}):i[o]=(0,e.cloneElement)(s,{onExited:r.bind(null,s),in:!0,exit:ok(s,"exit",t),enter:ok(s,"enter",t)})}})),i}var uk=Object.values||function(e){return Object.keys(e).map((function(t){return e[t]}))},ck=function(t){var n,r;function a(e,n){var r,a=(r=t.call(this,e,n)||this).handleExited.bind(l(r));return r.state={contextValue:{isMounting:!0},handleExited:a,firstRender:!0},r}r=t,(n=a).prototype=Object.create(r.prototype),n.prototype.constructor=n,f(n,r);var i=a.prototype;return i.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},i.componentWillUnmount=function(){this.mounted=!1},a.getDerivedStateFromProps=function(t,n){var r,a,i=n.children,o=n.handleExited;return{children:n.firstRender?(r=t,a=o,ik(r.children,(function(t){return(0,e.cloneElement)(t,{onExited:a.bind(null,t),in:!0,appear:ok(t,"appear",r),enter:ok(t,"enter",r),exit:ok(t,"exit",r)})}))):sk(t,i,o),firstRender:!1}},i.handleExited=function(e,t){var n=ik(this.props.children);e.key in n||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState((function(t){var n=Cy({},t.children);return delete n[e.key],{children:n}})))},i.render=function(){var t=this.props,n=t.component,r=t.childFactory,a=Sy(t,["component","childFactory"]),i=this.state.contextValue,o=uk(this.state.children).map(r);return delete a.appear,delete a.enter,delete a.exit,null===n?e.createElement(ak.Provider,{value:i},o):e.createElement(ak.Provider,{value:i},e.createElement(n,a,o))},a}(e.Component);ck.propTypes={},ck.defaultProps={component:"div",childFactory:function(e){return e}};var lk=ck,fk=(n(110),t.useInsertionEffect?t.useInsertionEffect:e.useLayoutEffect),hk=rb((function(t,n){var r=t.styles,a=tb([r],void 0,(0,e.useContext)(ab)),i=(0,e.useRef)();return fk((function(){var e=n.key+"-global",t=new n.sheet.constructor({key:e,nonce:n.sheet.nonce,container:n.sheet.container,speedy:n.sheet.isSpeedy}),r=!1,o=document.querySelector('style[data-emotion="'+e+" "+a.name+'"]');return n.sheet.tags.length&&(t.before=n.sheet.tags[0]),null!==o&&(r=!0,o.setAttribute("data-emotion",e),t.hydrate([o])),i.current=[t,r],function(){t.flush()}}),[n]),fk((function(){var e=i.current,t=e[0];if(e[1])e[1]=!1;else{if(void 0!==a.next&&sb(n,a.next,!0),t.tags.length){var r=t.tags[t.tags.length-1].nextElementSibling;t.before=r,t.flush()}n.insert("",a,t,!1)}}),[n,a.name]),null}));function pk(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return tb(t)}var dk=function(){var e=pk.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}};var vk=n(184);var mk=function(t){var n=t.className,r=t.classes,a=t.pulsate,i=void 0!==a&&a,s=t.rippleX,u=t.rippleY,c=t.rippleSize,l=t.in,f=t.onExited,h=t.timeout,p=o(e.useState(!1),2),d=p[0],v=p[1],m=Ty(n,r.ripple,r.rippleVisible,i&&r.ripplePulsate),y={width:c,height:c,top:-c/2+u,left:-c/2+s},g=Ty(r.child,d&&r.childLeaving,i&&r.childPulsate);return l||d||v(!0),e.useEffect((function(){if(!l&&null!=f){var e=setTimeout(f,h);return function(){clearTimeout(e)}}}),[f,l,h]),(0,vk.jsx)("span",{className:m,style:y,children:(0,vk.jsx)("span",{className:g})})},yk=function(e){return e},gk=function(){var e=yk;return{configure:function(t){e=t},generate:function(t){return e(t)},reset:function(){e=yk}}}(),bk={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",required:"required",selected:"selected"};function xk(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",r=bk[t];return r?"".concat(n,"-").concat(r):"".concat(gk.generate(e),"-").concat(t)}function wk(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Mui",r={};return t.forEach((function(t){r[t]=xk(e,t,n)})),r}var kk,Ek,Sk,Ck,Ik,Tk,Nk,_k,Rk=wk("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),Ak=["center","classes","className"],Dk=dk(Ik||(Ik=kk||(kk=rk(["\n  0% {\n    transform: scale(0);\n    opacity: 0.1;\n  }\n\n  100% {\n    transform: scale(1);\n    opacity: 0.3;\n  }\n"])))),Ok=dk(Tk||(Tk=Ek||(Ek=rk(["\n  0% {\n    opacity: 1;\n  }\n\n  100% {\n    opacity: 0;\n  }\n"])))),Mk=dk(Nk||(Nk=Sk||(Sk=rk(["\n  0% {\n    transform: scale(1);\n  }\n\n  50% {\n    transform: scale(0.92);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n"])))),Fk=Mw("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),Pk=Mw(mk,{name:"MuiTouchRipple",slot:"Ripple"})(_k||(_k=Ck||(Ck=rk(["\n  opacity: 0;\n  position: absolute;\n\n  &."," {\n    opacity: 0.3;\n    transform: scale(1);\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  &."," {\n    animation-duration: ","ms;\n  }\n\n  & ."," {\n    opacity: 1;\n    display: block;\n    width: 100%;\n    height: 100%;\n    border-radius: 50%;\n    background-color: currentColor;\n  }\n\n  & ."," {\n    opacity: 0;\n    animation-name: ",";\n    animation-duration: ","ms;\n    animation-timing-function: ",";\n  }\n\n  & ."," {\n    position: absolute;\n    /* @noflip */\n    left: 0px;\n    top: 0;\n    animation-name: ",";\n    animation-duration: 2500ms;\n    animation-timing-function: ",";\n    animation-iteration-count: infinite;\n    animation-delay: 200ms;\n  }\n"]))),Rk.rippleVisible,Dk,550,(function(e){return e.theme.transitions.easing.easeInOut}),Rk.ripplePulsate,(function(e){return e.theme.transitions.duration.shorter}),Rk.child,Rk.childLeaving,Ok,550,(function(e){return e.theme.transitions.easing.easeInOut}),Rk.childPulsate,Mk,(function(e){return e.theme.transitions.easing.easeInOut})),Lk=e.forwardRef((function(t,n){var r=Ww({props:t,name:"MuiTouchRipple"}),a=r.center,i=void 0!==a&&a,s=r.classes,u=void 0===s?{}:s,c=r.className,l=Sy(r,Ak),f=o(e.useState([]),2),h=f[0],p=f[1],d=e.useRef(0),v=e.useRef(null);e.useEffect((function(){v.current&&(v.current(),v.current=null)}),[h]);var m=e.useRef(!1),y=e.useRef(null),g=e.useRef(null),b=e.useRef(null);e.useEffect((function(){return function(){clearTimeout(y.current)}}),[]);var x=e.useCallback((function(e){var t=e.pulsate,n=e.rippleX,r=e.rippleY,a=e.rippleSize,i=e.cb;p((function(e){return[].concat(S(e),[(0,vk.jsx)(Pk,{classes:{ripple:Ty(u.ripple,Rk.ripple),rippleVisible:Ty(u.rippleVisible,Rk.rippleVisible),ripplePulsate:Ty(u.ripplePulsate,Rk.ripplePulsate),child:Ty(u.child,Rk.child),childLeaving:Ty(u.childLeaving,Rk.childLeaving),childPulsate:Ty(u.childPulsate,Rk.childPulsate)},timeout:550,pulsate:t,rippleX:n,rippleY:r,rippleSize:a},d.current)])})),d.current+=1,v.current=i}),[u]),w=e.useCallback((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,r=t.pulsate,a=void 0!==r&&r,o=t.center,s=void 0===o?i||t.pulsate:o,u=t.fakeElement,c=void 0!==u&&u;if("mousedown"===(null==e?void 0:e.type)&&m.current)m.current=!1;else{"touchstart"===(null==e?void 0:e.type)&&(m.current=!0);var l,f,h,p=c?null:b.current,d=p?p.getBoundingClientRect():{width:0,height:0,left:0,top:0};if(s||void 0===e||0===e.clientX&&0===e.clientY||!e.clientX&&!e.touches)l=Math.round(d.width/2),f=Math.round(d.height/2);else{var v=e.touches&&e.touches.length>0?e.touches[0]:e,w=v.clientX,k=v.clientY;l=Math.round(w-d.left),f=Math.round(k-d.top)}if(s)(h=Math.sqrt((2*Math.pow(d.width,2)+Math.pow(d.height,2))/3))%2===0&&(h+=1);else{var E=2*Math.max(Math.abs((p?p.clientWidth:0)-l),l)+2,S=2*Math.max(Math.abs((p?p.clientHeight:0)-f),f)+2;h=Math.sqrt(Math.pow(E,2)+Math.pow(S,2))}null!=e&&e.touches?null===g.current&&(g.current=function(){x({pulsate:a,rippleX:l,rippleY:f,rippleSize:h,cb:n})},y.current=setTimeout((function(){g.current&&(g.current(),g.current=null)}),80)):x({pulsate:a,rippleX:l,rippleY:f,rippleSize:h,cb:n})}}),[i,x]),k=e.useCallback((function(){w({},{pulsate:!0})}),[w]),E=e.useCallback((function(e,t){if(clearTimeout(y.current),"touchend"===(null==e?void 0:e.type)&&g.current)return g.current(),g.current=null,void(y.current=setTimeout((function(){E(e,t)})));g.current=null,p((function(e){return e.length>0?e.slice(1):e})),v.current=t}),[]);return e.useImperativeHandle(n,(function(){return{pulsate:k,start:w,stop:E}}),[k,w,E]),(0,vk.jsx)(Fk,Cy({className:Ty(u.root,Rk.root,c),ref:b},l,{children:(0,vk.jsx)(lk,{component:null,exit:!0,children:h})}))})),Bk=Lk;function Vk(e){return xk("MuiButtonBase",e)}var zk,Uk=wk("MuiButtonBase",["root","disabled","focusVisible"]),Wk=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],jk=Mw("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:function(e,t){return t.root}})((C(zk={display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"}},"&.".concat(Uk.disabled),{pointerEvents:"none",cursor:"default"}),C(zk,"@media print",{colorAdjust:"exact"}),zk)),Gk=e.forwardRef((function(t,n){var r=Ww({props:t,name:"MuiButtonBase"}),a=r.action,i=r.centerRipple,s=void 0!==i&&i,u=r.children,c=r.className,l=r.component,f=void 0===l?"button":l,h=r.disabled,p=void 0!==h&&h,d=r.disableRipple,v=void 0!==d&&d,m=r.disableTouchRipple,y=void 0!==m&&m,g=r.focusRipple,b=void 0!==g&&g,x=r.LinkComponent,w=void 0===x?"a":x,k=r.onBlur,E=r.onClick,S=r.onContextMenu,C=r.onDragLeave,I=r.onFocus,T=r.onFocusVisible,N=r.onKeyDown,_=r.onKeyUp,R=r.onMouseDown,A=r.onMouseLeave,D=r.onMouseUp,O=r.onTouchEnd,M=r.onTouchMove,F=r.onTouchStart,P=r.tabIndex,L=void 0===P?0:P,B=r.TouchRippleProps,V=r.touchRippleRef,z=r.type,U=Sy(r,Wk),W=e.useRef(null),j=e.useRef(null),G=Hw(j,V),H=nk(),q=H.isFocusVisibleRef,K=H.onFocus,X=H.onBlur,$=H.ref,Q=o(e.useState(!1),2),Y=Q[0],J=Q[1];p&&Y&&J(!1),e.useImperativeHandle(a,(function(){return{focusVisible:function(){J(!0),W.current.focus()}}}),[]);var Z=o(e.useState(!1),2),ee=Z[0],te=Z[1];e.useEffect((function(){te(!0)}),[]);var ne=ee&&!v&&!p;function re(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y;return Xw((function(r){return t&&t(r),!n&&j.current&&j.current[e](r),!0}))}e.useEffect((function(){Y&&b&&!v&&ee&&j.current.pulsate()}),[v,b,Y,ee]);var ae=re("start",R),ie=re("stop",S),oe=re("stop",C),se=re("stop",D),ue=re("stop",(function(e){Y&&e.preventDefault(),A&&A(e)})),ce=re("start",F),le=re("stop",O),fe=re("stop",M),he=re("stop",(function(e){X(e),!1===q.current&&J(!1),k&&k(e)}),!1),pe=Xw((function(e){W.current||(W.current=e.currentTarget),K(e),!0===q.current&&(J(!0),T&&T(e)),I&&I(e)})),de=function(){var e=W.current;return f&&"button"!==f&&!("A"===e.tagName&&e.href)},ve=e.useRef(!1),me=Xw((function(e){b&&!ve.current&&Y&&j.current&&" "===e.key&&(ve.current=!0,j.current.stop(e,(function(){j.current.start(e)}))),e.target===e.currentTarget&&de()&&" "===e.key&&e.preventDefault(),N&&N(e),e.target===e.currentTarget&&de()&&"Enter"===e.key&&!p&&(e.preventDefault(),E&&E(e))})),ye=Xw((function(e){b&&" "===e.key&&j.current&&Y&&!e.defaultPrevented&&(ve.current=!1,j.current.stop(e,(function(){j.current.pulsate(e)}))),_&&_(e),E&&e.target===e.currentTarget&&de()&&" "===e.key&&!e.defaultPrevented&&E(e)})),ge=f;"button"===ge&&(U.href||U.to)&&(ge=w);var be={};"button"===ge?(be.type=void 0===z?"button":z,be.disabled=p):(U.href||U.to||(be.role="button"),p&&(be["aria-disabled"]=p));var xe=Hw($,W),we=Hw(n,xe);var ke=Cy({},r,{centerRipple:s,component:f,disabled:p,disableRipple:v,disableTouchRipple:y,focusRipple:b,tabIndex:L,focusVisible:Y}),Ee=function(e){var t=e.disabled,n=e.focusVisible,r=e.focusVisibleClassName,a=_y({root:["root",t&&"disabled",n&&"focusVisible"]},Vk,e.classes);return n&&r&&(a.root+=" ".concat(r)),a}(ke);return(0,vk.jsxs)(jk,Cy({as:ge,className:Ty(Ee.root,c),ownerState:ke,onBlur:he,onClick:E,onContextMenu:ie,onFocus:pe,onKeyDown:me,onKeyUp:ye,onMouseDown:ae,onMouseLeave:ue,onMouseUp:se,onDragLeave:oe,onTouchEnd:le,onTouchMove:fe,onTouchStart:ce,ref:we,tabIndex:p?-1:L,type:z},be,U,{children:[u,ne?(0,vk.jsx)(Bk,Cy({ref:G,center:s},B)):null]}))})),Hk=Gk,qk=Nb;function Kk(e){return xk("MuiButton",e)}var Xk=wk("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]);var $k=e.createContext({}),Qk=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Yk=function(e){return Cy({},"small"===e.size&&{"& > *:nth-of-type(1)":{fontSize:18}},"medium"===e.size&&{"& > *:nth-of-type(1)":{fontSize:20}},"large"===e.size&&{"& > *:nth-of-type(1)":{fontSize:22}})},Jk=Mw(Hk,{shouldForwardProp:function(e){return Dw(e)||"classes"===e},name:"MuiButton",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t[n.variant],t["".concat(n.variant).concat(qk(n.color))],t["size".concat(qk(n.size))],t["".concat(n.variant,"Size").concat(qk(n.size))],"inherit"===n.color&&t.colorInherit,n.disableElevation&&t.disableElevation,n.fullWidth&&t.fullWidth]}})((function(e){var t,n,r,a=e.theme,i=e.ownerState;return Cy({},a.typography.button,(C(t={minWidth:64,padding:"6px 16px",borderRadius:(a.vars||a).shape.borderRadius,transition:a.transitions.create(["background-color","box-shadow","border-color","color"],{duration:a.transitions.duration.short}),"&:hover":Cy({textDecoration:"none",backgroundColor:a.vars?"rgba(".concat(a.vars.palette.text.primaryChannel," / ").concat(a.vars.palette.action.hoverOpacity,")"):Fy(a.palette.text.primary,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"text"===i.variant&&"inherit"!==i.color&&{backgroundColor:a.vars?"rgba(".concat(a.vars.palette[i.color].mainChannel," / ").concat(a.vars.palette.action.hoverOpacity,")"):Fy(a.palette[i.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"outlined"===i.variant&&"inherit"!==i.color&&{border:"1px solid ".concat((a.vars||a).palette[i.color].main),backgroundColor:a.vars?"rgba(".concat(a.vars.palette[i.color].mainChannel," / ").concat(a.vars.palette.action.hoverOpacity,")"):Fy(a.palette[i.color].main,a.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},"contained"===i.variant&&{backgroundColor:(a.vars||a).palette.grey.A100,boxShadow:(a.vars||a).shadows[4],"@media (hover: none)":{boxShadow:(a.vars||a).shadows[2],backgroundColor:(a.vars||a).palette.grey[300]}},"contained"===i.variant&&"inherit"!==i.color&&{backgroundColor:(a.vars||a).palette[i.color].dark,"@media (hover: none)":{backgroundColor:(a.vars||a).palette[i.color].main}}),"&:active":Cy({},"contained"===i.variant&&{boxShadow:(a.vars||a).shadows[8]})},"&.".concat(Xk.focusVisible),Cy({},"contained"===i.variant&&{boxShadow:(a.vars||a).shadows[6]})),C(t,"&.".concat(Xk.disabled),Cy({color:(a.vars||a).palette.action.disabled},"outlined"===i.variant&&{border:"1px solid ".concat((a.vars||a).palette.action.disabledBackground)},"outlined"===i.variant&&"secondary"===i.color&&{border:"1px solid ".concat((a.vars||a).palette.action.disabled)},"contained"===i.variant&&{color:(a.vars||a).palette.action.disabled,boxShadow:(a.vars||a).shadows[0],backgroundColor:(a.vars||a).palette.action.disabledBackground})),t),"text"===i.variant&&{padding:"6px 8px"},"text"===i.variant&&"inherit"!==i.color&&{color:(a.vars||a).palette[i.color].main},"outlined"===i.variant&&{padding:"5px 15px",border:"1px solid currentColor"},"outlined"===i.variant&&"inherit"!==i.color&&{color:(a.vars||a).palette[i.color].main,border:a.vars?"1px solid rgba(".concat(a.vars.palette[i.color].mainChannel," / 0.5)"):"1px solid ".concat(Fy(a.palette[i.color].main,.5))},"contained"===i.variant&&{color:a.vars?a.vars.palette.text.primary:null==(n=(r=a.palette).getContrastText)?void 0:n.call(r,a.palette.grey[300]),backgroundColor:(a.vars||a).palette.grey[300],boxShadow:(a.vars||a).shadows[2]},"contained"===i.variant&&"inherit"!==i.color&&{color:(a.vars||a).palette[i.color].contrastText,backgroundColor:(a.vars||a).palette[i.color].main},"inherit"===i.color&&{color:"inherit",borderColor:"currentColor"},"small"===i.size&&"text"===i.variant&&{padding:"4px 5px",fontSize:a.typography.pxToRem(13)},"large"===i.size&&"text"===i.variant&&{padding:"8px 11px",fontSize:a.typography.pxToRem(15)},"small"===i.size&&"outlined"===i.variant&&{padding:"3px 9px",fontSize:a.typography.pxToRem(13)},"large"===i.size&&"outlined"===i.variant&&{padding:"7px 21px",fontSize:a.typography.pxToRem(15)},"small"===i.size&&"contained"===i.variant&&{padding:"4px 10px",fontSize:a.typography.pxToRem(13)},"large"===i.size&&"contained"===i.variant&&{padding:"8px 22px",fontSize:a.typography.pxToRem(15)},i.fullWidth&&{width:"100%"})}),(function(e){var t;return e.ownerState.disableElevation&&(C(t={boxShadow:"none","&:hover":{boxShadow:"none"}},"&.".concat(Xk.focusVisible),{boxShadow:"none"}),C(t,"&:active",{boxShadow:"none"}),C(t,"&.".concat(Xk.disabled),{boxShadow:"none"}),t)})),Zk=Mw("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:function(e,t){var n=e.ownerState;return[t.startIcon,t["iconSize".concat(qk(n.size))]]}})((function(e){var t=e.ownerState;return Cy({display:"inherit",marginRight:8,marginLeft:-4},"small"===t.size&&{marginLeft:-2},Yk(t))})),eE=Mw("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:function(e,t){var n=e.ownerState;return[t.endIcon,t["iconSize".concat(qk(n.size))]]}})((function(e){var t=e.ownerState;return Cy({display:"inherit",marginRight:-4,marginLeft:8},"small"===t.size&&{marginRight:-2},Yk(t))})),tE=e.forwardRef((function(t,n){var r=e.useContext($k),a=Ww({props:Ny(r,t),name:"MuiButton"}),i=a.children,o=a.color,s=void 0===o?"primary":o,u=a.component,c=void 0===u?"button":u,l=a.className,f=a.disabled,h=void 0!==f&&f,p=a.disableElevation,d=void 0!==p&&p,v=a.disableFocusRipple,m=void 0!==v&&v,y=a.endIcon,g=a.focusVisibleClassName,b=a.fullWidth,x=void 0!==b&&b,w=a.size,k=void 0===w?"medium":w,E=a.startIcon,S=a.type,C=a.variant,I=void 0===C?"text":C,T=Sy(a,Qk),N=Cy({},a,{color:s,component:c,disabled:h,disableElevation:d,disableFocusRipple:m,fullWidth:x,size:k,type:S,variant:I}),_=function(e){var t=e.color,n=e.disableElevation,r=e.fullWidth,a=e.size,i=e.variant,o=e.classes;return Cy({},o,_y({root:["root",i,"".concat(i).concat(qk(t)),"size".concat(qk(a)),"".concat(i,"Size").concat(qk(a)),"inherit"===t&&"colorInherit",n&&"disableElevation",r&&"fullWidth"],label:["label"],startIcon:["startIcon","iconSize".concat(qk(a))],endIcon:["endIcon","iconSize".concat(qk(a))]},Kk,o))}(N),R=E&&(0,vk.jsx)(Zk,{className:_.startIcon,ownerState:N,children:E}),A=y&&(0,vk.jsx)(eE,{className:_.endIcon,ownerState:N,children:y});return(0,vk.jsxs)(Jk,Cy({ownerState:N,className:Ty(l,r.className),component:c,disabled:h,focusRipple:!m,focusVisibleClassName:Ty(_.focusVisible,g),ref:n,type:S},T,{classes:_,children:[R,i,A]}))})),nE=tE;var rE=function(){return(0,vk.jsx)("div",{style:{display:"flex",justifyContent:"center",height:"100vh",alignItems:"center"},children:(0,vk.jsx)(nE,{style:{padding:"30px",fontSize:"20px",fontWeight:"600"},onClick:function(){var e=new ar;!function(e,t,n){ua.apply(this,arguments)}(Ey,e)},variant:"contained",children:"Sign In With Google"})})};var aE=function(){return(0,vk.jsx)("div",{style:{display:"flex",justifyContent:"center",position:"fixed",width:"100%",backgroundColor:"#FAFAFA",top:0,borderBottom:"solid 1px lightgray",zIndex:"10"},children:(0,vk.jsx)(nE,{style:{padding:"20px",fontSize:"15px",borderRadius:"0",fontWeight:"600"},onClick:function(){return function(e){return $(e).signOut()}(Ey)},children:"Sign Out"})})},iE=n(164);function oE(e){var t=function(e){return e&&e.ownerDocument||document}(e);return t.defaultView||window}var sE=["onChange","maxRows","minRows","style","value"];function uE(e,t){return parseInt(e[t],10)||0}var cE={visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"};function lE(e){return void 0===e||null===e||0===Object.keys(e).length}var fE=e.forwardRef((function(t,n){var r=t.onChange,a=t.maxRows,i=t.minRows,s=void 0===i?1:i,u=t.style,c=t.value,l=Sy(t,sE),f=e.useRef(null!=c).current,h=e.useRef(null),p=Gw(n,h),d=e.useRef(null),v=e.useRef(0),m=o(e.useState({}),2),y=m[0],g=m[1],b=e.useCallback((function(){var e=h.current,n=oE(e).getComputedStyle(e);if("0px"===n.width)return{};var r=d.current;r.style.width=n.width,r.value=e.value||t.placeholder||"x","\n"===r.value.slice(-1)&&(r.value+=" ");var i=n["box-sizing"],o=uE(n,"padding-bottom")+uE(n,"padding-top"),u=uE(n,"border-bottom-width")+uE(n,"border-top-width"),c=r.scrollHeight;r.value="x";var l=r.scrollHeight,f=c;return s&&(f=Math.max(Number(s)*l,f)),a&&(f=Math.min(Number(a)*l,f)),{outerHeightStyle:(f=Math.max(f,l))+("border-box"===i?o+u:0),overflow:Math.abs(f-c)<=1}}),[a,s,t.placeholder]),x=function(e,t){var n=t.outerHeightStyle,r=t.overflow;return v.current<20&&(n>0&&Math.abs((e.outerHeightStyle||0)-n)>1||e.overflow!==r)?(v.current+=1,{overflow:r,outerHeightStyle:n}):e},w=e.useCallback((function(){var e=b();lE(e)||g((function(t){return x(t,e)}))}),[b]);e.useEffect((function(){var e,t=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function r(){for(var r=this,a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];var s=function(){e.apply(r,i)};clearTimeout(t),t=setTimeout(s,n)}return r.clear=function(){clearTimeout(t)},r}((function(){v.current=0,h.current&&function(){var e=b();lE(e)||(0,iE.flushSync)((function(){g((function(t){return x(t,e)}))}))}()})),n=oE(h.current);return n.addEventListener("resize",t),"undefined"!==typeof ResizeObserver&&(e=new ResizeObserver(t)).observe(h.current),function(){t.clear(),n.removeEventListener("resize",t),e&&e.disconnect()}})),qw((function(){w()})),e.useEffect((function(){v.current=0}),[c]);return(0,vk.jsxs)(e.Fragment,{children:[(0,vk.jsx)("textarea",Cy({value:c,onChange:function(e){v.current=0,f||w(),r&&r(e)},ref:p,rows:s,style:Cy({height:y.outerHeightStyle,overflow:y.overflow?"hidden":null},u)},l)),(0,vk.jsx)("textarea",{"aria-hidden":!0,className:t.className,readOnly:!0,ref:d,tabIndex:-1,style:Cy({},cE,u,{padding:0})})]})})),hE=fE;var pE=function(e){return"string"===typeof e};var dE=e.createContext();var vE=qw;function mE(e){var t=e.styles,n=e.defaultTheme,r=void 0===n?{}:n,a="function"===typeof t?function(e){return t(void 0===(n=e)||null===n||0===Object.keys(n).length?r:e);var n}:t;return(0,vk.jsx)(hk,{styles:a})}var yE=function(e){return(0,vk.jsx)(mE,Cy({},e,{defaultTheme:Aw}))};function gE(e){return null!=e&&!(Array.isArray(e)&&0===e.length)}function bE(e){return xk("MuiInputBase",e)}var xE=wk("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),wE=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","startAdornment","type","value"],kE=function(e,t){var n=e.ownerState;return[t.root,n.formControl&&t.formControl,n.startAdornment&&t.adornedStart,n.endAdornment&&t.adornedEnd,n.error&&t.error,"small"===n.size&&t.sizeSmall,n.multiline&&t.multiline,n.color&&t["color".concat(qk(n.color))],n.fullWidth&&t.fullWidth,n.hiddenLabel&&t.hiddenLabel]},EE=function(e,t){var n=e.ownerState;return[t.input,"small"===n.size&&t.inputSizeSmall,n.multiline&&t.inputMultiline,"search"===n.type&&t.inputTypeSearch,n.startAdornment&&t.inputAdornedStart,n.endAdornment&&t.inputAdornedEnd,n.hiddenLabel&&t.inputHiddenLabel]},SE=Mw("div",{name:"MuiInputBase",slot:"Root",overridesResolver:kE})((function(e){var t=e.theme,n=e.ownerState;return Cy({},t.typography.body1,C({color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center"},"&.".concat(xE.disabled),{color:(t.vars||t).palette.text.disabled,cursor:"default"}),n.multiline&&Cy({padding:"4px 0 5px"},"small"===n.size&&{paddingTop:1}),n.fullWidth&&{width:"100%"})})),CE=Mw("input",{name:"MuiInputBase",slot:"Input",overridesResolver:EE})((function(e){var t,n=e.theme,r=e.ownerState,a="light"===n.palette.mode,i=Cy({color:"currentColor"},n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:a?.42:.5},{transition:n.transitions.create("opacity",{duration:n.transitions.duration.shorter})}),o={opacity:"0 !important"},s=n.vars?{opacity:n.vars.opacity.inputPlaceholder}:{opacity:a?.42:.5};return Cy((C(t={font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":i,"&::-moz-placeholder":i,"&:-ms-input-placeholder":i,"&::-ms-input-placeholder":i,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"}},"label[data-shrink=false] + .".concat(xE.formControl," &"),{"&::-webkit-input-placeholder":o,"&::-moz-placeholder":o,"&:-ms-input-placeholder":o,"&::-ms-input-placeholder":o,"&:focus::-webkit-input-placeholder":s,"&:focus::-moz-placeholder":s,"&:focus:-ms-input-placeholder":s,"&:focus::-ms-input-placeholder":s}),C(t,"&.".concat(xE.disabled),{opacity:1,WebkitTextFillColor:(n.vars||n).palette.text.disabled}),C(t,"&:-webkit-autofill",{animationDuration:"5000s",animationName:"mui-auto-fill"}),t),"small"===r.size&&{paddingTop:1},r.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},"search"===r.type&&{MozAppearance:"textfield"})})),IE=(0,vk.jsx)(yE,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),TE=e.forwardRef((function(t,n){var r=Ww({props:t,name:"MuiInputBase"}),a=r["aria-describedby"],i=r.autoComplete,s=r.autoFocus,u=r.className,c=r.components,l=void 0===c?{}:c,f=r.componentsProps,h=void 0===f?{}:f,p=r.defaultValue,d=r.disabled,v=r.disableInjectingGlobalStyles,m=r.endAdornment,y=r.fullWidth,g=void 0!==y&&y,b=r.id,x=r.inputComponent,w=void 0===x?"input":x,k=r.inputProps,E=void 0===k?{}:k,S=r.inputRef,C=r.maxRows,I=r.minRows,T=r.multiline,N=void 0!==T&&T,_=r.name,R=r.onBlur,A=r.onChange,D=r.onClick,O=r.onFocus,M=r.onKeyDown,F=r.onKeyUp,P=r.placeholder,L=r.readOnly,B=r.renderSuffix,V=r.rows,z=r.startAdornment,U=r.type,W=void 0===U?"text":U,j=r.value,G=Sy(r,wE),H=null!=E.value?E.value:j,q=e.useRef(null!=H).current,K=e.useRef(),X=e.useCallback((function(e){0}),[]),$=Hw(E.ref,X),Q=Hw(S,$),Y=Hw(K,Q),J=o(e.useState(!1),2),Z=J[0],ee=J[1],te=e.useContext(dE);var ne=function(e){var t=e.props,n=e.states,r=e.muiFormControl;return n.reduce((function(e,n){return e[n]=t[n],r&&"undefined"===typeof t[n]&&(e[n]=r[n]),e}),{})}({props:r,muiFormControl:te,states:["color","disabled","error","hiddenLabel","size","required","filled"]});ne.focused=te?te.focused:Z,e.useEffect((function(){!te&&d&&Z&&(ee(!1),R&&R())}),[te,d,Z,R]);var re=te&&te.onFilled,ae=te&&te.onEmpty,ie=e.useCallback((function(e){!function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e&&(gE(e.value)&&""!==e.value||t&&gE(e.defaultValue)&&""!==e.defaultValue)}(e)?ae&&ae():re&&re()}),[re,ae]);vE((function(){q&&ie({value:H})}),[H,ie,q]);e.useEffect((function(){ie(K.current)}),[]);var oe=w,se=E;N&&"input"===oe&&(se=Cy(V?{type:void 0,minRows:V,maxRows:V}:{type:void 0,maxRows:C,minRows:I},se),oe=hE);e.useEffect((function(){te&&te.setAdornedStart(Boolean(z))}),[te,z]);var ue=Cy({},r,{color:ne.color||"primary",disabled:ne.disabled,endAdornment:m,error:ne.error,focused:ne.focused,formControl:te,fullWidth:g,hiddenLabel:ne.hiddenLabel,multiline:N,size:ne.size,startAdornment:z,type:W}),ce=function(e){var t=e.classes,n=e.color,r=e.disabled,a=e.error,i=e.endAdornment,o=e.focused,s=e.formControl,u=e.fullWidth,c=e.hiddenLabel,l=e.multiline,f=e.size,h=e.startAdornment,p=e.type;return _y({root:["root","color".concat(qk(n)),r&&"disabled",a&&"error",u&&"fullWidth",o&&"focused",s&&"formControl","small"===f&&"sizeSmall",l&&"multiline",h&&"adornedStart",i&&"adornedEnd",c&&"hiddenLabel"],input:["input",r&&"disabled","search"===p&&"inputTypeSearch",l&&"inputMultiline","small"===f&&"inputSizeSmall",c&&"inputHiddenLabel",h&&"inputAdornedStart",i&&"inputAdornedEnd"]},bE,t)}(ue),le=l.Root||SE,fe=h.root||{},he=l.Input||CE;return se=Cy({},se,h.input),(0,vk.jsxs)(e.Fragment,{children:[!v&&IE,(0,vk.jsxs)(le,Cy({},fe,!pE(le)&&{ownerState:Cy({},ue,fe.ownerState)},{ref:n,onClick:function(e){K.current&&e.currentTarget===e.target&&K.current.focus(),D&&D(e)}},G,{className:Ty(ce.root,fe.className,u),children:[z,(0,vk.jsx)(dE.Provider,{value:null,children:(0,vk.jsx)(he,Cy({ownerState:ue,"aria-invalid":ne.error,"aria-describedby":a,autoComplete:i,autoFocus:s,defaultValue:p,disabled:ne.disabled,id:b,onAnimationStart:function(e){ie("mui-auto-fill-cancel"===e.animationName?K.current:{value:"x"})},name:_,placeholder:P,readOnly:L,required:ne.required,rows:V,value:H,onKeyDown:M,onKeyUp:F,type:W},se,!pE(he)&&{as:oe,ownerState:Cy({},ue,se.ownerState)},{ref:Y,className:Ty(ce.input,se.className),onBlur:function(e){R&&R(e),E.onBlur&&E.onBlur(e),te&&te.onBlur?te.onBlur(e):ee(!1)},onChange:function(e){if(!q){var t=e.target||K.current;if(null==t)throw new Error(Ry(1));ie({value:t.value})}for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];E.onChange&&E.onChange.apply(E,[e].concat(r)),A&&A.apply(void 0,[e].concat(r))},onFocus:function(e){ne.disabled?e.stopPropagation():(O&&O(e),E.onFocus&&E.onFocus(e),te&&te.onFocus?te.onFocus(e):ee(!0))}}))}),m,B?B(Cy({},ne,{startAdornment:z})):null]}))]})})),NE=TE;function _E(e){return xk("MuiInput",e)}var RE=Cy({},xE,wk("MuiInput",["root","underline","input"])),AE=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","type"],DE=Mw(SE,{shouldForwardProp:function(e){return Dw(e)||"classes"===e},name:"MuiInput",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[].concat(S(kE(e,t)),[!n.disableUnderline&&t.underline])}})((function(e){var t,n=e.theme,r=e.ownerState,a="light"===n.palette.mode?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return n.vars&&(a="rgba(".concat(n.vars.palette.common.onBackgroundChannel," / ").concat(n.vars.opacity.inputUnderline,")")),Cy({position:"relative"},r.formControl&&{"label + &":{marginTop:16}},!r.disableUnderline&&(C(t={"&:after":{borderBottom:"2px solid ".concat((n.vars||n).palette[r.color].main),left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:n.transitions.create("transform",{duration:n.transitions.duration.shorter,easing:n.transitions.easing.easeOut}),pointerEvents:"none"}},"&.".concat(RE.focused,":after"),{transform:"scaleX(1) translateX(0)"}),C(t,"&.".concat(RE.error,":after"),{borderBottomColor:(n.vars||n).palette.error.main,transform:"scaleX(1)"}),C(t,"&:before",{borderBottom:"1px solid ".concat(a),left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:n.transitions.create("border-bottom-color",{duration:n.transitions.duration.shorter}),pointerEvents:"none"}),C(t,"&:hover:not(.".concat(RE.disabled,"):before"),{borderBottom:"2px solid ".concat((n.vars||n).palette.text.primary),"@media (hover: none)":{borderBottom:"1px solid ".concat(a)}}),C(t,"&.".concat(RE.disabled,":before"),{borderBottomStyle:"dotted"}),t))})),OE=Mw(CE,{name:"MuiInput",slot:"Input",overridesResolver:EE})({}),ME=e.forwardRef((function(e,t){var n=Ww({props:e,name:"MuiInput"}),r=n.disableUnderline,a=n.components,i=void 0===a?{}:a,o=n.componentsProps,s=n.fullWidth,u=void 0!==s&&s,c=n.inputComponent,l=void 0===c?"input":c,f=n.multiline,h=void 0!==f&&f,p=n.type,d=void 0===p?"text":p,v=Sy(n,AE),m=function(e){var t=e.classes;return Cy({},t,_y({root:["root",!e.disableUnderline&&"underline"],input:["input"]},_E,t))}(n),y={root:{ownerState:{disableUnderline:r}}},g=o?bb(o,y):y;return(0,vk.jsx)(NE,Cy({components:Cy({Root:DE,Input:OE},i),componentsProps:g,fullWidth:u,inputComponent:l,multiline:h,ref:t,type:d},v,{classes:m}))}));ME.muiName="Input";var FE=ME,PE=function(e,t){return(PE=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function LE(e,t){function n(){this.constructor=e}PE(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function BE(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function VE(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var zE=function(){function e(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return e.prototype.setPlatform=function(e,t){null!=this.platform&&console.warn("Platform "+this.platformName+" has already been set. Overwriting the platform with "+t+"."),this.platformName=e,this.platform=t},e.prototype.registerFlag=function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL "+e+": "+r+"."),this.set(e,r)}},e.prototype.get=function(e){return e in this.flags||(this.flags[e]=this.evaluateFlag(e)),this.flags[e]},e.prototype.getNumber=function(e){return this.get(e)},e.prototype.getBool=function(e){return this.get(e)},e.prototype.getFlags=function(){return this.flags},Object.defineProperty(e.prototype,"features",{get:function(){return this.flags},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag "+e+" as it has not been registered.");this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)},e.prototype.evaluateFlag=function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '"+e+"': no evaluation function found.");return this.flagRegistry[e].evaluationFn()},e.prototype.setFlags=function(e){this.flags=Object.assign({},e)},e.prototype.reset=function(){this.flags={},this.urlFlags={},this.populateURLFlags()},e.prototype.populateURLFlags=function(){var e=this;if(void 0!==this.global&&void 0!==this.global.location&&void 0!==this.global.location.search){var t,n,r=(t=this.global.location.search,n={},t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return UE(n,t[0],t[1]),t.join("=")})),n);"tfjsflags"in r&&r.tfjsflags.split(",").forEach((function(t){var n=t.split(":"),r=n[0],a=n[1];e.urlFlags[r]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if(""+ +t===t)return+t;throw new Error("Could not parse value flag value "+t+" for flag "+e+".")}(r,a)}))}},e}();function UE(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function WE(){return jE}var jE=null,GE=new Map,HE=new Map;function qE(e,t){var n=YE(e,t);return GE.get(n)}function KE(e){return HE.get(e)}function XE(e){for(var t=GE.entries(),n=[];;){var r=t.next(),a=r.done,i=r.value;if(a)break;var o=i[0],s=i[1];o.split("_")[0]===e&&n.push(s)}return n}function $E(e){var t=e.kernelName,n=e.backendName,r=YE(t,n);if(GE.has(r))throw new Error("The kernel '"+t+"' for backend '"+n+"' is already registered");GE.set(r,e)}function QE(e){var t=e.kernelName;HE.has(t)&&console.warn("Overriding the gradient for '"+t+"'"),HE.set(t,e)}function YE(e,t){return t+"_"+e}function JE(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function ZE(e,t,n){return Math.max(e,Math.min(t,n))}function eS(e){return e%2==0?e:e+1}function tS(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function nS(e,t){if(!e)throw new Error("string"==typeof t?t:t())}function rS(e,t,n){void 0===n&&(n=""),nS(sS(e,t),(function(){return n+" Shapes "+e+" and "+t+" must match"}))}function aS(e){nS(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function iS(e,t,n){if(void 0===t&&(t=[]),void 0===n&&(n=!1),null==t&&(t=[]),Array.isArray(e)||wS(e)&&!n)for(var r=0;r<e.length;++r)iS(e[r],t,n);else t.push(e);return t}function oS(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function sS(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function uS(e){return e%1==0}function cS(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function lS(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function fS(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function hS(e,t,n){return void 0===t&&(t=function(e){return 0}),new Promise((function(r,a){var i=0;!function o(){if(e())r();else{i++;var s=t(i);null!=n&&i>=n?a():setTimeout(o,s)}}()}))}function pS(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. Found -1 at dim "+r+" and dim "+a);r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found "+e[a]+" at dim "+a);if(-1===r){if(t>0&&t!==n)throw Error("Size("+t+") must match the product of shape "+e);return e}if(0===n)throw Error("Cannot infer the missing size in ["+e+"] when there are 0 elements");if(t%n!=0)throw Error("The implicit shape can't be a fractional number. Got "+t+" / "+n);var i=e.slice();return i[r]=t/n,i}function dS(e,t){var n=t.length;return nS((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-"+n+", "+n+") but got axis "+e})),nS(e.every((function(e){return uS(e)})),(function(){return"All values in axis param must be integers but got axis "+e})),e.map((function(e){return e<0?n+e:e}))}function vS(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:dS(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis "+s+" since its dim '"+e[s]+"' is not 1");(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function mS(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type "+e);n=new Uint8Array(t)}return n}function yS(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type "+e);n=new Array(t)}return n}function gS(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type "+t+" being uploaded contains "+r+".")}}function bS(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function xS(e,t){return"complex64"!==t&&("float32"!==t||"complex64"===e)&&("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)}function wS(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function kS(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype "+e)}function ES(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}function SS(e){return"string"==typeof e||e instanceof String}function CS(e){return"boolean"==typeof e}function IS(e){return"number"==typeof e}function TS(e){return Array.isArray(e)?TS(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":IS(e)?"float32":SS(e)?"string":CS(e)?"bool":"float32"}function NS(e){return!!(e&&e.constructor&&e.call&&e.apply)}function _S(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}function RS(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function AS(e,t,n){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=iS(e)),n&&gS(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var r=new Uint8Array(e.length),a=0;a<r.length;++a)0!==Math.round(e[a])&&(r[a]=1);return r}throw new Error("Unknown data type "+t)}function DS(e,t){if(0===e.length)return t[0];var n=e.reduce((function(e,t){return e*t}));if(0===n)return[];if(n!==t.length)throw new Error("["+e+"] does not match the input size.");return function e(t,n,r){var a=new Array;if(1===n.length)for(var i=n[0],o=0;o<i;o++)a[o]=r[t+o];else{i=n[0];var s=n.slice(1),u=s.reduce((function(e,t){return e*t}));for(o=0;o<i;o++)a[o]=e(t+o*u,s,r)}return a}(0,e,t)}function OS(e,t){for(var n=MS(e,t),r=0;r<n.length;r++)n[r]=1;return n}function MS(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type "+t)}function FS(){return WE().platform.now()}function PS(e){e.forEach((function(t){nS(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got shape ["+e+"]."}))}))}function LS(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",WE().platform.encode(e,t)}function BS(e,t){return void 0===t&&(t="utf-8"),t=t||"utf-8",WE().platform.decode(e,t)}function VS(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function zS(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}var US=Object.freeze({shuffle:JE,clamp:ZE,nearestLargerEven:eS,sum:tS,randUniform:function(e,t){var n=Math.random();return t*n+(1-n)*e},distSquared:function(e,t){for(var n=0,r=0;r<e.length;r++){var a=Number(e[r])-Number(t[r]);n+=a*a}return n},assert:nS,assertShapesMatch:rS,assertNonNull:aS,flatten:iS,sizeFromShape:oS,isScalarShape:function(e){return 0===e.length},arraysEqual:sS,isInt:uS,tanh:cS,sizeToSquarishShape:lS,createShuffledIndices:function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return JE(t),t},rightPad:fS,repeatedTry:hS,inferFromImplicitShape:pS,parseAxisParam:dS,squeezeShape:vS,getTypedArrayFromDType:mS,getArrayFromDType:yS,checkConversionForErrors:gS,isValidDtype:bS,hasEncodingLoss:xS,isTypedArray:wS,bytesPerElement:kS,bytesFromStringArray:ES,isString:SS,isBoolean:CS,isNumber:IS,inferDtype:TS,isFunction:NS,nearestDivisor:_S,computeStrides:RS,toTypedArray:AS,toNestedArray:DS,makeOnesTypedArray:OS,makeZerosTypedArray:MS,now:FS,assertNonNegativeIntegerDimensions:PS,fetch:function(e,t){return WE().platform.fetch(e,t)},encodeString:LS,decodeString:BS,locToIndex:VS,indexToLoc:zS}),WS=function(){function e(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new jS)}return e.prototype.profileKernel=function(e,t,n){var r,a=this,i=this.backendTimer.time((function(){r=n()}));return r.forEach((function(n){n.data().then((function(r){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found "+a+" in the result of '"+n+"'"),!0}}(r,n.dtype,e),i.then((function(i){var o="";null!=i.getExtraProfileInfo&&(o=i.getExtraProfileInfo()),a.logger.logKernelProfile(e,n,r,i.kernelMs,t,o)}))}))})),r},e}(),jS=function(){function e(){}return e.prototype.logKernelProfile=function(e,t,n,r,a,i){var o="number"==typeof r?fS(r+"ms",9):r.error,s=fS(e,25),u=t.rank,c=t.size,l=fS(t.shape.toString(),14),f="";for(var h in a){var p=a[h].shape||t.shape,d=p.length;f+=h+": "+d+"D "+(d>0?p:"")+" "}console.log("%c"+s+"\t%c"+o+"\t%c"+u+"D "+l+"\t%c"+c+"\t%c"+f+"\t%c"+i,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")},e}();function GS(e,t,n){return fS(Array.isArray(e)?parseFloat(e[0].toFixed(7))+" + "+parseFloat(e[1].toFixed(7))+"j":SS(e)?"'"+e+"'":"bool"===n?HS(e):parseFloat(e.toFixed(7)).toString(),t)}function HS(e){return 0===e?"false":"true"}function qS(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var KS=function(){function e(e,t,n){var r=this;if(this.dtype=t,this.shape=e.slice(),this.size=oS(e),null!=n){var a=n.length;nS(a===this.size,(function(){return"Length of values '"+a+"' does not match the size inferred by the shape '"+r.size+"'."}))}if("complex64"===t)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=n||yS(t,this.size),this.strides=RS(e)}return e.prototype.set=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];0===n.length&&(n=[0]),nS(n.length===this.rank,(function(){return"The number of provided coordinates ("+n.length+") must match the rank ("+t.rank+")"}));var a=this.locToIndex(n);this.values[a]=e},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=0,r=0,a=e;r<a.length;r++){var i=a[r];if(i<0||i>=this.shape[n]){var o="Requested out of range element at "+e+".   Buffer shape="+this.shape;throw new Error(o)}n++}for(var s=e[e.length-1],u=0;u<e.length-1;++u)s+=this.strides[u]*e[u];return this.values[s]},e.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},e.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return XS().makeTensor(this.values,this.shape,this.dtype)},e}(),XS=null,$S=null,QS=null,YS=function(){function e(e,t,n,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=oS(e),this.strides=RS(e),this.dataId=n,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}return e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),nS(1===this.size,(function(){return"The array must have only 1 element."})),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},e.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},e.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])},e.prototype.as5D=function(e,t,n,r,a){return this.throwIfDisposed(),this.reshape([e,t,n,r,a])},e.prototype.asType=function(e){return this.throwIfDisposed(),$S.cast(this,e)},Object.defineProperty(e.prototype,"rank",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.buffer=function(){return BE(this,void 0,void 0,(function(){var e;return VE(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,$S.buffer(this.shape,this.dtype,e)]}}))}))},e.prototype.bufferSync=function(){return $S.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.array=function(){return BE(this,void 0,void 0,(function(){var e;return VE(this,(function(t){switch(t.label){case 0:return[4,this.data()];case 1:return e=t.sent(),[2,DS(this.shape,e)]}}))}))},e.prototype.arraySync=function(){return DS(this.shape,this.dataSync())},e.prototype.data=function(){return BE(this,void 0,void 0,(function(){var e,t;return VE(this,(function(n){switch(n.label){case 0:return this.throwIfDisposed(),e=XS().read(this.dataId),"string"!==this.dtype?[3,2]:[4,e];case 1:t=n.sent();try{return[2,t.map((function(e){return BS(e)}))]}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}n.label=2;case 2:return[2,e]}}))}))},e.prototype.dataSync=function(){this.throwIfDisposed();var e=XS().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return BS(e)}))}catch(e){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e},e.prototype.bytes=function(){return BE(this,void 0,void 0,(function(){var e;return VE(this,(function(t){switch(t.label){case 0:return this.throwIfDisposed(),[4,XS().read(this.dataId)];case 1:return e=t.sent(),"string"===this.dtype?[2,e]:[2,new Uint8Array(e.buffer)]}}))}))},e.prototype.dispose=function(){this.isDisposed||(XS().disposeTensor(this),this.isDisposedInternal=!0)},Object.defineProperty(e.prototype,"isDisposed",{get:function(){return this.isDisposedInternal},enumerable:!0,configurable:!0}),e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error("Tensor is disposed.")},e.prototype.toFloat=function(){return this.asType("float32")},e.prototype.toInt=function(){return this.asType("int32")},e.prototype.toBool=function(){return this.asType("bool")},e.prototype.print=function(e){return void 0===e&&(e=!1),$S.print(this,e)},e.prototype.reshape=function(e){return this.throwIfDisposed(),$S.reshape(this,e)},e.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},e.prototype.expandDims=function(e){return void 0===e&&(e=0),$S.expandDims(this,e)},e.prototype.cumsum=function(e,t,n){return void 0===e&&(e=0),void 0===t&&(t=!1),void 0===n&&(n=!1),$S.cumsum(this,e,t,n)},e.prototype.squeeze=function(e){return this.throwIfDisposed(),$S.squeeze(this,e)},e.prototype.clone=function(){return this.throwIfDisposed(),$S.clone(this)},e.prototype.toString=function(e){return void 0===e&&(e=!1),function(e,t,n,r){var a=RS(t),i=function(e,t,n,r){var a=oS(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,u="complex64"===n?qS(e):e;if(s>1)for(var c=0;c<a/i;c++)for(var l=c*i,f=0;f<i;f++)o[f]=Math.max(o[f],GS(u[l+f],0,n).length);return o}(e,t,n,a),o=t.length,s=function e(t,n,r,a,i,o){void 0===o&&(o=!0);var s="complex64"===r?2:1,u=n[0],c=n.length;if(0===c)return"complex64"===r?[GS(qS(t)[0],0,r)]:"bool"===r?[HS(t[0])]:[t[0].toString()];if(1===c){if(u>20){var l=3*s,f=Array.from(t.slice(0,l)),h=Array.from(t.slice((u-3)*s,u*s));return"complex64"===r&&(f=qS(f),h=qS(h)),["["+f.map((function(e,t){return GS(e,i[t],r)})).join(", ")+", ..., "+h.map((function(e,t){return GS(e,i[u-3+t],r)})).join(", ")+"]"]}return["["+("complex64"===r?qS(t):Array.from(t)).map((function(e,t){return GS(e,i[t],r)})).join(", ")+"]"]}var p=n.slice(1),d=a.slice(1),v=a[0]*s,m=[];if(u>20){for(var y=0;y<3;y++){var g=(b=y*v)+v;m.push.apply(m,e(t.slice(b,g),p,r,d,i,!1))}for(m.push("..."),y=u-3;y<u;y++)g=(b=y*v)+v,m.push.apply(m,e(t.slice(b,g),p,r,d,i,y===u-1))}else for(y=0;y<u;y++){var b;g=(b=y*v)+v,m.push.apply(m,e(t.slice(b,g),p,r,d,i,y===u-1))}var x=2===c?",":"";for(m[0]="["+m[0]+x,y=1;y<m.length-1;y++)m[y]=" "+m[y]+x;var w=",\n";for(y=2;y<c;y++)w+="\n";return m[m.length-1]=" "+m[m.length-1]+"]"+(o?"":w),m}(e,t,n,a,i),u=["Tensor"];return r&&(u.push("  dtype: "+n),u.push("  rank: "+o),u.push("  shape: ["+t+"]"),u.push("  values:")),u.push(s.map((function(e){return"    "+e})).join("\n")),u.join("\n")}(this.dataSync(),this.shape,this.dtype,e)},e.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),$S.gather(this,e,t)},e.prototype.matMul=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),this.throwIfDisposed(),$S.matMul(this,e,t,n)},e.prototype.dot=function(e){return this.throwIfDisposed(),$S.dot(this,e)},e.prototype.norm=function(e,t,n){return void 0===e&&(e="euclidean"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),$S.norm(this,e,t,n)},e.prototype.slice=function(e,t){return this.throwIfDisposed(),$S.slice(this,e,t)},e.prototype.reverse=function(e){return this.throwIfDisposed(),$S.reverse(this,e)},e.prototype.concat=function(t,n){return void 0===n&&(n=0),this.throwIfDisposed(),t instanceof e&&(t=[t]),$S.concat([this].concat(t),n)},e.prototype.split=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),$S.split(this,e,t)},e.prototype.stack=function(e,t){return void 0===t&&(t=0),$S.stack([this,e],t)},e.prototype.unstack=function(e){return void 0===e&&(e=0),$S.unstack(this,e)},e.prototype.batchNormalization=function(e,t,n,r,a){return void 0===n&&(n=.001),QS("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon"),this.batchNorm(e,t,a,r,n)},e.prototype.all=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),$S.all(this,e,t)},e.prototype.any=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),$S.any(this,e,t)},e.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),$S.logSumExp(this,e,t)},e.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),$S.sum(this,e,t)},e.prototype.prod=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),$S.prod(this,e,t)},e.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),$S.mean(this,e,t)},e.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),$S.min(this,e,t)},e.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),$S.max(this,e,t)},e.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),$S.argMin(this,e)},e.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),$S.argMax(this,e)},e.prototype.cast=function(e){return this.throwIfDisposed(),$S.cast(this,e)},e.prototype.addStrict=function(e){return this.throwIfDisposed(),$S.addStrict(this,e)},e.prototype.atan2=function(e){return this.throwIfDisposed(),$S.atan2(this,e)},e.prototype.sub=function(e){return this.throwIfDisposed(),$S.sub(this,e)},e.prototype.subStrict=function(e){return this.throwIfDisposed(),$S.subStrict(this,e)},e.prototype.pow=function(e){return this.throwIfDisposed(),$S.pow(this,e)},e.prototype.powStrict=function(e){return this.throwIfDisposed(),$S.powStrict(this,e)},e.prototype.mul=function(e){return this.throwIfDisposed(),$S.mul(this,e)},e.prototype.mulStrict=function(e){return this.throwIfDisposed(),$S.mulStrict(this,e)},e.prototype.floorDiv=function(e){return this.throwIfDisposed(),$S.floorDiv(this,e)},e.prototype.divStrict=function(e){return this.throwIfDisposed(),$S.divStrict(this,e)},e.prototype.minimum=function(e){return this.throwIfDisposed(),$S.minimum(this,e)},e.prototype.minimumStrict=function(e){return this.throwIfDisposed(),$S.minimumStrict(this,e)},e.prototype.maximum=function(e){return this.throwIfDisposed(),$S.maximum(this,e)},e.prototype.maximumStrict=function(e){return this.throwIfDisposed(),$S.maximumStrict(this,e)},e.prototype.mod=function(e){return this.throwIfDisposed(),$S.mod(this,e)},e.prototype.modStrict=function(e){return this.throwIfDisposed(),$S.modStrict(this,e)},e.prototype.squaredDifferenceStrict=function(e){return this.throwIfDisposed(),$S.squaredDifferenceStrict(this,e)},e.prototype.notEqual=function(e){return this.throwIfDisposed(),$S.notEqual(this,e)},e.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),$S.notEqualStrict(this,e)},e.prototype.less=function(e){return this.throwIfDisposed(),$S.less(this,e)},e.prototype.lessStrict=function(e){return this.throwIfDisposed(),$S.lessStrict(this,e)},e.prototype.equal=function(e){return this.throwIfDisposed(),$S.equal(this,e)},e.prototype.equalStrict=function(e){return this.throwIfDisposed(),$S.equalStrict(this,e)},e.prototype.lessEqual=function(e){return this.throwIfDisposed(),$S.lessEqual(this,e)},e.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),$S.lessEqualStrict(this,e)},e.prototype.greater=function(e){return this.throwIfDisposed(),$S.greater(this,e)},e.prototype.greaterStrict=function(e){return this.throwIfDisposed(),$S.greaterStrict(this,e)},e.prototype.greaterEqual=function(e){return this.throwIfDisposed(),$S.greaterEqual(this,e)},e.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),$S.greaterEqualStrict(this,e)},e.prototype.logicalAnd=function(e){return this.throwIfDisposed(),$S.logicalAnd(this,e)},e.prototype.logicalOr=function(e){return this.throwIfDisposed(),$S.logicalOr(this,e)},e.prototype.logicalNot=function(){return this.throwIfDisposed(),$S.logicalNot(this)},e.prototype.logicalXor=function(e){return this.throwIfDisposed(),$S.logicalXor(this,e)},e.prototype.where=function(e,t){return this.throwIfDisposed(),$S.where(e,this,t)},e.prototype.neg=function(){return this.throwIfDisposed(),$S.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),$S.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),$S.floor(this)},e.prototype.sign=function(){return this.throwIfDisposed(),$S.sign(this)},e.prototype.isNaN=function(){return this.throwIfDisposed(),$S.isNaN(this)},e.prototype.isInf=function(){return this.throwIfDisposed(),$S.isInf(this)},e.prototype.isFinite=function(){return this.throwIfDisposed(),$S.isFinite(this)},e.prototype.exp=function(){return this.throwIfDisposed(),$S.exp(this)},e.prototype.expm1=function(){return this.throwIfDisposed(),$S.expm1(this)},e.prototype.log=function(){return this.throwIfDisposed(),$S.log(this)},e.prototype.log1p=function(){return this.throwIfDisposed(),$S.log1p(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),$S.sqrt(this)},e.prototype.rsqrt=function(){return this.throwIfDisposed(),$S.rsqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),$S.square(this)},e.prototype.reciprocal=function(){return this.throwIfDisposed(),$S.reciprocal(this)},e.prototype.abs=function(){return this.throwIfDisposed(),$S.abs(this)},e.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),$S.clipByValue(this,e,t)},e.prototype.relu=function(){return this.throwIfDisposed(),$S.relu(this)},e.prototype.relu6=function(){return this.throwIfDisposed(),$S.relu6(this)},e.prototype.elu=function(){return this.throwIfDisposed(),$S.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),$S.selu(this)},e.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),$S.leakyRelu(this,e)},e.prototype.prelu=function(e){return this.throwIfDisposed(),$S.prelu(this,e)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),$S.sigmoid(this)},e.prototype.logSigmoid=function(){return this.throwIfDisposed(),$S.logSigmoid(this)},e.prototype.softplus=function(){return this.throwIfDisposed(),$S.softplus(this)},e.prototype.zerosLike=function(){return this.throwIfDisposed(),$S.zerosLike(this)},e.prototype.onesLike=function(){return this.throwIfDisposed(),$S.onesLike(this)},e.prototype.sin=function(){return this.throwIfDisposed(),$S.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),$S.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),$S.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),$S.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),$S.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),$S.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),$S.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),$S.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),$S.tanh(this)},e.prototype.asinh=function(){return this.throwIfDisposed(),$S.asinh(this)},e.prototype.acosh=function(){return this.throwIfDisposed(),$S.acosh(this)},e.prototype.atanh=function(){return this.throwIfDisposed(),$S.atanh(this)},e.prototype.erf=function(){return this.throwIfDisposed(),$S.erf(this)},e.prototype.round=function(){return this.throwIfDisposed(),$S.round(this)},e.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),$S.step(this,e)},e.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),$S.softmax(this,e)},e.prototype.logSoftmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),$S.logSoftmax(this,e)},e.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),$S.image.resizeBilinear(this,e,t)},e.prototype.resizeNearestNeighbor=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),$S.image.resizeNearestNeighbor(this,e,t)},e.prototype.conv1d=function(e,t,n,r,a,i){return void 0===r&&(r="NWC"),void 0===a&&(a=1),this.throwIfDisposed(),$S.conv1d(this,e,t,n,r,a,i)},e.prototype.conv2d=function(e,t,n,r,a,i){return void 0===r&&(r="NHWC"),void 0===a&&(a=[1,1]),this.throwIfDisposed(),$S.conv2d(this,e,t,n,r,a,i)},e.prototype.conv2dTranspose=function(e,t,n,r,a){return this.throwIfDisposed(),$S.conv2dTranspose(this,e,t,n,r,a)},e.prototype.depthwiseConv2D=function(e,t,n,r,a,i){return void 0===r&&(r="NHWC"),void 0===a&&(a=[1,1]),this.throwIfDisposed(),$S.depthwiseConv2d(this,e,t,n,r,a,i)},e.prototype.separableConv2d=function(e,t,n,r,a,i){return void 0===a&&(a=[1,1]),void 0===i&&(i="NHWC"),this.throwIfDisposed(),$S.separableConv2d(this,e,t,n,r,a,i)},e.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),$S.avgPool(this,e,t,n,r)},e.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),$S.maxPool(this,e,t,n,r)},e.prototype.localResponseNormalization=function(e,t,n,r){return void 0===e&&(e=5),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=.5),$S.localResponseNormalization(this,e,t,n,r)},e.prototype.pool=function(e,t,n,r,a){return this.throwIfDisposed(),$S.pool(this,e,t,n,r,a)},e.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),XS().makeVariable(this,e,t,n)},e.prototype.unsortedSegmentSum=function(e,t){return this.throwIfDisposed(),$S.unsortedSegmentSum(this,e,t)},e.prototype.batchToSpaceND=function(e,t){return this.throwIfDisposed(),$S.batchToSpaceND(this,e,t)},e.prototype.spaceToBatchND=function(e,t){return this.throwIfDisposed(),$S.spaceToBatchND(this,e,t)},e.prototype.topk=function(e,t){return void 0===e&&(e=1),void 0===t&&(t=!0),this.throwIfDisposed(),$S.topk(this,e,t)},e.prototype.stridedSlice=function(e,t,n,r,a,i,o,s){return void 0===r&&(r=0),void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),this.throwIfDisposed(),$S.stridedSlice(this,e,t,n,r,a,i,o,s)},e.prototype.depthToSpace=function(e,t){return this.throwIfDisposed(),$S.depthToSpace(this,e,t)},e.prototype.fft=function(){return this.throwIfDisposed(),$S.spectral.fft(this)},e.prototype.ifft=function(){return this.throwIfDisposed(),$S.spectral.ifft(this)},e.prototype.rfft=function(){return this.throwIfDisposed(),$S.spectral.rfft(this)},e.prototype.irfft=function(){return this.throwIfDisposed(),$S.spectral.irfft(this)},e}();Object.defineProperty(YS,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.dataId&&null!=e.shape&&null!=e.dtype}});var JS,ZS,eC,tC,nC,rC=function(e){function t(t,n,r,a){var i=e.call(this,t.shape,t.dtype,t.dataId,a)||this;return i.trainable=n,i.name=r,i}return LE(t,e),t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value ("+e.dtype+") and previous value ("+this.dtype+") must match");if(!sS(e.shape,this.shape))throw new Error("shape of the new value ("+e.shape+") and previous value ("+this.shape+") must match");XS().disposeTensor(this),this.dataId=e.dataId,XS().incRef(this,null)},t.prototype.dispose=function(){XS().disposeVariable(this),this.isDisposedInternal=!0},t}(YS);Object.defineProperty(rC,Symbol.hasInstance,{value:function(e){return e instanceof YS&&null!=e.assign&&e.assign instanceof Function}}),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(JS||(JS={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(ZS||(ZS={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(eC||(eC={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(tC||(tC={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(nC||(nC={}));var aC={float32:tC,int32:ZS,bool:eC,complex64:nC};function iC(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast "+e+" with "+t)}return aC[e][t]}function oC(e){return iC(e,"int32")}function sC(e,t){if(e.dtype===t.dtype)return[e,t];var n=iC(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function uC(e,t){nS(e.dtype===t.dtype,(function(){return"The dtypes of the first("+e.dtype+") and second("+t.dtype+") input must match"}))}function cC(e){var t=[];return function e(t,n,r){if(null!=t)if(t instanceof YS)n.push(t);else if(a=t,Array.isArray(a)||"object"==typeof a){var a,i=t;for(var o in i){var s=i[o];r.has(s)||(r.add(s),e(s,n,r))}}}(e,t,new Set),t}Object.freeze({makeTypesMatch:sC,assertTypesMatch:uC,isTensorInList:function(e,t){return t.some((function(t){return t.id===e.id}))},getTensorsInContainer:cC});var lC,fC=function(){function e(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null}}return e.prototype.dispose=function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()},e}(),hC=function(){function e(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new fC}return e.prototype.ready=function(){return BE(this,void 0,void 0,(function(){var e,t,n;return VE(this,(function(r){switch(r.label){case 0:if(null!=this.pendingBackendInit)return[2,this.pendingBackendInit.then((function(){}))];if(null!=this.backendInstance)return[2];e=this.getSortedBackends(),t=0,r.label=1;case 1:return t<e.length?(n=e[t],[4,this.initializeBackend(n).success]):[3,5];case 2:return r.sent()?[4,this.setBackend(n)]:[3,4];case 3:return r.sent(),[2];case 4:return t++,[3,1];case 5:throw new Error("Could not initialize any backends, all backend initializations failed.")}}))}))},Object.defineProperty(e.prototype,"backend",{get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '"+this.backendName+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '"+t+"' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance},enumerable:!0,configurable:!0}),e.prototype.backendNames=function(){return Object.keys(this.registryFactory)},e.prototype.findBackend=function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]},e.prototype.findBackendFactory=function(e){return e in this.registryFactory?this.registryFactory[e].factory:null},e.prototype.registerBackend=function(e,t,n){return void 0===n&&(n=1),e in this.registryFactory?(console.warn(e+" backend was already registered. Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)},e.prototype.setBackend=function(e){return BE(this,void 0,void 0,(function(){var t,n,r;return VE(this,(function(a){switch(a.label){case 0:if(null==this.registryFactory[e])throw new Error("Backend name '"+e+"' not found in registry");return this.backendName=e,null!=this.registry[e]?[3,4]:(this.backendInstance=null,t=this.initializeBackend(e),n=t.success,t.asyncInit?[4,n]:[3,2]);case 1:return r=a.sent(),[3,3];case 2:r=n,a.label=3;case 3:if(!r)return[2,!1];a.label=4;case 4:return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new WS(this.backendInstance),[2,!0]}}))}))},e.prototype.setupRegisteredKernels=function(){var e=this;XE(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))},e.prototype.disposeRegisteredKernels=function(e){var t=this;XE(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))},e.prototype.initializeBackend=function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend "+e+", no registration found.");try{var r=n.factory();if(Promise.resolve(r)===r){var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return!(a<t.pendingBackendInitId)&&(t.pendingBackendInit=null,console.warn("Initialization of backend "+e+" failed"),console.warn(n.stack||n.message),!1)}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(t){return console.warn("Initialization of backend "+e+" failed"),console.warn(t.stack||t.message),{success:!1,asyncInit:!1}}},e.prototype.removeBackend=function(e){if(!(e in this.registryFactory))throw new Error(e+" backend not found in registry");this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)},e.prototype.getSortedBackends=function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))},e.prototype.initializeBackendsAndReturnBest=function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")},e.prototype.moveData=function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t);r.disposeData(t),n.backend=e,e.move(t,a,n.shape,n.dtype),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++},e.prototype.tidy=function(e,t){var n,r=this,a=null;if(null==t){if("function"!=typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!=typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!=typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))},e.prototype.scopedRun=function(e,t,n){e();try{var r=n();return t(),r}catch(e){throw t(),e}},e.prototype.nextTensorId=function(){return e.nextTensorId++},e.prototype.nextVariableId=function(){return e.nextVariableId++},e.prototype.clone=function(e){var t=this.makeTensorFromDataId(e.dataId,e.shape,e.dtype),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){return e.toFloat()}}}),[],{}),t},e.prototype.runKernel=function(e,t,n,r,a){return this.runKernelFunc(null,t,null,e,n,r,a)},e.prototype.shouldCheckForMemLeaks=function(){return this.ENV.getBool("IS_TEST")},e.prototype.checkKernelForMemLeak=function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '"+this.backendName+"' has an internal memory leak ("+o+" data ids) after running '"+e+"'")},e.prototype.runKernelFunc=function(e,t,n,r,a,i,o){var s,u=this,c=[],l=this.isTapeOn();null==r&&(r=null!=this.state.activeScope?this.state.activeScope.name:"");var f,h=this.state.numBytes,p=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);var d,v=qE(r,this.backendName);if(null!=v)f=function(){var e=u.backend.numDataIds();d=v.kernelFunc({inputs:t,attrs:a,backend:u.backend});var n=Array.isArray(d)?d:[d];u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,e,n);var s=n.map((function(e){var t=e.dataId,n=e.shape,r=e.dtype;return u.makeTensorFromDataId(t,n,r)}));if(l){var f=u.getTensorsForGradient(r,t,s);if(null==f){null==o&&(o=[]);var h=s.filter((function(e,t){return o[t]}));f=(i||[]).slice().concat(h)}c=u.saveTensorsForBackwardMode(f)}return s};else{var m=function(e){l&&(c=e.map((function(e){return u.keep(u.clone(e))})))};f=function(){var t=u.backend.numDataIds();d=u.tidy((function(){return e(u.backend,m)}));var n=Array.isArray(d)?d:[d];return u.shouldCheckForMemLeaks()&&u.checkKernelForMemLeak(r,t,n),n}}return this.scopedRun((function(){return u.state.kernelDepth++}),(function(){return u.state.kernelDepth--}),(function(){s=u.ENV.getBool("DEBUG")?u.profiler.profileKernel(r,t,(function(){return f()})):f()})),l&&this.addTapeNode(r,t,s,n,c,a),this.state.profiling&&this.state.activeProfile.kernels.push({name:r,bytesAdded:this.state.numBytes-h,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-p,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(t).map((function(e){return t[e].shape})),outputShapes:s.map((function(e){return e.shape}))}),Array.isArray(d)?s:s[0]},e.prototype.saveTensorsForBackwardMode=function(e){var t=this;return e.map((function(e){return t.keep(t.clone(e))}))},e.prototype.getTensorsForGradient=function(e,t,n){var r=KE(e);if(null!=r){var a=r.inputsToSave||[],i=r.outputsToSave||[],o=void 0;r.saveAllInputs?(nS(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),o=Object.keys(t).map((function(e){return t[e]}))):o=a.map((function(e){return t[e]}));var s=n.filter((function(e,t){return i[t]}));return o.concat(s)}return null},e.prototype.makeTensor=function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&SS(e[0])&&(a=e.map((function(e){return LS(e)})));var i=r.write(a,t,n),o=new YS(t,n,i,this.nextTensorId());if(this.incRef(o,r),"string"===n){var s=this.state.tensorInfo.get(i),u=ES(a);this.state.numBytes+=u-s.bytes,s.bytes=u}return o},e.prototype.makeTensorFromDataId=function(e,t,n,r){var a=new YS(t,n=n||"float32",e,this.nextTensorId());return this.incRef(a,r),a},e.prototype.makeVariable=function(e,t,n,r){void 0===t&&(t=!0),n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.asType(r));var a=new rC(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name "+a.name+" was already registered");return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a},e.prototype.incRef=function(e,t){var n=this.state.tensorInfo.has(e.dataId)?this.state.tensorInfo.get(e.dataId).refCount:0;if(this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++,0===n){this.state.numDataBuffers++;var r=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(r=e.size*kS(e.dtype)),this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r,refCount:0}),this.state.numBytes+=r}this.state.tensorInfo.get(e.dataId).refCount++,e instanceof rC||this.track(e)},e.prototype.disposeTensor=function(e){if(this.state.tensorInfo.has(e.dataId)){this.state.numTensors--,"string"===e.dtype&&this.state.numStringTensors--;var t=this.state.tensorInfo.get(e.dataId);t.refCount<=1?("complex64"!==e.dtype&&(this.state.numBytes-=t.bytes),this.state.numDataBuffers--,t.backend.disposeData(e.dataId),this.state.tensorInfo.delete(e.dataId)):this.state.tensorInfo.get(e.dataId).refCount--}},e.prototype.disposeVariables=function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}},e.prototype.disposeVariable=function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]},e.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e},e.prototype.profile=function(e){return BE(this,void 0,void 0,(function(){var t,n;return VE(this,(function(r){return this.state.profiling=!0,t=this.state.numBytes,n=this.state.numTensors,this.state.activeProfile.kernels=[],this.state.activeProfile.result=e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot}))),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-n,[2,this.state.activeProfile]}))}))},e.prototype.isTapeOn=function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth},e.prototype.addTapeNode=function(e,t,n,r,a,i){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},u=KE(e);null!=u&&(r=u.gradFunc),null!=r&&(s.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=MS(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(s)},e.prototype.keep=function(e){return e.kept=!0,e},e.prototype.startTape=function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++},e.prototype.endTape=function(){this.state.gradientDepth--},e.prototype.startScope=function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t},e.prototype.endScope=function(e){for(var t=this,n=cC(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))},e.prototype.gradients=function(e,t,n,r){var a=this;if(void 0===r&&(r=!1),nS(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '"+n.dtype+"'");var i=this.scopedRun((function(){return a.startTape()}),(function(){return a.endTape()}),(function(){return a.tidy("forward",e)}));nS(i instanceof YS,(function(){return"The result y returned by f() must be a tensor."}));var o=function(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(i=0;i<e.length;i++){var o=(d=e[i]).inputs;for(var s in o){for(var u=o[s],c=!1,l=0;l<t.length;l++)if(r[u.id]){d.outputs.forEach((function(e){return r[e.id]=!0})),c=!0,a[d.id]=!0;break}if(c)break}}var f={};f[n.id]=!0;var h={};for(i=e.length-1;i>=0;i--)for(o=(d=e[i]).inputs,l=0;l<d.outputs.length;l++)if(f[d.outputs[l].id]){for(var s in o)f[o[s].id]=!0,h[d.id]=!0;break}var p=[];for(i=0;i<e.length;i++){var d;if(a[(d=e[i]).id]&&h[d.id]){var v={};for(var s in d.inputs){var m=d.inputs[s];r[m.id]&&(v[s]=m)}var y=Object.assign({},d);y.inputs=v,y.outputs=d.outputs,p.push(y)}}return p}(this.state.activeTape,t,i);if(!r&&0===o.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e,r,s={};s[i.id]=null==n?(r=OS(oS(e=i.shape),"float32"),pC.makeTensor(r,e,"float32")):n,function(e,t,n){for(var r=function(r){var a=t[r],i=[];if(a.outputs.forEach((function(t){var n=e[t.id];null!=n?i.push(n):i.push(null)})),null==a.gradient)throw new Error("Cannot compute gradient: gradient function not found for "+a.kernelName+".");var o=a.gradient(i),s=function(t){if(!(t in o))throw new Error("Cannot backprop through input "+t+". Available gradients found: "+Object.keys(o)+".");var r=n((function(){return o[t]()}));if("float32"!==r.dtype)throw new Error("Error in gradient for op "+a.kernelName+". The gradient of input "+t+" must have 'float32' dtype, but has '"+r.dtype+"'");var i=a.inputs[t];if(!sS(r.shape,i.shape))throw new Error("Error in gradient for op "+a.kernelName+". The gradient of input '"+t+"' has shape '"+r.shape+"', which does not match the shape of the input '"+i.shape+"'");if(null==e[i.id])e[i.id]=r;else{var s=e[i.id];e[i.id]=s.add(r),s.dispose()}};for(var u in a.inputs)s(u)},a=t.length-1;a>=0;a--)r(a)}(s,o,(function(e){return a.tidy(e)}));var u=t.map((function(e){return s[e.id]}));return 0===a.state.gradientDepth&&(a.state.activeTape.forEach((function(e){for(var t=0,n=e.saved;t<n.length;t++)n[t].dispose()})),a.state.activeTape=null),{value:i,grads:u}}))},e.prototype.customGrad=function(e){var t=this;return nS(NS(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];nS(r.every((function(e){return e instanceof YS})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var i={};return r.forEach((function(e,t){i[t]=e})),t.runKernelFunc((function(t,a){return nS((n=e.apply(void 0,r.concat([a]))).value instanceof YS,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),nS(NS(n.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),n.value}),i,(function(e,t){var a=n.gradFunc(e,t),i=Array.isArray(a)?a:[a];nS(i.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),nS(i.every((function(e){return e instanceof YS})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return i.forEach((function(e,t){o[t]=function(){return e}})),o}))}},e.prototype.readSync=function(e){return this.state.tensorInfo.get(e).backend.readSync(e)},e.prototype.read=function(e){return this.state.tensorInfo.get(e).backend.read(e)},e.prototype.time=function(e){return BE(this,void 0,void 0,(function(){var t,n;return VE(this,(function(r){switch(r.label){case 0:return t=FS(),[4,this.backend.time(e)];case 1:return(n=r.sent()).wallMs=FS()-t,[2,n]}}))}))},e.prototype.track=function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e},Object.defineProperty(e.prototype,"registeredVariables",{get:function(){return this.state.registeredVariables},enumerable:!0,configurable:!0}),e.prototype.reset=function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new fC,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null},e.nextTensorId=0,e.nextVariableId=0,e}(),pC=function(){var e=function(){if(null==lC){var e=void 0;if("undefined"!=typeof window)e=window;else if("undefined"!=typeof n.g)e=n.g;else if("undefined"!=typeof process)e=process;else{if("undefined"==typeof self)throw new Error("Could not find a global object");e=self}lC=e}return lC}();if(null==e._tfengine){var t=new zE(e);e._tfengine=new hC(t)}return function(e){jE=e}(e._tfengine.ENV),XS=function(){return e._tfengine},e._tfengine}();function dC(){return"undefined"!=typeof window&&null!=window.document||"undefined"!=typeof WorkerGlobalScope}var vC=WE();vC.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),vC.registerFlag("IS_BROWSER",(function(){return dC()})),vC.registerFlag("IS_NODE",(function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node})),vC.registerFlag("IS_CHROME",(function(){return"undefined"!=typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),vC.registerFlag("PROD",(function(){return!1})),vC.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return vC.getBool("DEBUG")})),vC.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),vC.registerFlag("IS_TEST",(function(){return!1}));var mC,yC,gC,bC={},xC={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function wC(e,t){bC[e]=t}function kC(e){e in bC||(bC[e]=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!=typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!=typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);return t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete bC[e]}),!1),1===e?t.getContext("webgl",xC)||t.getContext("experimental-webgl",xC):t.getContext("webgl2",xC)}(e));var t=bC[e];return t.isContextLost()?(delete bC[e],kC(e)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),bC[e])}function EC(e,t){return[t,e]}function SC(e){var t=oS(e);return lS(Math.ceil(t/4))}function CC(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function IC(e,t){var n,r,a,i,o,s,u,c,l,f=e;return 2===WE().getNumber("WEBGL_VERSION")?(n=f.R32F,r=f.R16F,a=f.RGBA16F,i=f.RGBA32F,o=f.RED,s=4,u=1,c=f.HALF_FLOAT,l=f.FLOAT):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=f.RGBA,o=e.RGBA,s=4,u=4,c=null!=t?t.HALF_FLOAT_OES:null,l=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:o,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:s,defaultNumChannels:u,textureTypeHalfFloat:c,textureTypeFloat:l}}function TC(e,t,n){var r=n();return t&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+_C(e,t))}(e),r}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(mC||(mC={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(yC||(yC={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(gC||(gC={}));function NC(e){return!!(WE().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function _C(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code "+t}}function RC(e,t,n){return ZC(e,t,(function(){return e.getExtension(n)}),'Extension "'+n+'" not supported on this browser.')}function AC(e,t,n){var r=ZC(e,t,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(TC(e,t,(function(){return e.shaderSource(r,n)})),TC(e,t,(function(){return e.compileShader(r)})),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(r)),new Error("Failed to compile vertex shader.");return r}function DC(e,t,n){var r=ZC(e,t,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(TC(e,t,(function(){return e.shaderSource(r,n)})),TC(e,t,(function(){return e.compileShader(r)})),!1===e.getShaderParameter(r,e.COMPILE_STATUS))throw function(e,t){var n=FC.exec(t);if(null==n)return console.log("Couldn't parse line number in error: "+t),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,o=a.map((function(e,t){return fS((t+1).toString(),i)+e})),s=0,u=0;u<o.length;u++)s=Math.max(o[u].length,s);var c=o.slice(0,r-1),l=o.slice(r-1,r),f=o.slice(r);console.log(c.join("\n")),console.log(t.split("\n")[0]),console.log("%c "+fS(l[0],s),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(f.join("\n"))}(n,e.getShaderInfoLog(r)),new Error("Failed to compile fragment shader.");return r}var OC,MC,FC=/ERROR: [0-9]+:([0-9]+):/g;function PC(e,t){return ZC(e,t,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}function LC(e,t,n){if(TC(e,t,(function(){return e.linkProgram(n)})),!1===e.getProgramParameter(n,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Failed to link vertex and fragment shaders.")}function BC(e,t,n){if(TC(e,t,(function(){return e.validateProgram(n)})),!1===e.getProgramParameter(n,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(n)),new Error("Shader program validation failed.")}function VC(e,t,n){var r=ZC(e,t,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return TC(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),TC(e,t,(function(){return e.bufferData(e.ARRAY_BUFFER,n,e.STATIC_DRAW)})),r}function zC(e,t,n){var r=ZC(e,t,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return TC(e,t,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,r)})),TC(e,t,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW)})),r}function UC(e,t){return ZC(e,t,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}function WC(e,t){var n=WE().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="["+e+"x"+t+"]";throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n)throw r="["+e+"x"+t+"]",new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU ["+n+"x"+n+"].")}function jC(e,t){return ZC(e,t,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}function GC(e,t,n,r,a,i,o,s){var u=e.getAttribLocation(n,r);return-1!==u&&(TC(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,a)})),TC(e,t,(function(){return e.vertexAttribPointer(u,i,e.FLOAT,!1,o,s)})),TC(e,t,(function(){return e.enableVertexAttribArray(u)})),!0)}function HC(e,t,n,r){eI(e,r),TC(e,t,(function(){return e.activeTexture(e.TEXTURE0+r)})),TC(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)}))}function qC(e,t,n,r){return ZC(e,t,(function(){return e.getUniformLocation(n,r)}),'uniform "'+r+'" not present in program.')}function KC(e,t,n){return e.getUniformLocation(t,n)}function XC(e,t,n,r,a,i){TC(e,t,(function(){return HC(e,t,r,i)})),TC(e,t,(function(){return e.uniform1i(a,i)}))}function $C(e,t,n,r){TC(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,r)})),TC(e,t,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0)}))}function QC(e,t,n){TC(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),TC(e,t,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function YC(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+JC(e,t))}function JC(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error "+t}}function ZC(e,t,n,r){var a=TC(e,t,(function(){return n()}));if(null==a)throw new Error(r);return a}function eI(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error("textureUnit must be in [gl.TEXTURE0, gl.TEXTURE"+n+"].")}function tI(e,t){return void 0===t&&(t=2),oS(e.slice(0,e.length-t))}function nI(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function rI(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[tI(e)].concat(nI(e))),t}function aI(e,t){var n;void 0===t&&(t=!1);var r=WE().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(r*=2,1===(e=e.map((function(t,n){return n>=e.length-2?eS(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var a=vS(e);e=a.newShape}var i=oS(e);if(e.length<=1&&i<=r)return[1,i];if(2===e.length&&e[0]<=r&&e[1]<=r)return e;if(3===e.length&&e[0]*e[1]<=r&&e[2]<=r)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=r&&e[1]*e[2]<=r)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=r&&e[3]<=r)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=r&&e[1]*e[2]*e[3]<=r)return[e[0],e[1]*e[2]*e[3]];if(t){var o=tI(e),s=2,u=2;return e.length&&(s=(n=nI(e))[0],u=n[1]),lS(i=o*(s/2)*(u/2)).map((function(e){return 2*e}))}return lS(i)}function iI(e){return e%2==0}function oI(e,t){if(sS(e=e.slice(-2),t=t.slice(-2)))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(iI(n)&&iI(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&iI(e[0])&&iI(t[0])}function sI(e){if(null==OC){var t=kC(e);OC=t.getParameter(t.MAX_TEXTURE_SIZE)}return OC}function uI(e){if(null==MC){var t=kC(e);MC=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,MC)}function cI(e){if(0===e)return 0;var t=kC(e);return lI(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:lI(t,"EXT_disjoint_timer_query")?1:0}function lI(e,t){return null!=e.getExtension(t)}function fI(e){try{if(null!=kC(e))return!0}catch(e){return!1}return!1}function hI(e){if(0===e)return!1;var t=kC(e);if(1===e){if(!lI(t,"OES_texture_float"))return!1}else if(!lI(t,"EXT_color_buffer_float"))return!1;return dI(t)}function pI(e){if(0===e)return!1;var t=kC(e);if(1!==e){if(lI(t,"EXT_color_buffer_float"))return dI(t);if(lI(t,"EXT_color_buffer_half_float")){var n=t.getExtension("EXT_color_buffer_half_float");return function(e,t){var n=IC(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var a=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,a),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var i=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(a),i}(t,n)}return!1}return!!lI(t,"OES_texture_float")&&!!lI(t,"WEBGL_color_buffer_float")&&dI(t)}function dI(e){var t=IC(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function vI(e){return 2===e&&null!=kC(e).fenceSync}var mI=Object.freeze({callAndCheck:TC,canBeRepresented:NC,getWebGLErrorMessage:_C,getExtensionOrThrow:RC,createVertexShader:AC,createFragmentShader:DC,createProgram:PC,linkProgram:LC,validateProgram:BC,createStaticVertexBuffer:VC,createStaticIndexBuffer:zC,getNumChannels:function(){return 2===WE().getNumber("WEBGL_VERSION")?1:4},createTexture:UC,validateTextureSize:WC,createFramebuffer:jC,bindVertexBufferToProgramAttribute:GC,bindTextureUnit:HC,unbindTextureUnit:function(e,t,n){eI(e,n),TC(e,t,(function(){return e.activeTexture(e.TEXTURE0+n)})),TC(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))},getProgramUniformLocationOrThrow:qC,getProgramUniformLocation:KC,bindTextureToProgramUniformSampler:XC,bindCanvasToFramebuffer:function(e,t){TC(e,t,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)})),TC(e,t,(function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)})),TC(e,t,(function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)}))},bindColorTextureToFramebuffer:$C,unbindColorTextureFromFramebuffer:QC,validateFramebuffer:YC,getFramebufferErrorMessage:JC,getBatchDim:tI,getRowsCols:nI,getShapeAs3D:rI,getTextureShapeFromLogicalShape:aI,isReshapeFree:oI,getWebGLMaxTextureSize:sI,resetMaxTextureSize:function(){OC=null},resetMaxTexturesInShader:function(){MC=null},getMaxTexturesInShader:uI,getWebGLDisjointQueryTimerVersion:cI,hasExtension:lI,isWebGLVersionEnabled:fI,isCapableOfRenderingToFloatTexture:hI,isDownloadFloatTextureEnabled:pI,isWebGLFenceEnabled:vI}),yI=WE();function gI(e){WE().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function bI(e,t){return pC.tidy(e,t)}function xI(e){cC(e).forEach((function(e){return e.dispose()}))}function wI(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];WE().getBool("IS_TEST")||console.warn.apply(console,e)}function kI(e,t){var n=e;if(wS(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||wS(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&WE().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&function e(t,n,r){if(r=r||[],Array.isArray(t)||wS(t)){nS(n.length>0,(function(){return"Element arr["+r.join("][")+"] should be a primitive, but is an array of "+t.length+" elements"})),nS(t.length===n[0],(function(){return"Element arr["+r.join("][")+"] should have "+n[0]+" elements, but has "+t.length+" elements"}));for(var a=n.slice(1),i=0;i<t.length;++i)e(t[i],a,r.concat(i))}else nS(0===n.length,(function(){return"Element arr["+r.join("][")+"] is a primitive, but should be an array/TypedArray of "+n[0]+" elements"}))}(e,r,[]),r}function EI(e,t,n,r){if(null!=e&&("numeric"!==e&&e!==t||"numeric"===e&&"string"===t))throw new Error("Argument '"+n+"' passed to '"+r+"' must be "+e+" tensor, but got "+t+" tensor")}function SI(e,t,n,r){if(void 0===r&&(r="numeric"),e instanceof YS)return EI(r,e.dtype,t,n),e;var a=TS(e);if("string"!==a&&["bool","int32","float32"].indexOf(r)>=0&&(a=r),EI(r,a,t,n),null==e||!wS(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e){var i=null==e?"null":e.constructor.name;throw new Error("Argument '"+t+"' passed to '"+n+"' must be a Tensor or TensorLike, but got '"+i+"'")}var o=kI(e,a);wS(e)||Array.isArray(e)||(e=[e]);var s="string"!==a?AS(e,a,WE().getBool("DEBUG")):iS(e,[],!0);return pC.makeTensor(s,o,a)}function CI(e,t,n,r){if(void 0===r&&(r="numeric"),!Array.isArray(e))throw new Error("Argument "+t+" passed to "+n+" must be a `Tensor[]` or `TensorLike[]`");return e.map((function(e,r){return SI(e,t+"["+r+"]",n)}),r)}function II(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function TI(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}function NI(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map((function(t){return e[t]}))]}function _I(e,t){return TI(e,t.map((function(e){return 1})),t)}function RI(e,t,n){nS(II(t,n),(function(){return e+" supports only inner-most axes for now. Got axes "+t+" and rank-"+n+" input."}))}function AI(e,t){if(II(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function DI(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function OI(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}function MI(e,t){var n=e[0].length;e.forEach((function(e,t){nS(e.length===n,(function(){return"Error in concat"+n+"D: rank of tensors["+t+"] must be the same as the rank of the rest ("+n+")"}))})),nS(t>=0&&t<n,(function(){return"Error in concat"+n+"D: axis must be between 0 and "+(n-1)+"."}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)nS(i===t||e[i]===r[i],(function(){return"Error in concat"+n+"D: Shape of tensors["+a+"] ("+e+") does not match the shape of the rest ("+r+") along the non-concatenated axis "+a+"."}))}))}function FI(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}function PI(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+t.length+" keys.");var n=t[0],r=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1));var a=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];pC.startScope(n);try{var a=r.apply(void 0,e);return a instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),pC.endScope(a),a}catch(e){throw pC.endScope(null),e}};return Object.defineProperty(a,"name",{value:n,configurable:!0}),a}yI.registerFlag("HAS_WEBGL",(function(){return yI.getNumber("WEBGL_VERSION")>0})),yI.registerFlag("WEBGL_VERSION",(function(){return fI(2)?2:fI(1)?1:0})),yI.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===yI.get("WEBGL_VERSION")})),yI.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),yI.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),yI.registerFlag("WEBGL_PACK",(function(){return yI.getBool("HAS_WEBGL")})),yI.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return yI.getBool("WEBGL_PACK")})),yI.registerFlag("WEBGL_PACK_CLIP",(function(){return yI.getBool("WEBGL_PACK")})),yI.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),yI.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return yI.getBool("WEBGL_PACK")})),yI.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return yI.getBool("WEBGL_PACK")})),yI.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return yI.getBool("WEBGL_PACK")})),yI.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return yI.getBool("WEBGL_PACK")})),yI.registerFlag("WEBGL_PACK_REDUCE",(function(){return yI.getBool("WEBGL_PACK")})),yI.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return yI.getBool("WEBGL_PACK")})),yI.registerFlag("WEBGL_CONV_IM2COL",(function(){return yI.getBool("WEBGL_PACK")})),yI.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return sI(yI.getNumber("WEBGL_VERSION"))})),yI.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return uI(yI.getNumber("WEBGL_VERSION"))})),yI.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=yI.getNumber("WEBGL_VERSION");return 0===e?0:cI(e)})),yI.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return yI.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&(e=navigator.userAgent||navigator.vendor||window.opera,!(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))));var e})),yI.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return hI(yI.getNumber("WEBGL_VERSION"))})),yI.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!yI.getBool("WEBGL_FORCE_F16_TEXTURES")&&yI.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),yI.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return pI(yI.getNumber("WEBGL_VERSION"))})),yI.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return vI(yI.getNumber("WEBGL_VERSION"))})),yI.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return yI.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),QS=gI;var LI=PI({complex_:function(e,t){var n=SI(e,"real","complex"),r=SI(t,"imag","complex");return rS(n.shape,r.shape,"real and imag shapes, "+n.shape+" and "+r.shape+", must match in call to tf.complex()."),pC.runKernelFunc((function(e){return e.complex(n,r)}),{$real:n,$imag:r})}}),BI=PI({real_:function(e){var t=SI(e,"input","real");return pC.runKernelFunc((function(e){return e.real(t)}),{$input:t})}}),VI=PI({imag_:function(e){var t=SI(e,"input","imag");return pC.runKernelFunc((function(e){return e.imag(t)}),{$input:t})}});function zI(e,t,n){return UI(e,t,kI(e,n),n)}function UI(e,t,n,r){if(null==r&&(r=TS(e)),"complex64"===r)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!wS(e)&&!Array.isArray(e)&&"number"!=typeof e&&"boolean"!=typeof e&&"string"!=typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){PS(t);var a=oS(t),i=oS(n);nS(a===i,(function(){return"Based on the provided shape, ["+t+"], the tensor should have "+a+" values but has "+i}));for(var o=0;o<n.length;++o){var s=n[o],u=o!==n.length-1||s!==oS(t.slice(o));nS(n[o]===t[o]||!u,(function(){return"Error creating a new Tensor. Inferred shape ("+n+") does not match the provided shape ("+t+"). "}))}}return wS(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==r?AS(e,r,WE().getBool("DEBUG")):iS(e,[],!0),pC.makeTensor(e,t,r)}function WI(e,t){if((wS(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&wS(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return UI(e,[],[],t)}function jI(e,t){aS(e);var n=kI(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return UI(e,null,n,t)}function GI(e,t,n){if(aS(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=kI(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return UI(e,t,r,n)}function HI(e,t,n){if(aS(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var r=kI(e,n);if(3!==r.length&&1!==r.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return UI(e,t,r,n)}function qI(e,t,n){if(aS(e),null!=t&&4!==t.length)throw new Error("tensor4d() requires shape to have four numbers");var r=kI(e,n);if(4!==r.length&&1!==r.length)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return UI(e,t,r,n)}function KI(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=KI(e,"float32"),r=XI(e,"float32");return LI(n,r)}var a=OS(oS(e),t);return pC.makeTensor(a,e,t)}function XI(e,t){if(void 0===t&&(t="float32"),"complex64"===t){var n=XI(e,"float32"),r=XI(e,"float32");return LI(n,r)}var a=MS(oS(e),t);return pC.makeTensor(a,e,t)}function $I(e,t,n){return pC.runKernelFunc((function(r){return r.fill(e,t,n)}),{})}function QI(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");return pC.runKernelFunc((function(r){return r.linspace(e,t,n)}),{})}function YI(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r="float32"),0===n)throw new Error("Cannot have a step of zero");if(e===t||e<t&&n<0||t<e&&n>1)return XI([0],r);var a=MS(Math.abs(Math.ceil((t-e)/n)),r);t<e&&1===n&&(n=-1),a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+n;return jI(a,r)}var JI=PI({onesLike_:function(e){var t=SI(e,"x","onesLike");if("complex64"===t.dtype){var n=JI(BI(t)),r=ZI(VI(t));return LI(n,r)}return pC.runKernelFunc((function(e){return e.onesLike(t)}),{x:t},(function(e,t){return{x:function(){return ZI(e)}}}),"OnesLike")}}),ZI=PI({zerosLike_:function(e){var t=SI(e,"x","zerosLike");return pC.runKernelFunc((function(e){return e.zerosLike(t)}),{x:t},(function(e,t){return{x:function(){return ZI(e)}}}),"ZerosLike")}}),eT=PI({concat_:function(e,t){void 0===t&&(t=0),nS(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=CI(e,"tensors","concat");"complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype "+e.dtype+". ")})),t=dS(t,n[0].shape)[0];var r=FI(n.map((function(e){return e.shape})),t);if(0===oS(r))return zI([],r);if(1===(n=n.filter((function(e){return e.size>0}))).length)return n[0];var a=n.map((function(e){return e.shape}));MI(a,t);var i=n,o={axis:t};return pC.runKernelFunc((function(e){return e.concat(n,t)}),i,(function(e){var n=a.map((function(e){return e[t]}));return iT(e,n,t).map((function(e){return function(){return e}}))}),"Concat",o)}}),tT=PI({concat1d_:function(e){return eT(e,0)}}),nT=PI({concat2d_:function(e,t){return eT(e,t)}}),rT=PI({concat3d_:function(e,t){return eT(e,t)}}),aT=PI({concat4d_:function(e,t){return eT(e,t)}}),iT=PI({split_:function(e,t,n){void 0===n&&(n=0);var r,a=SI(e,"x","split");return n=dS(n,a.shape)[0],"number"==typeof t?(nS(a.shape[n]%t==0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(a.shape[n]/t)):(nS(a.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t),pC.runKernelFunc((function(e){return e.split(a,r,n)}),{$x:a},(function(e){return{$x:function(){return eT(e,n)}}}))}});function oT(e,t,n){return void 0===t&&(t="float32"),t=t||"float32",PS(e),new KS(e,t,n)}var sT=PI({batchToSpaceND_:function(e,t,n){var r=SI(e,"x","batchToSpaceND"),a=t.reduce((function(e,t){return e*t}));return nS(r.rank>=1+t.length,(function(){return"input rank is "+r.rank+" but should be > than blockShape.length "+t.length})),nS(n.length===t.length,(function(){return"crops.length is "+n.length+" but should be equal to blockShape.length  "+t.length})),nS(r.shape[0]%a==0,(function(){return"input tensor batch is "+r.shape[0]+" but is not divisible by the product of the elements of blockShape "+t.join(" * ")+" === "+a})),pC.runKernelFunc((function(e){return e.batchToSpaceND(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.spaceToBatchND(t,n)}}}))}}),uT=PI({cast_:function(e,t){var n=SI(e,"x","cast");if(!bS(t))throw new Error("Failed to cast to unknown dtype "+t);if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var r={dtype:t};return pC.runKernelFunc((function(e){return e.cast(n,t)}),{x:n},(function(e){return{x:function(){return e.clone()}}}),"Cast",r)}}),cT=PI({cumsum_:function(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=!1),void 0===r&&(r=!1);var a=SI(e,"x","cumsum"),i=AI([t|=0],a.rank),o=a;null!=i&&(o=a.transpose(i));var s=OI(1,a.rank)[0],u=pC.runKernelFunc((function(e){return e.cumsum(o,s,n,r)}),{permutedX:o},(function(e){return{permutedX:function(){return e.cumsum(t,n,!r)}}}));return null!=i&&(u=u.transpose(i)),u}}),lT=PI({depthToSpace_:function(e,t,n){void 0===n&&(n="NHWC");var r=SI(e,"x","depthToSpace"),a="NHWC"===n?r.shape[1]:r.shape[2],i="NHWC"===n?r.shape[2]:r.shape[3],o="NHWC"===n?r.shape[3]:r.shape[1];return nS(a*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+a+" and "+t+"  for depthToSpace with input shape\n      "+r.shape})),nS(i*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n      "+i+" and "+t+" for depthToSpace with input shape\n          "+r.shape})),nS(o%(t*t)==0,(function(){return"Dimension size must be evenly divisible by "+t*t+" but is "+o+" for depthToSpace with input shape "+r.shape})),pC.runKernelFunc((function(e){return e.depthToSpace(r,t,n)}),{$x:r})}}),fT=PI({expandDims_:function(e,t){void 0===t&&(t=0);var n=SI(e,"x","expandDims",null);nS(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var r=n.shape.slice();return t<0&&(nS(-(n.rank+1)<=t,(function(){return"Axis must be in the interval ["+-(n.rank+1)+", "+n.rank+"]"})),t=n.rank+t+1),r.splice(t,0,1),hT(n,r)}}),hT=PI({reshape_:function(e,t){var n=SI(e,"x","reshape",null);t=pS(t,n.size),nS(n.size===oS(t),(function(){return"new shape and old shape must have the same number of elements."}));var r={shape:t};return pC.runKernelFunc((function(e){return e.reshape(n,t)}),{x:n},(function(e){return{x:function(){return e.reshape(n.shape)}}}),"Reshape",r)}}),pT=PI({spaceToBatchND_:function(e,t,n){var r=SI(e,"x","spaceToBatchND");return nS(r.rank>=1+t.length,(function(){return"input rank "+r.rank+" should be > than [blockShape] "+t.length})),nS(n.length===t.length,(function(){return"paddings.shape[0] "+n.length+" must be equal to [blockShape] "+t.length})),nS(r.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]==0:e}),!0),(function(){return"input spatial dimensions "+r.shape.slice(1)+" with paddings "+n.toString()+" must be divisible by blockShapes "+t.toString()})),pC.runKernelFunc((function(e){return e.spaceToBatchND(r,t,n)}),{$x:r},(function(e){return{$x:function(){return e.batchToSpaceND(t,n)}}}))}}),dT=PI({squeeze_:function(e,t){var n=SI(e,"x","squeeze");return hT(n,vS(n.shape,t).newShape)}}),vT=PI({stack_:function(e,t){void 0===t&&(t=0);var n=CI(e,"tensors","stack");if(nS(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),1===n.length)return n[0].expandDims(t);var r=n[0].rank,a=n[0].shape,i=n[0].dtype;nS(t<=r,(function(){return"Axis must be <= rank of the tensor"})),n.forEach((function(e){rS(a,e.shape,"All tensors passed to stack must have matching shapes")})),n.forEach((function(e){nS(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var o=n.map((function(e){return e.expandDims(t)}));return eT(o,t)}}),mT=PI({unstack_:function(e,t){void 0===t&&(t=0),t=t||0;var n=SI(e,"x","unstack");nS(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = "+t+" is not in [-"+n.shape.length+", "+n.shape.length+")"})),t<0&&(t+=n.shape.length);var r={axis:t};return pC.runKernelFunc((function(e){return e.unstack(n,t)}),{x:n},(function(e){return{x:function(){return vT(e,t)}}}),"Unpack",r)}}),yT=function(e,t){return BE(this,void 0,void 0,(function(){var n,r,a,i,o,s,u,c,l,f;return VE(this,(function(h){switch(h.label){case 0:return n=SI(e,"x","setdiff1d"),r=SI(t,"y","setdiff1d"),nS(n.dtype===r.dtype,(function(){return"x and y should have the same dtype, but got x ("+n.dtype+") and y ("+r.dtype+")."})),nS(1===n.rank,(function(){return"x should be 1D tensor, but got x ("+n.shape+")."})),nS(1===r.rank,(function(){return"y should be 1D tensor, but got y ("+r.shape+")."})),[4,n.data()];case 1:return a=h.sent(),[4,r.data()];case 2:for(i=h.sent(),o=new Set(i),s=0,l=0;l<a.length;l++)o.has(a[l])||s++;for(u=new KS([s],n.dtype),c=new KS([s],"int32"),l=0,f=0;l<a.length;l++)o.has(a[l])||(u.values[f]=a[l],c.values[f]=l,f++);return[2,[u.toTensor(),c.toTensor()]]}}))}))};function gT(e,t,n,r){void 0===r&&(r=!0);var a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function bT(e,t,n){void 0===n&&(n=!0);var r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{var i=[],o=[];for(a=1;a<e;++a)a>=2*t+1||a%2==1?o.push(a):i.push(a);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function xT(e,t,n,r){void 0===r&&(r=!0);var a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function wT(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function kT(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}var ET="Div",ST="SquaredDifference",CT="BroadcastTo",IT="OneHot",TT="Identity",NT="Tile",_T="PadV2",RT=PI({add_:function(e,t){var n,r=SI(e,"a","add"),a=SI(t,"b","add");n=sC(r,a),r=n[0],a=n[1];var i={a:r,b:a};return pC.runKernelFunc((function(e,t){var n=e.add(r,a);return t([r,a]),n}),i,null,"Add")}});function AT(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function DT(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function OT(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o)throw Error("Operands could not be broadcast together with shapes "+e+" and "+t+".");n.unshift(i)}}return n}var MT=PI({abs_:function(e){var t=SI(e,"x","abs");return"complex64"===t.dtype?pC.runKernelFunc((function(e){return e.complexAbs(t)}),{$x:t}):pC.runKernelFunc((function(e,n){var r=e.abs(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().step(-1))}}}),"Abs")}}),FT=PI({acos_:function(e){var t=SI(e,"x","acos");return pC.runKernelFunc((function(e,n){var r=e.acos(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(WI(1).sub(n.toFloat().square()).sqrt()).neg()}}}))}}),PT=PI({acosh_:function(e){var t=SI(e,"x","acosh");return pC.runKernelFunc((function(e,n){var r=e.acosh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(n.toFloat().square().sub(1).sqrt())}}}))}}),LT=PI({asin_:function(e){var t=SI(e,"x","asin");return pC.runKernelFunc((function(e,n){var r=e.asin(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(WI(1).sub(n.toFloat().square()).sqrt())}}}))}}),BT=PI({asinh_:function(e){var t=SI(e,"x","asinh");return pC.runKernelFunc((function(e,n){var r=e.asinh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.divStrict(WI(1).add(n.toFloat().square()).sqrt())}}}))}}),VT=PI({atan_:function(e){var t=SI(e,"x","atan");return pC.runKernelFunc((function(e,n){var r=e.atan(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().square().add(1))}}}))}}),zT=PI({atanh_:function(e){var t=SI(e,"x","atanh");return pC.runKernelFunc((function(e,n){var r=e.atanh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(WI(1).sub(n.toFloat().square()))}}}))}}),UT=PI({ceil_:function(e){var t=SI(e,"x","ceil");return pC.runKernelFunc((function(e){return e.ceil(t)}),{$x:t},(function(e){return{$x:function(){return ZI(e)}}}))}}),WT=PI({clipByValue_:function(e,t,n){var r=SI(e,"x","clipByValue");nS(t<=n,(function(){return"Error in clip: min ("+t+") must be less than or equal to max ("+n+")."}));var a=[r],i={min:t,max:n};return pC.runKernelFunc((function(e,a){var i=e.clip(r,t,n);return a([r]),i}),{x:r},(function(e,r){var a=r[0];return{x:function(){return e.where(a.greaterEqual(t).logicalAnd(a.lessEqual(n)),ZI(e))}}}),"ClipByValue",i,a)}}),jT=PI({cos_:function(e){var t=SI(e,"x","cos"),n=[t];return pC.runKernelFunc((function(e,n){var r=e.cos(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return n.toFloat().sin().neg().mul(e)}}}),"Cos",{},n)}}),GT=PI({cosh_:function(e){var t=SI(e,"x","cosh");return pC.runKernelFunc((function(e,n){var r=e.cosh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return n.toFloat().sinh().mulStrict(e)}}}))}}),HT=PI({erf_:function(e){var t=SI(e,"x","erf");return nS("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=t.toFloat()),pC.runKernelFunc((function(e,n){var r=e.erf(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.square().neg().exp().mul(2/Math.sqrt(Math.PI)))}}}))}}),qT=PI({exp_:function(e){var t=SI(e,"x","exp");return pC.runKernelFunc((function(e,n){var r=e.exp(t);return n([r]),r}),{x:t},(function(e,t){return{x:function(){return e.mulStrict(t[0])}}}),"Exp",{},[],[!0])}}),KT=PI({expm1_:function(e){var t=SI(e,"x","expm1");return pC.runKernelFunc((function(e,n){var r=e.expm1(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.exp())}}}))}}),XT=PI({floor_:function(e){var t=SI(e,"x","floor");return pC.runKernelFunc((function(e){return e.floor(t)}),{$x:t},(function(e){return{$x:function(){return ZI(e)}}}))}}),$T=PI({log_:function(e){var t=SI(e,"x","log"),n=[t];return pC.runKernelFunc((function(e,n){var r=e.log(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.div(n.toFloat())}}}),"Log",{},n)}}),QT=PI({log1p_:function(e){var t=SI(e,"x","log1p");return pC.runKernelFunc((function(e,n){var r=e.log1p(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.add(1))}}}))}}),YT=PI({logSigmoid_:function(e){var t=SI(e,"x","logSigmoid");return pC.runKernelFunc((function(e,n){var r=e.softplus(t.neg()).neg();return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.neg().sigmoid())}}}))}}),JT=PI({neg_:function(e){var t=SI(e,"x","neg"),n=[t];return pC.runKernelFunc((function(e){return e.neg(t)}),{x:t},(function(e){return{x:function(){return e.neg()}}}),"Neg",{},n)}}),ZT=PI({reciprocal_:function(e){var t=SI(e,"x","reciprocal");return pC.runKernelFunc((function(e,n){var r=e.reciprocal(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.square().neg())}}}))}}),eN=PI({round_:function(e){var t=SI(e,"x","round");return pC.runKernelFunc((function(e){return e.round(t)}),{$x:t},(function(e){return{$x:function(){return ZI(e)}}}))}}),tN=PI({rsqrt_:function(e){var t=SI(e,"x","rsqrt"),n=[t];return pC.runKernelFunc((function(e,n){var r=e.rsqrt(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.div(n.pow(1.5).mul(2)).neg()}}}),"Rsqrt",{},n)}}),nN=PI({sigmoid_:function(e){var t=SI(e,"x","sigmoid");return pC.runKernelFunc((function(e,n){var r=e.sigmoid(t);return n([r]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mul(n.mul(WI(1).sub(n)))}}}),"Sigmoid")}}),rN=PI({sign_:function(e){var t=SI(e,"x","sign");return pC.runKernelFunc((function(e){return e.sign(t)}),{$x:t},(function(e){return{$x:function(){return ZI(e)}}}))}}),aN=PI({isNaN_:function(e){var t=SI(e,"x","isNaN");return pC.runKernelFunc((function(e){return e.isNaN(t)}),{$x:t},(function(e){return{$x:function(){return ZI(e)}}}))}}),iN=PI({isInf_:function(e){var t=SI(e,"x","isInf");return pC.runKernelFunc((function(e){return e.isInf(t)}),{$x:t},(function(e){return{$x:function(){return ZI(e)}}}))}}),oN=PI({isFinite_:function(e){var t=SI(e,"x","isFinite");return pC.runKernelFunc((function(e){return e.isFinite(t)}),{$x:t},(function(e){return{$x:function(){return ZI(e)}}}))}}),sN=PI({sin_:function(e){var t=SI(e,"x","sin"),n=[t];return pC.runKernelFunc((function(e,n){var r=e.sin(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return n.toFloat().cos().mul(e)}}}),"Sin",{},n)}}),uN=PI({sinh_:function(e){var t=SI(e,"x","sinh");return pC.runKernelFunc((function(e,n){var r=e.sinh(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return n.toFloat().cosh().mulStrict(e)}}}))}}),cN=PI({softplus_:function(e){var t=SI(e,"x","softplus");return pC.runKernelFunc((function(e,n){var r=e.softplus(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.mul(n.sigmoid())}}}))}}),lN=PI({sqrt_:function(e){var t=SI(e,"x","sqrt");return pC.runKernelFunc((function(e,n){var r=e.sqrt(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.toFloat().sqrt().mul(2))}}}))}}),fN=PI({step_:function(e,t){void 0===t&&(t=0);var n=SI(e,"x","step");return pC.runKernelFunc((function(e){return e.step(n,t)}),{$x:n},(function(e){return{$x:function(){return ZI(e)}}}))}}),hN=PI({tan_:function(e){var t=SI(e,"x","tan");return pC.runKernelFunc((function(e,n){var r=e.tan(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return e.div(n.cos().square())}}}))}}),pN=PI({tanh_:function(e){var t=SI(e,"x","tanh");return pC.runKernelFunc((function(e,n){var r=e.tanh(t);return n([r]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return WI(1).sub(n.square()).mulStrict(e)}}}),"Tanh",{},null,[!0])}}),dN=PI({addStrict_:function(e,t){var n=SI(e,"a","addStrict"),r=SI(t,"b","addStrict");return rS(n.shape,r.shape,"Error in addStrict: "),n.add(r)}}),vN=PI({atan2_:function(e,t){var n,r=SI(e,"a","atan2"),a=SI(t,"b","atan2");n=sC(r,a),r=n[0],a=n[1];var i=OT(r.shape,a.shape);return pC.runKernelFunc((function(e,t){var n=e.atan2(r,a);return t([r,a]),n}),{$a:r,$b:a},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=RT(n.square(),r.square()),a=e.mul(r.div(t)),o=DT(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},$b:function(){var t=RT(n.square(),r.square()),a=JT(e.mul(n.div(t))),o=DT(r.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(r.shape)}}}))}}),mN=PI({divStrict_:function(e,t){var n=SI(e,"a","div"),r=SI(t,"b","div");return rS(n.shape,r.shape,"Error in divideStrict: "),n.div(r)}}),yN=PI({floorDiv_:function(e,t){var n,r=SI(e,"a","floorDiv"),a=SI(t,"b","floorDiv");n=sC(r,a),r=n[0],a=n[1];var i=OT(r.shape,a.shape);return pC.runKernelFunc((function(e,t){var n=e.floorDiv(r,a);return t([r,a]),n}),{a:r,b:a},(function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.div(r.toFloat()),a=DT(n.shape,i);return a.length>0?t.sum(a).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),a=DT(r.shape,i);a.length>0&&(t=t.sum(a).reshape(r.shape));var o=r.square();return t.div(o.toFloat()).neg()}}}),"FloorDiv")}}),gN=PI({maximum_:function(e,t){var n,r=SI(e,"a","maximum"),a=SI(t,"b","maximum");return n=sC(r,a),r=n[0],a=n[1],"bool"===r.dtype&&(r=r.toInt(),a=a.toInt()),OT(r.shape,a.shape),pC.runKernelFunc((function(e,t){var n=e.maximum(r,a);return t([r,a]),n}),{a:r,b:a},(function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.greaterEqual(r).toFloat())},b:function(){return e.mul(n.less(r).toFloat())}}}),"Maximum")}}),bN=PI({maximumStrict_:function(e,t){var n=SI(e,"a","maximumStrict"),r=SI(t,"b","maximumStrict");return rS(n.shape,r.shape,"Error in maximumStrict: "),n.maximum(r)}}),xN=PI({minimum_:function(e,t){var n,r=SI(e,"a","minimum"),a=SI(t,"b","minimum");return n=sC(r,a),r=n[0],a=n[1],"bool"===r.dtype&&(r=r.toInt(),a=a.toInt()),OT(r.shape,a.shape),pC.runKernelFunc((function(e,t){var n=e.minimum(r,a);return t([r,a]),n}),{a:r,b:a},(function(e,t){var n=t[0],r=t[1];return{a:function(){return e.mul(n.lessEqual(r).toFloat())},b:function(){return e.mul(n.greater(r).toFloat())}}}),"Minimum")}}),wN=PI({minimumStrict_:function(e,t){var n=SI(e,"a","minimumStrict"),r=SI(t,"b","minimumStrict");return rS(n.shape,r.shape,"Error in minimumStrict: "),n.minimum(r)}}),kN=PI({mod_:function(e,t){var n,r=SI(e,"a","mod"),a=SI(t,"b","mod");n=sC(r,a),r=n[0],a=n[1];var i=OT(r.shape,a.shape);return pC.runKernelFunc((function(e,t){var n=e.mod(r,a);return t([r,a]),n}),{$a:r,$b:a},(function(e,t){var n=t[0],r=t[1];return{$a:function(){var t=DT(n.shape,i);return t.length>0?e.sum(t).reshape(n.shape):e},$b:function(){var t=e.mul(n.div(r).floor().neg()),a=DT(r.shape,i);return a.length>0?t.sum(a).reshape(r.shape):t}}}))}}),EN=PI({modStrict_:function(e,t){var n=SI(e,"a","modStrict"),r=SI(t,"b","modStrict");return rS(n.shape,r.shape,"Error in modStrict: "),n.mod(r)}}),SN=PI({mul_:function(e,t){var n,r=SI(e,"a","mul"),a=SI(t,"b","mul");n=sC(r,a),r=n[0],a=n[1];var i=OT(r.shape,a.shape);return pC.runKernelFunc((function(e,t){var n=e.multiply(r,a);return t([r,a]),n}),{a:r,b:a},(function(e,t){var n=t[0],r=t[1];return{a:function(){var t=e.mul(r.toFloat()),a=DT(n.shape,i);return a.length>0?t.sum(a).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),a=DT(r.shape,i);return a.length>0?t.sum(a).reshape(r.shape):t}}}),"Mul")}}),CN=PI({mulStrict_:function(e,t){var n=SI(e,"a","mul"),r=SI(t,"b","mul");return rS(n.shape,r.shape,"Error in multiplyStrict: "),n.mul(r)}}),IN=PI({pow_:function(e,t){var n,r=SI(e,"base","pow"),a=SI(t,"exp","pow");n=sC(r,a),r=n[0],a=n[1];var i=OT(r.shape,a.shape),o=[r,a];return pC.runKernelFunc((function(e,t){var n=e.pow(r,a);return t([r,a,n]),n}),{a:r,b:a},(function(e,t){var n=t[0],r=t[1],a=t[2];return{a:function(){var t=r.toFloat(),a=e.mul(t.mul(n.pow(t.sub(WI(1))))),o=DT(n.shape,i);return o.length>0&&(a=a.sum(o)),a.reshape(n.shape)},b:function(){var t=n.greater(0),o=n.log().where(t,ZI(n)),s=e.mul(a.mul(o)),u=DT(r.shape,i);return u.length>0&&(s=s.sum(u)),s.reshape(r.shape)}}}),"Pow",{},o,[!0])}}),TN=PI({powStrict_:function(e,t){return rS(e.shape,t.shape,"Error in powStrict: "),e.pow(t)}}),NN=PI({squaredDifferenceStrict_:function(e,t){var n=SI(e,"a","squaredDifferenceStrict"),r=SI(t,"b","squaredDifferenceStrict");return rS(n.shape,r.shape,"Error in squaredDifferenceStrict: "),n.squaredDifference(r)}}),_N=PI({sub_:function(e,t){var n,r=SI(e,"a","sub"),a=SI(t,"b","sub");n=sC(r,a),r=n[0],a=n[1];var i=OT(r.shape,a.shape);return pC.runKernelFunc((function(e){return e.subtract(r,a)}),{a:r,b:a},(function(e){return{a:function(){var t=e,n=DT(r.shape,i);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)},b:function(){var t=e,n=DT(a.shape,i);return n.length>0&&(t=t.sum(n)),t.neg().reshape(a.shape)}}}),"Sub")}}),RN=PI({subStrict_:function(e,t){var n=SI(e,"a","subStrict"),r=SI(t,"b","subStrict");return rS(n.shape,r.shape,"Error in subStrict: "),n.sub(r)}}),AN=PI({div_:function(e,t){var n,r=SI(e,"a","div"),a=SI(t,"b","div");if(n=sC(r,a),r=n[0],a=n[1],"int32"===r.dtype&&"int32"===a.dtype)return yN(r,a);var i={a:r,b:a};return pC.runKernelFunc((function(e,t){var n=e.realDivide(r,a);return t([r,a]),n}),i,null,ET,{})}});function DN(e,t){if(e.rank<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher, but the rank was "+e.rank+".");if(t.rank<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type, but the dtype was "+t.dtype+".");if(t.shape[t.rank-1]>e.rank)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+t.shape[t.rank-1]+" vs. "+e.rank);if(0===e.size)throw new Error("Requested more than 0 entries, but input is empty. Input shape: "+e.shape+".");for(var n=t.shape,r=n[n.length-1],a=1,i=0;i<n.length-1;++i)a*=n[i];var o=e.shape,s=n.slice();s.pop();var u=1;for(i=r;i<e.rank;++i)u*=o[i],s.push(o[i]);var c=RS(e.shape).map((function(e){return e/u})).concat([1]).slice(0,r);return[s,a,u,c]}Object.freeze({prepareAndValidate:DN});function ON(e){return e<=30?e:_S(e,Math.floor(Math.sqrt(e)))}function MN(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: "+n.shape+", indices.shape: "+t.shape+", shape: "+e+", sliceDim: "+r+", and batchDim: "+a+".";if(n.rank<a)throw new Error(i+" update.rank < "+a+". ");if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < "+(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != "+(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape["+o+"] ("+n.shape[o]+") != indices.shape["+o+"] ("+t.shape[o]+").");for(o=0;o<n.rank-a;++o)if(n.shape[o+a]!==e[o+r])throw new Error(i+" updates.shape["+(o+a)+"] ("+n.shape[o+a]+") != shape["+(o+a)+"] ("+e[o+a]+")")}function FN(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher, but the rank was "+t.rank+".");if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher, but the rank was "+e.rank+".");if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: "+t.dtype);if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: "+n);if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: "+t.shape);if(0===e.size)throw new Error("Updates specified for empty output. updates shape: "+e.shape)}MN(n,t,e)}function PN(e,t,n){for(var r=t.shape.length,a=r>1?t.shape[r-1]:1,i=n.length,o=1,s=a;s<i;++s)o*=n[s];var u=a<1?1:a;return{sliceRank:a,numUpdates:oS(t.shape)/u,sliceSize:o,strides:RS(n.slice(0,a)).concat([1]),outputSize:oS(n)}}Object.freeze({validateUpdateShape:MN,validateInput:FN,calculateShapes:PN});function LN(e,t,n){nS(e.rank===t.length,(function(){return"Error in slice"+e.rank+"D: Length of begin "+t+" must match the rank of the array ("+e.rank+")."})),nS(e.rank===n.length,(function(){return"Error in slice"+e.rank+"D: Length of size "+n+" must match the rank of the array ("+e.rank+")."}));for(var r=function(r){nS(t[r]+n[r]<=e.shape[r],(function(){return"Error in slice"+e.rank+"D: begin["+r+"] + size["+r+"] ("+(t[r]+n[r])+") would overflow input.shape["+r+"] ("+e.shape[r]+")"}))},a=0;a<e.rank;++a)r(a)}function BN(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function VN(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function zN(e,t,n,r,a){var i=t[a],o=n[a]||1;(e&1<<a||null==i)&&(i=o>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var s=r[a];return i<0&&(i+=s),ZE(0,i,s-1)}function UN(e,t,n,r,a){var i=t[a],o=n[a]||1;(e&1<<a||null==i)&&(i=o>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var s=r[a];return i<0&&(i+=s),o>0?ZE(0,i,s):ZE(-1,i,s-1)}function WN(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(a=r+1;a<n.length;a++)if(t[a]>0||n[a]!==e[a])return!1;return!0}function jN(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}Object.freeze({assertParamsValid:LN,maskToAxes:BN,computeOutShape:VN,startForAxis:zN,stopForAxis:UN,isSliceContinous:WN,computeFlatOffset:jN});function GN(e){return pC.customGrad(e)}var HN=PI({softmax_:function(e,t){void 0===t&&(t=-1);var n=SI(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and dim was "+t);return pC.runKernelFunc((function(e,r){var a=e.softmax(n,t);return r([a]),a}),{logits:n},(function(e,n){var r=n[0],a=e.mul(r);return{logits:function(){return a.sub(a.sum([t],!0).mul(r))}}}),"Softmax",{dim:t},[],[!0])}}),qN=PI({logSoftmax_:function(e,t){void 0===t&&(t=-1);var n=SI(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. Logits was rank "+n.rank+" and axis was "+t);return GN((function(e,n){var r=e.max(t,!0),a=e.sub(r),i=a.toFloat().sub(a.exp().sum(t,!0).log());return n([i]),{value:i,gradFunc:function(e,n){var r=n[0].exp();return e.sub(e.sum(t,!0).mul(r))}}}))(n)}}),KN=PI({transpose_:function(e,t){var n=SI(e,"x","transpose");if(null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),nS(n.rank===t.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of perm "+t+"."})),t.forEach((function(e){nS(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and "+(n.rank-1)+" but got "+t}))})),n.rank<=1)return n.clone();var r={perm:t};return pC.runKernelFunc((function(e){return e.transpose(n,t)}),{x:n},null,"Transpose",r)}}),XN=function(){function e(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}return e.prototype.get=function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)},e.prototype.set=function(e,t){this.dataIdsCount++,this.data.set(e,t)},e.prototype.has=function(e){return this.data.has(e)},e.prototype.delete=function(e){return this.dataIdsCount--,this.data.delete(e)},e.prototype.numDataIds=function(){return this.dataIdsCount},e}(),$N=function(){function e(){}return e.prototype.time=function(e){return QN("time")},e.prototype.read=function(e){return QN("read")},e.prototype.readSync=function(e){return QN("readSync")},e.prototype.numDataIds=function(){return QN("numDataIds")},e.prototype.disposeData=function(e){return QN("disposeData")},e.prototype.write=function(e,t,n){return QN("write")},e.prototype.move=function(e,t,n,r){return QN("move")},e.prototype.memory=function(){return QN("memory")},e.prototype.floatPrecision=function(){return QN("floatPrecision")},e.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},e.prototype.batchMatMul=function(e,t,n,r){return QN("batchMatMul")},e.prototype.fusedBatchMatMul=function(e){return e.a,e.b,e.transposeA,e.transposeB,e.bias,e.activation,e.preluActivationWeights,QN("fusedBatchMatMul")},e.prototype.slice=function(e,t,n){return QN("slice")},e.prototype.stridedSlice=function(e,t,n,r){return QN("stridedSlice")},e.prototype.unstack=function(e,t){return QN("unstack")},e.prototype.reverse=function(e,t){return QN("reverse")},e.prototype.concat=function(e,t){return QN("concat")},e.prototype.neg=function(e){return QN("neg")},e.prototype.add=function(e,t){return QN("add")},e.prototype.addN=function(e){return QN("addN")},e.prototype.subtract=function(e,t){return QN("subtract")},e.prototype.multiply=function(e,t){return QN("multiply")},e.prototype.realDivide=function(e,t){return QN("realDivide")},e.prototype.floorDiv=function(e,t){return QN("floorDiv")},e.prototype.sum=function(e,t){return QN("sum")},e.prototype.prod=function(e,t){return QN("prod")},e.prototype.unsortedSegmentSum=function(e,t,n){return QN("unsortedSegmentSum")},e.prototype.argMin=function(e,t){return QN("argMin")},e.prototype.argMax=function(e,t){return QN("argMax")},e.prototype.equal=function(e,t){return QN("equal")},e.prototype.notEqual=function(e,t){return QN("notEqual")},e.prototype.less=function(e,t){return QN("less")},e.prototype.lessEqual=function(e,t){return QN("lessEqual")},e.prototype.greater=function(e,t){return QN("greater")},e.prototype.greaterEqual=function(e,t){return QN("greaterEqual")},e.prototype.logicalNot=function(e){return QN("logicalNot")},e.prototype.logicalAnd=function(e,t){return QN("logicalAnd")},e.prototype.logicalOr=function(e,t){return QN("logicalOr")},e.prototype.where=function(e){return QN("where")},e.prototype.select=function(e,t,n){return QN("select")},e.prototype.topk=function(e,t,n){return QN("topk")},e.prototype.min=function(e,t){return QN("min")},e.prototype.minimum=function(e,t){return QN("minimum")},e.prototype.mod=function(e,t){return QN("mod")},e.prototype.max=function(e,t){return QN("max")},e.prototype.maximum=function(e,t){return QN("maximum")},e.prototype.all=function(e,t){return QN("all")},e.prototype.any=function(e,t){return QN("any")},e.prototype.squaredDifference=function(e,t){return QN("squaredDifference")},e.prototype.ceil=function(e){return QN("ceil")},e.prototype.floor=function(e){return QN("floor")},e.prototype.round=function(e){return QN("round")},e.prototype.sign=function(e){return QN("sign")},e.prototype.isNaN=function(e){return QN("isNaN")},e.prototype.isInf=function(e){return QN("isInf")},e.prototype.isFinite=function(e){return QN("isFinite")},e.prototype.pow=function(e,t){return QN("pow")},e.prototype.exp=function(e){return QN("exp")},e.prototype.expm1=function(e){return QN("expm1")},e.prototype.softmax=function(e,t){return QN("softmax")},e.prototype.log=function(e){return QN("log")},e.prototype.log1p=function(e){return QN("log1p")},e.prototype.sqrt=function(e){return QN("sqrt")},e.prototype.rsqrt=function(e){return QN("rsqrt")},e.prototype.square=function(e){return QN("square")},e.prototype.reciprocal=function(e){return QN("reciprocal")},e.prototype.relu=function(e){return QN("relu")},e.prototype.relu6=function(e){return QN("relu6")},e.prototype.prelu=function(e,t){return QN("prelu")},e.prototype.elu=function(e){return QN("elu")},e.prototype.eluDer=function(e,t){return QN("eluDer")},e.prototype.selu=function(e){return QN("selu")},e.prototype.int=function(e){return QN("int")},e.prototype.clip=function(e,t,n){return QN("clip")},e.prototype.abs=function(e){return QN("abs")},e.prototype.complexAbs=function(e){return QN("complexAbs")},e.prototype.sigmoid=function(e){return QN("sigmoid")},e.prototype.softplus=function(e){return QN("softplus")},e.prototype.sin=function(e){return QN("sin")},e.prototype.cos=function(e){return QN("cos")},e.prototype.tan=function(e){return QN("tan")},e.prototype.asin=function(e){return QN("asin")},e.prototype.acos=function(e){return QN("acos")},e.prototype.atan=function(e){return QN("atan")},e.prototype.atan2=function(e,t){return QN("atan2")},e.prototype.sinh=function(e){return QN("sinh")},e.prototype.cosh=function(e){return QN("cosh")},e.prototype.tanh=function(e){return QN("tanh")},e.prototype.asinh=function(e){return QN("asinh")},e.prototype.acosh=function(e){return QN("acosh")},e.prototype.atanh=function(e){return QN("atanh")},e.prototype.erf=function(e){return QN("erf")},e.prototype.step=function(e,t){return QN("step")},e.prototype.fusedConv2d=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,QN("fusedConv2d")},e.prototype.conv2d=function(e,t,n){return QN("conv2d")},e.prototype.conv2dDerInput=function(e,t,n){return QN("conv2dDerInput")},e.prototype.conv2dDerFilter=function(e,t,n){return QN("conv2dDerFilter")},e.prototype.fusedDepthwiseConv2D=function(e){return e.input,e.filter,e.convInfo,e.bias,e.activation,e.preluActivationWeights,QN("fusedDepthwiseConv2D")},e.prototype.depthwiseConv2D=function(e,t,n){return QN("depthwiseConv2D")},e.prototype.depthwiseConv2DDerInput=function(e,t,n){return QN("depthwiseConv2DDerInput")},e.prototype.depthwiseConv2DDerFilter=function(e,t,n){return QN("depthwiseConv2DDerFilter")},e.prototype.conv3d=function(e,t,n){return QN("conv3d")},e.prototype.conv3dDerInput=function(e,t,n){return QN("conv3dDerInput")},e.prototype.conv3dDerFilter=function(e,t,n){return QN("conv3dDerFilter")},e.prototype.maxPool=function(e,t){return QN("maxPool")},e.prototype.maxPoolBackprop=function(e,t,n,r){return QN("maxPoolBackprop")},e.prototype.avgPool=function(e,t){return QN("avgPool")},e.prototype.avgPoolBackprop=function(e,t,n){return QN("avgPoolBackprop")},e.prototype.avgPool3d=function(e,t){return QN("avgPool3d")},e.prototype.avgPool3dBackprop=function(e,t,n){return QN("avgPool3dBackprop")},e.prototype.maxPool3d=function(e,t){return QN("maxPool3d")},e.prototype.maxPool3dBackprop=function(e,t,n,r){return QN("maxPool3dBackprop")},e.prototype.reshape=function(e,t){return QN("reshape")},e.prototype.cast=function(e,t){return QN("cast")},e.prototype.tile=function(e,t){return QN("tile")},e.prototype.pad=function(e,t,n){return QN("pad")},e.prototype.transpose=function(e,t){return QN("transpose")},e.prototype.gather=function(e,t,n){return QN("gather")},e.prototype.gatherND=function(e,t){return QN("gatherND")},e.prototype.scatterND=function(e,t,n){return QN("scatterND")},e.prototype.batchToSpaceND=function(e,t,n){return QN("batchToSpaceND")},e.prototype.spaceToBatchND=function(e,t,n){return QN("spaceToBatchND")},e.prototype.resizeBilinear=function(e,t,n,r){return QN("resizeBilinear")},e.prototype.resizeBilinearBackprop=function(e,t,n){return QN("resizeBilinearBackprop")},e.prototype.resizeNearestNeighbor=function(e,t,n,r){return QN("resizeNearestNeighbor")},e.prototype.resizeNearestNeighborBackprop=function(e,t,n){return QN("resizeNearestNeighborBackprop")},e.prototype.batchNormalization=function(e,t,n,r,a,i){return QN("batchNormalization")},e.prototype.localResponseNormalization4D=function(e,t,n,r,a){return QN("localResponseNormalization4D")},e.prototype.LRNGrad=function(e,t,n,r,a,i,o){return QN("LRNGrad")},e.prototype.multinomial=function(e,t,n,r){return QN("multinomial")},e.prototype.oneHot=function(e,t,n,r){return QN("oneHot")},e.prototype.cumsum=function(e,t,n,r){return QN("cumsum")},e.prototype.nonMaxSuppression=function(e,t,n,r,a){return QN("nonMaxSuppression")},e.prototype.fft=function(e){return QN("fft")},e.prototype.ifft=function(e){return QN("ifft")},e.prototype.complex=function(e,t){return QN("complex")},e.prototype.real=function(e){return QN("real")},e.prototype.imag=function(e){return QN("imag")},e.prototype.cropAndResize=function(e,t,n,r,a,i){return QN("cropAndResize")},e.prototype.depthToSpace=function(e,t,n){return QN("depthToSpace")},e.prototype.split=function(e,t,n){return QN("split")},e.prototype.sparseToDense=function(e,t,n,r){return QN("sparseToDense")},e.prototype.diag=function(e){return QN("diag")},e.prototype.fill=function(e,t,n){return QN("fill")},e.prototype.onesLike=function(e){return QN("onesLike")},e.prototype.zerosLike=function(e){return QN("zerosLike")},e.prototype.linspace=function(e,t,n){return QN("linspace")},e.prototype.dispose=function(){return QN("dispose")},e}();function QN(e){throw new Error("'"+e+"' not yet implemented or not found in the registry. Did you forget to import the kernel?")}function YN(e,t,n,r,a,i,o){void 0===o&&(o="channelsLast");var s,u=n_(t),c=u[0],l=u[1];if("channelsLast"===o)s=[c,l,e[3],e[3]];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);s=[c,l,e[1],e[1]]}return ZN(e,s,n,r,a,i,!1,o)}function JN(e,t,n,r,a,i,o){void 0===o&&(o="NDHWC");var s,u,c=r_(t),l=c[0],f=c[1],h=c[2];if("NDHWC"===o)u="channelsLast",s=[l,f,h,e[4],e[4]];else{if("NCDHW"!==o)throw new Error("Unknown dataFormat "+o);u="channelsFirst",s=[l,f,h,e[1],e[1]]}return e_(e,s,n,r,a,!1,u,i)}function ZN(e,t,n,r,a,i,o,s){void 0===o&&(o=!1),void 0===s&&(s="channelsLast");var u=[-1,-1,-1,-1],c=u[0],l=u[1],f=u[2],h=u[3];if("channelsLast"===s)c=e[0],l=e[1],f=e[2],h=e[3];else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat "+s);c=e[0],h=e[1],l=e[2],f=e[3]}var p,d=t[0],v=t[1],m=t[3],y=n_(n),g=y[0],b=y[1],x=n_(r),w=x[0],k=x[1],E=a_(d,w),S=a_(v,k),C=function(e,t,n,r,a,i,o,s){var u,c,l;if("number"==typeof e){u={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var f=function(e,t,n,r,a){null==r&&(r=t_(e,t,n));var i=e[1],o=i_((e[0]-t+2*r)/n+1,a);nS(uS(o),(function(){return"The output # of rows ("+o+") must be an integer. Change the stride and/or zero pad parameters"}));var s=i_((i-t+2*r)/n+1,a);return nS(uS(s),(function(){return"The output # of columns ("+s+") must be an integer. Change the stride and/or zero pad parameters"})),[o,s]}([t,n],i,r,e,s);c=f[0],l=f[1]}else if("same"===e){c=Math.ceil(t/r),l=Math.ceil(n/a);var h=Math.max(0,(c-1)*r+i-t),p=Math.max(0,(l-1)*a+o-n),d=Math.floor(h/2),v=h-d,m=Math.floor(p/2);u={top:d,bottom:v,left:m,right:p-m,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);u={top:0,bottom:0,left:0,right:0,type:"VALID"},c=Math.ceil((t-i+1)/r),l=Math.ceil((n-o+1)/a)}return{padInfo:u,outHeight:c,outWidth:l}}(a,l,f,g,b,E,S,i),I=C.padInfo,T=C.outHeight,N=C.outWidth,_=o?m*h:m;return"channelsFirst"===s?p=[c,_,T,N]:"channelsLast"===s&&(p=[c,T,N,_]),{batchSize:c,dataFormat:s,inHeight:l,inWidth:f,inChannels:h,outHeight:T,outWidth:N,outChannels:_,padInfo:I,strideHeight:g,strideWidth:b,filterHeight:d,filterWidth:v,effectiveFilterHeight:E,effectiveFilterWidth:S,dilationHeight:w,dilationWidth:k,inShape:e,outShape:p,filterShape:t}}function e_(e,t,n,r,a,i,o,s){void 0===i&&(i=!1),void 0===o&&(o="channelsLast");var u=[-1,-1,-1,-1,-1],c=u[0],l=u[1],f=u[2],h=u[3],p=u[4];if("channelsLast"===o)c=e[0],l=e[1],f=e[2],h=e[3],p=e[4];else{if("channelsFirst"!==o)throw new Error("Unknown dataFormat "+o);c=e[0],p=e[1],l=e[2],f=e[3],h=e[4]}var d,v=t[0],m=t[1],y=t[2],g=t[4],b=r_(n),x=b[0],w=b[1],k=b[2],E=r_(r),S=E[0],C=E[1],I=E[2],T=a_(v,S),N=a_(m,C),_=a_(y,I),R=function(e,t,n,r,a,i,o,s,u,c,l){var f,h,p,d;if("number"==typeof e){f={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var v=function(e,t,n,r,a,i){null==a&&(a=t_(e,t,r));var o=e[1],s=e[2],u=i_((e[0]-t+2*a)/r+1,i);nS(uS(u),(function(){return"The output # of depths ("+u+") must be an integer. Change the stride and/or zero pad parameters"}));var c=i_((o-t+2*a)/r+1,i);nS(uS(c),(function(){return"The output # of rows ("+c+") must be an integer. Change the stride and/or zero pad parameters"}));var l=i_((s-t+2*a)/r+1,i);return nS(uS(l),(function(){return"The output # of columns ("+l+") must be an integer. Change the stride and/or zero pad parameters"})),[u,c,l,1]}([t,n,r,1],s,0,a,e,l);h=v[0],p=v[1],d=v[2]}else if("same"===e){var m=((h=Math.ceil(t/a))-1)*a+s-t,y=((p=Math.ceil(n/i))-1)*i+u-n,g=((d=Math.ceil(r/o))-1)*o+c-r,b=Math.floor(m/2),x=m-b,w=Math.floor(y/2),k=y-w,E=Math.floor(g/2);f={top:w,bottom:k,left:E,right:g-E,front:b,back:x,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: "+e);f={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},h=Math.ceil((t-s+1)/a),p=Math.ceil((n-u+1)/i),d=Math.ceil((r-c+1)/o)}return{padInfo:f,outDepth:h,outHeight:p,outWidth:d}}(a,l,f,h,x,w,k,T,N,_,s),A=R.padInfo,D=R.outDepth,O=R.outHeight,M=R.outWidth,F=i?g*p:g;return"channelsFirst"===o?d=[c,F,D,O,M]:"channelsLast"===o&&(d=[c,D,O,M,F]),{batchSize:c,dataFormat:o,inDepth:l,inHeight:f,inWidth:h,inChannels:p,outDepth:D,outHeight:O,outWidth:M,outChannels:F,padInfo:A,strideDepth:x,strideHeight:w,strideWidth:k,filterDepth:v,filterHeight:m,filterWidth:y,effectiveFilterDepth:T,effectiveFilterHeight:N,effectiveFilterWidth:_,dilationDepth:S,dilationHeight:C,dilationWidth:I,inShape:e,outShape:d,filterShape:t}}function t_(e,t,n,r){void 0===r&&(r=1);var a=a_(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function n_(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function r_(e){return"number"==typeof e?[e,e,e]:e}function a_(e,t){return t<=1?e:e+(e-1)*(t-1)}function i_(e,t){if(!t)return e;switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode "+t)}}function o_(e){var t=n_(e),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function s_(e,t){return o_(e)||o_(t)}function u_(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat "+e)}function c_(e,t,n){if("complex64"===t){if("complex64"===e.dtype)return e.clone();var r=XI(e.shape),a=e.toFloat(),i=n.complex(a,r);return r.dispose(),a.dispose(),i}if(!xS(e.dtype,t))return pC.makeTensorFromDataId(e.dataId,e.shape,t);if("complex64"===e.dtype){var o=n.real(e);return i=o.cast(t),o.dispose(),i}if("int32"===t)return n.int(e);if("bool"===t){var s=WI(0,e.dtype);return i=n.notEqual(e,s),s.dispose(),i}throw new Error("Error in Cast: failed to cast "+e.dtype+" to "+t)}function l_(e,t){return pC.makeTensorFromDataId(e.dataId,t,e.dtype)}function f_(e,t,n){var r=(t-e)/(n-1),a=MS(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return jI(a,"float32")}Object.freeze({castTensor:c_,reshapeTensor:l_,linspaceImpl:f_,upcastType:iC,axesAreInnerMostDims:II,combineLocations:TI,computeOutAndReduceShapes:NI,expandShapeToKeepDim:_I,assertAxesAreInnerMostDims:RI,getAxesPermutation:AI,getUndoAxesPermutation:DI,getInnerMostAxes:OI,getBroadcastDims:AT,getReductionAxes:DT,assertAndGetBroadcastShape:OT,assertParamsConsistent:MI,computeOutShape:FI,computePool2DInfo:YN,computePool3DInfo:JN,computeConv2DInfo:ZN,computeConv3DInfo:e_,computeDefaultPad:t_,tupleValuesAreOne:o_,eitherStridesOrDilationsAreOne:s_,convertConv2DDataFormat:u_,PARALLELIZE_THRESHOLD:30,computeOptimalWindowSize:ON});function h_(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+e.length+", imag: "+t.length+".");for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function p_(e,t){return{real:e[2*t],imag:e[2*t+1]}}function d_(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function v_(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function m_(e,t,n){var r=function(e,t,n){return function(e,t,n){for(var r=0,a=e.length,i=0,o=!1;r<a;){var s=n(t,e[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||y_)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function y_(e,t){return e>t?1:e<t?-1:0}function g_(e,t,n,r,a){return x_(e,t,n,r,a,0).selectedIndices}function b_(e,t,n,r,a,i){var o=x_(e,t,n,r,a,i,!0);return o.numValidOutputs.dispose(),{selectedIndices:o.selectedIndices,selectedScores:o.selectedScores}}function x_(e,t,n,r,a,i,o,s){void 0===o&&(o=!1),void 0===s&&(s=!1);for(var u=Array.from(t).map((function(e,t){return{score:e,boxIndex:t,suppressBeginIndex:0}})).filter((function(e){return e.score>a})).sort(E_),c=i>0?-.5/i:0,l=[],f=[];l.length<n&&u.length>0;){var h=u.pop(),p=h.score,d=h.boxIndex,v=h.suppressBeginIndex;if(p<a)break;for(var m=!1,y=l.length-1;y>=v;--y){var g=w_(e,d,l[y]);if(g>=r){m=!0;break}if(h.score=h.score*k_(r,c,g),h.score<=a)break}h.suppressBeginIndex=l.length,m||(h.score===p?(l.push(d),f.push(h.score)):h.score>a&&m_(u,h,E_))}var b=l.length;return s&&(l.fill(0,b),f.fill(0,b)),{selectedIndices:jI(l,"int32"),selectedScores:jI(f,"float32"),numValidOutputs:WI(b,"int32")}}function w_(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),f=Math.max(a[0],a[2]),h=Math.max(a[1],a[3]),p=(s-i)*(u-o),d=(f-c)*(h-l);if(p<=0||d<=0)return 0;var v=Math.max(i,c),m=Math.max(o,l),y=Math.min(s,f),g=Math.min(u,h),b=Math.max(y-v,0)*Math.max(g-m,0);return b/(p+d-b)}function k_(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function E_(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}function S_(e,t,n){var r=new Array(e.rank).fill(0),a=e.shape.slice();return t.map((function(t){a[n]=t;var i=e.slice(r,a);return r[n]+=t,i}))}function C_(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var a=oT(n,e.dtype);for(r=0;r<a.values.length;++r){for(var i=a.indexToLoc(r),o=new Array(e.rank),s=0;s<o.length;s++)o[s]=i[s]%e.shape[s];var u=e.locToIndex(o);a.values[r]=e.values[u]}return a.toTensor()}function I_(e,t,n,r,a){for(var i=t[t.length-1],o=[e.length/i,i],s=o[0],u=o[1],c=mS(n,s*r),l=mS("int32",s*r),f=0;f<s;f++){for(var h=f*u,p=e.subarray(h,h+u),d=[],v=0;v<p.length;v++)d.push({value:p[v],index:v});d.sort((function(e,t){return t.value-e.value}));var m=f*r,y=c.subarray(m,m+r),g=l.subarray(m,m+r);for(v=0;v<r;v++)y[v]=d[v].value,g[v]=d[v].index}var b=t.slice();return b[b.length-1]=r,[zI(c,b,n),zI(l,b,"int32")]}function T_(e,t){for(var n=[],r=0;r<t.length;r++)t[r]&&n.push(r);var a=oT(e,"int32"),i=oT([n.length,e.length],"int32");for(r=0;r<n.length;r++){var o=a.indexToLoc(n[r]),s=r*e.length;i.values.set(o,s)}return i.toTensor()}var N_=function(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((function(e,t){return"T"+t}));var n=[];this.variableNames.forEach((function(e){n.push("float v"+e+" = get"+e+"AtOutCoords();")}));var r=this.variableNames.map((function(e){return"v"+e})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        float result = "+r+";\n        setOutput(result);\n      }\n    "},__=function(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((function(e,t){return"T"+t}));var n=[];this.variableNames.forEach((function(e){n.push("vec4 v"+e+" = get"+e+"AtOutCoords();")}));var r=this.variableNames.map((function(e){return"v"+e})).join(" + ");this.userCode="\n      void main() {\n        "+n.join("\n        ")+"\n\n        vec4 result = "+r+";\n        setOutput(result);\n      }\n    "},R_=function(e,t,n){this.variableNames=["A"];var r=e.windowSize,a=e.batchSize,i=e.inSize,o=Math.ceil(i/r);n||this.variableNames.push("bestIndicesA"),this.outputShape=[a,o];var s="max"===t?">":"<",u=n?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+r+";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < "+r+"; i++) {\n          int inIdx = "+u+";\n          float candidate = getA(batch, inIdx);\n          if (candidate "+s+" bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    "};function A_(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return e+"."+t}))}function D_(e,t){return 1===t?[e]:A_(e,t)}function O_(){var e,t,n,r,a,i,o,s,u,c;return 2===WE().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",o="out vec4 outputColor;",s="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",c="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",o="",s="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",c="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:o,defineSpecialNaN:s,defineSpecialInf:u,defineRound:c}}function M_(e,t,n){void 0===n&&(n="index");var r=RS(t);return r.map((function(t,a){return"int "+e[a]+" = "+n+" / "+t+"; "+(a===r.length-1?"int "+e[a+1]+" = "+n+" - "+e[a]+" * "+t:"index -= "+e[a]+" * "+t)+";"})).join("")}function F_(e){var t=RS(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * "+t[0]+" + coords.y * "+t[1]+" + coords.z;\n  }\n"}var P_="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n";function L_(e,t,n,r){var a=[];e.forEach((function(e){var t=oS(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?a.push("uniform float "+e.name+(t>1?"["+t+"]":"")+";"):(a.push("uniform sampler2D "+e.name+";"),a.push("uniform int offset"+e.name+";"))}));var i,o,s=a.join("\n"),u=e.map((function(e){return function(e,t,n){void 0===n&&(n=!1);var r="";r+=n?V_(e):B_(e);var a=e.shapeInfo.logicalShape,i=t.logicalShape;return a.length<=i.length&&(r+=n?function(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",o=e.shapeInfo.logicalShape.length,s=t.logicalShape.length,u=AT(e.shapeInfo.logicalShape,t.logicalShape),c=q_(s),l=s-o,f=["x","y","z","w","u","v"];n=0===o?"":s<2&&u.length>=1?"coords = 0;":u.map((function(e){return"coords."+f[e+l]+" = 0;"})).join("\n");var h;h=s<2&&o>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords."+f[t+l]})).join(", ");var p="return outputValue;",d=1===oS(e.shapeInfo.logicalShape),v=1===oS(t.logicalShape);if(1!==o||d||v){if(d&&!v)p=1===s?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var m=o-2,y=o-1;u.indexOf(m)>-1&&u.indexOf(y)>-1?p="return vec4(outputValue.x);":u.indexOf(m)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(y)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 "+i+"() {\n      "+c+" coords = getOutputCoords();\n      "+n+"\n      vec4 outputValue = get"+a+"("+h+");\n      "+p+"\n    }\n  "}(e,t):function(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,o=e.shapeInfo.texShape,s=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&s===u&&null==e.shapeInfo.flatOffset&&sS(o,i))return"\n      float "+a+"() {\n        return sampleTexture("+n+", resultUV);\n      }\n    ";var c,l=q_(u),f=AT(e.shapeInfo.logicalShape,t.logicalShape),h=u-s,p=["x","y","z","w","u","v"];c=0===s?"":u<2&&f.length>=1?"coords = 0;":f.map((function(e){return"coords."+p[e+h]+" = 0;"})).join("\n");var d;return d=u<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords."+p[t+h]})).join(", "),"\n    float "+a+"() {\n      "+l+" coords = getOutputCoords();\n      "+c+"\n      return get"+r+"("+d+");\n    }\n  "}(e,t)),r}(e,t,r)})).join("\n"),c=t.texShape,l=O_(),f=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return "+e.texture2D+"(textureSampler, uv).r;\n    }\n  "}(l),h=function(e){return e.version+"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    "+e.varyingFs+" vec2 resultUV;\n    "+e.defineOutput+"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    "+e.defineSpecialNaN+"\n    "+e.defineSpecialInf+"\n    "+e.defineRound+"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    "+z_+"\n    "+U_+"\n    "+W_+"\n  "}(l);return t.isPacked?(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];return 1===n[0]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * "+n[1]+".0);\n      }\n    ":1===n[1]?"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * "+n[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      return 2 * (resTexRC.x * "+n[1]+" + resTexRC.y);\n    }\n  "}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(sS(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2("+n[0]+", "+n[1]+"));\n      }\n    ";var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=e,r=t,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],o=(i=Math.ceil(n[2]/2))*Math.ceil(n[1]/2),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+a[0]+", "+a[1]+"));\n      int index = resTexRC.x * "+a[1]+" + resTexRC.y;\n\n      int b = index / "+o+";\n      index -= b * "+o+";\n\n      int r = 2 * (index / "+i+");\n      int c = imod(index, "+i+") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ";default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),a=r*Math.ceil(e[e.length-2]/2),i=a,o="",s="b, r, c",u=2;u<e.length-1;u++)o="\n      int b"+u+" = index / "+(i*=e[e.length-u-1])+";\n      index -= b"+u+" * "+i+";\n    "+o,s="b"+u+", "+s;return"\n    ivec"+e.length+" getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n\n      "+o+"\n\n      int b = index / "+a+";\n      index -= b * "+a+";\n\n      int r = 2 * (index / "+r+");\n      int c = imod(index, "+r+") * 2;\n\n      return ivec"+e.length+"("+s+");\n    }\n  "}(e,t)}var n,r,a,i,o}(t.logicalShape,c),o=function(e){return"\n    void setOutput(vec4 val) {\n      "+e.output+" = val;\n    }\n  "}(l)):(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){return 1===t[0]?"\n      int getOutputCoords() {\n        return int(resultUV.x * "+t[1]+".0);\n      }\n    ":1===t[1]?"\n      int getOutputCoords() {\n        return int(resultUV.y * "+t[0]+".0);\n      }\n    ":"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      return resTexRC.x * "+t[1]+" + resTexRC.y;\n    }\n  "}(0,t);case 2:return function(e,t){return sS(e,t)?"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2("+t[0]+", "+t[1]+"));\n      }\n    ":1===e[1]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ":1===e[0]?"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2("+t[0]+", "+t[1]+"));\n        int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ":"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      int r = index / "+e[1]+";\n      int c = index - r * "+e[1]+";\n      return ivec2(r, c);\n    }\n  "}(e,t);case 3:return n=t,r=M_(["r","c","d"],e),"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2("+n[0]+", "+n[1]+"));\n      int index = resTexRC.x * "+n[1]+" + resTexRC.y;\n      "+r+"\n      return ivec3(r, c, d);\n    }\n  ";case 4:return function(e,t){var n=M_(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n      "+n+"\n      return ivec4(r, c, d, d2);\n    }\n  "}(e,t);case 5:return function(e,t){var n=M_(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2("+t[0]+",\n                             "+t[1]+"));\n\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  "}(e,t);case 6:return function(e,t){var n=M_(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2("+t[0]+", "+t[1]+"));\n      int index = resTexRC.x * "+t[1]+" + resTexRC.y;\n\n      "+n+"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  "}(e,t);default:throw new Error(e.length+"-D output sampling is not yet supported")}var n,r}(t.logicalShape,c),o=function(e){return"\n    void setOutput(float val) {\n      "+e.output+" = vec4(val, 0, 0, 0);\n    }\n  "}(l)),r&&(h+=j_),[h,f,o,s,i,u,n].join("\n")}function B_(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float "+n+"() {return "+t+";}";var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===a&&1===i)return"\n      float "+n+"() {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var o=e.shapeInfo.texShape;return"\n    float "+n+"() {\n      vec2 uv = uvFromFlat("+o[0]+", "+o[1]+", "+G_(t)+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float "+n+"(int index) {\n        "+H_(e)+"\n      }\n    ";var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===i&&1===a)return"\n      float "+n+"(int index) {\n        return sampleTexture("+t+", halfCR);\n      }\n    ";var o=G_(t);return 1===i?"\n      float "+n+"(int index) {\n        vec2 uv = vec2(0.5, (float(index + "+o+") + 0.5) / "+a+".0);\n        return sampleTexture("+t+", uv);\n      }\n    ":1===a?"\n      float "+n+"(int index) {\n        vec2 uv = vec2((float(index + "+o+") + 0.5) / "+i+".0, 0.5);\n        return sampleTexture("+t+", uv);\n      }\n    ":"\n    float "+n+"(int index) {\n      vec2 uv = uvFromFlat("+a+", "+i+", index + "+o+");\n      return sampleTexture("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape;if(null!=a&&sS(t,a)){var i=a[0];return"\n    float "+r+"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2("+a[1]+".0, "+i+".0);\n      return sampleTexture("+n+", uv);\n    }\n  "}var o=vS(t),s=o.newShape,u=o.keptDims,c=s;if(c.length<t.length)return"\n      "+B_(K_(e,c))+"\n      float "+r+"(int row, int col) {\n        return "+r+"("+X_(["row","col"],u)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2("+t[1]+", 1)));\n        "+H_(e)+"\n      }\n    ";var l=a[0],f=a[1],h=G_(n);return 1===f?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+h+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / "+l+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":1===l?"\n    float "+r+"(int row, int col) {\n      float index = dot(vec3(row, col, "+h+"), vec3("+t[1]+", 1, 1));\n      vec2 uv = vec2((index + 0.5) / "+f+".0, 0.5);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n  float "+r+"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * "+t[1]+" + col + "+h+";\n    vec2 uv = uvFromFlat("+l+", "+f+", index);\n    return sampleTexture("+n+", uv);\n  }\n"}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[1]*t[2],i=t[2],o=vS(t),s=o.newShape,u=o.keptDims,c=s;if(c.length<t.length)return"\n        "+B_(K_(e,c))+"\n        float "+r+"(int row, int col, int depth) {\n          return "+r+"("+X_(["row","col","depth"],u)+");\n        }\n      ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3("+a+", "+i+", 1)));\n        "+H_(e)+"\n      }\n    ";var l=e.shapeInfo.texShape,f=l[0],h=l[1],p=e.shapeInfo.flatOffset;return h===a&&null==p?"\n        float "+r+"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2("+i+", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2("+h+".0, "+f+".0);\n          return sampleTexture("+n+", uv);\n        }\n      ":h===i&&null==p?"\n    float "+r+"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2("+t[1]+", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+h+".0, "+f+".0);\n      return sampleTexture("+n+", uv);\n    }\n  ":"\n      float "+r+"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * "+a+" + col * "+i+" + depth + "+G_(n)+";\n        vec2 uv = uvFromFlat("+f+", "+h+", index);\n        return sampleTexture("+n+", uv);\n      }\n  "}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[3],i=t[2]*a,o=t[1]*i,s=vS(t),u=s.newShape,c=s.keptDims;if(u.length<t.length)return"\n      "+B_(K_(e,u))+"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        return "+r+"("+X_(["row","col","depth","depth2"],c)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4("+o+", "+i+", "+a+", 1)));\n        "+H_(e)+"\n      }\n    ";var l=e.shapeInfo.flatOffset,f=e.shapeInfo.texShape,h=f[0],p=f[1];return p===o&&null==l?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3("+i+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+p+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":p===a&&null==l?"\n      float "+r+"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3("+t[1]*t[2]+", "+t[2]+", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+p+".0, "+h+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+o+" + col * "+i+" +\n          depth * "+a+" + depth2;\n      vec2 uv = uvFromFlat("+h+", "+p+", index + "+G_(n)+");\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,o=t[2]*i,s=t[1]*o,u=vS(t),c=u.newShape,l=u.keptDims;if(c.length<t.length)return"\n      "+B_(K_(e,c))+"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        return "+r+"("+X_(["row","col","depth","depth2","depth3"],l)+");\n      }\n    ";if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+s+", "+o+", "+i+", "+a+")) +\n          depth3;\n        "+H_(e)+"\n      }\n    ";var f=e.shapeInfo.flatOffset,h=e.shapeInfo.texShape,p=h[0],d=h[1];return d===s&&null==f?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4("+o+", "+i+", "+a+", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+d+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":d===a&&null==f?"\n      float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]+",\n               "+t[2]*t[3]+", "+t[3]+", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+d+".0, "+p+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+s+" + col * "+o+" + depth * "+i+" +\n          depth2 * "+a+" + depth3 + "+G_(n)+";\n      vec2 uv = uvFromFlat("+p+", "+d+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=vS(t),i=a.newShape,o=a.keptDims;if(i.length<t.length)return"\n      "+B_(K_(e,i))+"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return "+r+"("+X_(["row","col","depth","depth2","depth3","depth4"],o)+");\n      }\n    ";var s=t[5],u=t[4]*s,c=t[3]*u,l=t[2]*c,f=t[1]*l;if(e.shapeInfo.isUniform)return"\n      float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4("+f+", "+l+", "+c+", "+u+")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2("+s+", 1)));\n        "+H_(e)+"\n      }\n    ";var h=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,d=p[0],v=p[1];return v===f&&null==h?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4("+l+", "+c+", "+u+", "+s+")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2("+v+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":v===s&&null==h?"\n      float "+r+"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4("+t[1]*t[2]*t[3]*t[4]+",\n               "+t[2]*t[3]*t[4]+",\n               "+t[3]*t[4]+",\n               "+t[4]+")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2("+v+".0, "+d+".0);\n        return sampleTexture("+n+", uv);\n      }\n    ":"\n    float "+r+"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * "+f+" + col * "+l+" + depth * "+c+" +\n          depth2 * "+u+" + depth3 * "+s+" + depth4 + "+G_(n)+";\n      vec2 uv = uvFromFlat("+d+", "+v+", index);\n      return sampleTexture("+n+", uv);\n    }\n  "}(e);default:throw new Error(t.length+"-D input sampling is not yet supported")}}function V_(e){var t;switch(e.shapeInfo.logicalShape.length){case 0:return"\n    vec4 "+("get"+(t=e.name).charAt(0).toUpperCase()+t.slice(1))+"() {\n      return "+O_().texture2D+"("+t+", halfCR);\n    }\n  ";case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=O_();return"\n    vec4 "+n+"(int index) {\n      vec2 uv = packedUVfrom1D(\n        "+a[0]+", "+a[1]+", index);\n      return "+i.texture2D+"("+t+", uv);\n    }\n  "}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=a[0],o=a[1],s=O_();if(null!=a&&sS(t,a))return"\n      vec4 "+r+"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2("+o+".0, "+i+".0);\n\n        return "+s.texture2D+"("+n+", uv);\n      }\n    ";var u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];return"\n    vec4 "+r+"(int row, int col) {\n      vec2 uv = packedUVfrom2D("+Math.ceil(t[1]/2)+", "+u[0]+", "+u[1]+", row, col);\n      return "+s.texture2D+"("+n+", uv);\n    }\n  "}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===t[0])return"\n        "+V_(K_(e,t.slice(1)))+"\n        vec4 "+r+"(int b, int row, int col) {\n          return "+r+"("+X_(["b","row","col"],[1,2])+");\n        }\n      ";var o=i[0],s=i[1],u=Math.ceil(t[2]/2);return"\n    vec4 "+r+"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        "+o+", "+s+", "+u*Math.ceil(t[1]/2)+", "+u+", b, row, col);\n      return "+O_().texture2D+"("+n+", uv);\n    }\n  "}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=o[0],u=o[1],c=Math.ceil(t[n-1]/2),l=c*Math.ceil(t[n-2]/2),f="int b, int row, int col",h="b * "+l+" + (row / 2) * "+c+" + (col / 2)",p=2;p<n-1;p++)f="int b"+p+", "+f,h="b"+p+" * "+(l*=t[n-p-1])+" + "+h;return"\n    vec4 "+a+"("+f+") {\n      int index = "+h+";\n      int texR = index / "+u+";\n      int texC = index - texR * "+u+";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+u+", "+s+");\n      return "+O_().texture2D+"("+r+", uv);\n    }\n  "}(e)}}var z_="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",U_="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",W_="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",j_="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function G_(e){return"offset"+e}function H_(e){var t=e.name,n=oS(e.shapeInfo.logicalShape);return n<2?"return "+t+";":"\n    for (int i = 0; i < "+n+"; i++) {\n      if (i == index) {\n        return "+t+"[i];\n      }\n    }\n  "}function q_(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank "+e+" is not yet supported")}function K_(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function X_(e,t){return t.map((function(t){return e[t]})).join(", ")}var $_=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,nS(e.length>2,(function(){return"Packed arg"+(n.charAt(0).toUpperCase()+n.slice(1))+" supports only inputs with rank above 2."}));var a=e[e.length-1],i=Math.ceil(a/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");var o,s,u=this.outputShape,c=u.length,l=q_(c),f=D_("coords",c);if(1===i){var h=q_(s=c+1);o="\n        "+h+" sourceLocR = "+h+"("+f.join()+", 0);\n        ++"+f[c-1]+";\n        "+h+" sourceLocG = "+h+"("+f.join()+", 0);\n        ++"+f[c-2]+";\n        "+h+" sourceLocA = "+h+"("+f.join()+", 0);\n        --"+f[c-1]+";\n        "+h+" sourceLocB = "+h+"("+f.join()+", 0);\n        --"+f[c-2]+";"}else s=c,o="\n        "+l+" sourceLocR = coords;\n        ++"+f[c-1]+";\n        "+l+" sourceLocG = coords;\n        ++"+f[c-2]+";\n        "+l+" sourceLocA = coords;\n        --"+f[c-1]+";\n        "+l+" sourceLocB = coords;\n        --"+f[c-2]+";";var p=["x","y","z","w","u","v"].slice(0,s),d="."+p[s-1],v=p.map((function(e){return"int "+e})),m=D_("sourceLocR",s-1).concat("inIdx.r"),y=D_("sourceLocG",s-1).concat("inIdx.g"),g=D_("sourceLocB",s-1).concat("inIdx.b"),b=D_("sourceLocA",s-1).concat("inIdx.a"),x="max"===n?"greaterThan":"lessThan",w=r?"":"\n          inIdx = round(vec4(getBestIndicesAChannel("+m.join()+"),\n                             getBestIndicesAChannel("+y.join()+"),\n                             getBestIndicesAChannel("+g.join()+"),\n                             getBestIndicesAChannel("+b.join()+")));",k="vec4(\n            getAChannel("+m.join()+"),\n            hasNextCol ? getAChannel("+y.join()+") : 0.,\n            hasNextRow ? getAChannel("+g.join()+") : 0.,\n            hasNextRow && hasNextCol ? getAChannel("+b.join()+") : 0.)",E=r?"":"\n      float getBestIndicesAChannel("+v.join()+") {\n        return getChannel(getBestIndicesA("+p.join()+"),\n                                          vec2("+p.slice(-2).join()+"));\n      }";this.userCode="\n      float getAChannel("+v.join()+") {\n        return getChannel(getA("+p.join()+"),\n                               vec2("+p.slice(-2).join()+"));\n      }\n      "+E+"\n      void main() {\n        "+l+" coords = getOutputCoords();\n        bool hasNextCol = "+f[c-1]+" < "+(u[c-1]-1)+";\n        bool hasNextRow = "+f[c-2]+" < "+(u[c-2]-1)+";\n        "+o+"\n        ivec4 srcIdx = ivec4(sourceLocR"+d+", sourceLocG"+d+",\n          sourceLocB"+d+", sourceLocA"+d+") * "+t+";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = "+k+";\n\n        for (int i = 0; i < "+t+"; i++) {\n          inIdx = srcIdx;\n          "+w+"\n          vec4 candidate = "+k+";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4("+x+"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    "},Q_=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterHeight,u=e.effectiveFilterWidth,c=s-1-e.padInfo.top,l=u-1-e.padInfo.left,f=1/(t*n);this.userCode="\n      const ivec2 pads = ivec2("+c+", "+l+");\n      const float avgMultiplier = float("+f+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+s+";\n            wR += "+i+") {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+u+";\n            wC+= "+o+") {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},Y_=function(e){this.variableNames=["dy"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterDepth,f=e.effectiveFilterHeight,h=e.effectiveFilterWidth,p=l-1-e.padInfo.front,d=f-1-e.padInfo.top,v=h-1-e.padInfo.left,m=1/(t*n*r);this.userCode="\n      const ivec3 pads = ivec3("+p+", "+d+", "+v+");\n      const float avgMultiplier = float("+m+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+l+";\n            wD += "+s+") {\n          float dyD = float(dyDCorner + wD) / "+a+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+f+";\n              wR += "+u+") {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+h+";\n                wC += "+c+") {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},J_=function(e,t,n,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],OT(e,t),OT(e,n);var o="0.0";null!=r&&(OT(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="1.0";null!=a&&(OT(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = "+o+";\n        float scale = "+s+";\n        float inv = scale * inversesqrt(variance + float("+i+"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    "},Z_=function(e,t,n,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],OT(e,t),OT(e,n);var o="vec4(0.0)";null!=r&&(OT(e,r),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");var s="vec4(1.0)";null!=a&&(OT(e,a),this.variableNames.push("scale"),s="getScaleAtOutCoords()"),this.outputShape=e,this.userCode="\n      void main() {\n        vec4 offset = "+o+";\n        vec4 scale = "+s+";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4("+i+"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    "},eR=function(e,t,n){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=OT(t,n),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        "+e+"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    "},tR="return a + b;",nR="return a - b;",rR="return a * b;",aR="return (a < 0.) ? b * a : a;",iR=function(e,t,n){this.variableNames=["A","B"],this.outputShape=OT(t,n),this.userCode="\n      float binaryOperation(float a, float b) {\n        "+e+"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    "},oR="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n",sR=function(e,t,n,r){void 0===r&&(r=!1),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=OT(t,n);var a=this.outputShape.length,i="";if(r)if(0===a||1===oS(this.outputShape))i="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else if(i="\n          "+q_(a)+" coords = getOutputCoords();\n        ",1===a)i+="\n            result.y = (coords + 1) >= "+this.outputShape[0]+" ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ";else{var o=D_("coords",a);i+="\n            bool nextRowOutOfBounds =\n              ("+o[a-2]+" + 1) >= "+this.outputShape[a-2]+";\n            bool nextColOutOfBounds =\n              ("+o[a-1]+" + 1) >= "+this.outputShape[a-1]+";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          "}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        "+e+"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        "+i+"\n\n        setOutput(result);\n      }\n    "},uR=function(){function e(e){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),cR=function(){function e(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}},e}(),lR=function(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "},fR=function(e){this.outputShape=[],this.outputShape=FI(e,1),this.variableNames=e.map((function(e,t){return"T"+t}));var t=new Array(e.length-1);t[0]=e[0][1];for(var n=1;n<t.length;n++)t[n]=t[n-1]+e[n][1];var r=["if (yC < "+t[0]+") setOutput(getT0(yR, yC));"];for(n=1;n<t.length;n++){var a=t[n-1];r.push("else if (yC < "+t[n]+") setOutput(getT"+n+"(yR, yC-"+a+"));")}var i=t.length,o=t[t.length-1];r.push("else setOutput(getT"+i+"(yR, yC-"+o+"));"),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        "+r.join("\n        ")+"\n      }\n    "},hR=function(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=FI(e,t);var n=this.outputShape,r=n.length,a=q_(r),i=D_("coords",r),o=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((function(e,t){return"T"+t}));var s=new Array(e.length-1);s[0]=e[0][t];for(var u=1;u<s.length;u++)s[u]=s[u-1]+e[u][t];var c=o[t],l=o.slice(-2),f=o.join(),h="if ("+c+" < "+s[0]+") {\n        return getChannel(\n            getT0("+f+"), vec2("+l.join()+"));\n        }";for(u=1;u<s.length;u++){var p=s[u-1];h+="\n        if ("+c+" < "+s[u]+"  && "+c+" >= "+s[u-1]+") {\n          return getChannel(\n            getT"+u+"("+pR(o,c,p)+"),\n            vec2("+pR(l,c,p)+"));\n        }"}var d=s.length,v=s[s.length-1];h+="\n        return getChannel(\n          getT"+d+"("+pR(o,c,v)+"),\n          vec2("+pR(l,c,v)+"));",this.userCode="\n      float getValue("+o.map((function(e){return"int "+e}))+") {\n        "+h+"\n      }\n\n      void main() {\n        "+a+" coords = getOutputCoords();\n        vec4 result = vec4(getValue("+i+"), 0., 0., 0.);\n\n        "+i[r-1]+" = "+i[r-1]+" + 1;\n        if ("+i[r-1]+" < "+n[r-1]+") {\n          result.g = getValue("+i+");\n        }\n\n        "+i[r-2]+" = "+i[r-2]+" + 1;\n        if ("+i[r-2]+" < "+n[r-2]+") {\n          result.a = getValue("+i+");\n        }\n\n        "+i[r-1]+" = "+i[r-1]+" - 1;\n        if ("+i[r-2]+" < "+n[r-2]+" &&\n            "+i[r-1]+" < "+n[r-1]+") {\n          result.b = getValue("+i+");\n        }\n        setOutput(result);\n      }\n    "};function pR(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?e+" - "+n:e})).join()}var dR=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i="channelsLast"===e.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+a+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              if ("+i+") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},vR=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i="channelsLast"===e.dataFormat,o=t-1-e.padInfo.top,s=n-1-e.padInfo.left,u=i?1:2,c=i?2:3,l=i?3:1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords["+l+"];\n\n        ivec2 dyCorner = ivec2(coords["+u+"], coords["+c+"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n\n              if ("+i+") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},mR=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,o=e.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yF = 0; yF < "+e.outDepth+"; yF++) {\n            int xF = wF + yF * "+t+" - "+a+";\n\n            if (xF < 0 || xF >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n              int xR = wR + yR * "+n+" - "+i+";\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n                int xC = wC + yC * "+r+" - "+o+";\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},yR=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterDepth,n=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=t-1-e.padInfo.front,u=n-1-e.padInfo.top,c=r-1-e.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3("+s+", "+u+", "+c+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+t+"; wF++) {\n          float dyF = float(dyFCorner + wF) / "+a+".0;\n\n          if (dyF < 0.0 || dyF >= "+e.outDepth+".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = "+t+" - 1 - wF;\n\n          for (int wR = 0; wR < "+n+"; wR++) {\n            float dyR = float(dyRCorner + wR) / "+i+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = "+n+" - 1 - wR;\n\n            for (int wC = 0; wC < "+r+"; wC++) {\n              float dyC = float(dyCCorner + wC) / "+o+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = "+r+" - 1 - wC;\n\n              for (int d2 = 0; d2 < "+e.outChannels+"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},gR=function(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * "+i+" + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < "+e.batchSize+"; b++) {\n          for (int yR = 0; yR < "+e.outHeight+"; yR++) {\n            int xR = wR + yR * "+t+" - "+r+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int yC = 0; yC < "+e.outWidth+"; yC++) {\n              int xC = wC + yC * "+n+" - "+a+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},bR=function(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=t-1-e.padInfo.top,o=n-1-e.padInfo.left,s=e.outChannels/e.inChannels;this.userCode="\n      const ivec2 pads = ivec2("+i+", "+o+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < "+t+"; wR++) {\n          float dyR = float(dyRCorner + wR) / "+r+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = "+t+" - 1 - wR;\n\n          for (int wC = 0; wC < "+n+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+a+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = "+n+" - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < "+s+"; dm++) {\n              int d2 = d1 * "+s+" + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},xR=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var a=e.padInfo.top,i=e.padInfo.left,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterHeight,f=e.filterWidth,h=4*Math.floor(e.inChannels/4),p=e.inChannels%4,d="channelsLast"===e.dataFormat,v=d?1:2,m=d?2:3,y=d?3:1,g="",b="";n&&(g=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",b="result = activation(result);");var x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+g+"\n\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+a+", "+i+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords["+y+"];\n\n        ivec2 xRCCorner =\n            ivec2(coords["+v+"], coords["+m+"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+l+"; wR++) {\n          int xR = xRCorner + wR * "+u+";\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+f+"; wC++) {\n            int xC = xCCorner + wC * "+c+";\n\n            if (xC < 0 || xC >= "+e.inWidth+") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < "+h+"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if ("+d+") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if ("+(1===p)+") {\n\n              if ("+d+") {\n                dotProd +=\n                    getX(batch, xR, xC, "+h+") *\n                    getW(wR, wC, "+h+", d2);\n              } else {\n                dotProd +=\n                    getX(batch, "+h+", xR, xC) *\n                    getW(wR, wC, "+h+", d2);\n              }\n\n            } else if ("+(2===p)+") {\n              vec2 wValues = vec2(\n                getW(wR, wC, "+h+", d2),\n                getW(wR, wC, "+h+" + 1, d2)\n              );\n\n              if ("+d+") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, "+h+"),\n                  getX(batch, xR, xC, "+h+" + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, "+h+", xR, xC),\n                  getX(batch, "+h+" + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if ("+(3===p)+") {\n              vec3 wValues = vec3(\n                getW(wR, wC, "+h+", d2),\n                getW(wR, wC, "+h+" + 1, d2),\n                getW(wR, wC, "+h+" + 2, d2)\n              );\n\n              if ("+d+") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, "+h+"),\n                  getX(batch, xR, xC, "+h+" + 1),\n                  getX(batch, xR, xC, "+h+" + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, "+h+", xR, xC),\n                  getX(batch, "+h+" + 1, xR, xC),\n                  getX(batch, "+h+" + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        "+x+"\n        "+b+"\n        setOutput(result);\n      }\n    "},wR=function(e){this.variableNames=["x","W"],this.outputShape=e.outShape;var t=e.padInfo.front,n=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,o=e.strideWidth,s=e.dilationDepth,u=e.dilationHeight,c=e.dilationWidth,l=e.filterDepth,f=e.filterHeight,h=e.filterWidth,p=4*Math.floor(e.inChannels/4),d=e.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3("+a+", "+i+", "+o+");\n      const ivec3 pads = ivec3("+t+", "+n+", "+r+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < "+l+"; wF++) {\n          int xF = xFCorner + wF * "+s+";\n\n          if (xF < 0 || xF >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+f+"; wR++) {\n            int xR = xRCorner + wR * "+u+";\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+h+"; wC++) {\n              int xC = xCCorner + wC * "+c+";\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < "+p+"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if ("+(1===d)+") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, "+p+") *\n                  getW(wF, wR, wC, "+p+", d2);\n              } else if ("+(2===d)+") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, "+p+"),\n                  getX(batch, xF, xR, xC, "+p+" + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, "+p+", d2),\n                  getW(wF, wR, wC, "+p+" + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if ("+(3===d)+") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, "+p+"),\n                  getX(batch, xF, xR, xC, "+p+" + 1),\n                  getX(batch, xF, xR, xC, "+p+" + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, "+p+", d2),\n                  getW(wF, wR, wC, "+p+" + 1, d2),\n                  getW(wF, wR, wC, "+p+" + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},kR=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.outputShape=e.outShape;var a=e.inHeight,i=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,f=e.dilationWidth,h=e.filterHeight,p=e.filterWidth,d=e.outChannels/e.inChannels,v="",m="";n&&(v=r?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"\n          float activation(float x) {\n            "+n+"\n          }\n        ",m="result = activation(result);");var y=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+v+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / "+d+";\n        int q = d2 - d1 * "+d+";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < "+h+"; wR++) {\n          int xR = xRCorner + wR * "+l+";\n\n          if (xR < 0 || xR >= "+a+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+p+"; wC++) {\n            int xC = xCCorner + wC * "+f+";\n\n            if (xC < 0 || xC >= "+i+") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        "+y+"\n        "+m+"\n        setOutput(result);\n      }\n    "},ER=function(e,t,n,r){void 0===t&&(t=!1),void 0===n&&(n=null),void 0===r&&(r=!1),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e.outShape;for(var a=e.inHeight,i=e.inWidth,o=e.padInfo.top,s=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,f=e.dilationWidth,h=e.filterHeight,p=e.filterWidth,d=p,v="int xR; int xC; int xCOffset;",m=0;m<h;m++)for(var y=0;y<p;y++)v+="\n          vec4 xTexelR"+m+"C"+2*y+" = vec4(0.);\n          vec4 wR"+m+"C"+y+" = vec4(0.);\n          vec4 xR"+m+"C"+y+" = vec4(0.);";for(m=0;m<h;m++)for(var g=0;g<d;g++){if(v+="\n          xR = xRCorner + "+m*l+";\n          xC = xCCorner + "+(y=2*g)*f+";\n        ",1===c){if(y<p&&(v+=s%2==1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < "+a+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+y+" = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    xTexelR"+m+"C"+y+".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR"+m+"C"+y+" = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < "+a+" && xCOffset >= 0 && xCOffset < "+i+") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= "+i+") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR"+m+"C"+y+" = vec4(previous.zw, xTexelR"+m+"C"+y+".xy);\n                } else {\n                  xR"+m+"C"+y+" = vec4(0, 0, xTexelR"+m+"C"+y+".xy);\n                }\n              ":"\n                if(xR >= 0 && xR < "+a+" && xC >= 0 && xC < "+i+") {\n                  xTexelR"+m+"C"+y+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+m+"C"+y+" = vec4(0.);\n                }\n\n                xR"+m+"C"+y+" = xTexelR"+m+"C"+y+";\n              ",y+1<p)){var b=s%2==0?eS(f):f;f%2==0&&s%2==1||f%2!=0&&s%2!=1?(v+="\n                  xCOffset = xC + "+s%2+" + "+b+";\n\n                  if(xR >= 0 && xR < "+a+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+m+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n                ",f>1&&(v+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < "+a+" &&\n                      xCOffset >= 0 && xCOffset < "+i+") {\n                      xTexelR"+m+"C"+y+" = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR"+m+"C"+y+" = vec4(0.);\n                    }\n                  "),v+="\n                  xR"+m+"C"+(y+1)+" = vec4(\n                    xTexelR"+m+"C"+y+".zw, xTexelR"+m+"C"+(y+2)+".xy);\n                "):v+="\n                  xCOffset = xC + "+b+";\n\n                  if(xR >= 0 && xR < "+a+" &&\n                    xCOffset >= 0 && xCOffset < "+i+") {\n                    xTexelR"+m+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR"+m+"C"+(y+1)+" = xTexelR"+m+"C"+(y+2)+";\n                "}}else y<p&&(v+="\n              if(xR >= 0 && xR < "+a+") {\n            ",s%2==1?(v+="\n                xCOffset = xC + 1 - "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+y+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+m+"C"+y+" = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < "+i+") {\n                  xTexelR"+m+"C"+(y+2)+" = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR"+m+"C"+(y+2)+" = vec4(0.);\n                }\n\n                xR"+m+"C"+y+" = vec4(\n                  xTexelR"+m+"C"+y+".zw, xTexelR"+m+"C"+(y+2)+".zw);\n              ",y+1<p&&(v+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + "+c+";\n                  if(xCOffset >= 0 && xCOffset < "+i+") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR"+m+"C"+(y+1)+" = vec4(xTexelR"+m+"C"+(y+2)+".xy, final.xy);\n                ")):(v+="\n                if(xC >= 0 && xC < "+i+") {\n                  xTexelR"+m+"C"+y+" = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR"+m+"C"+y+" = vec4(0.);\n                }\n\n                xCOffset = xC + "+c+";\n                if(xCOffset >= 0 && xCOffset < "+i+") {\n                  xTexelR"+m+"C"+(y+2)+" = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR"+m+"C"+(y+2)+" = vec4(0.);\n                }\n\n                xR"+m+"C"+y+" = vec4(\n                  xTexelR"+m+"C"+y+".xy, xTexelR"+m+"C"+(y+2)+".xy);\n              ",y+1<p&&(v+="\n                  xR"+m+"C"+(y+1)+" = vec4(\n                    xTexelR"+m+"C"+y+".zw, xTexelR"+m+"C"+(y+2)+".zw);\n                ")),v+="}");y<p&&(v+="\n            vec4 wTexelR"+m+"C"+y+" = getW("+m+", "+y+", d1, q);\n            wR"+m+"C"+y+" = vec4(wTexelR"+m+"C"+y+".xz, wTexelR"+m+"C"+y+".xz);\n          ",y+1<p&&(v+="\n              vec4 wTexelR"+m+"C"+(y+1)+" = getW("+m+", "+(y+1)+", d1, q);\n              wR"+m+"C"+(y+1)+" =\n                vec4(wTexelR"+m+"C"+(y+1)+".xz, wTexelR"+m+"C"+(y+1)+".xz);"))}for(m=0;m<h;m++)for(y=0;y<p;y++)v+="dotProd += xR"+m+"C"+y+" * wR"+m+"C"+y+";";var x="",w="";n&&(x=r?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+n+"\n        }":"vec4 activation(vec4 x) {\n          "+n+"\n        }",w="result = activation(result);");var k=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+x+"\n\n      const ivec2 strides = ivec2("+u+", "+c+");\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        "+v+"\n\n        vec4 result = dotProd;\n        "+k+"\n        "+w+"\n        setOutput(result);\n      }\n    "},SR=function(e,t,n,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var i=e[0],o=e[1],s=e[2],u=e[3],c=t[0],l=n[0],f=n[1];this.outputShape=[c,l,f,u];var h="bilinear"===r?1:0,p=[o-1+".0",s-1+".0"],d=p[0],v=p[1],m=l>1?[""+(o-1)/(l-1),"(y2-y1) * height_ratio","y1*"+d+" + float(y)*(height_scale)"]:["0.0","0.0","0.5 * (y1+y2) * "+d],y=m[0],g=m[1],b=m[2],x=f>1?[""+(s-1)/(f-1),"(x2-x1) * width_ratio","x1*"+v+" + float(x)*(width_scale)"]:["0.0","0.0","0.5 * (x1+x2) * "+v],w=x[0],k=x[1],E=x[2];this.userCode="\n      const float height_ratio = float("+y+");\n      const float width_ratio = float("+w+");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= "+i+") {\n          return;\n        }\n\n        float height_scale = "+g+";\n        float width_scale = "+k+";\n\n        float in_y = "+b+";\n        if( in_y < 0.0 || in_y > "+d+" ) {\n          setOutput(float("+a+"));\n          return;\n        }\n        float in_x = "+E+";\n        if( in_x < 0.0 || in_x > "+v+" ) {\n          setOutput(float("+a+"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if("+h+" == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    "},CR=function(e,t,n){this.variableNames=["x"],this.outputShape=e;var r=e.length,a=e[e.length-1],i=n?"<":">";this.userCode="\n      int getIndex(int i) {\n        "+(n?"return "+a+" -i - 1;":"return i;")+"\n      }\n\n      void main() {\n        "+q_(r)+" coords = getOutputCoords();\n        int end = "+IR(r,"coords")+";\n        float val = 0.0;\n        for (int i = "+a+" - 1; i >= 0; i -= 1) {\n          int idx = getIndex(i);\n          if (idx "+i+" end) {\n            continue;\n          }\n          if (idx == end && "+t+") {\n            continue;\n          }\n          "+IR(r,"coords")+" = idx;\n          val += getX("+function(e,t){if(1===e)return""+t;if(2===e)return t+".x, "+t+".y";if(3===e)return t+".x, "+t+".y, "+t+".z";if(4===e)return t+".x, "+t+".y, "+t+".z, "+t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}(r,"coords")+");\n        }\n        setOutput(val);\n      }\n    "};function IR(e,t){if(1===e)return""+t;if(2===e)return t+".y";if(3===e)return t+".z";if(4===e)return t+".w";throw Error("Cumulative sum for rank "+e+" is not yet supported")}var TR=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=mC.DENSE;var t=SC(e),n=O_();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+M_(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        "+n.output+" = result;\n      }\n    "},NR=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=mC.DENSE;var t=SC(e),n=O_();this.outputShape=e,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        "+M_(["r","c","d"],e)+"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2("+t[0]+", "+t[1]+"));\n        int index = 4 * (resTexRC.x * "+t[1]+" + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        "+n.output+" = result;\n      }\n    "},_R=function(){function e(e,t,n){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=n,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = "+this.getHeightCoordString()+";\n      int w = "+this.getWidthCoordString()+";\n      int d = "+this.getDepthCoordString()+";\n\n      int in_h = h / "+t+";\n      int offset_h = imod(h, "+t+");\n      int in_w = w / "+t+";\n      int offset_w = imod(w, "+t+");\n      int offset_d = (offset_h * "+t+" + offset_w) *\n        "+this.getOutputDepthSize()+";\n      int in_d = d + offset_d;\n\n      float result = "+this.getInputSamplingString()+";\n      setOutput(result);\n    }\n  "}return e.prototype.getHeightCoordString=function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"},e.prototype.getWidthCoordString=function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"},e.prototype.getDepthCoordString=function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"},e.prototype.getOutputDepthSize=function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]},e.prototype.getInputSamplingString=function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"},e}(),RR=function(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "},AR=function(e){this.variableNames=["A"],this.outTexUsage=yC.DOWNLOAD;var t=O_();this.outputShape=e,this.userCode="\n      "+P_+"\n\n      void main() {\n        float x = getAAtOutCoords();\n        "+t.output+" = encode_float(x);\n      }\n    "},DR=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=yC.DOWNLOAD;var t=O_();this.outputShape=e,this.userCode="\n      "+P_+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        "+t.output+" = encode_float(x);\n      }\n    "},OR=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"];var r=O_(),a=t[0],i=t[1];this.outputShape=e;var o="result";n&&(o="floor(result * 255. + 0.5)"),this.userCode="\n      "+F_(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n        \n        int r = flatIndex / "+i+";\n        int c = imod(flatIndex, "+i+");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+a+".0);\n        vec4 values = "+r.texture2D+"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        "+r.output+" = vec4("+o+", 0., 0., 0.);\n      }\n    "},MR=function(e,t,n){void 0===n&&(n=!1),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var r=O_(),a=t[0],i=t[1];this.outputShape=e;var o="",s="result";n&&(s="floor(result * 255. + 0.5)");for(var u=0;u<=1;u++)for(var c=0;c<=1;c++){var l=2*u+c;o+="\n          localCoords = coords;\n          if(localCoords[2] + "+c+" < "+e[2]+") {\n            localCoords[2] += "+c+";\n            if(localCoords[1] + "+u+" < "+e[1]+") {\n              localCoords[1] += "+u+";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / "+i+";\n              c = imod(flatIndex, "+i+");\n              uv = (vec2(c, r) + halfCR) / vec2("+i+".0, "+a+".0);\n              values = "+r.texture2D+"(A, uv);\n\n              if(offset == 0) {\n                result["+l+"] = values[0];\n              } else if(offset == 1) {\n                result["+l+"] = values[1];\n              } else if(offset == 2) {\n                result["+l+"] = values[2];\n              } else {\n                result["+l+"] = values[3];\n              }\n            }\n          }\n        "}this.userCode="\n      "+F_(e)+"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        "+o+"\n\n        "+r.output+" = "+s+";\n      }\n    "},FR=function(e,t,n){this.variableNames=["real","imag"];var r=t[1];this.outputShape=t;var a=n?"2.0 * "+Math.PI:"-2.0 * "+Math.PI,i=n?r+".0":"1.0";this.userCode="\n      const float exponentMultiplier = "+a+";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        "+e+"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float("+r+");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < "+r+"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / "+i+";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    "},PR=function(){function e(e,t){this.outputShape=[],this.variableNames=["x"],this.outputShape=e,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}},e}(),LR=function(e,t,n){this.variableNames=["A","indices"];var r=e.slice();r[n]=t,this.outputShape=r,this.rank=r.length;var a=q_(this.rank),i=function(e,t){var n=e.length;if(n>4)throw Error("Gather for rank "+n+" is not yet supported");if(1===n)return"int(getIndices(resRC))";for(var r=["resRC.x","resRC.y","resRC.z","resRC.w"],a=[],i=0;i<e.length;i++)i===t?a.push("int(getIndices("+r[i]+"))"):a.push(""+r[i]);return a.join()}(e,n);this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},BR=function(e,t,n){this.sliceDim=e,this.strides=t,this.variableNames=["x","indices"],this.outputShape=n;var r=q_(t.length),a=q_(n.length),i=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        "+r+" strides = "+r+"("+this.strides+");\n         void main() {\n          "+a+" coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < "+this.sliceDim+"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * "+i+";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      "};function VR(e,t){var n=O_();return AC(e,t,n.version+"\n    precision highp float;\n    "+n.attribute+" vec3 clipSpacePos;\n    "+n.attribute+" vec2 uv;\n    "+n.varyingVs+" vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }")}function zR(e,t){return VC(e,t,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function UR(e,t){return zC(e,t,new Uint16Array([0,1,2,2,1,3]))}function WR(e,t,n,r,a,i,o){WC(n,r);var s=UC(e,t),u=e.TEXTURE_2D;return TC(e,t,(function(){return e.bindTexture(u,s)})),TC(e,t,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),TC(e,t,(function(){return e.texParameteri(u,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),TC(e,t,(function(){return e.texParameteri(u,e.TEXTURE_MIN_FILTER,e.NEAREST)})),TC(e,t,(function(){return e.texParameteri(u,e.TEXTURE_MAG_FILTER,e.NEAREST)})),TC(e,t,(function(){return e.texImage2D(u,0,a,n,r,0,i,o,null)})),TC(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),s}function jR(e,t,n,r,a){var i=EC(n,r);return WR(e,t,i[0],i[1],a.internalFormatFloat,a.textureFormatFloat,e.FLOAT)}function GR(e,t,n,r,a){var i=EC(n,r);return WR(e,t,i[0],i[1],a.internalFormatHalfFloat,a.textureFormatFloat,a.textureTypeHalfFloat)}function HR(e,t,n,r,a){var i=EC(n,r);return WR(e,t,i[0],i[1],e.RGBA,e.RGBA,e.UNSIGNED_BYTE)}function qR(e,t,n,r,a){var i=CC(n,r);return WR(e,t,i[0],i[1],a.internalFormatPackedFloat,e.RGBA,e.FLOAT)}function KR(e,t,n,r,a){var i=CC(n,r);return WR(e,t,i[0],i[1],a.internalFormatPackedHalfFloat,e.RGBA,a.textureTypeHalfFloat)}function XR(e,t,n,r){return TC(e,t,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),GC(e,t,n,"clipSpacePos",r,3,20,0)&&GC(e,t,n,"uv",r,2,20,12)}function $R(e,t,n,r,a,i,o){var s,u,c;TC(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)})),i instanceof Uint8Array?(s=new Uint8Array(r*a*4),u=e.UNSIGNED_BYTE,c=e.RGBA):(s=new Float32Array(r*a*4),u=e.FLOAT,c=o.internalFormatPackedFloat),s.set(i),TC(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,c,r,a,0,e.RGBA,u,s)})),TC(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function QR(e,t,n,r){TC(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,n)})),r.data instanceof Uint8Array?TC(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,r.width,r.height,0,e.RGBA,e.UNSIGNED_BYTE,r.data)})):TC(e,t,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,r)})),TC(e,t,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}function YR(e,t,n,r,a){var i=e.createBuffer();TC(e,t,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,i)}));var o=16*n*r;return TC(e,t,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,o,e.STREAM_READ)})),TC(e,t,(function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,0)})),TC(e,t,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),i}function JR(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}function ZR(e,t,n,r,a){var i=EC(n,r),o=i[0],s=i[1],u=new Uint8Array(n*r*4);return TC(e,t,(function(){return e.readPixels(0,0,o,s,a.downloadTextureFormat,e.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}function eA(e,t,n,r,a,i,o,s){var u=e,c=new Float32Array(function(e,t){var n=CC(e,t);return n[0]*n[1]*4}(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function tA(e,t,n,r){var a=new Float32Array(n*r*4);return TC(e,t,(function(){return e.readPixels(0,0,r,n,e.RGBA,e.FLOAT,a)})),a}var nA=Object.freeze({createVertexShader:VR,createVertexBuffer:zR,createIndexBuffer:UR,createFloat32MatrixTexture:jR,createFloat16MatrixTexture:GR,createUnsignedBytesMatrixTexture:HR,createPackedMatrixTexture:qR,createFloat16PackedMatrixTexture:KR,bindVertexProgramAttributeStreams:XR,uploadDenseMatrixToTexture:$R,uploadPixelDataToTexture:QR,createBufferFromOutputTexture:YR,downloadFloat32MatrixFromBuffer:JR,downloadByteEncodedFloatMatrixFromOutputTexture:ZR,downloadPackedMatrixFromBuffer:eA,downloadMatrixFromPackedOutputTexture:tA}),rA=function(){function e(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var t=WE().getNumber("WEBGL_VERSION");null!=e?(this.gl=e,wC(t,e)):this.gl=kC(t);var n="WEBGL_color_buffer_float";if(1===WE().getNumber("WEBGL_VERSION")){if(this.textureFloatExtension=RC(this.gl,this.debug,"OES_texture_float"),lI(this.gl,"OES_texture_half_float"))this.textureHalfFloatExtension=RC(this.gl,this.debug,"OES_texture_half_float");else if(WE().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(n),lI(this.gl,"EXT_color_buffer_half_float"))this.colorBufferHalfFloatExtension=RC(this.gl,this.debug,"EXT_color_buffer_half_float");else if(WE().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(n="EXT_color_buffer_float",lI(this.gl,n))this.colorBufferFloatExtension=this.gl.getExtension(n);else{if(!lI(this.gl,"EXT_color_buffer_half_float"))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension("EXT_color_buffer_half_float")}this.vertexBuffer=zR(this.gl,this.debug),this.indexBuffer=UR(this.gl,this.debug),this.framebuffer=jC(this.gl,this.debug),this.textureConfig=IC(this.gl,this.textureHalfFloatExtension)}return Object.defineProperty(e.prototype,"debug",{get:function(){return WE().getBool("DEBUG")},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;TC(t,this.debug,(function(){return t.finish()})),TC(t,this.debug,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),TC(t,this.debug,(function(){return t.deleteFramebuffer(e.framebuffer)})),TC(t,this.debug,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),TC(t,this.debug,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),TC(t,this.debug,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}},e.prototype.createFloat32MatrixTexture=function(e,t){return this.throwIfDisposed(),jR(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createFloat16MatrixTexture=function(e,t){return this.throwIfDisposed(),GR(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createUnsignedBytesMatrixTexture=function(e,t){return this.throwIfDisposed(),HR(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),QR(this.gl,this.debug,e,t)},e.prototype.uploadDenseMatrixToTexture=function(e,t,n,r){this.throwIfDisposed(),$R(this.gl,this.debug,e,t,n,r,this.textureConfig)},e.prototype.createFloat16PackedMatrixTexture=function(e,t){return this.throwIfDisposed(),KR(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),qR(this.gl,this.debug,e,t,this.textureConfig)},e.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(QC(this.gl,this.debug,this.framebuffer),this.outputTexture=null),TC(this.gl,this.debug,(function(){return t.gl.deleteTexture(e)}))},e.prototype.downloadByteEncodedFloatMatrixFromOutputTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return ZR(r.gl,r.debug,t,n,r.textureConfig)}))},e.prototype.downloadPackedMatrixFromBuffer=function(e,t,n,r,a,i){return eA(this.gl,e,0,0,0,a,i,this.textureConfig)},e.prototype.downloadFloat32MatrixFromBuffer=function(e,t){return JR(this.gl,e,t)},e.prototype.createBufferFromTexture=function(e,t,n){this.bindTextureToFrameBuffer(e);var r=YR(this.gl,this.debug,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r},e.prototype.createAndWaitForFence=function(){var e=this.createFence(this.gl);return this.pollFence(e)},e.prototype.createFence=function(e){var t,n,r=this;if(WE().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else WE().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,WE().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}},e.prototype.downloadMatrixFromPackedTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return tA(r.gl,r.debug,t,n)}))},e.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=DC(t,this.debug,e),r=VR(t,this.debug),a=PC(t,this.debug);return TC(t,this.debug,(function(){return t.attachShader(a,r)})),TC(t,this.debug,(function(){return t.attachShader(a,n)})),LC(t,this.debug,a),this.debug&&BC(t,this.debug,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=XR(t,this.debug,this.program,this.vertexBuffer)),a},e.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&TC(this.gl,this.debug,(function(){return t.gl.deleteProgram(e)}))},e.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&BC(this.gl,this.debug,this.program),TC(this.gl,this.debug,(function(){return t.gl.useProgram(e)}))},e.prototype.getUniformLocation=function(e,t,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?qC(this.gl,this.debug,e,t):KC(this.gl,e,t)},e.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),TC(this.gl,this.debug,(function(){return n.gl.getAttribLocation(e,t)}))},e.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},e.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),XC(this.gl,this.debug,this.program,e,t,n)},e.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},e.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var r=CC(t,n),a=r[0],i=r[1];this.setOutputMatrixTextureDriver(e,a,i)},e.prototype.setOutputMatrixWriteRegion=function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)},e.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")},e.prototype.debugValidate=function(){null!=this.program&&BC(this.gl,this.debug,this.program),YC(this.gl)},e.prototype.executeProgram=function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),TC(e,this.debug,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))},e.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),TC(this.gl,this.debug,(function(){return e.gl.finish()}))},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=RC(this.gl,this.debug,2===WE().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.beginQuery=function(){if(2===WE().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a},e.prototype.endQuery=function(){if(2!==WE().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}},e.prototype.waitForQueryAndGetTime=function(e){return BE(this,void 0,void 0,(function(){var t=this;return VE(this,(function(n){switch(n.label){case 0:return[4,hS((function(){return t.disposed||t.isQueryAvailable(e,WE().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}))];case 1:return n.sent(),[2,this.getQueryTime(e,WE().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))]}}))}))},e.prototype.getQueryTime=function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6},e.prototype.isQueryAvailable=function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}return a=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT),null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint},e.prototype.pollFence=function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))},e.prototype.pollItems=function(){for(var e=function(e){for(var t=0;t<e.length&&e[t]();++t);return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t)(0,this.itemsToPoll[t].resolveFn)();this.itemsToPoll=this.itemsToPoll.slice(e+1)},e.prototype.addItemToPoll=function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||hS((function(){return n.pollItems(),0===n.itemsToPoll.length}))},e.prototype.bindTextureToFrameBuffer=function(e){this.throwIfDisposed(),$C(this.gl,this.debug,e,this.framebuffer),this.debug&&YC(this.gl)},e.prototype.unbindTextureToFrameBuffer=function(){null!=this.outputTexture?($C(this.gl,this.debug,this.outputTexture,this.framebuffer),this.debug&&YC(this.gl)):QC(this.gl,this.debug,this.framebuffer)},e.prototype.downloadMatrixDriver=function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n},e.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var r=this.gl;$C(r,this.debug,e,this.framebuffer),this.debug&&YC(r),this.outputTexture=e,TC(r,this.debug,(function(){return r.viewport(0,0,t,n)})),TC(r,this.debug,(function(){return r.scissor(0,0,t,n)}))},e.prototype.setOutputMatrixWriteRegionDriver=function(e,t,n,r){var a=this;this.throwIfDisposed(),TC(this.gl,this.debug,(function(){return a.gl.scissor(e,t,n,r)}))},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error("No GPU program is currently set.")},e}();function aA(e,t){if(e.length!==t.length)throw Error("Binary was compiled with "+e.length+" inputs, but was executed with "+t.length+" inputs");e.forEach((function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!sS(r,i))throw Error("Binary was compiled with different shapes than the current args. Shapes "+r+" and "+i+" must match");if(!e.isUniform||!a.isUniform){var o=e.texShape,s=a.isUniform?null:a.texData.texShape;if(!sS(o,s))throw Error("Binary was compiled with different texture shapes than the current args. Shape "+o+" and "+s+" must match")}}))}var iA=function(e,t,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var r=n.filterWidth,a=n.inChannels,i=n.strideWidth,o=n.strideHeight,s=n.padInfo,u=n.outWidth,c=n.dilationWidth,l=n.dilationHeight,f=n.dataFormat,h=s.left,p=s.top,d=a*r,v=O_(),m="channelsLast"===f,y=m?0:1,g=m?1:2,b="",x=0;x<=1;x++)for(var w=0;w<=1;w++)b+="\n          blockIndex = rc.y + "+w+";\n          pos = rc.x + "+x+";\n\n          if(blockIndex < "+e[1]+" && pos < "+e[0]+") {\n            offsetY = int(blockIndex / ("+u+")) * "+o+" - "+p+";\n            d0 = offsetY + "+l+" * (pos / "+d+");\n\n            if(d0 < "+t[y]+" && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), "+u+".) * "+i+". - "+h+".);\n              d1 = offsetX + "+c+" * (int(mod(float(pos), "+d+".) / "+a+".));\n\n              if(d1 < "+t[g]+" && d1 >= 0) {\n\n                ch = int(mod(float(pos), "+a+".));\n\n                if ("+m+") {\n                  innerDims = vec2(d1, ch);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result["+(2*x+w)+"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ";this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        "+b+"\n\n        "+v.output+" = result;\n      }\n    "},oA=function(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[];var i,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=.5===a?"inversesqrt("+u+")":1===a?"1.0/("+u+")":"exp(log("+u+") * float(-"+a+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -"+o+"; j <= "+o+"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  "+s+") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * "+i+";\n        setOutput(val);\n      }\n    "},sA=function(e,t,n,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=n,this.alpha=r,this.beta=a,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < "+this.depth+"; ++d) {\n          int depthBegin = int(max(0.0, float(d - "+t+")));\n          int depthEnd = int(min(float("+this.depth+"),\n              float(d + "+t+" + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = "+this.depth+";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float("+r+") * norm + float("+n+");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float("+r+")\n                * float("+a+")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * "+a+");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    "},uA=function(e,t,n,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var i,o=t,s=e[3]-1;this.outputShape=e;var u="float("+n+") + float("+r+") * sum";i=.5===a?"inversesqrt("+u+")":1===a?"1.0/("+u+")":"exp(log("+u+") * float(-"+a+"));",this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < "+this.outputShape[3]+";\n        bool hasNextRow = c < "+this.outputShape[2]+";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - "+o+";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - "+o+"; j <= "+o+"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2("+s+"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * "+i+";\n        setOutput(result);\n      }\n    "},cA=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideHeight,n=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,o=a-1-e.padInfo.top,s=i-1-e.padInfo.left,u=a*i-1;this.userCode="\n      const ivec2 pads = ivec2("+o+", "+s+");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < "+a+";\n          wR += "+r+") {\n          float dyR = float(dyRCorner + wR) / "+t+".0;\n\n          if (dyR < 0.0 || dyR >= "+e.outHeight+".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < "+i+"; wC++) {\n            float dyC = float(dyCCorner + wC) / "+n+".0;\n\n            if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = "+u+" - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * "+i+" + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},lA=function(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;var t=e.strideDepth,n=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,o=e.dilationWidth,s=e.effectiveFilterDepth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=s-1-e.padInfo.front,f=u-1-e.padInfo.top,h=c-1-e.padInfo.left,p=s*u*c-1;this.userCode="\n      const ivec3 pads = ivec3("+l+", "+f+", "+h+");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < "+s+";\n           wD += "+a+") {\n          float dyD = float(dyDCorner + wD) / "+t+".0;\n\n          if (dyD < 0.0 || dyD >= "+e.outDepth+".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < "+u+";\n              wR += "+i+") {\n            float dyR = float(dyRCorner + wR) / "+n+".0;\n\n            if (dyR < 0.0 || dyR >= "+e.outHeight+".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < "+c+";\n                wC += "+o+") {\n              float dyC = float(dyCCorner + wC) / "+r+".0;\n\n              if (dyC < 0.0 || dyC >= "+e.outWidth+".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = "+p+" -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * "+u+" * "+c+" +\n                  wR * "+c+" + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    "},fA=function(e,t,n,r,a,i,o){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===a&&(a=!1),void 0===i&&(i=null),void 0===o&&(o=!1),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;var s=n?e[1]:e[2],u=Math.ceil(s/2),c=n?"i * 2, rc.y":"rc.y, i * 2",l=r?"rc.z, i * 2":"i * 2, rc.z",f=n?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],h=r?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],p="",d="";i&&(p=o?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          "+i+"\n        }":"vec4 activation(vec4 x) {\n          "+i+"\n        }",d="result = activation(result);");var v=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),o&&this.variableNames.push("preluActivationWeights"),this.userCode="\n      "+p+"\n\n      const float sharedDimension = "+u+".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < "+u+"; i++) {\n          vec4 a = getMatrixA(rc.x, "+c+");\n          vec4 b = getMatrixB(rc.x, "+l+");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += ("+f[0]+" * "+h[0]+");\n          result += ("+f[1]+" * "+h[1]+");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        "+v+"\n\n        "+d+"\n\n        setOutput(result);\n      }\n    "},hA=function(){function e(e,t,n){this.variableNames=["probs"],this.outputShape=[e,n],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < "+(t-1)+"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float("+(t-1)+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}},e}(),pA=function(e,t,n,r){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float("+r+"), float("+n+"),\n                      float(index == coords.y)));\n      }\n    "},dA=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e;var t=e.length;if(0===t)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var n=D_("rc",t),r=q_(t),a=function(e,t,n){if(1===e)return"rc > "+t[0];for(var r="",a=e-2;a<e;a++)r+=n[a]+" >= "+t[a],a<e-1&&(r+="||");return r}(t,e,n),i=function(e,t,n,r){if(1===e)return"";var a=r.slice(-2);return"\n    int r = "+a[0]+";\n    int c = "+a[1]+";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= "+t+";\n    bool rEdge = rp1 >= "+n+";\n  "}(t,e[e.length-1],e[e.length-2],n),o=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var i=(0===r?"r":"rp1")+", "+(0===a?"c":"cp1"),o=2;o<e;o++)i=t[t.length-1-o]+","+i;n.push(i)}return n}(n,t);return 1===n?"getA(rc),\n            rc + 1 >= "+e[0]+" ? 0. : getA(rc + 1),\n            0, 0":"getA("+r[0]+"),\n          cEdge ? 0. : getA("+r[1]+"),\n          rEdge ? 0. : getA("+r[2]+"),\n          rEdge || cEdge ? 0. : getA("+r[3]+")"}(e,n);this.userCode="\n        void main() {\n          "+r+" rc = getOutputCoords();\n\n          if("+a+") {\n            setOutput(vec4(0));\n          } else {\n            "+i+"\n\n            setOutput(vec4("+o+"));\n          }\n        }\n      "}},vA=function(e,t,n){this.variableNames=["x"],this.outputShape=t.map((function(t,n){return t[0]+e[n]+t[1]}));var r=e.length,a=q_(r),i=t.map((function(e){return e[0]})).join(","),o=t.map((function(t,n){return t[0]+e[n]})).join(","),s=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);this.userCode=1!==r?"\n      "+a+" start = "+a+"("+i+");\n      "+a+" end = "+a+"("+o+");\n\n      void main() {\n        "+a+" outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(float("+n+"));\n        } else {\n          "+a+" coords = outC - start;\n          setOutput(getX("+s+"));\n        }\n      }\n    ":"\n        int start = "+i+";\n        int end = "+o+";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(float("+n+"));\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      "},mA=function(e,t,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((function(t,n){return t[0]+e[n]+t[1]}));for(var r=e.length,a=q_(r),i=t.map((function(e){return e[0]})).join(","),o=t.map((function(t,n){return t[0]+e[n]})).join(","),s=D_("rc",r),u=D_("source",r),c=s[r-1]+" < "+this.outputShape[r-1],l=1===r?"source":"vec2("+u.slice(-2).join()+")",f=[a+" rc = outputLoc;",s[r-1]+" += 1;\n       if("+c+") {\n      ",1===r?"":"}\n       rc = outputLoc;\n       "+s[r-2]+" += 1;\n       if("+s[r-2]+" < "+this.outputShape[r-2]+") {",1===r?"":"  "+s[r-1]+" += 1;\n         if("+c+") {"],h=1===r?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",p="",d=0,v=1===r?2:4;d<v;d++)p+="\n        "+f[d]+"\n        if ("+h+") {\n          result["+d+"] = float("+n+");\n        } else {\n          "+a+" source = rc - start;\n          result["+d+"] = getChannel(getX("+u.join()+"), "+l+");\n        }\n      ";p+=1===r?"} ":"}}",this.userCode="\n      const "+a+" start = "+a+"("+i+");\n      const "+a+" end = "+a+"("+o+");\n\n      void main() {\n        "+a+" outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        "+p+"\n        setOutput(result);\n      }\n    "},yA=function(e,t,n,r,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var i=e.filterWidth,o=e.strideHeight,s=e.strideWidth,u=e.dilationHeight,c=e.dilationWidth,l=e.effectiveFilterHeight,f=e.effectiveFilterWidth,h=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;var d="avg"===t,v="((batch  * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + d",m="(xR * "+e.inWidth+" + xC) * "+e.inChannels+" + d",y="0.0";if(d||(y="-1.0 / 1e-20"),n)this.userCode="\n        const ivec2 strides = ivec2("+o+", "+s+");\n        const ivec2 pads = ivec2("+h+", "+p+");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < "+l+";\n              wR += "+u+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+f+";\n                wC += "+c+") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= "+e.inWidth+") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value >= currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = "+(r?a?v:m:"wR * "+f+" + wC")+";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var g=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(g="avgValue / count");var b=4*Math.floor(i/4),x=i%4,w="\n      if ("+d+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec2 strides = ivec2("+o+", "+s+");\n      const ivec2 pads = ivec2("+h+", "+p+");\n      const float initializationValue = "+y+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+y+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < "+l+";\n            wR += "+u+") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= "+e.inHeight+") {\n            continue;\n          }\n\n          for (int wC = 0; wC < "+b+"; wC += 4) {\n            int xC = xCCorner + wC * "+c+";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+c+", d),\n              getValue(batch, xR, xC + 2 * "+c+", d),\n              getValue(batch, xR, xC + 3 * "+c+", d)\n            );\n\n            "+w+"\n          }\n\n          int xC = xCCorner + "+b+";\n          if ("+(1===x)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            "+w+"\n          } else if ("+(2===x)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+c+", d),\n              initializationValue,\n              initializationValue\n            );\n\n            "+w+"\n          } else if ("+(3===x)+") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + "+c+", d),\n              getValue(batch, xR, xC + 2 * "+c+", d),\n              initializationValue\n            );\n\n            "+w+"\n          }\n        }\n        setOutput("+g+");\n      }\n    "}},gA=function(e,t,n,r,a){if(void 0===r&&(r=!1),void 0===a&&(a=!1),this.variableNames=["x"],"avg"===t&&n)throw new Error("Cannot compute positions for average pool.");var i=e.filterWidth,o=e.strideDepth,s=e.strideHeight,u=e.strideWidth,c=e.dilationDepth,l=e.dilationHeight,f=e.dilationWidth,h=e.effectiveFilterDepth,p=e.effectiveFilterHeight,d=e.effectiveFilterWidth,v=e.padInfo.front,m=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;var g="avg"===t,b="0.0";if(g||(b="-1.0 / 1e-20"),n)this.userCode="\n        const ivec3 strides =\n            ivec3("+o+", "+s+", "+u+");\n        const ivec3 pads = ivec3("+v+", "+m+", "+y+");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < "+h+";\n              wD += "+c+") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= "+e.inDepth+") {\n              continue;\n            }\n\n            for (int wR = 0; wR < "+p+";\n                wR += "+l+") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= "+e.inHeight+") {\n                continue;\n              }\n\n              for (int wC = 0; wC < "+d+";\n                  wC += "+f+") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= "+e.inWidth+") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value >= currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = "+(r?a?"(((batch * "+e.inDepth+" + xD) * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + ch":"((xD * "+e.inHeight+" + xR) * "+e.inWidth+" + xC) * "+e.inChannels+" + ch":"wD * "+p+" * "+d+" +\n                      wR * "+d+" + wC")+";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ";else{var x=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===t&&(x="avgValue / count");var w=4*Math.floor(i/4),k=i%4,E="\n      if ("+g+") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = max(values, minMaxValue);\n      }\n    ";this.userCode="\n      const ivec3 strides =\n        ivec3("+o+", "+s+", "+u+");\n      const ivec3 pads = ivec3("+v+", "+m+", "+y+");\n      const float initializationValue = "+b+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= "+e.inWidth+") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4("+b+");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < "+h+";\n            wD += "+c+") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= "+e.inDepth+") {\n            continue;\n          }\n\n          for (int wR = 0; wR < "+p+";\n            wR += "+l+") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= "+e.inHeight+") {\n              continue;\n            }\n\n            for (int wC = 0; wC < "+w+"; wC += 4) {\n              int xC = xCCorner + wC * "+f+";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+f+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+f+", ch),\n                getValue(batch, xD, xR, xC + 3 * "+f+", ch)\n              );\n\n              "+E+"\n            }\n\n            int xC = xCCorner + "+w+";\n            if ("+(1===k)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              "+E+"\n            } else if ("+(2===k)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+f+", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              "+E+"\n            } else if ("+(3===k)+") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + "+f+", ch),\n                getValue(batch, xD, xR, xC + 2 * "+f+", ch),\n                initializationValue\n              );\n\n              "+E+"\n            }\n          }\n          setOutput("+x+");\n        }\n      }\n    "}},bA=function(e,t){this.variableNames=["x"];var n=e.windowSize,r=e.batchSize,a=e.inSize,i=Math.ceil(a/n);this.outputShape=[r,i];var o="0.0",s="";"prod"===t?o="1.0":"min"===t?(o="1.0 / 1e-20",s="min"):"max"===t&&(o="-1.0 / 1e-20",s="max");var u=t+"("+t+"("+t+"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===t?u="sumValue":"prod"===t?u="prodValue":"all"===t?u="allValue":"any"===t&&(u="anyValue");var c=4*Math.floor(n/4),l=n%4,f="\n      if ("+("sum"===t)+") {\n        sumValue += dot(values, ones);\n      } else if ("+("prod"===t)+") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = "+s+"(values, minMaxValue);\n      }\n    ",h="vec4";"all"===t?(o="1.0",f="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",h="bvec4"):"any"===t&&(o="0.0",f="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",h="bvec4");var p="";a%n>0&&(p="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return initializationValue;\n        }\n      "),this.userCode="\n      const float initializationValue = "+o+";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        "+p+"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * "+n+";\n\n        vec4 minMaxValue = vec4("+o+");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < "+c+"; i += 4) {\n          int inIdx = inOffset + i;\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          "+f+"\n        }\n\n        int inIdx = inOffset + "+c+";\n        if ("+(1===l)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          "+f+"\n        } else if ("+(2===l)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          "+f+"\n        } else if ("+(3===l)+") {\n          "+h+" values = "+h+"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          "+f+"\n        }\n        setOutput("+u+");\n      }\n    "},xA=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e;for(var n="",r=0;r<4;r++){var a="thisRC = rc;";r%2==1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),n+="\n        "+a+"\n        "+(r>0?"if(thisRC.y < rows && thisRC.z < cols){":"")+"\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result["+r+"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        "+(r>0?"}":"")+"\n      "}this.userCode="\n      \n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      "+M_(["r","c","d"],t)+"\n      return ivec3(r, c, d);\n    }\n  \n      "+F_(e)+"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = "+e[1]+";\n        int cols = "+e[2]+";\n\n        "+n+"\n\n        setOutput(result);\n      }\n    "},wA=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],i=r[2],o=e.shape,s=o[1],u=o[2],c=[n&&s>1?a-1:a,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=c[0]/l[0],h=c[1]/l[1],p=1/f,d=1/h,v=2*Math.ceil(p)+2,m=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+f+");\n        const float widthScale = float("+h+");\n\n        const float invHeightScale = float("+p+");\n        const float invWidthScale = float("+d+");\n\n        const int winHeight = int("+v+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), "+(a-1)+".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), "+(i-1)+".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},kA=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var a=e[0],i=e[1],o=e[2],s=e[3];this.outputShape=[a,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    "},EA=function(e,t,n,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var a=e[0],i=e[1],o=e[2],s=e[3];this.outputShape=[a,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n];this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+",\n          "+u[1]/c[1]+");\n      const vec3 inputShapeRC = vec3("+i+".0, "+o+".0,\n                                     "+o+".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = vec3(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(sourceFracIndexRC);\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < "+(s-1)+";\n        bool hasNextRow = coords.z < "+(n-1)+";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    "},SA=function(e,t,n){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t.shape;var r=t.shape,a=r[1],i=r[2],o=e.shape,s=o[1],u=o[2],c=[n&&s>1?a-1:a,n&&u>1?i-1:i],l=[n&&s>1?s-1:s,n&&u>1?u-1:u],f=c[0]/l[0],h=c[1]/l[1],p=1/f,d=1/h,v=2*Math.ceil(p)+2,m=2*Math.ceil(d)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float("+f+");\n        const float widthScale = float("+h+");\n\n        const float invHeightScale = float("+p+");\n        const float invWidthScale = float("+d+");\n\n        const int winHeight = int("+v+");\n        const int winWidth = int("+m+");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= "+s+") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= "+u+") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float("+c[0]+") *\n                (float(dyR) / float("+l[0]+"));\n\n            float sourceFracCol =\n                float("+c[1]+") *\n                  (float(dyC) / float("+l[1]+"));\n\n            int sourceNearestRow = int(min(\n                float(int("+a+") - 1),\n                "+n+" ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int("+i+") - 1),\n                "+n+" ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    "},CA=function(e,t,n,r){this.variableNames=["A"],this.outputShape=[];var a=e[0],i=e[1],o=e[2],s=e[3];this.outputShape=[a,t,n,s];var u=[r&&t>1?i-1:i,r&&n>1?o-1:o],c=[r&&t>1?t-1:t,r&&n>1?n-1:n],l=r?"0.5":"0.0";this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          "+u[0]/c[0]+",\n          "+u[1]/c[1]+");\n      const vec2 inputShapeRC = vec2("+i+".0, "+o+".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + "+l+")));\n\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    "},IA=function(e,t){this.variableNames=["x"];var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");if(this.outputShape=e,1!==n){var r=e.map((function(n,r){return function(n){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - coords["+n+"] - 1":"coords["+n+"]"}(r)})).join(","),a=q_(n);this.userCode="\n      void main() {\n        "+a+" coords = getOutputCoords();\n        setOutput(getX("+r+"));\n      }\n    "}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX("+e[0]+" - coord - 1));\n        }\n      "},TA=function(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var n=e.length;if(n>4)throw new Error("WebGL backend: Reverse of rank-"+n+" tensor is not yet supported");this.outputShape=e;var r=D_("rc",n),a=r[n-1]+" + 1 < "+this.outputShape[n-1],i=r[n-2]+" + 1 < "+this.outputShape[n-2],o=q_(n);function s(n){var r=e.map((function(r,a){return function(n,r){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+" - "+r[n]+" - 1":""+r[n]}(a,n)}));return"getChannel(getX("+r.join(",")+"), vec2("+r.slice(-2).join(",")+"))"}this.userCode=1===n?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX("+e[0]+" - rc - 1),\n            "+e[0]+" - rc - 1);\n          if("+a+"){\n              result.g = getChannel(getX("+e[0]+" - (rc  + 1) - 1),\n                "+e[0]+" - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      ":"\n        void main() {\n          "+o+" rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = "+function(e){return s(e)}(r.slice())+";\n          if("+a+"){\n            result.g = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",s(e)}(r.slice())+";\n          }\n          if("+i+") {\n            result.b = "+function(e){return e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            if("+a+") {\n              result.a = "+function(e){return e[n-1]="("+e[n-1]+" + 1)",e[n-2]="("+e[n-2]+" + 1)",s(e)}(r.slice())+";\n            }\n          }\n          setOutput(result);\n        }\n    "},NA=function(e,t,n,r,a,i,o){void 0===o&&(o=!0),this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;var s=q_(a.length),u=q_(i.length),c="";1===n?c="i":2===n&&(c="i, j");var l="getIndices("+c+")",f="";1===r?f="i":2===r&&(f="i, coords[1]");var h="getUpdates("+f+")",p=t>1?"strides[j]":"strides";this.userCode="\n        "+s+" strides = "+s+"("+a+");\n\n        void main() {\n          "+u+" coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < "+e+"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < "+t+"; j++) {\n              int index = round("+l+");\n              flattenedIndex += index * "+p+";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += "+h+";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      "},_A=function(e,t){this.variableNames=["x","segmentIds"];var n=e.windowSize,r=e.batchSize,a=e.inSize,i=e.numSegments,o=i*Math.ceil(a/n);this.outputShape=[r,o];var s=4*Math.floor(n/4),u=n%4,c="\n        sumValue += dot(values, segFilter);\n    ",l="";a%n>0&&(l="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return initializationValue;\n        }\n      ");var f="";a%n>0&&(f="\n        if (inIdx < 0 || inIdx >= "+a+") {\n          return -1.0;\n        }\n      "),this.userCode="\n      const float initializationValue = 0.0;\n\n      float getValue(int batch, int inIdx) {\n        "+l+"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        "+f+"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          "+i+")) * float("+n+"));\n        int currentSeg = int(mod(float(outIdx), float("+i+")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < "+s+"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          "+c+"\n        }\n\n        int inIdx = inOffset + "+s+";\n        if ("+(1===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          "+c+"\n        } else if ("+(2===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          "+c+"\n        } else if ("+(3===u)+") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          "+c+"\n        }\n        setOutput(sumValue);\n      }\n    "},RA=function(e,t,n){var r,a;if(this.variableNames=["c","a","b"],this.outputShape=t,n>4)throw Error("Where for rank "+n+" is not yet supported");if(1===n)a="resRC",r="resRC";else{for(var i=["resRC.x","resRC.y","resRC.z","resRC.w"],o=[],s=[],u=0;u<t.length;u++)s.push(""+i[u]),u<e&&o.push(""+i[u]);r=o.join(),a=s.join()}var c=q_(n);this.userCode="\n      void main() {\n        "+c+" resRC = getOutputCoords();\n        float cVal = getC("+r+");\n        if (cVal >= 1.0) {\n          setOutput(getA("+a+"));\n        } else {\n          setOutput(getB("+a+"));\n        }\n      }\n    "},AA=function(){function e(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;var t,n=q_(this.rank),r="uniform int start["+this.rank+"];",a=function(e){if(1===e)return"sourceLoc";if(e<=6)return DA.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank "+e+" is not yet supported")}(this.rank);t="\n        "+n+" sourceLoc;\n        "+n+" coords = getOutputCoords();\n        "+e.map((function(e,t){return"sourceLoc."+DA[t]+" = start["+t+"] + coords."+DA[t]+";"})).join("\n")+"\n      ",this.userCode="\n      "+r+"\n      void main() {\n        "+t+"\n        setOutput(getSource("+a+"));\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),DA=["x","y","z","w","u","v"],OA=function(){function e(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length;var t=q_(this.rank),n=D_("coords",this.rank),r=D_("sourceLoc",this.rank),a=1===this.rank?"sourceLoc":"vec2("+r.slice(-2).join()+")",i="getChannel(getSource("+r.join()+"), "+a+")",o="\n      result.x = "+i+";\n      if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n        ++"+r[this.rank-1]+";\n        result.y = "+i+";\n        --"+r[this.rank-1]+";\n      }\n    ",s=1===this.rank?"":"\n      --"+n[this.rank-1]+";\n      if (++"+n[this.rank-2]+" < "+e[this.rank-2]+") {\n        ++"+r[this.rank-2]+";\n        result.z = "+i+";\n        if (++"+n[this.rank-1]+" < "+e[this.rank-1]+") {\n          ++"+r[this.rank-1]+";\n          result.w = "+i+";\n        }\n      }\n    ",u=this.rank<=4?"sourceLoc = coords +\n            "+t+"("+e.map((function(e,t){return"start["+t+"]"})).join()+");":e.map((function(e,t){return r[t]+" = "+n[t]+" + start["+t+"];"})).join("\n");this.userCode="\n      uniform int start["+this.rank+"];\n      void main() {\n        "+t+" coords = getOutputCoords();\n        "+t+" sourceLoc;\n        "+u+"\n        vec4 result = vec4(0.);\n        "+o+"\n        "+s+"\n        setOutput(result);\n      }\n    "}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error("The rank ("+this.rank+") of the program must match the length of start ("+e.length+")");return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}},e}(),MA=function(e,t,n){this.variableNames=["x"],this.outputShape=n;var r=n.length,a=q_(n.length),i=q_(n.length),o="";if(1===r)o="coords * strides + begin";else{var s=0;o=n.map((function(e,t){return s++,1===n.length?"coords * strides["+t+"] + begin["+t+"]":"coords["+(s-1)+"] * strides["+t+"] + begin["+t+"]"})).join(",")}this.userCode="\n      "+a+" begin = "+a+"("+e+");\n      "+a+" strides = "+a+"("+t+");\n\n      void main() {\n        "+i+" coords = getOutputCoords();\n        setOutput(getX("+o+"));\n      }\n    "},FA=function(){function e(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return e.prototype.acquireTexture=function(e,t,n){var r,a=PA(t,n),i=LA(e,a,n);if(i in this.freeTextures||(this.freeTextures[i]=[]),i in this.usedTextures||(this.usedTextures[i]=[]),this.freeTextures[i].length>0){this.numFreeTextures--,this.numUsedTextures++,this.log();var o=this.freeTextures[i].shift();return this.usedTextures[i].push(o),o}return this.numUsedTextures++,this.log(),a===gC.PACKED_2X2_FLOAT32?r=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):a===gC.PACKED_2X2_FLOAT16?r=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):a===gC.UNPACKED_FLOAT32?r=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):a===gC.UNPACKED_FLOAT16?r=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):a===gC.PACKED_4X1_UNSIGNED_BYTE&&(r=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[i].push(r),r},e.prototype.releaseTexture=function(e,t,n,r){if(null!=this.freeTextures){var a=LA(t,PA(n,r),r);a in this.freeTextures||(this.freeTextures[a]=[]),this.freeTextures[a].push(e),this.numFreeTextures++,this.numUsedTextures--;var i=this.usedTextures[a],o=i.indexOf(e);if(o<0)throw new Error("Cannot release a texture that was never provided by this texture manager");i.splice(o,1),this.log()}},e.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",this.numFreeTextures+" / "+this.numUsedTextures,"("+e+")")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var t in this.usedTextures)this.usedTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0}},e}();function PA(e,t){if(e===yC.UPLOAD)return gC.PACKED_2X2_FLOAT32;if(e===yC.RENDER||null==e)return function(e){return WE().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?gC.PACKED_2X2_FLOAT32:gC.UNPACKED_FLOAT32:e?gC.PACKED_2X2_FLOAT16:gC.UNPACKED_FLOAT16}(t);if(e===yC.DOWNLOAD||e===yC.PIXELS)return gC.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type "+e)}function LA(e,t,n){return e[0]+"_"+e[1]+"_"+t+"_"+n}var BA=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[r]*t[r];this.outputShape=n,this.rank=n.length;var a=q_(this.rank),i=function(e){var t=e.length;if(t>5)throw Error("Tile for rank "+t+" is not yet supported");if(1===t)return"imod(resRC, "+e[0]+")";for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod("+n[a]+", "+e[a]+")");return r.join()}(e);this.userCode="\n      void main() {\n        "+a+" resRC = getOutputCoords();\n        setOutput(getA("+i+"));\n      }\n    "},VA=1.7580993408473768,zA=1.0507009873554805,UA=function(e,t){this.variableNames=["A"],this.outputShape=e,this.userCode="\n      float unaryOperation(float x) {\n        "+t+"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},WA="if (isnan(x)) return x;",jA="return abs(x);",GA=WA+"\n  return (x < 0.0) ? 0.0 : x;\n",HA=WA+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",qA="return (x >= 0.0) ? x : (exp(x) - 1.0);",KA="return -x;",XA="return ceil(x);",$A="return floor(x);",QA="return exp(x);",YA="return exp(x) - 1.0;",JA="return x;",ZA="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",eD="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",tD="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",nD=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        "+t+"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    "},rD=function(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e;var t=e.length,n=D_("rc",t),r=q_(t),a=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(t,n),i=n.slice(-2),o=t<=1?"rc":"vec2("+i.join(",")+")";this.userCode="\n      void main() {\n        "+r+" rc = getOutputCoords();\n        vec4 packedInput = getA("+a+");\n\n        setOutput(getChannel(packedInput, "+o+"));\n      }\n    "},aD={};function iD(e,t){if(void 0===t&&(t=!1),"linear"===e)return"return x;";if("relu"===e)return t?ZA:GA;if("elu"===e)return t?tD:qA;if("relu6"===e)return t?eD:HA;if("prelu"===e)return t?oR:aR;throw new Error("Activation "+e+" has not been implemented for the WebGL backend.")}var oD=function(e){function t(t){var n,r=e.call(this)||this;if(r.pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.warnedAboutMemory=!1,r.pendingDeletes=0,r.disposed=!1,!WE().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==t){var a=kC(WE().getNumber("WEBGL_VERSION"));r.binaryCache=((n=WE().getNumber("WEBGL_VERSION"))in aD||(aD[n]={}),aD[n]),r.gpgpu=new rA(a),r.canvas=a.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=t,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=t.gl.canvas;return r.textureManager=new FA(r.gpgpu),r.numMBBeforeWarning=null==WE().global.screen?1024:WE().global.screen.height*WE().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new XN(r,pC),r}return LE(t,e),t.prototype.numDataIds=function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes},t.prototype.write=function(e,t,n){if(WE().getBool("DEBUG")&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:yC.UPLOAD}),r},t.prototype.move=function(e,t,n,r){if(WE().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:yC.UPLOAD})},t.prototype.readSync=function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensors,i=t.slice,o=t.shape,s=t.isPacked;if(null!=i){var u;u=s?new nD(o,JA):new UA(o,JA);var c=this.runWebGLProgram(u,[{dataId:e,shape:o,dtype:r}],r),l=this.readSync(c.dataId);return this.disposeData(c.dataId),l}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var f,h,p=null!=this.activeTimers;return p&&(f=FS()),h="complex64"===r?h_(a.real.dataSync(),a.imag.dataSync()):this.getValuesFromTexture(e),p&&(this.downloadWaitMs+=FS()-f),this.convertAndCacheOnCPU(e,h)},t.prototype.read=function(e){return BE(this,void 0,void 0,(function(){var t,n,r,a,i,o,s,u,c,l,f,h,p,d,v,m,y,g,b,x,w,k;return VE(this,(function(E){switch(E.label){case 0:if(this.pendingRead.has(e))return t=this.pendingRead.get(e),[2,new Promise((function(e){return t.push(e)}))];if(n=this.texData.get(e),r=n.values,a=n.shape,i=n.slice,o=n.dtype,s=n.complexTensors,u=n.isPacked,null!=i)return void 0,c=u?new nD(a,JA):new UA(a,JA),l=this.runWebGLProgram(c,[{dataId:e,shape:a,dtype:o}],o),f=this.read(l.dataId),this.disposeData(l.dataId),[2,f];if(null!=r)return[2,this.convertAndCacheOnCPU(e)];if(!WE().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&2===WE().getNumber("WEBGL_VERSION"))throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");return h=null,"complex64"!==o&&WE().get("WEBGL_BUFFER_SUPPORTED")&&(p=this.decode(e),d=this.texData.get(p.dataId),h=(k=this.gpgpu).createBufferFromTexture.apply(k,[d.texture].concat(SC(a)))),this.pendingRead.set(e,[]),"complex64"===o?[3,2]:[4,this.gpgpu.createAndWaitForFence()];case 1:E.sent(),E.label=2;case 2:return"complex64"!==o?[3,4]:[4,Promise.all([s.real.data(),s.imag.data()])];case 3:return m=E.sent(),y=m[0],g=m[1],v=h_(y,g),[3,5];case 4:null==h?v=this.getValuesFromTexture(e):(b=oS(a),v=this.gpgpu.downloadFloat32MatrixFromBuffer(h,b)),E.label=5;case 5:return null!=p&&this.disposeData(p.dataId),x=this.convertAndCacheOnCPU(e,v),w=this.pendingRead.get(e),this.pendingRead.delete(e),w.forEach((function(e){return e(x)})),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e),this.pendingDeletes--),[2,x]}}))}))},t.prototype.checkNumericalProblems=function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!NC(n)){if(WE().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value "+n+" cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value "+n+" cannot be represented on this device.")}}},t.prototype.getValuesFromTexture=function(e){var t,n=this.texData.get(e),r=n.shape,a=n.dtype,i=n.isPacked,o=oS(r);if(WE().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s=this.decode(e),u=this.texData.get(s.dataId),c=(t=this.gpgpu).downloadMatrixFromPackedTexture.apply(t,[u.texture].concat(SC(r))).subarray(0,o);return this.disposeData(s.dataId),c}var l=WE().getBool("WEBGL_PACK")&&!0===i,f=l?rI(r):r,h=l?new DR(f):new AR(f),p=this.runWebGLProgram(h,[{shape:f,dtype:a,dataId:e}],"float32"),d=this.texData.get(p.dataId),v=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(d.texture,d.texShape[0],d.texShape[1]).subarray(0,o);return this.disposeData(p.dataId),v},t.prototype.time=function(e){return BE(this,void 0,void 0,(function(){var t,n,r,a,i,o,s;return VE(this,(function(u){switch(u.label){case 0:return t=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e(),a=iS(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),i=iS(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=t,r&&(this.programTimersStack=null),o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},WE().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[4,Promise.all(a)]:[3,2];case 1:return s=u.sent(),o.kernelMs=tS(s),o.getExtraProfileInfo=function(){return s.map((function(e,t){return{name:i[t],ms:e}})).map((function(e){return e.name+": "+e.ms})).join(", ")},[3,3];case 2:o.kernelMs={error:"WebGL query timers are not supported in this environment."},u.label=3;case 3:return this.uploadWaitMs=0,this.downloadWaitMs=0,[2,o]}}))}))},t.prototype.memory=function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU}},t.prototype.startTimer=function(){return WE().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:FS(),endMs:null}},t.prototype.endTimer=function(e){return WE().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=FS(),e)},t.prototype.getQueryTime=function(e){return BE(this,void 0,void 0,(function(){var t;return VE(this,(function(n){return WE().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?[2,this.gpgpu.waitForQueryAndGetTime(e)]:[2,(t=e).endMs-t.startMs]}))}))},t.prototype.disposeData=function(e){if(!this.pendingDisposal.has(e)){if(this.pendingRead.has(e))return this.pendingDisposal.add(e),void this.pendingDeletes++;if(this.texData.has(e)){this.releaseGPUData(e);var t=this.texData.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.texData.delete(e)}}},t.prototype.releaseGPUData=function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,s=t.slice,u=s&&s.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null},t.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},t.prototype.getDataInfo=function(e){return this.texData.get(e)},t.prototype.getCPUBackend=function(){return WE().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=pC.findBackend("cpu")),this.cpuBackend):null},t.prototype.shouldExecuteOnCPU=function(e,t){var n=this;return void 0===t&&(t=128),null!=this.getCPUBackend()&&e.every((function(e){return null==n.texData.get(e.dataId).texture&&oS(e.shape)<t}))},t.prototype.getGPGPUContext=function(){return this.gpgpu},t.prototype.complex=function(e,t){var n=this.makeOutput(e.shape,"complex64");return this.texData.get(n.dataId).complexTensors={real:pC.keep(e.clone()),imag:pC.keep(t.clone())},n},t.prototype.real=function(e){return this.texData.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.texData.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.slice(e,t,n);if(0===oS(n))return zI([],n,e.dtype);var r=this.texData.get(e.dataId).isPacked,a=WN(e.shape,t,n);if(r||!a){var i=WE().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new OA(n):new AA(n),o=i.getCustomSetupFunc(t);return this.compileAndRun(i,[e],null,o)}return this.uploadToGPU(e.dataId),this.shallowSlice(e,t,n)},t.prototype.shallowSlice=function(e,t,n){var r=this.texData.get(e.dataId),a=this.makeOutput(n,e.dtype),i=this.texData.get(a.dataId);Object.assign(i,r),i.shape=n,i.dtype=e.dtype;var o=jN(t,e.strides);r.slice&&(o+=r.slice.flatOffset),i.slice={flatOffset:o,origDataId:r.slice&&r.slice.origDataId||e.dataId};var s=this.dataRefCount.get(i.slice.origDataId)||1;return this.dataRefCount.set(i.slice.origDataId,s+1),a},t.prototype.stridedSlice=function(e,t,n,r){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.stridedSlice(e,t,n,r);var a=VN(t,n,r);if(a.some((function(e){return 0===e})))return zI([],a);var i=new MA(t,r,a);return this.compileAndRun(i,[e])},t.prototype.reverse=function(e,t){var n=WE().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new TA(e.shape,t):new IA(e.shape,t);return this.compileAndRun(n,[e])},t.prototype.concat=function(e,t){if("complex64"===e[0].dtype){var n=e.map((function(e){return BI(e)})),r=e.map((function(e){return VI(e)}));return LI(this.concat(n,t),this.concat(r,t))}if(this.shouldExecuteOnCPU(e))return this.cpuBackend.concat(e,t);if(1===e.length)return e[0];if(e.length>WE().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var a=Math.floor(e.length/2),i=this.concat(e.slice(0,a),t),o=this.concat(e.slice(a),t);return this.concat([i,o],t)}if(WE().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].rank>1){var s=new hR(e.map((function(e){return e.shape})),t);return this.compileAndRun(s,e)}var u=FI(e.map((function(e){return e.shape})),t),c=e.map((function(e){return e.as2D(-1,oS(e.shape.slice(t)))})),l=new fR(c.map((function(e){return e.shape})));return this.compileAndRun(l,c).reshape(u)},t.prototype.neg=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.neg(e);if(WE().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,KA,e.dtype);var t=new UA(e.shape,KA);return this.compileAndRun(t,[e])},t.prototype.batchMatMul=function(e,t,n,r){var a=n?e.shape[2]:e.shape[1],i=r?t.shape[1]:t.shape[2],o=n?e.shape[1]:e.shape[2],s=e.shape[0];if((1===a||1===i)&&o>1e3){n&&(e=KN(e,[0,2,1])),r&&(t=KN(t,[0,2,1]));var u=1===i?e:e.as3D(s,o,1),c=1===i?2:1,l=1===i?t.as3D(s,1,o):t;return this.multiply(u,l).sum(c,!0)}var f=iC(e.dtype,t.dtype),h=new fA(e.shape,[s,a,i],n,r);return this.compileAndRun(h,[e,t],f)},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.bias,o=e.activation,s=e.preluActivationWeights,u=r?t.shape[2]:t.shape[1],c=a?n.shape[1]:n.shape[2],l=t.shape[0],f=iC(t.dtype,n.dtype),h=null!=i,p=null!=s,d=o?iD(o,!0):null,v=new fA(t.shape,[l,u,c],r,a,h,d,p),m=[t,n];return i&&m.push(i),s&&m.push(s),this.compileAndRun(v,m,f)},t.prototype.multiply=function(e,t){if("complex64"===e.dtype){var n=this.texData.get(e.dataId),r=this.texData.get(t.dataId),a=new eR("return areal * breal - aimag * bimag;",e.shape,t.shape),i=new eR("return areal * bimag + aimag * breal;",e.shape,t.shape),o=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag),this.makeComplexComponentTensorInfo(t,r.complexTensors.real),this.makeComplexComponentTensorInfo(t,r.complexTensors.imag)],s=this.compileAndRun(a,o),u=this.compileAndRun(i,o),c=this.complex(s,u);return s.dispose(),u.dispose(),c}if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.multiply(e,t);if(WE().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,rR,e.dtype);var l=new iR(rR,e.shape,t.shape);return this.compileAndRun(l,[e,t],e.dtype)},t.prototype.batchNormalization=function(e,t,n,r,a,i){var o=[e,t,n],s=null;null!=i&&(s=i.shape,o.push(i));var u=null;if(null!=a&&(u=a.shape,o.push(a)),WE().getBool("WEBGL_PACK_NORMALIZATION")){var c=new Z_(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(c,o)}var l=new J_(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(l,o)},t.prototype.localResponseNormalization4D=function(e,t,n,r,a){var i=WE().getBool("WEBGL_PACK_NORMALIZATION")?new uA(e.shape,t,n,r,a):new oA(e.shape,t,n,r,a);return this.compileAndRun(i,[e])},t.prototype.LRNGrad=function(e,t,n,r,a,i,o){var s=new sA(t.shape,r,a,i,o);return this.compileAndRun(s,[t,n,e])},t.prototype.tile=function(e,t){if("string"===e.dtype){var n=this.readSync(e.dataId).map((function(e){return BS(e)}));return C_(oT(e.shape,e.dtype,n),t)}var r=new BA(e.shape,t);return this.compileAndRun(r,[e])},t.prototype.pad=function(e,t,n){var r=WE().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new mA(e.shape,t,n):new vA(e.shape,t,n);return this.compileAndRun(r,[e])},t.prototype.gather=function(e,t,n){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.gather(e,t,n);var r=new LR(e.shape,t.size,n);return this.compileAndRun(r,[e,t])},t.prototype.batchToSpaceND=function(e,t,n){nS(e.rank<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),a=gT(e.shape,t,r),i=bT(a.length,t.length),o=xT(e.shape,t,r),s=wT(n,t.length),u=kT(o,n,t.length);return KN(e.reshape(a),i).reshape(o).slice(s,u)},t.prototype.spaceToBatchND=function(e,t,n){nS(e.rank<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var r=t.reduce((function(e,t){return e*t})),a=[[0,0]];a.push.apply(a,n);for(var i=1+t.length;i<e.shape.length;++i)a.push([0,0]);var o=e.pad(a),s=gT(o.shape,t,r,!1),u=bT(s.length,t.length,!1),c=xT(o.shape,t,r,!1);return KN(o.reshape(s),u).reshape(c)},t.prototype.reduce=function(e,t,n){var r=e.shape[0],a=e.shape[1],i=ON(a),o=new bA({windowSize:i,inSize:a,batchSize:r},t),s=this.compileAndRun(o,[e],n);return 1===s.shape[1]?s:this.reduce(s,t,n)},t.prototype.argReduce=function(e,t,n){void 0===n&&(n=null);var r=e.shape[0],a=e.shape[1];null!=n&&(r=n.shape[0],a=n.shape[1]);var i=ON(a),o=new R_({windowSize:i,inSize:a,batchSize:r},t,null==n),s=[e];null!=n&&s.push(n);var u=this.compileAndRun(o,s,"int32");return 1===u.shape[1]?u:this.argReduce(e,t,u)},t.prototype.argReducePacked=function(e,t,n){void 0===n&&(n=null);var r=null!=n?n.shape:e.shape,a=ON(r[r.length-1]),i=new $_(r,a,t,null==n),o=null==n?[e]:[e,n],s=this.compileAndRun(i,o,"int32");return s.rank===e.rank?this.argReducePacked(e,t,s):s},t.prototype.sum=function(e,t){RI("sum",t,e.rank);var n=NI(e.shape,t),r=n[0],a=oS(n[1]),i=e.as2D(-1,a),o=oC(e.dtype);return this.reduce(i,"sum",o).reshape(r)},t.prototype.prod=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.prod(e,t);var n=NI(e.shape,t),r=n[0],a=oS(n[1]),i=e.as2D(-1,a),o=oC(e.dtype);return this.reduce(i,"prod",o).reshape(r)},t.prototype.unsortedSegmentSum=function(e,t,n){var r=0,a=AI([r],e.rank),i=e;null!=a&&(i=KN(e,a),r=OI(1,e.rank)[0]);var o=function(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}(i.shape,r,n),s=oS([i.shape[r]]),u=i.as2D(-1,s),c=oC(e.dtype),l=this.segOpCompute(u,"unsortedSegmentSum",t,c,n).reshape(o);return null!=a&&(l=KN(l,DI(a))),l},t.prototype.segOpCompute=function(e,t,n,r,a){var i=e.shape[0],o=e.shape[1],s=function(e,t){var n,r=!1;for(e<=30?(n=e,r=!0):n=_S(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=_S(e,n+1);return n}(o,a),u=new _A({windowSize:s,inSize:o,batchSize:i,numSegments:a},t),c=this.compileAndRun(u,[e,n],r);return c.shape[1]===a?c:(n=YI(0,a).tile([o/s]),this.segOpCompute(c,t,n,r,a))},t.prototype.argMinMaxReduce=function(e,t,n){var r=[t];if(RI("arg"+n.charAt(0).toUpperCase()+n.slice(1),r,e.rank),!WE().getBool("WEBGL_PACK_REDUCE")||e.rank<=2){var a=NI(e.shape,r),i=a[0],o=oS(a[1]),s=e.as2D(-1,o);return this.argReduce(s,n).reshape(i)}return this.argReducePacked(e,n)},t.prototype.argMin=function(e,t){return this.argMinMaxReduce(e,t,"min")},t.prototype.argMax=function(e,t){return this.argMinMaxReduce(e,t,"max")},t.prototype.cumsum=function(e,t,n,r){if(t!==e.rank-1)throw new Error("WebGL cumsum shader expects an inner-most axis="+(e.rank-1)+" but got axis="+t);var a=new CR(e.shape,n,r);return this.compileAndRun(a,[e])},t.prototype.equal=function(e,t){if(WE().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(equal(a, b));\n","bool");var n=new iR("return float(a == b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.notEqual=function(e,t){if(WE().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(notEqual(a, b));\n","bool");var n=new iR("return float(a != b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.less=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.less(e,t);if(WE().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThan(a, b));\n","bool");var n=new iR("return float(a < b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.lessEqual=function(e,t){if(WE().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(lessThanEqual(a, b));\n","bool");var n=new iR("return float(a <= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greater=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.greater(e,t);if(WE().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThan(a, b));\n","bool");var n=new iR("return float(a > b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.greaterEqual=function(e,t){if(WE().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(greaterThanEqual(a, b));\n","bool");var n=new iR("return float(a >= b);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalNot=function(e){var t=new UA(e.shape,"return float(!(x >= 1.0));");return this.compileAndRun(t,[e])},t.prototype.logicalAnd=function(e,t){if(WE().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n","bool");var n=new iR("return float(a >= 1.0 && b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.logicalOr=function(e,t){if(WE().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n","bool");var n=new iR("return float(a >= 1.0 || b >= 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t],"bool")},t.prototype.select=function(e,t,n){var r=new RA(e.rank,t.shape,t.rank);return this.compileAndRun(r,[e,t,n],iC(t.dtype,n.dtype))},t.prototype.where=function(e){wI("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return T_(e.shape,t)},t.prototype.topk=function(e,t,n){return I_(e.dataSync(),e.shape,e.dtype,t)},t.prototype.min=function(e,t){RI("min",t,e.rank);var n=NI(e.shape,t),r=n[0],a=oS(n[1]),i=e.as2D(-1,a);return this.reduce(i,"min",i.dtype).reshape(r)},t.prototype.minimum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.minimum(e,t);var n=WE().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sR("\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new iR("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.mod=function(e,t){var n=WE().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sR("\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new iR("if (b == 0.0) return NAN;\n  return mod(a, b);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.max=function(e,t){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.max(e,t);RI("max",t,e.rank);var n=NI(e.shape,t),r=n[0],a=oS(n[1]),i=e.as2D(-1,a);return this.reduce(i,"max",i.dtype).reshape(r)},t.prototype.maximum=function(e,t){if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.maximum(e,t);var n=WE().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sR("\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new iR("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.all=function(e,t){RI("all",t,e.rank);var n=NI(e.shape,t),r=n[0],a=oS(n[1]),i=e.as2D(-1,a);return this.reduce(i,"all",i.dtype).reshape(r)},t.prototype.any=function(e,t){RI("any",t,e.rank);var n=NI(e.shape,t),r=n[0],a=oS(n[1]),i=e.as2D(-1,a);return this.reduce(i,"any",i.dtype).reshape(r)},t.prototype.floorDiv=function(e,t){if(WE().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n","int32");var n=new iR("\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",e.shape,t.shape);return this.compileAndRun(n,[e,t],"int32")},t.prototype.add=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,tR);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.add(e,t);var n=iC(e.dtype,t.dtype);if(WE().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,tR,n);var r=new iR(tR,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.packedUnaryOp=function(e,t,n){var r=new nD(e.shape,t);return this.compileAndRun(r,[e],n)},t.prototype.packedBinaryOp=function(e,t,n,r,a){void 0===a&&(a=!1);var i=new sR(n,e.shape,t.shape,a);return this.compileAndRun(i,[e,t],r)},t.prototype.complexSeparableBinaryOp=function(e,t,n){var r=this,a=this.texData.get(e.dataId),i=this.texData.get(t.dataId),o=[[a.complexTensors.real,i.complexTensors.real],[a.complexTensors.imag,i.complexTensors.imag]].map((function(a){var i=a[0],o=a[1],s=r.makeComplexComponentTensorInfo(e,i),u=r.makeComplexComponentTensorInfo(t,o),c=new iR(n,e.shape,t.shape);return r.compileAndRun(c,[s,u],iC(i.dtype,o.dtype))})),s=o[0],u=o[1],c=this.complex(s,u);return s.dispose(),u.dispose(),c},t.prototype.makeComplexComponentTensorInfo=function(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}},t.prototype.addN=function(e){if(1===e.length)return e[0];if(e.length>WE().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var t=Math.floor(e.length/2),n=this.addN(e.slice(0,t)),r=this.addN(e.slice(t));return this.addN([n,r])}var a=e.map((function(e){return e.dtype})).reduce((function(e,t){return iC(e,t)})),i=e.map((function(e){return e.shape})),o=WE().getBool("WEBGL_PACK")?new __(e[0].shape,i):new N_(e[0].shape,i);return this.compileAndRun(o,e,a)},t.prototype.subtract=function(e,t){if("complex64"===e.dtype&&"complex64"===t.dtype)return this.complexSeparableBinaryOp(e,t,nR);if(this.shouldExecuteOnCPU([e,t]))return this.cpuBackend.subtract(e,t);var n=iC(e.dtype,t.dtype);if(WE().getBool("WEBGL_PACK_BINARY_OPERATIONS"))return this.packedBinaryOp(e,t,nR,e.dtype);var r=new iR(nR,e.shape,t.shape);return this.compileAndRun(r,[e,t],n)},t.prototype.pow=function(e,t){var n=WE().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sR("\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new iR("\nif(a < 0.0 && floor(b) < b){\n  return NAN;\n}\nif (b == 0.0) {\n  return 1.0;\n}\nreturn (round(mod(b, 2.0)) != 1) ?\n    pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",e.shape,t.shape),r=iC(e.dtype,t.dtype);return this.compileAndRun(n,[e,t],r)},t.prototype.ceil=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.ceil(e);if(WE().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,XA,e.dtype);var t=new UA(e.shape,XA);return this.compileAndRun(t,[e])},t.prototype.floor=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.floor(e);if(WE().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,$A,e.dtype);var t=new UA(e.shape,$A);return this.compileAndRun(t,[e])},t.prototype.sign=function(e){var t=new UA(e.shape,"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n");return this.compileAndRun(t,[e])},t.prototype.isNaN=function(e){var t=new UA(e.shape,"return float(isnan(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isInf=function(e){var t=new UA(e.shape,"return float(isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.isFinite=function(e){var t=new UA(e.shape,"return float(!isnan(x) && !isinf(x));");return this.compileAndRun(t,[e],"bool")},t.prototype.round=function(e){var t=new UA(e.shape,"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n");return this.compileAndRun(t,[e])},t.prototype.exp=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.exp(e);if(WE().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,QA,e.dtype);var t=new UA(e.shape,QA);return this.compileAndRun(t,[e])},t.prototype.expm1=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.expm1(e);if(WE().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,YA,e.dtype);var t=new UA(e.shape,YA);return this.compileAndRun(t,[e])},t.prototype.softmax=function(e,t){var n=dS([t],e.shape),r=this.max(e,n),a=_I(r.shape,n),i=this.subtract(e,r.reshape(a)),o=this.exp(i),s=this.sum(o,n).reshape(a);return AN(o,s)},t.prototype.log=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.log(e);if(WE().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",e.dtype);var t=new UA(e.shape,"if (x < 0.0) return NAN;\n  return log(x);");return this.compileAndRun(t,[e])},t.prototype.log1p=function(e){var t=new UA(e.shape,"return log(1.0 + x);");return this.compileAndRun(t,[e])},t.prototype.sqrt=function(e){var t=new UA(e.shape,"return sqrt(x);");return this.compileAndRun(t,[e])},t.prototype.rsqrt=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.rsqrt(e);var t=new UA(e.shape,"return inversesqrt(x);");return this.compileAndRun(t,[e])},t.prototype.reciprocal=function(e){var t=new UA(e.shape,"return 1.0 / x;");return this.compileAndRun(t,[e])},t.prototype.relu=function(e){var t;return t=WE().getBool("WEBGL_PACK")?new nD(e.shape,ZA):new UA(e.shape,GA),this.compileAndRun(t,[e])},t.prototype.relu6=function(e){var t;return t=WE().getBool("WEBGL_PACK")?new nD(e.shape,eD):new UA(e.shape,HA),this.compileAndRun(t,[e])},t.prototype.prelu=function(e,t){var n=WE().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sR(oR,e.shape,t.shape):new iR(aR,e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.elu=function(e){if(WE().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,tD,e.dtype);var t=new UA(e.shape,qA);return this.compileAndRun(t,[e])},t.prototype.eluDer=function(e,t){var n=WE().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sR("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",e.shape,t.shape):new iR("return (b >= 1.0) ? a : a * (b + 1.0);",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.selu=function(e){var t=new UA(e.shape,"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = 1.7580993408473768;\n  float scale = 1.0507009873554805;\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n");return this.compileAndRun(t,[e])},t.prototype.int=function(e){var t=new UA(e.shape,"return float(int(x));");return this.compileAndRun(t,[e],"int32")},t.prototype.clip=function(e,t,n){var r,a=(r=WE().getBool("WEBGL_PACK_CLIP")?new cR(e.shape):new uR(e.shape)).getCustomSetupFunc(t,n);return this.compileAndRun(r,[e],null,a)},t.prototype.abs=function(e){if(this.shouldExecuteOnCPU([e]))return this.cpuBackend.abs(e);if(WE().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,jA,e.dtype);var t=new UA(e.shape,jA);return this.compileAndRun(t,[e])},t.prototype.complexAbs=function(e){var t=this.texData.get(e.dataId),n=new lR(e.shape),r=[this.makeComplexComponentTensorInfo(e,t.complexTensors.real),this.makeComplexComponentTensorInfo(e,t.complexTensors.imag)];return this.compileAndRun(n,r)},t.prototype.sigmoid=function(e){var t=new UA(e.shape,"return 1.0 / (1.0 + exp(-1.0 * x));");return this.compileAndRun(t,[e])},t.prototype.softplus=function(e){var t=new UA(e.shape,"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n");return this.compileAndRun(t,[e])},t.prototype.sin=function(e){var t=new UA(e.shape,"if (isnan(x)) return x;\n  return sin(x);\n");return this.compileAndRun(t,[e])},t.prototype.cos=function(e){var t=new UA(e.shape,"if (isnan(x)) return x;\n  return cos(x);\n");return this.compileAndRun(t,[e])},t.prototype.tan=function(e){var t=new UA(e.shape,"return tan(x);");return this.compileAndRun(t,[e])},t.prototype.asin=function(e){var t=new UA(e.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n");return this.compileAndRun(t,[e])},t.prototype.acos=function(e){var t=new UA(e.shape,"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n");return this.compileAndRun(t,[e])},t.prototype.atan=function(e){var t=new UA(e.shape,"if (isnan(x)) return x;\n  return atan(x);\n");return this.compileAndRun(t,[e])},t.prototype.atan2=function(e,t){var n=WE().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sR("\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",e.shape,t.shape):new iR("\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",e.shape,t.shape);return this.compileAndRun(n,[e,t])},t.prototype.sinh=function(e){var t=new UA(e.shape,"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.cosh=function(e){var t=new UA(e.shape,"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n");return this.compileAndRun(t,[e])},t.prototype.tanh=function(e){var t=new UA(e.shape,"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n");return this.compileAndRun(t,[e])},t.prototype.asinh=function(e){var t=new UA(e.shape,"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));");return this.compileAndRun(t,[e])},t.prototype.acosh=function(e){var t=new UA(e.shape,"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\n  return log(x + sqrt(x * x - 1.0));");return this.compileAndRun(t,[e])},t.prototype.atanh=function(e){var t=new UA(e.shape,"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\n  return (log(1.0 + x) - log(1.0 - x)) / 2.0;");return this.compileAndRun(t,[e])},t.prototype.erf=function(e){var t=new UA(e.shape,'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = 0.3275911;\n  float a1 = 0.254829592;\n  float a2 = -0.284496736;\n  float a3 = 1.421413741;\n  float a4 = -1.453152027;\n  float a5 = 1.061405429;\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n');return this.compileAndRun(t,[e])},t.prototype.step=function(e,t){var n=new UA(e.shape,function(e){return void 0===e&&(e=0),WA+"\n    return x > 0.0 ? 1.0 : float("+e+");\n  "}(t));return this.compileAndRun(n,[e])},t.prototype.conv2dByMatMul=function(e,t,n,r,a,i){var o=e.shape,s=this.texData.get(e.dataId),u=n.inChannels,c=o[0]*o[1]*o[2],l=n.outChannels,f="channelsLast"===n.dataFormat,h=(1===c||1===l)&&u>1e3,p=o[2]%2!=0&&!!s.isPacked;if(h||!WE().getBool("WEBGL_LAZILY_UNPACK")||!WE().getBool("WEBGL_PACK_BINARY_OPERATIONS")||!p){var d=f?o[0]*o[1]*o[2]:o[0]*o[2]*o[3],v=this.reshape(e,[1,d,n.inChannels]),m=this.reshape(t,[1,n.inChannels,n.outChannels]);return this.reshape(this.fusedBatchMatMul({a:v,b:m,transposeA:!1,transposeB:!1,bias:r,activation:a,preluActivationWeights:i}),n.outShape)}var y=f?o[0]*o[1]*(o[2]+1):o[0]*o[2]*(o[3]+1),g={dataId:e.dataId,shape:[1,y,n.inChannels],dtype:e.dtype},b=s.shape;s.shape=s.shape.slice(),s.shape[s.shape.length-2]++,nS(oI(s.shape,g.shape),(function(){return"packed reshape "+s.shape+" to "+g.shape+" isn't free"}));var x=this.reshape(t,[1,n.inChannels,n.outChannels]),w=this.fusedBatchMatMul({a:g,b:x,transposeA:!1,transposeB:!1,bias:r,activation:a,preluActivationWeights:i}),k=this.texData.get(w.dataId);return nS(k.isPacked,(function(){return"batchMatMul result is expected to be packed"})),s.shape=b,k.shape=n.outShape,pC.makeTensorFromDataId(w.dataId,n.outShape,w.dtype)},t.prototype.conv2dWithIm2Row=function(e,t,n,r,a,i){var o=n.filterWidth,s=n.filterHeight,u=n.inChannels,c=n.outWidth,l=n.outHeight,f="channelsLast"===n.dataFormat,h=o*s*u,p=l*c,d=[h,p],v=e.squeeze([0]),m=t.reshape([1,h,-1]),y=new iA(d,v.shape,n),g=this.compileAndRun(y,[v]).reshape([1,d[0],d[1]]),b=null!=r,x=null!=i,w=a?iD(a,!0):null,k=new fA(g.shape,[1,p,n.outChannels],!0,!1,b,w,x),E=[g,m];r&&E.push(r),x&&E.push(i);var S=this.compileAndRun(k,E);return f?S.reshape([1,l,c,n.outChannels]):S.reshape([1,n.outChannels,l,c])},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights;if(1===r.filterHeight&&1===r.filterWidth&&1===r.dilationHeight&&1===r.dilationWidth&&1===r.strideHeight&&1===r.strideWidth&&("SAME"===r.padInfo.type||"VALID"===r.padInfo.type))return this.conv2dByMatMul(t,n,r,a,i,o);if(WE().getBool("WEBGL_CONV_IM2COL")&&1===t.shape[0])return this.conv2dWithIm2Row(t,n,r,a,i,o);var s=null!=a,u=null!=o,c=i?iD(i,!1):null,l=new xR(r,s,c,u),f=[t,n];return a&&f.push(a),o&&f.push(o),this.compileAndRun(l,f)},t.prototype.conv2d=function(e,t,n){if(1===n.filterHeight&&1===n.filterWidth&&1===n.dilationHeight&&1===n.dilationWidth&&1===n.strideHeight&&1===n.strideWidth&&("SAME"===n.padInfo.type||"VALID"===n.padInfo.type))return this.conv2dByMatMul(e,t,n);if(WE().getBool("WEBGL_CONV_IM2COL")&&1===e.shape[0])return this.conv2dWithIm2Row(e,t,n);var r=new xR(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerInput=function(e,t,n){var r=new vR(n);return this.compileAndRun(r,[e,t])},t.prototype.conv2dDerFilter=function(e,t,n){var r=new dR(n);return this.compileAndRun(r,[e,t])},t.prototype.fusedDepthwiseConv2D=function(e){var t,n=e.input,r=e.filter,a=e.convInfo,i=e.bias,o=e.activation,s=e.preluActivationWeights,u=WE().getBool("WEBGL_PACK_DEPTHWISECONV")&&a.strideWidth<=2&&a.outChannels/a.inChannels==1,c=o?iD(o,u):null,l=[n,r],f=null!=i,h=null!=s;return f&&l.push(i),h&&l.push(s),u?(t=new ER(a,f,c,h),this.compileAndRun(t,l)):(t=new kR(a,f,c,h),this.compileAndRun(t,l))},t.prototype.depthwiseConv2D=function(e,t,n){var r;return WE().getBool("WEBGL_PACK_DEPTHWISECONV")&&n.strideWidth<=2&&n.outChannels/n.inChannels==1?(r=new ER(n),this.compileAndRun(r,[e,t])):(r=new kR(n),this.compileAndRun(r,[e,t]))},t.prototype.depthwiseConv2DDerInput=function(e,t,n){var r=new bR(n);return this.compileAndRun(r,[e,t])},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){var r=new gR(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3d=function(e,t,n){var r=new wR(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerInput=function(e,t,n){var r=new yR(n);return this.compileAndRun(r,[e,t])},t.prototype.conv3dDerFilter=function(e,t,n){var r=new mR(n);return this.compileAndRun(r,[e,t])},t.prototype.maxPool=function(e,t){var n=new yA(t,"max",!1);return this.compileAndRun(n,[e])},t.prototype.avgPool=function(e,t){var n=new yA(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPoolBackprop=function(e,t,n,r){var a=new yA(r,"max",!0),i=this.compileAndRun(a,[t]),o=new cA(r),s=this.compileAndRun(o,[e,i],t.dtype);return i.dispose(),s},t.prototype.avgPoolBackprop=function(e,t,n){var r=new Q_(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.cast=function(e,t){return c_(e,t,this)},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),a=0,i=0;i<e.rank;i++)i!==t&&(r[a++]=e.shape[i]);var o=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var u=new Array(n);for(i=0;i<u.length;i++)o[t]=i,u[i]=this.slice(e,o,s).reshape(r);return u},t.prototype.avgPool3d=function(e,t){var n=new gA(t,"avg",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.avgPool3dBackprop=function(e,t,n){var r=new Y_(n);return this.compileAndRun(r,[e],t.dtype)},t.prototype.maxPool3d=function(e,t){var n=new gA(t,"max",!1);return this.compileAndRun(n,[e],"float32")},t.prototype.maxPool3dBackprop=function(e,t,n,r){var a=new gA(r,"max",!0),i=this.compileAndRun(a,[t]),o=new lA(r),s=this.compileAndRun(o,[e,i],t.dtype);return i.dispose(),s},t.prototype.reshape=function(e,t){var n=this.texData.get(e.dataId);if(n.isPacked&&!oI(e.shape,t)&&(null===n.texture||!oI(n.shape,t))){var r=this.packedReshape(e,t);return pC.makeTensorFromDataId(r.dataId,r.shape,r.dtype)}return l_(e,t)},t.prototype.resizeBilinear=function(e,t,n,r){var a=WE().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new EA(e.shape,t,n,r):new kA(e.shape,t,n,r);return this.compileAndRun(a,[e],"float32")},t.prototype.resizeBilinearBackprop=function(e,t,n){var r=new wA(e,t,n);return this.compileAndRun(r,[e])},t.prototype.resizeNearestNeighbor=function(e,t,n,r){var a=new CA(e.shape,t,n,r);return this.compileAndRun(a,[e])},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){var r=new SA(e,t,n);return this.compileAndRun(r,[e])},t.prototype.multinomial=function(e,t,n,r){var a=t?e:HN(e),i=a.shape[0],o=a.shape[1],s=new hA(i,o,n),u=s.getCustomSetupFunc(r);return this.compileAndRun(s,[a],"int32",u)},t.prototype.oneHot=function(e,t,n,r){var a=new pA(e.size,t,n,r);return this.compileAndRun(a,[e])},t.prototype.diag=function(e){var t=new RR(e.size);return this.compileAndRun(t,[e])},t.prototype.nonMaxSuppression=function(e,t,n,r,a){return wI("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead"),g_(e.dataSync(),t.dataSync(),n,r,a)},t.prototype.cropAndResize=function(e,t,n,r,a,i){var o=new SR(e.shape,t.shape,r,a,i);return this.compileAndRun(o,[e,t,n],"float32")},t.prototype.depthToSpace=function(e,t,n){nS(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+t}));var r=e.shape[0],a="NHWC"===n?e.shape[1]:e.shape[2],i="NHWC"===n?e.shape[2]:e.shape[3],o="NHWC"===n?e.shape[3]:e.shape[1],s=a*t,u=i*t,c=o/(t*t),l=new _R("NHWC"===n?[r,s,u,c]:[r,c,s,u],t,n);return this.compileAndRun(l,[e])},t.prototype.split=function(e,t,n){return S_(e,t,n)},t.prototype.scatterND=function(e,t,n){var r=PN(0,e,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,c=[u/o,o],l=e.reshape([i,a]),f=t.reshape([i,o]);if(0===u)return l_(zI([]),n);var h=WI(0),p=new NA(i,a,l.rank,f.rank,s,c);return this.compileAndRun(p,[f,l,h]).reshape(n)},t.prototype.sparseToDense=function(e,t,n,r){var a=PN(0,e,n),i=a.sliceRank,o=a.numUpdates,s=a.strides,u=a.outputSize,c=new NA(o,i,e.rank,t.rank,s,[u,1],!1);return this.compileAndRun(c,[t,e,r]).reshape(n)},t.prototype.fft=function(e){return this.fftImpl(e,!1)},t.prototype.ifft=function(e){return this.fftImpl(e,!0)},t.prototype.fftImpl=function(e,t){var n=this.texData.get(e.dataId),r=new FR("return real * expR - imag * expI;",e.shape,t),a=new FR("return real * expI + imag * expR;",e.shape,t),i=[this.makeComplexComponentTensorInfo(e,n.complexTensors.real),this.makeComplexComponentTensorInfo(e,n.complexTensors.imag)],o=this.compileAndRun(r,i),s=this.compileAndRun(a,i),u=this.complex(o,s).as2D(e.shape[0],e.shape[1]);return o.dispose(),s.dispose(),u},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],a=DN(e,t),i=a[0],o=a[1],s=a[2],u=a[3],c=t.reshape([o,r]),l=e.reshape([e.size/s,s]),f=new BR(r,u,[o,s]);return this.compileAndRun(f,[l,c]).reshape(i)},t.prototype.fill=function(e,t,n){if("string"===(n=n||TS(t))){var r=yS(n,oS(e));return r.fill(t),pC.makeTensor(r,e,n,this)}var a=new PR(e,t),i=a.getCustomSetupFunc(t);return this.compileAndRun(a,[],n,i)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported under string dtype");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){return this.fill(e.shape,"string"===e.dtype?"":0,e.dtype)},t.prototype.linspace=function(e,t,n){return f_(e,t,n)},t.prototype.makeTensorInfo=function(e,t){var n=this.write(null,e,t);return this.texData.get(n).usage=null,{dataId:n,shape:e,dtype:t}},t.prototype.makeOutput=function(e,t){var n=this.makeTensorInfo(e,t).dataId;return pC.makeTensorFromDataId(n,e,t,this)},t.prototype.unpackTensor=function(e){var t=new rD(e.shape);return this.runWebGLProgram(t,[e],e.dtype)},t.prototype.packTensor=function(e){var t=new dA(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)},t.prototype.packedReshape=function(e,t){var n=[tI(e.shape)].concat(nI(e.shape)),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[tI(t)].concat(nI(t)),i=new xA(a,n),o=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}},t.prototype.decode=function(e){var t,n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype,o=rI(a);return t=r?new NR(o):new TR(o),{dtype:i,shape:a,dataId:this.runWebGLProgram(t,[{shape:o,dtype:i,dataId:e}],i,null,!0).dataId}},t.prototype.runWebGLProgram=function(e,t,n,r,a){var i=this;void 0===a&&(a=!1);var o=this.makeTensorInfo(e.outputShape,n),s=this.texData.get(o.dataId);if(e.packedOutput&&(s.isPacked=!0),e.outPackingScheme===mC.DENSE){var u=SC(e.outputShape);s.texShape=u.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(s.usage=e.outTexUsage),0===oS(o.shape))return s.values=mS(o.dtype,0),o;var c=[],l=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=i.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&oS(t.shape)<=WE().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!=!!e.packedInputs)t=n.isPacked?i.unpackTensor(t):i.packTensor(t),c.push(t),n=i.texData.get(t.dataId);else if(n.isPacked&&!oI(n.shape,t.shape)){var r=t,a=t.shape;t.shape=n.shape,t=i.packedReshape(t,a),c.push(t),n=i.texData.get(t.dataId),r.shape=a}return i.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(o.dataId);var f,h={shape:o.shape,texData:s,isUniform:!1},p=function(e,t,n){var r="";t.concat(n).forEach((function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+=e.shape+"_"+n+"_"+t}));var a=e.userCode;return e.constructor.name+"_"+r+"_"+a}(e,l,h),d=this.getAndSaveBinary(p,(function(){return function(e,t,n,r){var a=t.userCode,i=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),o=i.map((function(e){return e.shapeInfo})),s={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=L_(i,s,a,t.packedInputs),c=e.createProgram(u),l=null,f=e.getUniformLocation(c,"NAN",!1);1===WE().getNumber("WEBGL_VERSION")&&(l=e.getUniformLocation(c,"INFINITY",!1));for(var h={},p=0;p<t.variableNames.length;p++){var d=t.variableNames[p];h[d]=e.getUniformLocation(c,d,!1),h["offset"+d]=e.getUniformLocation(c,"offset"+d,!1)}return{program:t,source:u,webGLProgram:c,uniformLocations:h,inShapeInfos:o,outShapeInfo:s,infLoc:l,nanLoc:f}}(i.gpgpu,e,l,h)})),v=null!=this.activeTimers;if(v&&(f=this.startTimer()),function(e,t,n,r,a){aA(t.inShapeInfos,n),aA([t.outShapeInfo],[r]);var i=r.texData.texture,o=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i,o[0],o[1]):e.setOutputMatrixTexture(i,o[0],o[1]),e.setProgram(t.webGLProgram),1===WE().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var a=t.program.variableNames[r],i=t.uniformLocations[a],o=t.uniformLocations["offset"+a];if(null!=i)if(n.isUniform)if(oS(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var s=n.uniformValues;s instanceof Float32Array||(s=new Float32Array(s)),e.gl.uniform1fv(i,s)}else null!=n.texData.slice&&null!=o&&e.gl.uniform1i(o,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,i,r)})),null!=a&&a(e,t.webGLProgram),e.executeProgram()}(this.gpgpu,d,l,h,r),c.forEach((function(e){return i.disposeData(e.dataId)})),v&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)})),!WE().getBool("WEBGL_LAZILY_UNPACK")&&s.isPacked&&!1===a){var m=this.unpackTensor(o);return this.disposeData(o.dataId),m}return o},t.prototype.compileAndRun=function(e,t,n,r,a){void 0===a&&(a=!1),n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,a);return pC.makeTensorFromDataId(i.dataId,i.shape,i.dtype)},t.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},t.prototype.getTextureManager=function(){return this.textureManager},t.prototype.dispose=function(){var e=this;this.disposed||(WE().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]})),this.textureManager.dispose(),null!=this.canvas&&"undefined"!=typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)},t.prototype.floatPrecision=function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=bI((function(){if(!WE().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=WE().getBool("DEBUG");WE().set("DEBUG",!1);var n=e.abs(WI(1e-8)).dataSync()[0];if(WE().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue},t.prototype.epsilon=function(){return 32===this.floatPrecision()?1e-7:1e-4},t.prototype.uploadToGPU=function(e){var t,n=this.texData.get(e),r=n.shape,a=n.dtype,i=n.values,o=n.texture,s=n.usage,u=n.isPacked;if(null==o){var c,l=null!=this.activeTimers;l&&(c=FS());var f=n.texShape;if(null==f&&(f=aI(r,u),n.texShape=f),null!=i){var h=rI(r),p=void 0,d=f[1],v=f[0],m=i instanceof Uint8Array;u?(d=(t=CC(f[0],f[1]))[0],v=t[1],p=new MR(h,[v,d],m)):p=new OR(h,[v,d],m);var y=this.makeTensorInfo([v,d],a);this.texData.get(y.dataId).usage=m?yC.PIXELS:yC.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),d,v,i);var g=this.runWebGLProgram(p,[y],a,null,!0),b=this.texData.get(g.dataId);n.texture=b.texture,n.texShape=b.texShape,n.isPacked=b.isPacked,n.usage=b.usage,this.disposeData(y.dataId),this.texData.delete(g.dataId),n.values=null,l&&(this.uploadWaitMs+=FS()-c)}else{var x=this.acquireTexture(f,s,a,u);n.texture=x}}},t.prototype.convertAndCacheOnCPU=function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype "+t)}(t,r)),n.values},t.prototype.acquireTexture=function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: "+a+" MB, most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)},t.prototype.computeBytes=function(e,t){return e[0]*e[1]*kS(t)},t}($N);function sD(e,t){return e(t={exports:{}},t.exports),t.exports}dC()&&pC.registerBackend("webgl",(function(){return new oD}),2),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof n.g?n.g:"undefined"!=typeof self&&self;var uD=sD((function(e){!function(e,t,n){function r(e){var t,n=this,r=(t=4022871197,function(e){e=e.toString();for(var n=0;n<e.length;n++){var r=.02519603282416938*(t+=e.charCodeAt(n));r-=t=r>>>0,t=(r*=t)>>>0,t+=4294967296*(r-=t)}return 2.3283064365386963e-10*(t>>>0)});n.next=function(){var e=2091639*n.s0+2.3283064365386963e-10*n.c;return n.s0=n.s1,n.s1=n.s2,n.s2=e-(n.c=0|e)},n.c=1,n.s0=r(" "),n.s1=r(" "),n.s2=r(" "),n.s0-=r(e),n.s0<0&&(n.s0+=1),n.s1-=r(e),n.s1<0&&(n.s1+=1),n.s2-=r(e),n.s2<0&&(n.s2+=1),r=null}function a(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function i(e,t){var n=new r(e),i=t&&t.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+11102230246251565e-32*(2097152*o()|0)},o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:this.alea=i}(0,e)})),cD=sD((function(e){!function(e,t,n){function r(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function i(e,t){var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:this.xor128=i}(0,e)})),lD=sD((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function a(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function i(e,t){var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:this.xorwow=i}(0,e)})),fD=sD((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function a(e,t){return t.x=e.x.slice(),t.i=e.i,t}function i(e,t){null==e&&(e=+new Date);var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,i&&(i.x&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:this.xorshift7=i}(0,e)})),hD=sD((function(e){!function(e,t,n){function r(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,u=Math.max(u,t.length)),a=0,i=-32;i<u;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function a(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function i(e,t){null==e&&(e=+new Date);var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,i&&(i.X&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:this.xor4096=i}(0,e)})),pD=sD((function(e){!function(e,t,n){function r(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function a(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function i(e,t){var n=new r(e),i=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,i&&("object"==typeof i&&a(i,n),o.state=function(){return a(n,{})}),o}t&&t.exports?t.exports=i:this.tychei=i}(0,e)})),dD=sD((function(e){!function(t,r){var a,i=this,o=256,s="random",u=r.pow(o,6),c=r.pow(2,52),l=2*c,f=255;function h(e,n,f){var h=[],y=v(function e(t,n){var r,a=[],i=typeof t;if(n&&"object"==i)for(r in t)try{a.push(e(t[r],n-1))}catch(e){}return a.length?a:"string"==i?t:t+"\0"}((n=1==n?{entropy:!0}:n||{}).entropy?[e,m(t)]:null==e?function(){try{var e;return a&&(e=a.randomBytes)?e=e(o):(e=new Uint8Array(o),(i.crypto||i.msCrypto).getRandomValues(e)),m(e)}catch(e){var n=i.navigator,r=n&&n.plugins;return[+new Date,i,r,i.screen,m(t)]}}():e,3),h),g=new p(h),b=function(){for(var e=g.g(6),t=u,n=0;e<c;)e=(e+n)*o,t*=o,n=g.g(1);for(;e>=l;)e/=2,t/=2,n>>>=1;return(e+n)/t};return b.int32=function(){return 0|g.g(4)},b.quick=function(){return g.g(4)/4294967296},b.double=b,v(m(g.S),t),(n.pass||f||function(e,t,n,a){return a&&(a.S&&d(a,g),e.state=function(){return d(g,{})}),n?(r[s]=e,t):e})(b,y,"global"in n?n.global:this==r,n.state)}function p(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,s=r.S=[];for(n||(e=[n++]);a<o;)s[a]=a++;for(a=0;a<o;a++)s[a]=s[i=f&i+e[a%n]+(t=s[a])],s[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,s=r.S;e--;)t=s[a=f&a+1],n=n*o+s[f&(s[a]=s[i=f&i+t])+(s[i]=t)];return r.i=a,r.j=i,n})(o)}function d(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function v(e,t){for(var n,r=e+"",a=0;a<r.length;)t[f&a]=f&(n^=19*t[f&a])+r.charCodeAt(a++);return m(t)}function m(e){return String.fromCharCode.apply(0,e)}if(r["seed"+s]=h,v(r.random(),t),e.exports){e.exports=h;try{a=n(902)}catch(e){}}}([],Math)}));dD.alea=uD,dD.xor128=cD,dD.xorwow=lD,dD.xorshift7=fD,dD.xor4096=hD,dD.tychei=pD;var vD=dD.alea,mD=PI({addN_:function(e){nS(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),nS(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+e.length}));var t=e.map((function(e,t){return SI(e,"tensors"+t,"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!sS(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var r=t;return pC.runKernelFunc((function(e,n){return e.addN(t)}),r,null,"AddN")}});function yD(){gI("tf.batchNormalization() is going away. Use tf.batchNorm() instead, and note the positional argument change of scale, offset, and varianceEpsilon")}function gD(e){return 0===e.rank||1===e.rank?e.as4D(1,1,1,e.size):2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}function bD(e,t,n,r,a,i){null==i&&(i=.001);var o,s,u=SI(e,"x","batchNorm"),c=SI(t,"mean","batchNorm"),l=SI(n,"variance","batchNorm");null!=a&&(o=SI(a,"scale","batchNorm")),null!=r&&(s=SI(r,"offset","batchNorm")),nS(c.rank===l.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),nS(null==s||c.rank===s.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),nS(null==o||c.rank===o.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var f={x:u,scale:o,offset:s,mean:c,variance:l},h={varianceEpsilon:i};return pC.runKernelFunc((function(e,t){var n=gD(u),r=e.batchNormalization(n,xD(c),xD(l),i,xD(o),xD(s));return t([u,c,l,o]),r}),f,null,"FusedBatchNorm",h).reshape(u.shape)}function xD(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}var wD=PI({batchNormalization_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),yD(),bD(e,t,n,i,a,r)}}),kD=PI({batchNorm_:bD});function ED(e,t,n,r,a,i){var o,s,u=SI(e,"x","batchNorm"),c=SI(t,"mean","batchNorm"),l=SI(n,"variance","batchNorm");return null!=a&&(o=SI(a,"scale","batchNorm")),null!=r&&(s=SI(r,"offset","batchNorm")),nS(2===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),nS(2===c.rank||1===c.rank,(function(){return"Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank "+c.rank+"."})),nS(2===l.rank||1===l.rank,(function(){return"Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank "+l.rank+"."})),null!=o&&nS(2===o.rank||1===o.rank,(function(){return"Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank "+o.rank+"."})),null!=s&&nS(2===s.rank||1===s.rank,(function(){return"Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank "+s.rank+"."})),kD(u,c,l,s,o,i)}var SD=PI({batchNormalization2d_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),yD(),ED(e,t,n,i,a,r)}}),CD=PI({batchNorm2d_:ED});function ID(e,t,n,r,a,i){var o,s,u=SI(e,"x","batchNorm"),c=SI(t,"mean","batchNorm"),l=SI(n,"variance","batchNorm");return null!=a&&(o=SI(a,"scale","batchNorm")),null!=r&&(s=SI(r,"offset","batchNorm")),nS(3===u.rank,(function(){return"Error in batchNorm3D: x must be rank 3 but got rank "+u.rank+"."})),nS(3===c.rank||1===c.rank,(function(){return"Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank "+c.rank+"."})),nS(3===l.rank||1===l.rank,(function(){return"Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank "+l.rank+"."})),null!=o&&nS(3===o.rank||1===o.rank,(function(){return"Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank "+o.rank+"."})),null!=s&&nS(3===s.rank||1===s.rank,(function(){return"Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank "+s.rank+"."})),kD(u,c,l,s,o,i)}var TD=PI({batchNormalization3d_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),yD(),ID(e,t,n,i,a,r)}}),ND=PI({batchNorm3d_:ID});function _D(e,t,n,r,a,i){var o,s,u=SI(e,"x","batchNorm"),c=SI(t,"mean","batchNorm"),l=SI(n,"variance","batchNorm");return null!=a&&(o=SI(a,"scale","batchNorm")),null!=r&&(s=SI(r,"offset","batchNorm")),nS(4===u.rank,(function(){return"Error in batchNorm4D: x must be rank 4 but got rank "+u.rank+"."})),nS(4===c.rank||1===c.rank,(function(){return"Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank "+c.rank+"."})),nS(4===l.rank||1===l.rank,(function(){return"Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank "+l.rank+"."})),null!=o&&nS(4===o.rank||1===o.rank,(function(){return"Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank "+o.rank+"."})),null!=s&&nS(4===s.rank||1===s.rank,(function(){return"Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank "+s.rank+"."})),kD(u,c,l,s,o,i)}var RD=PI({batchNormalization4d_:function(e,t,n,r,a,i){return void 0===r&&(r=.001),yD(),_D(e,t,n,i,a,r)}}),AD=PI({batchNorm4d_:_D}),DD=PI({broadcastTo_:function(e,t){var n=SI(e,"broadcastTo","x"),r=n.shape;if(t.some((function(e){return!(e>0)||e%1!=0})))throw new Error("broadcastTo(): Invalid broadcast shape ["+t+"].");if(t.length<n.rank)throw new Error("broadcastTo(): shape.length="+t.length+" < input.rank="+n.rank+".");if(t.length>n.rank){for(var a=n.shape.slice();a.length<t.length;)a.unshift(1);n=n.reshape(a)}for(var i=n.shape,o=Array.from(t),s=t.length-1;s>=0;s--)if(i[s]===t[s])o[s]=1;else if(1!==n.shape[s])throw new Error("broadcastTo(): ["+r+"] cannot be broadcast to ["+t+"].");var u=o.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0}));if(0===u.length)return n.clone();var c={x:n},l={shape:t,inputShape:i};return pC.runKernelFunc((function(e){return e.tile(n,o)}),c,(function(e){return{x:function(){return e.sum(u,!0)}}}),CT,l)}}),OD=PI({clone_:function(e){var t=SI(e,"x","clone",null);return pC.runKernelFunc((function(){return pC.makeTensorFromDataId(t.dataId,t.shape,t.dtype)}),{x:t},null,TT)}}),MD=PI({logicalAnd_:function(e,t){var n=SI(e,"a","logicalAnd","bool"),r=SI(t,"b","logicalAnd","bool");return OT(n.shape,r.shape),pC.runKernelFunc((function(e){return e.logicalAnd(n,r)}),{a:n,b:r},null,"LogicalAnd")}}),FD=PI({logicalNot_:function(e){var t=SI(e,"x","logicalNot","bool");return pC.runKernelFunc((function(e){return e.logicalNot(t)}),{$x:t})}}),PD=PI({logicalOr_:function(e,t){var n=SI(e,"a","logicalOr","bool"),r=SI(t,"b","logicalOr","bool");return OT(n.shape,r.shape),pC.runKernelFunc((function(e){return e.logicalOr(n,r)}),{$a:n,$b:r})}}),LD=PI({logicalXor_:function(e,t){var n=SI(e,"a","logicalXor","bool"),r=SI(t,"b","logicalXor","bool");return OT(n.shape,r.shape),PD(e,t).logicalAnd(MD(e,t).logicalNot())}}),BD=PI({where_:function(e,t,n){var r=SI(t,"a","where"),a=SI(n,"b","where"),i=SI(e,"condition","where","bool");return rS(r.shape,a.shape,"Error in where: "),1===i.rank?nS(i.shape[0]===r.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})):rS(i.shape,a.shape,"Error in where: "),pC.runKernelFunc((function(e,t){var n=e.select(i,r,a);return t([i]),n}),{$condition:i,$a:r,$b:a},(function(e,t){var n=t[0];return{$condition:function(){return ZI(n).toFloat()},$a:function(){return e.mul(n.cast(e.dtype))},$b:function(){return e.mul(n.logicalNot().cast(e.dtype))}}}))}}),VD=function(e){return BE(this,void 0,void 0,(function(){var t,n,r;return VE(this,(function(a){switch(a.label){case 0:return[4,(t=SI(e,"condition","whereAsync","bool")).data()];case 1:return n=a.sent(),r=T_(t.shape,n),e!==t&&t.dispose(),[2,r]}}))}))},zD=PI({divNoNan_:function(e,t){var n,r=SI(e,"a","div"),a=SI(t,"b","div");r=(n=sC(r,a))[0],a=n[1];var i=AN(r,a),o=ZI(i),s=a.equal(o);return BD(s,o,i)}}),UD=PI({tile_:function(e,t){var n=SI(e,"x","tile",null);nS(n.rank===t.length,(function(){return"Error in transpose: rank of input "+n.rank+" must match length of reps "+t+"."}));var r=[n],a={x:n},i={reps:t};return pC.runKernelFunc((function(e,r){var a=e.tile(n,t);return r([n]),a}),a,null,NT,i,r)}}),WD=PI({eye_:function(e,t,n,r){void 0===r&&(r="float32"),null==t&&(t=e);for(var a=oT([e,t],r),i=e<=t?e:t,o=0;o<i;++o)a.set(1,o,o);var s=a.toTensor().as2D(e,t);if(null==n)return s;if(1===n.length)return UD(fT(s,0),[n[0],1,1]);if(2===n.length)return UD(fT(fT(s,0),0),[n[0],n[1],1,1]);if(3===n.length)return UD(fT(fT(fT(s,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D batchShapes, but received "+n.length+"D.")}}),jD=PI({multinomial_:function(e,t,n,r){void 0===r&&(r=!1);var a=SI(e,"logits","multinomial"),i=a.size,o=a.rank;if(i<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+i+".");if(o>2)throw new Error("Rank of probabilities must be 1 or 2, but is "+o);n=n||Math.random();var s=1===o?a.as2D(1,-1):a,u=pC.runKernelFunc((function(e){return e.multinomial(s,r,t,n)}),{logits2D:s});return 1===o?u.as1D():u}}),GD=PI({oneHot_:function(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),t<2)throw new Error("Error in oneHot: depth must be >=2, but it is "+t);var a=SI(e,"indices","oneHot","int32"),i=a.shape.concat([t]),o={indices:a=a.flatten()},s={depth:t,onValue:n,offValue:r};return pC.runKernelFunc((function(e,i){return i([a]),e.oneHot(a,t,n,r)}),o,null,IT,s).reshape(i)}}),HD=PI({pad_:function(e,t,n){void 0===n&&(n=0);var r=SI(e,"x","pad");if(0===r.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var a={paddings:t,constantValue:n},i={x:r};return pC.runKernelFunc((function(e,a){return a([r]),e.pad(r,t,n)}),i,null,_T,a)}}),qD=PI({pad1d_:function(e,t,n){return void 0===n&&(n=0),nS(2===t.length,(function(){return"Invalid number of paddings. Must be length of 2."})),HD(e,[t],n)}}),KD=PI({pad2d_:function(e,t,n){return void 0===n&&(n=0),nS(2===t.length&&2===t[0].length&&2===t[1].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),HD(e,t,n)}}),XD=PI({pad3d_:function(e,t,n){return void 0===n&&(n=0),nS(3===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),HD(e,t,n)}}),$D=PI({pad4d_:function(e,t,n){return void 0===n&&(n=0),nS(4===t.length&&2===t[0].length&&2===t[1].length&&2===t[2].length&&2===t[3].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),HD(e,t,n)}}),QD=PI({rand_:function(e,t,n){var r=oS(e),a=null;if(null==n||"float32"===n)a=new Float32Array(r);else if("int32"===n)a=new Int32Array(r);else{if("bool"!==n)throw new Error("Unknown data type "+n);a=new Uint8Array(r)}for(var i=0;i<r;i++)a[i]=t();return pC.makeTensor(a,e,n)}});function YD(){return 32===pC.backend.floatPrecision()?.001:.1}function JD(e,t,n){var r=!0;if((wS(e)||wS(t))&&(r=!1),wS(e)&&wS(t)&&(r=!0),r){var a=e.constructor.name,i=t.constructor.name;if(a!==i)throw new Error("Arrays are of different type. Actual: "+a+". Expected: "+i)}if(Array.isArray(e)&&Array.isArray(t)){var o=kI(e),s=kI(t);if(!sS(o,s))throw new Error("Arrays have different shapes. Actual: ["+o+"]. Expected: ["+s+"]")}var u=wS(e)?e:iS(e),c=wS(t)?t:iS(t);if(u.length!==c.length)throw new Error("Arrays have different lengths actual: "+u.length+" vs expected: "+c.length+".\nActual:   "+u+".\nExpected: "+c+".");for(var l=0;l<c.length;++l){var f=u[l],h=c[l];if(!n(f,h))throw new Error("Arrays differ: actual["+l+"] = "+f+", expected["+l+"] = "+h+".\nActual:   "+u+".\nExpected: "+c+".")}}function ZD(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}Object.freeze({TEST_EPSILON_FLOAT16:.1,expectArraysClose:function(e,t,n){return null==n&&(n=YD()),JD(e,t,(function(e,t){return ZD(e,t,n)}))},testEpsilon:YD,expectPromiseToFail:function(e,t){e().then((function(){return t.fail()}),(function(){return t()}))},expectArraysEqual:function(e,t){var n="string"==typeof t||"number"==typeof t||"boolean"==typeof t?[t]:t;return SS(e)||SS(e[0])||SS(t)||SS(t[0])?JD(e,n,(function(e,t){return e==t})):JD(e,t,(function(e,t){return ZD(e,t,0)}))},expectNumbersClose:function(e,t,n){if(null==n&&(n=YD()),!ZD(e,t,n))throw new Error("Numbers differ: actual === "+e+", expected === "+t)},expectValuesInRange:function(e,t,n){for(var r=0;r<e.length;r++)if(e[r]<t||e[r]>n)throw new Error("Value out of range:"+e[r]+" low: "+t+", high: "+n)},expectArrayBuffersEqual:function(e,t){expect(new Float32Array(e)).toEqual(new Float32Array(t))}});var eO=function(){function e(e,t,n,r,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=a||Math.random();this.random=vD(i.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)},e.prototype.convertValue=function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)},e.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},e}(),tO=function(){function e(e,t,n,r){this.alpha=e,this.beta=1/t,this.dtype=n;var a=r||Math.random();this.randu=vD(a.toString()),this.randn=new eO(0,1,n,!1,this.randu()),this.d=e<1?e+2/3:e-1/3,this.c=1/Math.sqrt(9*this.d)}return e.prototype.nextValue=function(){for(var e,t,n,r,a,i;;){do{r=this.randn.nextValue(),i=1+this.c*r}while(i<=0);if(i*=i*i,t=1-.331*(e=r*r)*e,n=.5*e+this.d*(1-i+Math.log(i)),(a=this.randu())<t||Math.log(a)<n)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)},e.prototype.convertValue=function(e){return"float32"===this.dtype?e:Math.round(e)},e}(),nO=function(){function e(e,t,n,r){var a=this;if(void 0===e&&(e=0),void 0===t&&(t=1),this.canReturnFloat=function(){return null==a.dtype||"float32"===a.dtype},this.min=e,this.range=t-e,this.dtype=n,null==r&&(r=Math.random()),"number"==typeof r&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between "+e+" - "+t+" <= 1 and dtype is not float");this.random=vD(r)}return e.prototype.convertValue=function(e){return this.canReturnFloat()?e:Math.round(e)},e.prototype.nextValue=function(){return this.convertValue(this.min+this.range*this.random())},e}(),rO=PI({randomGamma_:function(e,t,n,r,a){if(void 0===n&&(n=1),void 0===r&&(r="float32"),null==n&&(n=1),null==r&&(r="float32"),"float32"!==r&&"int32"!==r)throw new Error("Unsupported data type "+r);for(var i=new tO(t,n,r,a),o=oT(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),aO=PI({randomNormal_:function(e,t,n,r,a){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type "+r);for(var i=new eO(t,n,r,!1,a),o=oT(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),iO=PI({randomUniform_:function(e,t,n,r,a){void 0===t&&(t=0),void 0===n&&(n=1),void 0===r&&(r="float32");for(var i=oT(e,r),o=new nO(t,n,null,a),s=0;s<i.values.length;s++)i.values[s]=o.nextValue();return i.toTensor()}}),oO=PI({square_:function(e){var t=SI(e,"x","square"),n=[t];return pC.runKernelFunc((function(e,n){return n([t]),e.square(t)}),{x:t},null,"Square",{},n,[])}}),sO=PI({squaredDifference_:function(e,t){var n,r=SI(e,"a","squaredDifference"),a=SI(t,"b","squaredDifference");n=sC(r,a),r=n[0],a=n[1],OT(r.shape,a.shape);var i={a:r,b:a},o=[r,a];return pC.runKernelFunc((function(e,t){var n=e.squaredDifference(r,a);return t([r,a]),n}),i,(function(e,t){var n=t[0],r=t[1],a=WI(2);return{a:function(){return e.mul(n.sub(r).mul(a))},b:function(){return e.mul(r.sub(n).mul(a))}}}),ST,{},o,[])}}),uO=PI({truncatedNormal_:function(e,t,n,r,a){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&"bool"===r)throw new Error("Unsupported data type $ { dtype }");for(var i=new eO(t,n,r,!0,a),o=oT(e,r),s=0;s<o.values.length;s++)o.values[s]=i.nextValue();return o.toTensor()}}),cO=PI({equal_:function(e,t){var n,r=SI(e,"a","equal"),a=SI(t,"b","equal");return n=sC(r,a),r=n[0],a=n[1],OT(r.shape,a.shape),pC.runKernelFunc((function(e){return e.equal(r,a)}),{$a:r,$b:a})}}),lO=PI({equalStrict_:function(e,t){var n=SI(e,"a","equalStrict"),r=SI(t,"b","equalStrict");return rS(n.shape,r.shape,"Error in equalStrict: "),n.equal(r)}}),fO=PI({greater_:function(e,t){var n,r=SI(e,"a","greater"),a=SI(t,"b","greater");return n=sC(r,a),r=n[0],a=n[1],OT(r.shape,a.shape),pC.runKernelFunc((function(e){return e.greater(r,a)}),{a:r,b:a},null,"Greater")}}),hO=PI({greaterEqual_:function(e,t){var n,r=SI(e,"a","greaterEqual"),a=SI(t,"b","greaterEqual");return n=sC(r,a),r=n[0],a=n[1],OT(r.shape,a.shape),pC.runKernelFunc((function(e,t){var n=e.greaterEqual(r,a);return t([r,a]),n}),{a:r,b:a},(function(e,t){var n=t[0],r=t[1];return{a:function(){return ZI(n)},b:function(){return ZI(r)}}}),"GreaterEqual")}}),pO=PI({greaterEqualStrict_:function(e,t){var n=SI(e,"a","greaterEqualStrict"),r=SI(t,"b","greaterEqualStrict");return rS(n.shape,r.shape,"Error in greaterEqualStrict: "),n.greaterEqual(r)}}),dO=PI({greaterStrict_:function(e,t){var n=SI(e,"a","greaterStrict"),r=SI(t,"b","greaterStrict");return rS(n.shape,r.shape,"Error in greaterStrict: "),n.greater(r)}}),vO=PI({less_:function(e,t){var n,r=SI(e,"a","less"),a=SI(t,"b","less");return n=sC(r,a),r=n[0],a=n[1],OT(r.shape,a.shape),pC.runKernelFunc((function(e){return e.less(r,a)}),{a:r,b:a},null,"Less")}}),mO=PI({lessEqual_:function(e,t){var n,r=SI(e,"a","lessEqual"),a=SI(t,"b","lessEqual");return n=sC(r,a),r=n[0],a=n[1],OT(r.shape,a.shape),pC.runKernelFunc((function(e,t){var n=e.lessEqual(r,a);return t([r,a]),n}),{a:r,b:a},null,"LessEqual")}}),yO=PI({lessEqualStrict_:function(e,t){var n=SI(e,"a","lessEqualStrict"),r=SI(t,"b","lessEqualStrict");return rS(n.shape,r.shape,"Error in lessEqualStrict: "),n.lessEqual(r)}}),gO=PI({lessStrict_:function(e,t){var n=SI(e,"a","lessStrict"),r=SI(t,"b","lessStrict");return rS(n.shape,r.shape,"Error in lessStrict: "),n.less(r)}}),bO=PI({notEqual_:function(e,t){var n,r=SI(e,"a","notEqual"),a=SI(t,"b","notEqual");return n=sC(r,a),r=n[0],a=n[1],OT(r.shape,a.shape),pC.runKernelFunc((function(e){return e.notEqual(r,a)}),{a:r,b:a},null,"NotEqual")}}),xO=PI({notEqualStrict_:function(e,t){var n=SI(e,"a","notEqualStrict"),r=SI(t,"b","notEqualStrict");return rS(n.shape,r.shape,"Error in notEqualStrict: "),n.notEqual(r)}});function wO(e,t){for(var n=[],r=e;r<t;++r)n.push(r);return n}function kO(e){for(var t=[],n=0;n<e.length;++n)for(var r=0;r<e[n].length;++r)t.push(e[n][r]);return t}var EO=PI({gather_:function(e,t,n){void 0===n&&(n=0);var r=SI(e,"x","gather"),a=SI(t,"indices","gather","int32");n=dS(n,r.shape)[0];var i=function(e,t,n){for(var r=e.shape[n],a=[],i=1,o=1,s=0;s<n;s++)a.push(e.shape[s]),i*=e.shape[s];for(s=0;s<t.rank;s++)a.push(t.shape[s]);for(s=n+1;s<e.rank;s++)a.push(e.shape[s]),o*=e.shape[s];return{batchSize:i,sliceSize:o,dimSize:r,outputShape:a}}(r,a,n);return pC.runKernelFunc((function(e,t){var i=e.gather(r,a.flatten(),n);return t([a]),i}),{x:r,indices:a},(function(e,t){var a=t[0];return{x:function(){var t=r.shape,i=a.size,o=t.slice(0,n),s=o.length,u=t.slice(n,t.length).slice(1),c=u.length,l=wO(0,s),f=wO(s+1,s+1+c),h=kO([o,[i],u]),p=e.reshape(h),d=a.reshape([i]),v=kO([[s],l,f]),m=p.transpose(v),y=SO(m,d,r.shape[n]),g=DI(v);return y.transpose(g)},indices:function(){return a}}}),"Gather",{axis:n}).reshape(i.outputShape)}}),SO=PI({unsortedSegmentSum_:function(e,t,n){var r=SI(e,"x","unsortedSegmentSum"),a=SI(t,"segmentIds","unsortedSegmentSum","int32");return nS(uS(n),(function(){return"numSegments must be of dtype int"})),pC.runKernelFunc((function(e,t){var i=e.unsortedSegmentSum(r,a,n);return t([a]),i}),{$x:r},(function(e,t){var n=t[0];return{$x:function(){return function(e,t){for(var n=gN(t,ZI(t)),r=EO(e,n),a=hO(t,WI(0,"int32")),i=r.rank-a.rank,o=0;o<i;++o)a=fT(a,o+1);a=MD(a,KI(r.shape,"bool"));var s=ZI(r);return BD(a,r,s)}(e,n)}}}))}});function CO(e,t,n,r,a,i,o){void 0===i&&(i="NHWC"),nS(e.length===t.rank,(function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"}));var s=e,u=t,c=!1;3===t.rank&&(c=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),s=[1,e[0],e[1],e[2]]),nS(4===s.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+s.length+"."})),nS(4===u.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got rank "+u.rank})),nS(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got rank "+n.rank}));var l="NHWC"===i?s[3]:s[1],f="NHWC"===i?u.shape[3]:u.shape[1];nS(l===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input ("+l+") must match input depth for filter "+n.shape[2]+"."})),nS(f===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output ("+f+") must match output depth for filter "+n.shape[3]+"."})),null!=o&&nS(uS(a),(function(){return"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var h=u_(i),p=ZN(s,n.shape,r,1,a,o,!1,h),d=pC.runKernelFunc((function(e,t){var r=e.conv2dDerInput(u,n,p);return t([n,u]),r}),{dy4D:u,filter:n},(function(e,t){var n=t[0],s=t[1];return{dy4D:function(){return _O(e,n,r,a,i,1,o)},filter:function(){return AO(e,s,n.shape,r,a,i,o)}}}));return c?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d}function IO(e){var t=function(e){return"number"==typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}(e),n=t[0],r=t[1],a=t[2];return 1===n&&1===r&&1===a}function TO(e,t,n,r,a){nS(e.length===t.rank,(function(){return"Length of inShape ("+e.length+") and rank of dy ("+t.rank+") must match"}));var i=e,o=t,s=!1;4===t.rank&&(s=!0,o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]),i=[1,e[0],e[1],e[2],e[3]]);var u=i[4],c=o.shape[4];nS(5===i.length,(function(){return"Error in conv3dDerInput: inShape must be length 5, but got length "+i.length+"."})),nS(5===o.rank,(function(){return"Error in conv3dDerInput: dy must be rank 5, but got rank "+o.rank})),nS(5===n.rank,(function(){return"Error in conv3dDerInput: filter must be rank 5, but got rank "+n.rank})),nS(u===n.shape[3],(function(){return"Error in conv3dDerInput: depth of input ("+u+") must match input depth for filter "+n.shape[3]+"."})),nS(c===n.shape[4],(function(){return"Error in conv3dDerInput: depth of output ("+c+") must match output depth for filter "+n.shape[4]+"."}));var l=e_(i,n.shape,r,1,a),f=pC.runKernelFunc((function(e){return e.conv3dDerInput(o,n,l)}),{dy5D:o});return s?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}var NO=PI({conv1d_:function(e,t,n,r,a,i,o){void 0===a&&(a="NWC"),void 0===i&&(i=1);var s=SI(e,"x","conv1d"),u=SI(t,"filter","conv1d"),c=s,l=!1;2===s.rank&&(l=!0,c=s.as3D(1,s.shape[0],s.shape[1])),nS(3===c.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank "+c.rank+"."})),nS(3===u.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+u.rank+"."})),null!=o&&nS(uS(r),(function(){return"Error in conv1d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."})),nS(c.shape[2]===u.shape[1],(function(){return"Error in conv1d: depth of input ("+c.shape[2]+") must match input depth for filter "+u.shape[1]+"."})),nS(s_(n,i),(function(){return"Error in conv1D: Either stride or dilation must be 1. Got stride "+n+" and dilation '"+i+"'"})),nS("NWC"===a,(function(){return"Error in conv1d: got dataFormat of "+a+" but only NWC is currently supported."}));var f=u.as4D(1,u.shape[0],u.shape[1],u.shape[2]),h=c.as4D(c.shape[0],1,c.shape[1],c.shape[2]),p=_O(h,f,[1,n],r,"NHWC",[1,i],o);return l?p.as2D(p.shape[2],p.shape[3]):p.as3D(p.shape[0],p.shape[2],p.shape[3])}}),_O=PI({conv2d_:function(e,t,n,r,a,i,o){void 0===a&&(a="NHWC"),void 0===i&&(i=[1,1]);var s=SI(e,"x","conv2d"),u=SI(t,"filter","conv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),nS(4===c.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank "+c.rank+"."})),nS(4===u.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+u.rank+"."})),null!=o&&nS(uS(r),(function(){return"Error in conv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var f="NHWC"===a?c.shape[3]:c.shape[1];nS(f===u.shape[2],(function(){return"Error in conv2d: depth of input ("+f+") must match input depth for filter "+u.shape[2]+"."})),nS(s_(n,i),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"}));var h=u_(a),p=ZN(c.shape,u.shape,n,i,r,o,!1,h),d=[u,c],v=pC.runKernelFunc((function(e,t){var n=e.conv2d(c,u,p);return t([u,c]),n}),{x:c,filter:u},(function(e,t){var o=t,s=o[0],u=o[1];return nS(o_(i),(function(){return"Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"})),{x:function(){return DO(u.shape,e,s,n,r,a)},filter:function(){return AO(u,e,s.shape,n,r,a)}}}),"Conv2D",p,d);return l?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),RO=PI({conv3d_:function(e,t,n,r,a,i){void 0===a&&(a="NDHWC"),void 0===i&&(i=[1,1,1]);var o=SI(e,"x","conv3d"),s=SI(t,"filter","conv3d"),u=o,c=!1;4===o.rank&&(c=!0,u=o.as5D(1,o.shape[0],o.shape[1],o.shape[2],o.shape[3])),nS(5===u.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank "+u.rank+"."})),nS(5===s.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+s.rank+"."})),nS(u.shape[4]===s.shape[3],(function(){return"Error in conv3d: depth of input ("+u.shape[4]+") must match input depth for filter "+s.shape[3]+"."})),nS(function(e,t){return IO(e)||IO(t)}(n,i),(function(){return"Error in conv3D: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"})),nS("NDHWC"===a,(function(){return"Error in conv3d: got dataFormat of "+a+" but only NDHWC is currently supported."}));var l=e_(u.shape,s.shape,n,i,r),f=pC.runKernelFunc((function(e,t){var n=e.conv3d(u,s,l);return t([u,s]),n}),{x:u,$filter:s},(function(e,t){nS(IO(i),(function(){return"Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+i+"'"}));var a=t[0],o=t[1];return{x:function(){return TO(a.shape,e,o,n,r)},$filter:function(){return function(e,t,n,r,a){var i=e;4===e.rank&&(i=e.as5D(1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]));var o=t;4===o.rank&&(o=t.as5D(1,t.shape[0],t.shape[1],t.shape[2],t.shape[3])),nS(5===i.rank,(function(){return"Error in conv3dDerFilter: input must be rank 5, but got shape "+i.shape+"."})),nS(5===o.rank,(function(){return"Error in conv3dDerFilter: dy must be rank 5, but got shape "+o.shape+"."})),nS(5===n.length,(function(){return"Error in conv3dDerFilter: filterShape must be length 5, but got "+n+"."})),nS(i.shape[4]===n[3],(function(){return"Error in conv3dDerFilter: depth of input "+i.shape[4]+") must match input depth in filter ("+n[3]+"."})),nS(o.shape[4]===n[4],(function(){return"Error in conv3dDerFilter: depth of dy ("+o.shape[4]+") must match output depth for filter ("+n[4]+")."}));var s=e_(i.shape,n,r,1,a);return pC.runKernelFunc((function(e){return e.conv3dDerFilter(i,o,s)}),{x5D:i,dy5D:o})}(a,e,o.shape,n,r)}}}));return c?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),AO=PI({conv2dDerFilter_:function(e,t,n,r,a,i,o){void 0===i&&(i="NHWC");var s=e;3===e.rank&&(s=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var u=t;3===u.rank&&(u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),nS(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+s.shape+"."})),nS(4===u.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+u.shape+"."})),nS(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+n+"."}));var c="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?u.shape[3]:u.shape[1];nS(c===n[2],(function(){return"Error in conv2dDerFilter: depth of input "+c+") must match input depth in filter ("+n[2]+"."})),nS(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy ("+l+") must match output depth for filter ("+n[3]+")."})),null!=o&&nS(uS(a),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+a+"."}));var f=u_(i),h=ZN(s.shape,n,r,1,a,o,!1,f);return pC.runKernelFunc((function(e){return e.conv2dDerFilter(s,u,h)}),{x4D:s,dy4D:u})}}),DO=PI({conv2dDerInput_:CO}),OO=PI({depthwiseConv2d_:function(e,t,n,r,a,i,o){void 0===a&&(a="NHWC"),void 0===i&&(i=[1,1]);var s=SI(e,"x","depthwiseConv2d"),u=SI(t,"filter","depthwiseConv2d"),c=s,l=!1;3===s.rank&&(l=!0,c=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),nS(4===c.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got rank "+c.rank+"."})),nS(4===u.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+u.rank+"."})),nS(c.shape[3]===u.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels ("+c.shape[3]+") must match the inChannels dimension in filter "+u.shape[2]+"."})),null==i&&(i=[1,1]),nS(s_(n,i),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+i+"'"})),null!=o&&nS(uS(r),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+r+"."}));var f=ZN(c.shape,u.shape,n,i,r,o,!0),h=[c,u],p=pC.runKernelFunc((function(e,t){var n=e.depthwiseConv2D(c,u,f);return t([c,u]),n}),{x:c,filter:u},(function(e,t){nS(o_(i),(function(){return"Error in gradient of depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+i+"'"}));var n=t[0],r=t[1];return{x:function(){return MO(n.shape,e,r,f)},filter:function(){return FO(n,e,r.shape,f)}}}),"DepthwiseConv2dNative",f,h);return l?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p}}),MO=PI({depthwiseConv2dDerInput_:function(e,t,n,r){var a=t,i=!1;3===t.rank&&(i=!0,a=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]));var o=pC.runKernelFunc((function(e){return e.depthwiseConv2DDerInput(a,n,r)}),{dy4D:a});return i?o.as3D(o.shape[1],o.shape[2],o.shape[3]):o}}),FO=PI({depthwiseConv2dDerFilter_:function(e,t,n,r){var a=e;3===e.rank&&(a=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var i=t;return 3===i.rank&&(i=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),pC.runKernelFunc((function(e){return e.depthwiseConv2DDerFilter(a,i,r)}),{x4D:a,dy4D:i})}}),PO=PI({separableConv2d_:function(e,t,n,r,a,i,o){void 0===i&&(i=[1,1]),void 0===o&&(o="NHWC");var s=SI(e,"x","separableConv2d"),u=SI(t,"depthwiseFilter","separableConv2d"),c=SI(n,"pointwiseFilter","separableConv2d"),l=s,f=!1;if(3===s.rank&&(f=!0,l=s.as4D(1,s.shape[0],s.shape[1],s.shape[2])),"NCHW"===o)throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");nS(4===l.rank,(function(){return"Error in separableConv2d: input must be rank 4, but got rank "+l.rank+"."})),nS(4===u.rank,(function(){return"Error in separableConv2d: depthwise filter must be rank 4, but got rank "+u.rank+"."})),nS(4===c.rank,(function(){return"Error in separableConv2d: pointwise filter must be rank 4, but got rank "+u.rank+"."})),nS(1===c.shape[0],(function(){return"Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got "+c.shape[0]+"."})),nS(1===c.shape[1],(function(){return"Error in separableConv2d: the second dimension of pointwise filter must be 1, but got "+c.shape[1]+"."}));var h=u.shape[2],p=u.shape[3];nS(c.shape[2]===h*p,(function(){return"Error in separableConv2d: the third dimension of pointwise filter must be "+h*p+", but got "+c.shape[2]+"."}));var d=OO(l,u,r,a,o,i),v=_O(d,c,1,"valid",o);return f?v.as3D(v.shape[1],v.shape[2],v.shape[3]):v}}),LO=PI({conv2dTranspose_:function(e,t,n,r,a,i){return CO(n,SI(e,"x","conv2dTranspose"),SI(t,"filter","conv2dTranspose"),r,a,"NHWC",i)}}),BO=PI({conv3dTranspose_:function(e,t,n,r,a){return TO(n,SI(e,"x","conv3dTranspose"),SI(t,"filter","conv3dTranspose"),r,a)}}),VO=PI({matMul_:function(e,t,n,r){var a;void 0===n&&(n=!1),void 0===r&&(r=!1);var i=SI(e,"a","matMul"),o=SI(t,"b","matMul");a=sC(i,o),i=a[0],o=a[1];var s=n?i.shape[i.rank-2]:i.shape[i.rank-1],u=r?o.shape[o.rank-1]:o.shape[o.rank-2],c=n?i.shape[i.rank-1]:i.shape[i.rank-2],l=r?o.shape[o.rank-2]:o.shape[o.rank-1],f=i.shape.slice(0,-2),h=o.shape.slice(0,-2),p=oS(f),d=oS(h);nS(i.rank>=2&&o.rank>=2&&i.rank===o.rank,(function(){return"Error in matMul: inputs must have the same rank of at least 2, got ranks "+i.rank+" and "+o.rank+"."})),nS(sS(f,h),(function(){return"Error in matMul: outer dimensions ("+f+") and ("+h+") of Tensors with shapes "+i.shape+" and "+o.shape+" must match."})),nS(s===u,(function(){return"Error in matMul: inner shapes ("+s+") and ("+u+") of Tensors with shapes "+i.shape+" and "+o.shape+" and transposeA="+n+" and transposeB="+r+" must match."}));var v=i.shape.slice(0,-2).concat([c,l]),m=n?i.as3D(p,s,c):i.as3D(p,c,s),y=r?o.as3D(d,l,u):o.as3D(d,u,l),g={transposeA:n,transposeB:r};return pC.runKernelFunc((function(e,t){var a=e.batchMatMul(m,y,n,r);return t([m,y]),a}),{a:m,b:y},(function(e,t){var a=t,i=a[0],o=a[1];return n||r?!n&&r?{a:function(){return e.matMul(o,!1,!1)},b:function(){return e.matMul(i,!0,!1)}}:n&&!r?{a:function(){return o.matMul(e,!1,!0)},b:function(){return i.matMul(e,!1,!1)}}:{a:function(){return o.matMul(e,!0,!0)},b:function(){return e.matMul(i,!0,!0)}}:{a:function(){return e.matMul(o,!1,!0)},b:function(){return i.matMul(e,!0,!1)}}}),"BatchMatMul",g).reshape(v)}}),zO=PI({dot_:function(e,t){var n=SI(e,"t1","dot"),r=SI(t,"t2","dot");nS(!(1!==n.rank&&2!==n.rank||1!==r.rank&&2!==r.rank),(function(){return"Error in dot: inputs must all be rank 1 or 2, but got ranks "+n.rank+" and "+r.rank+"."}));var a=1===n.rank?n.size:n.shape[1],i=1===r.rank?r.size:r.shape[0];return nS(a===i,(function(){return"Error in dot: inner dimensions of inputs must match, but got "+a+" and "+i+"."})),1===n.rank&&1===r.rank?n.as2D(1,-1).matMul(r.as2D(-1,1)).asScalar():1===n.rank&&2===r.rank?n.as2D(1,-1).matMul(r.as2D(r.shape[0],r.shape[1])).as1D():2===n.rank&&1===r.rank?n.matMul(r.as2D(-1,1)).as1D():n.matMul(r.as2D(r.shape[0],r.shape[1]))}}),UO=PI({outerProduct_:function(e,t){var n=SI(e,"v1","outerProduct"),r=SI(t,"v2","outerProduct");return nS(1===n.rank&&1===r.rank,(function(){return"Error in outerProduct: inputs must be rank 1, but got ranks "+n.rank+" and "+r.rank+"."})),n.as2D(-1,1).matMul(r.as2D(1,-1))}}),WO=PI({reverse_:function(e,t){var n=SI(e,"x","reverse");if(0===n.rank)return n.clone();var r=dS(t,n.shape);return pC.runKernelFunc((function(e){return e.reverse(n,r)}),{$x:n},(function(e){return{$x:function(){return e.reverse(r)}}})).reshapeAs(n)}}),jO=PI({reverse1d_:function(e){var t=SI(e,"x","reverse");return nS(1===t.rank,(function(){return"Error in reverse1D: x must be rank 1 but got rank "+t.rank+"."})),WO(t,0)}}),GO=PI({reverse2d_:function(e,t){var n=SI(e,"x","reverse");return nS(2===n.rank,(function(){return"Error in reverse2D: x must be rank 2 but got rank "+n.rank+"."})),WO(n,t)}}),HO=PI({reverse3d_:function(e,t){var n=SI(e,"x","reverse");return nS(3===n.rank,(function(){return"Error in reverse3D: x must be rank 3 but got rank "+n.rank+"."})),WO(n,t)}}),qO=PI({reverse4d_:function(e,t){var n=SI(e,"x","reverse");return nS(4===n.rank,(function(){return"Error in reverse4D: x must be rank 4 but got rank "+n.rank+"."})),WO(n,t)}});function KO(e,t,n,r,a,i){var o=SI(e,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),null==r&&(r=[1,1]),nS(4===s.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank "+s.rank+"."})),nS(s_(n,r),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"})),null!=i&&nS(uS(a),(function(){return"Error in maxPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."}));var c=YN(s.shape,t,n,r,a,i);if(1===c.filterWidth&&1===c.filterHeight&&sS(c.inShape,c.outShape))return o.clone();var l=[s],f=pC.runKernelFunc((function(e,t){var n=e.maxPool(s,c);return t([s,n]),n}),{x:s},(function(e,i){var o=i[0],s=i[1];return{x:function(){return function(e,t,n,r,a,i,o,s){var u=SI(e,"dy","maxPoolBackprop"),c=SI(t,"input","maxPoolBackprop"),l=SI(n,"output","maxPoolBackprop");nS(c.rank===u.rank,(function(){return"Rank of input ("+c.rank+") does not match rank of dy ("+u.rank+")"})),null==i&&(i=[1,1]),nS(s_(a,i),(function(){return"Error in maxPoolBackProp: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"})),nS(4===u.rank,(function(){return"Error in maxPoolBackprop: dy must be rank 4 but got rank "+u.rank+"."})),nS(4===c.rank,(function(){return"Error in maxPoolBackprop: input must be rank 4 but got rank "+c.rank+"."}));var f=YN(c.shape,r,a,i,o,s);return pC.runKernelFunc((function(e){return e.maxPoolBackprop(u,c,l,f)}),{$dy:u,$input:c})}(e,o,s,t,n,r,a)}}}),"MaxPool",c,l);return u?f.as3D(f.shape[1],f.shape[2],f.shape[3]):f}function XO(e,t,n,r,a,i){var o=SI(e,"x","avgPool","float32");null==r&&(r=[1,1]),nS(s_(n,r),(function(){return"Error in avgPool: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+r+"'"}));var s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),nS(4===s.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank "+s.rank+"."})),null!=i&&nS(uS(a),(function(){return"Error in avgPool: pad must be an integer when using, dimRoundingMode "+i+" but got pad "+a+"."}));var c=YN(s.shape,t,n,r,a,i);if(1===c.filterWidth&&1===c.filterHeight&&sS(c.inShape,c.outShape))return o.clone();var l=pC.runKernelFunc((function(e){return e.avgPool(s,c)}),{x:s},(function(e){return{x:function(){return function(e,t,n,r,a,i){var o=SI(e,"dy","avgPoolBackprop"),s=SI(t,"input","avgPoolBackprop");nS(s.rank===o.rank,(function(){return"Rank of input ("+s.rank+") does not match rank of dy ("+o.rank+")"})),null==a&&(a=[1,1]),nS(s_(r,a),(function(){return"Error in avgPoolBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+a+"'"}));var u=s,c=o,l=!1;3===s.rank&&(l=!0,u=s.as4D(1,s.shape[0],s.shape[1],s.shape[2]),c=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),nS(4===c.rank,(function(){return"Error in avgPoolBackprop: dy must be rank 4 but got rank "+c.rank+"."})),nS(4===u.rank,(function(){return"Error in avgPoolBackprop: input must be rank 4 but got rank "+u.rank+"."}));var f=YN(u.shape,n,r,a,i),h=pC.runKernelFunc((function(e){return e.avgPoolBackprop(c,u,f)}),{dy4D:c,input4D:u});return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h}(e,s,t,n,r,a)}}}),"AvgPool",c);return l=l.cast(o.dtype),u?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l}var $O=PI({maxPool_:function(e,t,n,r,a){return KO(e,t,n,1,r,a)}}),QO=PI({avgPool_:function(e,t,n,r,a){return XO(e,t,n,1,r,a)}}),YO=PI({pool_:function(e,t,n,r,a,i){null==a&&(a=[1,1]),null==i&&(i=1),0===r&&(r="valid");var o=SI(e,"x","maxPool"),s=o,u=!1;3===o.rank&&(u=!0,s=o.as4D(1,o.shape[0],o.shape[1],o.shape[2])),nS(s_(i,a),(function(){return"Error in pool: Either strides or dilations must be 1. Got strides "+i+" and dilations '"+a+"'"}));var c,l=YN(s.shape,t,i,a,r),f=[l.dilationHeight,l.dilationWidth];c="same"===r?function(e,t){var n=e.map((function(e,n){return e+(e-1)*(t[n]-1)})).map((function(e){return e-1})),r=n.map((function(e){return Math.floor(e/2)})),a=n.map((function(e,t){return e-r[t]}));return n.map((function(e,t){return[r[t],a[t]]}))}([l.filterHeight,l.filterWidth],f):[[0,0],[0,0]];var h=1===f[0]&&1===f[1],p=function(e,t,n){var r=n.map((function(e){return e[0]})),a=n.map((function(e){return e[1]})),i=e.concat(r,a),o=t.map((function(e,t){return(e-i[t]%e)%e})),s=a.map((function(e,t){return e+o[t]}));return[t.map((function(e,t){return[r[t],s[t]]})),t.map((function(e,t){return[0,o[t]]}))]}([l.inHeight,l.inWidth],f,c),d=p[0],v=p[1],m=h?r:"valid",y=h?s:pT(s,f,d),g=("avg"===n?function(){return XO(y,t,i,1,m)}:function(){return KO(y,t,i,1,m)})(),b=h?g:sT(g,f,v);return u?b.as3D(b.shape[1],b.shape[2],b.shape[3]):b}}),JO=PI({maxPool3d_:function(e,t,n,r,a,i,o){void 0===i&&(i="NDHWC");var s=SI(e,"x","maxPool3d"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),nS(5===u.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank "+u.rank+"."})),nS("NDHWC"===i,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),nS(s_(n,o),(function(){return"Error in maxPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=a&&nS(uS(r),(function(){return"Error in maxPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var l=JN(u.shape,t,n,o,r,a,i),f=pC.runKernelFunc((function(e,t){var n=e.maxPool3d(u,l);return t([u,n]),n}),{x:u},(function(e,i){var s=i[0],u=i[1];return{x:function(){return function(e,t,n,r,a,i,o,s){var u=SI(e,"dy","maxPool3dBackprop"),c=SI(t,"input","maxPool3dBackprop"),l=SI(n,"output","maxPool3dBackprop"),f=u,h=c,p=l,d=!1;4===c.rank&&(d=!0,f=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]),h=c.as5D(1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]),p=l.as5D(1,l.shape[0],l.shape[1],l.shape[2],l.shape[3])),nS(5===f.rank,(function(){return"Error in maxPool3dBackprop: dy must be rank 5 but got rank "+f.rank+"."})),nS(5===h.rank,(function(){return"Error in maxPool3dBackprop: input must be rank 5 but got rank "+h.rank+"."})),nS(5===p.rank,(function(){return"Error in maxPool3dBackprop: output must be rank 5 but got rank "+p.rank+"."})),null==i&&(i=[1,1,1]),nS(s_(a,i),(function(){return"Error in maxPool3dBackprop: Either strides or dilations must be 1. Got strides "+a+" and dilations '"+i+"'"})),null!=s&&nS(uS(o),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+s+" but got pad "+o+"."}));var v=JN(h.shape,r,a,i,o,s),m=pC.runKernelFunc((function(e){return e.maxPool3dBackprop(f,h,p,v)}),{dy5D:f,input5D:h});return d?m.as4D(m.shape[1],m.shape[2],m.shape[3],m.shape[4]):m}(e,s,u,t,n,o,r,a)}}}));return c?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),ZO=PI({avgPool3d_:function(e,t,n,r,a,i,o){void 0===i&&(i="NDHWC");var s=SI(e,"x","avgPool3d","float32"),u=s,c=!1;4===s.rank&&(c=!0,u=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3])),null==o&&(o=[1,1,1]),nS(5===u.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank "+u.rank+"."})),nS("NDHWC"===i,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of "+i})),nS(s_(n,o),(function(){return"Error in avgPool3d: Either strides or dilations must be 1. Got strides "+n+" and dilations '"+o+"'"})),null!=a&&nS(uS(r),(function(){return"Error in avgPool3d: pad must be an integer when using, dimRoundingMode "+a+" but got pad "+r+"."}));var l=JN(u.shape,t,n,o,r,a,i),f=pC.runKernelFunc((function(e){return e.avgPool3d(u,l)}),{x:u},(function(e){return{x:function(){return function(e,t,n,r,a,i,o){var s=SI(e,"dy","avgPool3dBackprop"),u=SI(t,"input","avgPool3dBackprop"),c=s,l=u,f=!1;4===u.rank&&(f=!0,c=s.as5D(1,s.shape[0],s.shape[1],s.shape[2],s.shape[3]),l=u.as5D(1,u.shape[0],u.shape[1],u.shape[2],u.shape[3])),nS(5===c.rank,(function(){return"Error in avgPool3dBackprop: dy must be rank 5 but got rank "+c.rank+"."})),nS(5===l.rank,(function(){return"Error in avgPool3dBackprop: input must be rank 5 but got rank "+l.rank+"."})),null==a&&(a=[1,1,1]),nS(s_(r,a),(function(){return"Error in avgPool3dBackprop: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+a+"'"})),null!=o&&nS(uS(i),(function(){return"Error in maxPool3dBackprop: pad must be an integer when using, dimRoundingMode "+o+" but got pad "+i+"."}));var h=JN(l.shape,n,r,a,i,o),p=pC.runKernelFunc((function(e){return e.avgPool3dBackprop(c,l,h)}),{dy5D:c,input5D:l});return f?p.as4D(p.shape[1],p.shape[2],p.shape[3],p.shape[4]):p}(e,u,t,n,o,r,a)}}}));return f=f.cast(u.dtype),c?f.as4D(f.shape[1],f.shape[2],f.shape[3],f.shape[4]):f}}),eM=PI({maxPoolWithArgmax_:function(e,t,n,r,a){void 0===a&&(a=!1);var i=SI(e,"x","maxPoolWithArgmax"),o={filterSize:t,strides:n,pad:r,includeBatchInIndex:a},s=pC.runKernel("MaxPoolWithArgmax",{x:i},o);return{result:s[0],indexes:s[1]}}}),tM=PI({slice_:function(e,t,n){var r,a,i=SI(e,"x","slice");if(0===i.rank)throw new Error("Slicing scalar is not possible");(r="number"==typeof t?[t].concat(new Array(i.rank-1).fill(0)):t.length<i.rank?t.concat(new Array(i.rank-t.length).fill(0)):t.slice()).forEach((function(e){nS(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(i.rank).fill(-1):"number"==typeof n?[n].concat(new Array(i.rank-1).fill(-1)):n.length<i.rank?n.concat(new Array(i.rank-n.length).fill(-1)):n).map((function(e,t){return e>=0?e:(nS(-1===e,(function(){return"Negative size values should be exactly -1 but got "+e+" for the slice() size at index "+t+"."})),i.shape[t]-r[t])})),LN(i,r,a);var o=i.shape,s={begin:r,size:a};return pC.runKernelFunc((function(e){return e.slice(i,r,a)}),{x:i},(function(e){for(var t=[],n=0;n<e.rank;n++)t.push([r[n],o[n]-r[n]-a[n]]);return{x:function(){return HD(e,t)}}}),"Slice",s)}}),nM=PI({slice1d_:function(e,t,n){var r=SI(e,"x","slice1d");return nS(1===r.rank,(function(){return"slice1d expects a rank-1 tensor, but got a rank-"+r.rank+" tensor"})),tM(r,[t],[n])}}),rM=PI({slice2d_:function(e,t,n){var r=SI(e,"x","slice2d");return nS(2===r.rank,(function(){return"slice2d expects a rank-2 tensor, but got a rank-"+r.rank+" tensor"})),tM(r,t,n)}}),aM=PI({slice3d_:function(e,t,n){var r=SI(e,"x","slice3d");return nS(3===r.rank,(function(){return"slice3d expects a rank-3 tensor, but got a rank-"+r.rank+" tensor"})),tM(r,t,n)}}),iM=PI({slice4d_:function(e,t,n){var r=SI(e,"x","slice4d");return nS(4===r.rank,(function(){return"slice4d expects a rank-4 tensor, but got a rank-"+r.rank+" tensor"})),tM(r,t,n)}});function oM(e,t,n,r,a){return t.rank<n.rank&&(t=t.reshape(_I(t.shape,r))),e.rank<n.rank&&(e=e.reshape(_I(e.shape,r))),{x:function(){var r=e.mul(n.equal(t).cast(e.dtype));return null==a?r:r.transpose(a)}}}var sM=PI({all_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=SI(e,"x","all","bool"),a=dS(t,r.shape),i=a,o=AI(i,r.rank);null!=o&&(r=r.transpose(o),i=OI(i.length,r.rank));var s=pC.runKernelFunc((function(e){return e.all(r,i)}),{$x:r});if(n){var u=_I(s.shape,a);return s.reshape(u)}return s}}),uM=PI({any_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=SI(e,"x","any","bool"),a=dS(t,r.shape),i=a,o=AI(i,r.rank);null!=o&&(r=r.transpose(o),i=OI(i.length,r.rank));var s=pC.runKernelFunc((function(e){return e.any(r,i)}),{$x:r});if(n){var u=_I(s.shape,a);return s.reshape(u)}return s}}),cM=PI({argMax_:function(e,t){void 0===t&&(t=0);var n=SI(e,"x","argMax");null==t&&(t=0);var r=dS(t,n.shape),a=AI(r,n.rank);null!=a&&(n=n.transpose(a),r=OI(r.length,n.rank));var i={axis:r[0]},o=[n];return pC.runKernelFunc((function(e,t){var a=e.argMax(n,r[0]);return t([n]),a}),{x:n},(function(e,t){var n=t[0];return{x:function(){return ZI(n)}}}),"ArgMax",i,o)}}),lM=PI({argMin_:function(e,t){void 0===t&&(t=0);var n=SI(e,"x","argMin");null==t&&(t=0);var r=dS(t,n.shape),a=AI(r,n.rank);return null!=a&&(n=n.transpose(a),r=OI(r.length,n.rank)),pC.runKernelFunc((function(e,t){var a=e.argMin(n,r[0]);return t([n]),a}),{$x:n},(function(e,t){var n=t[0];return{$x:function(){return ZI(n)}}}))}}),fM=PI({logSumExp_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=SI(e,"x","logSumExp"),a=dS(t,r.shape),i=r.max(a,!0),o=r.sub(i).exp().sum(a).log(),s=i.reshape(o.shape).add(o);if(n){var u=_I(s.shape,a);return s.reshape(u)}return s}}),hM=PI({max_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=SI(e,"x","max"),a=r,i=dS(t,r.shape),o=i,s=AI(o,r.rank);null!=s&&(r=r.transpose(s),o=OI(o.length,r.rank));var u=[r],c=pC.runKernelFunc((function(e,t){var n=e.max(r,o);return t([a,n]),n}),{x:r},(function(e,t){return oM(e,t[1],t[0],i,s)}),"Max",{axes:o},u,[!0]);if(n){var l=_I(c.shape,i);c=c.reshape(l)}return c}}),pM=PI({mean_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=SI(e,"x","mean"),a=dS(t,r.shape),i=oS(NI(r.shape,a)[1]);return GN((function(e){var r=WI(i);return{value:(r.dtype===e.dtype?e:e.cast(r.dtype)).div(r).sum(t,n),gradFunc:function(t){var n=e.shape.slice();return a.forEach((function(e){n[e]=1})),t.reshape(n).mul(KI(e.shape,"float32")).div(i)}}}))(r)}}),dM=PI({min_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=SI(e,"x","min"),a=r,i=dS(t,r.shape),o=i,s=AI(o,r.rank);null!=s&&(r=r.transpose(s),o=OI(o.length,r.rank));var u=[r],c=pC.runKernelFunc((function(e,t){var n=e.min(r,o);return t([a,n]),n}),{x:r},(function(e,t){return oM(e,t[1],t[0],i,s)}),"Min",{axes:o},u,[!0]);if(n){var l=_I(c.shape,i);c=c.reshape(l)}return c}}),vM=PI({moments_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=dS(t,(e=SI(e,"x","moments")).shape),a=e.mean(r,n),i=a.shape;n||(i=_I(a.shape,r));var o=e.toFloat().sub(a.reshape(i)).square();return{mean:a,variance:o.mean(r,n)}}}),mM=PI({sum_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=SI(e,"x","sum");"bool"===r.dtype&&(r=r.toInt());var a=dS(t,r.shape);return GN((function(e){var t=AI(a,e.rank),r=a,i=e;null!=t&&(i=e.transpose(t),r=OI(r.length,e.rank));var o=function(t){var n=e.shape.slice();return a.forEach((function(e){n[e]=1})),t.reshape(n).mul(KI(e.shape,"float32"))},s={axes:r},u=pC.runKernelFunc((function(e){return e.sum(i,r)}),{x:i},(function(e){return{x:function(){return o(e)}}}),"Sum",s);if(n){var c=_I(u.shape,a);u=u.reshape(c)}return{value:u,gradFunc:o}}))(r)}}),yM=PI({prod_:function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=SI(e,"x","prod");"bool"===r.dtype&&(r=r.toInt());var a=dS(t,r.shape),i=AI(a,r.rank),o=a,s=r;null!=i&&(s=r.transpose(i),o=OI(o.length,r.rank));var u=pC.runKernelFunc((function(e){return e.prod(s,o)}),{permutedX:s});if(n){var c=_I(u.shape,a);u=u.reshape(c)}return u}}),gM=PI({elu_:function(e){var t=SI(e,"x","elu");return pC.runKernelFunc((function(e,n){var r=e.elu(t);return n([r]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){return pC.runKernelFunc((function(t){return t.eluDer(e,n)}),{dy:e,y:n})}}}))}}),bM=PI({leakyRelu_:function(e,t){void 0===t&&(t=.2);var n=SI(e,"x","leakyRelu");return gN(WI(t).mul(n),n)}}),xM=PI({prelu_:function(e,t){var n=SI(e,"x","prelu"),r=SI(t,"alpha","prelu");return pC.runKernelFunc((function(e,t){var a=e.prelu(n,r);return t([n,r]),a}),{x:n,alpha:r},(function(e,t){var n=t[0],r=t[1],a=n.greater(0);return{x:function(){return BD(a,e,e.mul(r))},alpha:function(){var t=BD(a,ZI(e),e.mul(n)),i=DT(r.shape,e.shape);return i.length>0&&(t=t.sum(i)),t.reshape(r.shape)}}}),"Prelu")}}),wM=PI({relu_:function(e){var t=SI(e,"x","relu");return"bool"===t.dtype?t.toInt():pC.runKernelFunc((function(e,n){var r=e.relu(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0];return{x:function(){return e.mulStrict(n.step().toFloat())}}}),"Relu")}}),kM=PI({relu6_:function(e){var t=SI(e,"x","relu6");return"bool"===t.dtype?t.toInt():pC.runKernelFunc((function(e,n){var r=e.relu6(t);return n([t]),r}),{x:t},(function(e,t){var n=t[0],r=n.lessEqual(6).mul(n.step());return{x:function(){return e.mulStrict(r.toFloat())}}}),"Relu6")}}),EM=PI({selu_:function(e){var t=SI(e,"x","selu");return pC.runKernelFunc((function(e,n){var r=e.selu(t);return n([t]),r}),{$x:t},(function(e,t){var n=t[0];return{$x:function(){var t=n.greater(WI(0)),r=WI(VA),a=WI(zA),i=e.mul(a),o=e.mul(r).mul(n.toFloat().exp());return BD(t,i,o)}}}))}}),SM=PI({localResponseNormalization_:function(e,t,n,r,a){void 0===t&&(t=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===a&&(a=.5);var i=SI(e,"x","localResponseNormalization");nS(4===i.rank||3===i.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank "+i.rank+"."})),nS(uS(t),(function(){return"Error in localResponseNormalization: depthRadius must be an integer but got depthRadius "+t+"."}));var o=i,s=!1;3===i.rank&&(s=!0,o=i.as4D(1,i.shape[0],i.shape[1],i.shape[2]));var u=pC.runKernelFunc((function(e,i){var s=e.localResponseNormalization4D(o,t,n,r,a);return i([o,s]),s}),{x4D:o},(function(e,i){var o=i[0],s=i[1];return{x4D:function(){return pC.runKernelFunc((function(i){return i.LRNGrad(e,o,s,t,n,r,a)}),{})}}}));return s?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),CM=PI({norm_:function(e,t,n,r){void 0===t&&(t="euclidean"),void 0===n&&(n=null),void 0===r&&(r=!1);var a=function e(t,n,r){if(void 0===r&&(r=null),0===t.rank)return t.abs();if(1!==t.rank&&null===r)return e(t.reshape([-1]),n,r);if(1===t.rank||"number"==typeof r||Array.isArray(r)&&1===r.length){if(1===n)return t.abs().sum(r);if(n===1/0)return t.abs().max(r);if(n===-1/0)return t.abs().min(r);if("euclidean"===n||2===n)return t.abs().pow(WI(2,"int32")).sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}if(Array.isArray(r)&&2===r.length){if(1===n)return t.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return t.abs().sum(r[1]).max(r[0]);if(n===-1/0)return t.abs().sum(r[1]).min(r[0]);if("fro"===n||"euclidean"===n)return t.square().sum(r).sqrt();throw new Error("Error in norm: invalid ord value: "+n)}throw new Error("Error in norm: invalid axis: "+r)}(e=SI(e,"x","norm"),t,n),i=a.shape;if(r){var o=dS(n,e.shape);i=_I(a.shape,o)}return a.reshape(i)}}),IM=PI({basicLSTMCell_:function(e,t,n,r,a,i){var o=SI(e,"forgetBias","basicLSTMCell"),s=SI(t,"lstmKernel","basicLSTMCell"),u=SI(n,"lstmBias","basicLSTMCell"),c=SI(r,"data","basicLSTMCell"),l=SI(a,"c","basicLSTMCell"),f=SI(i,"h","basicLSTMCell"),h=c.concat(f,1).matMul(s).add(u),p=h.shape[0],d=h.shape[1]/4,v=[p,d],m=h.slice([0,0],v),y=h.slice([0,d],v),g=h.slice([0,2*d],v),b=h.slice([0,3*d],v),x=m.sigmoid().mulStrict(y.tanh()).addStrict(l.mulStrict(o.add(g).sigmoid())),w=x.tanh().mulStrict(b.sigmoid());return[x,w]}}),TM=PI({multiRNNCell_:function(e,t,n,r){for(var a=SI(t,"data","multiRNNCell"),i=CI(n,"c","multiRNNCell"),o=CI(r,"h","multiRNNCell"),s=a,u=[],c=0;c<e.length;c++){var l=e[c](s,i[c],o[c]);u.push(l[0]),u.push(l[1]),s=l[1]}var f=[],h=[];for(c=0;c<u.length;c+=2)f.push(u[c]),h.push(u[c+1]);return[f,h]}}),NM=PI({movingAverage_:function(e,t,n,r,a){void 0===a&&(a=!0);var i=SI(e,"v","movingAverage"),o=SI(t,"x","movingAverage"),s=SI(n,"decay","movingAverage");uC(i,o),nS(sS(i.shape,o.shape),(function(){return"Shape mismatch in v and x"}));var u=WI(1),c=u.sub(s),l=o.sub(i).mul(c);if(a){nS(null!=r,(function(){return"When using zeroDebias: true, step is required."}));var f=SI(r,"step","movingAverage");l=l.div(u.sub(IN(s,f)))}return i.add(l)}}),_M=PI({stridedSlice_:function(e,t,n,r,a,i,o,s,u){if(void 0===a&&(a=0),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===u&&(u=0),null==r&&(r=new Array(t.length)),0!==o)throw new Error("ellipsis mask is not yet supported");var c=SI(e,"x","stridedSlice"),l=BN(s),f=c.shape.slice();l.forEach((function(e){t[e]=0,n[e]=1,f.splice(e,0,1)})),c=c.reshape(f);for(var h=0;h<c.rank;h++)t[h]=zN(a,t,r,c.shape,h),n[h]=UN(i,n,r,c.shape,h),r[h]=r[h]||1;var p=BN(u);p.forEach((function(e){n[e]=t[e]+1,r[e]=1}));var d=VN(t,n,r),v=d.filter((function(e,t){return-1===p.indexOf(t)}));return r.every((function(e){return 1===e}))?tM(c,t,d).reshape(v):pC.runKernelFunc((function(e){return e.stridedSlice(c,t,n,r)}),{$x:c}).reshape(v)}}),RM=PI({topk_:function(e,t,n){void 0===t&&(t=1),void 0===n&&(n=!0);var r=SI(e,"x","topk");if(0===r.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var a=r.shape[r.shape.length-1];if(t>a)throw new Error("'k' passed to topk() must be <= the last dimension ("+a+") but got "+t);var i=pC.runKernelFunc((function(e){return e.topk(r,t,n)}),{$x:r});return{values:i[0],indices:i[1]}}}),AM=PI({scatterND_:function(e,t,n){var r=SI(e,"indices","scatterND","int32"),a=SI(t,"updates","scatterND");return FN(a,r,n),pC.runKernelFunc((function(e){return e.scatterND(r,a,n)}),{indices:r,updates:a},null,"ScatterNd",{shape:n})}}),DM=PI({fft_:function(e){nS("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 but got "+e.dtype+"."}));var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return pC.runKernelFunc((function(e){return e.fft(r)}),{input:e}).reshape(e.shape)}}),OM=PI({ifft_:function(e){nS("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 but got "+e.dtype+"."}));var t=e.shape[e.shape.length-1],n=e.size/t,r=e.as2D(n,t);return pC.runKernelFunc((function(e){return e.ifft(r)}),{input:e}).reshape(e.shape)}}),MM=PI({rfft_:function(e,t){nS("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got "+e.dtype}));var n,r=e.shape[e.shape.length-1],a=e.size/r;if(null!=t&&t<r){var i=e.shape.map((function(e){return 0})),o=e.shape.map((function(e){return e}));o[e.shape.length-1]=t,n=e.slice(i,o),r=t}else if(null!=t&&t>r){var s=e.shape.map((function(e){return e}));s[e.shape.length-1]=t-r,n=e.concat(XI(s),e.shape.length-1),r=t}else n=e;var u=n.zerosLike(),c=LI(n,u).as2D(a,r),l=DM(c),f=Math.floor(r/2)+1,h=BI(l),p=VI(l),d=h.split([f,r-f],h.shape.length-1),v=p.split([f,r-f],p.shape.length-1),m=n.shape.slice();return m[n.shape.length-1]=f,LI(d[0],v[0]).reshape(m)}}),FM=PI({irfft_:function(e){var t=e.shape[e.shape.length-1],n=e.size/t;if(t<=2){var r=e.as2D(n,t),a=OM(r);return BI(a)}var i=[n,2*(t-1)],o=BI(e).as2D(n,t),s=VI(e).as2D(n,t),u=o.slice([0,1],[n,t-2]).reverse(1),c=s.slice([0,1],[n,t-2]).reverse(1).mul(WI(-1)),l=o.concat(u,1),f=s.concat(c,1);return r=LI(l,f).as2D(i[0],i[1]),a=OM(r),BI(a)}}),PM=Object.freeze({fft:DM,ifft:OM,rfft:MM,irfft:FM}),LM=PI({sparseToDense_:function(e,t,n,r){void 0===r&&(r=0);var a=SI(e,"sparseIndices","sparseToDense","int32"),i=SI(t,"sparseValues","sparseToDense"),o=SI(r,"defaultValue","sparseToDense",i.dtype);return function(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type, but the dtype was "+e.dtype+".");if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix, but got shape "+e.shape+".");var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:, "+n.length+", should be: "+i+".");var o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error("sparseValues has incorrect shape "+t.shape+", should be [] or ["+a+"]");if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}(a,i,n,o),pC.runKernelFunc((function(e){return e.sparseToDense(a,i,n,o)}),{$sparseIndices:a,$sparseValues:i,$defaultValue:o})}}),BM=PI({gatherND_:function(e,t){var n=SI(t,"indices","gatherND","int32"),r=SI(e,"x","gatherND");return pC.runKernelFunc((function(e){return e.gatherND(r,n)}),{x:r,indices:n},null,"GatherNd")}}),VM=PI({diag_:function(e){var t=SI(e,"x","diag").flatten(),n=e.shape.concat(e.shape);return pC.runKernelFunc((function(e){return e.diag(t)}),{$x:t}).reshape(n)}}),zM=PI({dropout_:function(e,t,n,r){var a=SI(e,"x","dropout");if(nS("float32"===a.dtype,(function(){return"x has to be a floating point tensor since it's going to be scaled, but got a "+a.dtype+" tensor instead."})),nS(t>=0&&t<1,(function(){return"rate must be a float in the range [0, 1), but got "+t+"."})),0===t)return e instanceof YS?a.clone():a;var i=function(e,t){if(null==t)return e.shape.slice();if(sS(e.shape,t))return t;if(e.shape.length===t.length){for(var n=[],r=0;r<e.shape.length;r++)null==t[r]&&null!=e.shape[r]?n.push(e.shape[r]):n.push(t[r]);return n}return t}(a,n),o=1-t,s=iO(i,0,1,"float32",r).add(o).floor().div(o);return a.mul(s)}});function UM(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return jI(a,"float32")}var WM,jM=PI({hannWindow_:function(e){return UM(e,.5,.5)}}),GM=PI({hammingWindow_:function(e){return UM(e,.54,.46)}}),HM=PI({frame_:function(e,t,n,r,a){void 0===r&&(r=!1),void 0===a&&(a=0);for(var i=0,o=[];i+t<=e.size;)o.push(tM(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=eT([tM(e,i,t-s),$I([s],a)]);o.push(u),i+=n}return 0===o.length?GI([],[0,t]):eT(o).as2D(o.length,t)}}),qM=PI({stft_:function(e,t,n,r,a){var i;void 0===a&&(a=jM),null==r&&(i=t,r=Math.floor(Math.pow(2,Math.ceil(Math.log(i)/Math.log(2)))));for(var o=HM(e,t,n),s=SN(o,a(t)),u=[],c=0;c<o.shape[0];c++)u.push(MM(s.slice([c,0],[1,t]),r));return eT(u)}}),KM=Object.freeze({hannWindow:jM,hammingWindow:GM,frame:HM,stft:qM});!function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(WM||(WM={}));var XM=PI({absoluteDifference_:function(e,t,n,r){void 0===r&&(r=WM.SUM_BY_NONZERO_WEIGHTS);var a=SI(e,"labels","absoluteDifference"),i=SI(t,"predictions","absoluteDifference"),o=null;null!=n&&(o=SI(n,"weights","absoluteDifference")),rS(a.shape,i.shape,"Error in absoluteDifference: ");var s=a.sub(i).abs();return $M(s,o,r)}}),$M=PI({computeWeightedLoss_:function(e,t,n){void 0===n&&(n=WM.SUM_BY_NONZERO_WEIGHTS);var r=SI(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=SI(t,"weights","computeWeightedLoss"));var i=null==a?r:r.mul(a);if(n===WM.NONE)return i;if(n===WM.SUM)return i.sum();if(n===WM.MEAN){if(null==a)return i.mean();var o=r.size/a.size,s=i.sum().div(a.sum());return o>1?s.div(WI(o)):s}if(n===WM.SUM_BY_NONZERO_WEIGHTS){if(null==a)return i.sum().div(WI(r.size));var u=a.mul(KI(r.shape)).notEqual(WI(0)).sum().toFloat();return i.sum().div(u)}throw Error("Unknown reduction: "+n)}}),QM=PI({cosineDistance_:function(e,t,n,r,a){void 0===a&&(a=WM.SUM_BY_NONZERO_WEIGHTS);var i=SI(e,"labels","cosineDistance"),o=SI(t,"predictions","cosineDistance"),s=null;null!=r&&(s=SI(r,"weights","cosineDistance")),rS(i.shape,o.shape,"Error in cosineDistance: ");var u=WI(1).sub(i.mul(o).sum(n,!0));return $M(u,s,a)}}),YM=PI({hingeLoss_:function(e,t,n,r){void 0===r&&(r=WM.SUM_BY_NONZERO_WEIGHTS);var a=SI(e,"labels","hingeLoss"),i=SI(t,"predictions","hingeLoss"),o=null;null!=n&&(o=SI(n,"weights","hingeLoss")),rS(a.shape,i.shape,"Error in hingeLoss: ");var s=WI(1);a=WI(2).mul(a).sub(s);var u=s.sub(a.mul(i)).relu();return $M(u,o,r)}}),JM=PI({huberLoss_:function(e,t,n,r,a){void 0===r&&(r=1),void 0===a&&(a=WM.SUM_BY_NONZERO_WEIGHTS);var i=SI(e,"labels","huberLoss"),o=SI(t,"predictions","huberLoss"),s=null;null!=n&&(s=SI(n,"weights","huberLoss")),rS(i.shape,o.shape,"Error in huberLoss: ");var u=WI(r),c=o.sub(i).abs(),l=xN(c,u),f=c.sub(l),h=WI(.5).mul(l.square()).add(u.mul(f));return $M(h,s,a)}}),ZM=PI({logLoss_:function(e,t,n,r,a){void 0===r&&(r=1e-7),void 0===a&&(a=WM.SUM_BY_NONZERO_WEIGHTS);var i=SI(e,"labels","logLoss"),o=SI(t,"predictions","logLoss"),s=null;null!=n&&(s=SI(n,"weights","logLoss")),rS(i.shape,o.shape,"Error in logLoss: ");var u=WI(1),c=WI(r),l=i.mul(o.add(c).log()).neg().sub(u.sub(i).mul(u.sub(o).add(c).log()));return $M(l,s,a)}}),eF=PI({meanSquaredError_:function(e,t,n,r){void 0===r&&(r=WM.SUM_BY_NONZERO_WEIGHTS);var a=SI(e,"labels","meanSquaredError"),i=SI(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=SI(n,"weights","meanSquaredError")),rS(a.shape,i.shape,"Error in meanSquaredError: ");var s=a.squaredDifference(i);return $M(s,o,r)}}),tF=PI({sigmoidCrossEntropy_:function(e,t,n,r,a){void 0===r&&(r=0),void 0===a&&(a=WM.SUM_BY_NONZERO_WEIGHTS);var i=SI(e,"multiClassLabels","sigmoidCrossEntropy"),o=SI(t,"logits","sigmoidCrossEntropy"),s=null;if(null!=n&&(s=SI(n,"weights","sigmoidCrossEntropy")),rS(i.shape,o.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=WI(r),c=WI(1),l=WI(.5);i=i.mul(c.sub(u)).add(l.mul(u))}var f=function(e,t){var n=SI(e,"labels","sigmoidCrossEntropyWithLogits"),r=SI(t,"logits","sigmoidCrossEntropyWithLogits");rS(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var a=r.relu(),i=r.mul(n),o=r.abs().neg().exp().log1p();return a.sub(i).add(o)}(i,o);return $M(f,s,a)}}),nF=PI({softmaxCrossEntropy_:function(e,t,n,r,a){void 0===r&&(r=0),void 0===a&&(a=WM.SUM_BY_NONZERO_WEIGHTS);var i=SI(e,"onehotLabels","softmaxCrossEntropy"),o=SI(t,"logits","softmaxCrossEntropy"),s=null;if(null!=n&&(s=SI(n,"weights","softmaxCrossEntropy")),rS(i.shape,o.shape,"Error in softmaxCrossEntropy: "),r>0){var u=WI(r),c=WI(1),l=WI(i.shape[1]);i=i.mul(c.sub(u)).add(u.div(l))}var f=function(e,t,n){if(void 0===n&&(n=-1),-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank "+t.rank+" and dim was "+n);return GN((function(e,t,r){var a=t.logSumExp([n],!0),i=t.toFloat().sub(a);return r([e,i]),{value:i.mul(e).neg().sum([n]),gradFunc:function(e,t){var r=t[0],a=t[1],i=_I(e.shape,[n]);return[e.reshape(i).mul(r.toFloat().sub(a.exp())),e.reshape(i).mul(a.exp().sub(r.toFloat()))]}}}))(e,t)}(i,o);return $M(f,s,a)}}),rF=Object.freeze({get Reduction(){return WM},absoluteDifference:XM,computeWeightedLoss:$M,cosineDistance:QM,hingeLoss:YM,huberLoss:JM,logLoss:ZM,meanSquaredError:eF,sigmoidCrossEntropy:tF,softmaxCrossEntropy:nF});function aF(e,t){return void 0===t&&(t=!1),pC.tidy((function(){if(2!==e.shape.length)throw new Error("qr2d() requires a 2D Tensor, but got a "+e.shape.length+"D Tensor.");for(var n=e.shape[0],r=e.shape[1],a=WD(n),i=e.clone(),o=GI([[1]],[1,1]),s=o.clone(),u=n>=r?r:n,c=function(e){var t,u=i,c=s,l=a;t=pC.tidy((function(){var t=i.slice([e,e],[n-e,1]),u=t.norm(),c=i.slice([e,e],[1,1]),l=GI([[-1]]).where(c.greater(0),GI([[1]])),f=c.sub(l.mul(u)),h=t.div(f);s=1===h.shape[0]?o.clone():o.concat(h.slice([1,0],[h.shape[0]-1,h.shape[1]]),0);var p=l.matMul(f).div(u).neg(),d=i.slice([e,0],[n-e,r]),v=p.mul(s),m=s.transpose();if(0===e)i=d.sub(v.matMul(m.matMul(d)));else{var y=d.sub(v.matMul(m.matMul(d)));i=i.slice([0,0],[e,r]).concat(y,0)}var g=v.transpose(),b=a.slice([0,e],[n,a.shape[1]-e]);if(0===e)a=b.sub(b.matMul(s).matMul(g));else{var x=b.sub(b.matMul(s).matMul(g));a=a.slice([0,0],[n,e]).concat(x,1)}return[s,i,a]})),s=t[0],i=t[1],a=t[2],xI([u,c,l])},l=0;l<u;++l)c(l);return!t&&n>r&&(a=a.slice([0,0],[n,r]),i=i.slice([0,0],[r,r])),[a,i]}))}var iF=PI({bandPart_:function(e,t,n){if(t%1!=0)throw new Error("bandPart(): numLower must be an integer, got "+t+".");if(n%1!=0)throw new Error("bandPart(): numUpper must be an integer, got "+n+".");var r=SI(e,"a","bandPart");if(r.rank<2)throw new Error("bandPart(): Rank must be at least 2, got "+r.rank+".");var a=r.shape,i=r.shape.slice(-2),o=i[0],s=i[1];if(!(t<=o))throw new Error("bandPart(): numLower ("+t+") must not be greater than the number of rows ("+o+").");if(!(n<=s))throw new Error("bandPart(): numUpper ("+n+") must not be greater than the number of columns ("+s+").");t<0&&(t=o),n<0&&(n=s);var u=YI(0,o,1,"int32").reshape([-1,1]),c=YI(0,s,1,"int32"),l=_N(u,c),f=MD(l.lessEqual(WI(+t,"int32")),l.greaterEqual(WI(-n,"int32"))),h=XI([o,s],r.dtype);return vT(mT(r.reshape([-1,o,s])).map((function(e){return BD(f,e,h)}))).reshape(a)}}),oF=PI({gramSchmidt_:function(e){var t;if(Array.isArray(e)){t=!1,nS(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){nS(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: ("+e[t].shape[0]+" vs. "+n+")"}))},a=1;a<e.length;++a)r(a)}else t=!0,e=iT(e,e.shape[0],0).map((function(e){return dT(e,[0])}));nS(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors ("+e.length+") exceeds number of dimensions ("+e[0].shape[0]+")."}));var i=[],o=e,s=function(e){i.push(pC.tidy((function(){var t=o[e];if(e>0)for(var n=0;n<e;++n){var r=mM(i[n].mulStrict(t)).mul(i[n]);t=t.sub(r)}return t.div(CM(t,"euclidean"))})))};for(a=0;a<e.length;++a)s(a);return t?vT(i,0):i}}),sF=PI({qr_:function(e,t){if(void 0===t&&(t=!1),e.rank<2)throw new Error("qr() requires input tensor to have a rank >= 2, but got rank "+e.rank);if(2===e.rank)return aF(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=mT(e.reshape([n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];return r.forEach((function(e){var n=aF(e,t),r=n[0],o=n[1];a.push(r),i.push(o)})),[vT(a,0).reshape(e.shape),vT(i,0).reshape(e.shape)]}}),uF=Object.freeze({bandPart:iF,gramSchmidt:oF,qr:sF});function cF(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),nS(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '"+r+"'"})),nS(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '"+e.rank+"'"})),nS(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was "+e.shape[1]})),nS(1===t.rank,(function(){return"scores must be a 1D tensor"})),nS(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected "+o+", but was "+t.shape[0]})),nS(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '"+i+"'"})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var lF=PI({resizeBilinear_:function(e,t,n){void 0===n&&(n=!1);var r=SI(e,"images","resizeBilinear");nS(3===r.rank||4===r.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got rank "+r.rank+"."})),nS(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+t+"."}));var a=r,i=!1;3===r.rank&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=pC.runKernelFunc((function(e,t){return t([a]),e.resizeBilinear(a,o,s,n)}),{x:a},(function(e,t){return{x:function(){return pC.runKernelFunc((function(r){return r.resizeBilinearBackprop(e,t[0],n)}),{})}}}),"ResizeBilinear",{alignCorners:n,newHeight:o,newWidth:s});return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),fF=PI({resizeNearestNeighbor_:function(e,t,n){void 0===n&&(n=!1);var r=SI(e,"images","resizeNearestNeighbor");nS(3===r.rank||4===r.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank "+r.rank+"."})),nS(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+t+"."})),nS("float32"===r.dtype||"int32"===r.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"}));var a=r,i=!1;3===r.rank&&(i=!0,a=r.as4D(1,r.shape[0],r.shape[1],r.shape[2]));var o=t[0],s=t[1],u=pC.runKernelFunc((function(e,t){return t([a]),e.resizeNearestNeighbor(a,o,s,n)}),{batchImages:a},(function(e,t){return{batchImages:function(){return pC.runKernelFunc((function(r){return r.resizeNearestNeighborBackprop(e,t[0],n)}),{})}}}));return i?u.as3D(u.shape[1],u.shape[2],u.shape[3]):u}}),hF=PI({nonMaxSuppression_:function(e,t,n,r,a){void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY);var i=SI(e,"boxes","nonMaxSuppression"),o=SI(t,"scores","nonMaxSuppression"),s=cF(i,o,n,r,a);n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold;var u={maxOutputSize:n,iouThreshold:r,scoreThreshold:a};return pC.runKernelFunc((function(e){return e.nonMaxSuppression(i,o,n,r,a)}),{boxes:i,scores:o},null,"NonMaxSuppressionV3",u)}}),pF=PI({nonMaxSuppressionWithScore_:function(e,t,n,r,a,i){void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),void 0===i&&(i=0);var o=SI(e,"boxes","nonMaxSuppression"),s=SI(t,"scores","nonMaxSuppression"),u=cF(o,s,n,r,a,i),c={maxOutputSize:n=u.maxOutputSize,iouThreshold:r=u.iouThreshold,scoreThreshold:a=u.scoreThreshold,softNmsSigma:i=u.softNmsSigma},l=pC.runKernel("NonMaxSuppressionV5",{boxes:o,scores:s},c);return{selectedIndices:l[0],selectedScores:l[1]}}}),dF=PI({cropAndResize_:function(e,t,n,r,a,i){var o=SI(e,"image","cropAndResize"),s=SI(t,"boxes","cropAndResize","float32"),u=SI(n,"boxInd","cropAndResize","int32");a=a||"bilinear",i=i||0;var c=s.shape[0];return nS(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,but got rank "+o.rank+"."})),nS(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size ["+c+",4] but had shape "+s.shape+"."})),nS(1===u.rank&&u.shape[0]===c,(function(){return"Error in cropAndResize: boxInd must be have size ["+c+"] but had shape "+s.shape+"."})),nS(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got length "+r.length+"."})),nS(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was "+r})),nS("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was "+a})),pC.runKernelFunc((function(e,t){return e.cropAndResize(o,s,u,r,a,i)}),{images:o,boxes:s,boxInd:u},null,"CropAndResize",{method:a,extrapolationValue:i,cropSize:r})}}),vF=Object.freeze({resizeBilinear:lF,resizeNearestNeighbor:fF,nonMaxSuppression:hF,nonMaxSuppressionAsync:function(e,t,n,r,a){return void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),BE(this,void 0,void 0,(function(){var i,o,s,u,c,l,f;return VE(this,(function(h){switch(h.label){case 0:return i=SI(e,"boxes","nonMaxSuppressionAsync"),o=SI(t,"scores","nonMaxSuppressionAsync"),s=cF(i,o,n,r,a),n=s.maxOutputSize,r=s.iouThreshold,a=s.scoreThreshold,[4,Promise.all([i.data(),o.data()])];case 1:return u=h.sent(),c=u[0],l=u[1],f=g_(c,l,n,r,a),i!==e&&i.dispose(),o!==t&&o.dispose(),[2,f]}}))}))},nonMaxSuppressionWithScore:pF,nonMaxSuppressionWithScoreAsync:function(e,t,n,r,a,i){return void 0===r&&(r=.5),void 0===a&&(a=Number.NEGATIVE_INFINITY),void 0===i&&(i=0),BE(this,void 0,void 0,(function(){var o,s,u,c,l,f,h;return VE(this,(function(p){switch(p.label){case 0:return o=SI(e,"boxes","nonMaxSuppressionAsync"),s=SI(t,"scores","nonMaxSuppressionAsync"),u=cF(o,s,n,r,a,i),n=u.maxOutputSize,r=u.iouThreshold,a=u.scoreThreshold,i=u.softNmsSigma,[4,Promise.all([o.data(),s.data()])];case 1:return c=p.sent(),l=c[0],f=c[1],h=b_(l,f,n,r,a,i),o!==e&&o.dispose(),s!==t&&s.dispose(),[2,h]}}))}))},cropAndResize:dF}),mF=function(e,t){return!(e>0)||"linear"===t},yF=function(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return e.mul(t.step());throw new Error("Gradient for activation "+n+" has not been implemented yet.")},gF=function(e,t){var n=t,r=DT(e.shape,t.shape);return r.length>0&&(n=n.sum(r)),n.reshape(e.shape)},bF=function(e,t,n){if("linear"===t)return e;if("relu"===t)return wM(e);if("elu"===t)return gM(e);if("relu6"===t)return kM(e);if("prelu"===t)return xM(e,n);throw new Error("Unknown fused activation "+t+".")},xF=PI({fusedMatMul_:function(e){var t,n=e.a,r=e.b,a=e.transposeA,i=void 0!==a&&a,o=e.transposeB,s=void 0!==o&&o,u=e.bias,c=e.activation,l=void 0===c?"linear":c,f=e.preluActivationWeights;if(!1===mF(pC.state.gradientDepth,l)){var h=VO(n,r,i,s);return null!=u&&(h=RT(h,u)),bF(h,l,f)}var p=SI(n,"a","fused matMul"),d=SI(r,"b","fused matMul");t=sC(p,d),p=t[0],d=t[1];var v=i?p.shape[p.rank-2]:p.shape[p.rank-1],m=s?d.shape[d.rank-1]:d.shape[d.rank-2],y=i?p.shape[p.rank-1]:p.shape[p.rank-2],g=s?d.shape[d.rank-2]:d.shape[d.rank-1],b=p.shape.slice(0,-2),x=d.shape.slice(0,-2),w=oS(b),k=oS(x);nS(p.rank>=2&&d.rank>=2&&p.rank===d.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at least 2, got ranks "+p.rank+" and "+d.rank+"."})),nS(sS(b,x),(function(){return"Error in fused matMul: outer dimensions ("+b+") and ("+x+") of Tensors with shapes "+p.shape+" and "+d.shape+" must match."})),nS(v===m,(function(){return"Error in fused matMul: inner shapes ("+v+") and ("+m+") of Tensors with shapes "+p.shape+" and "+d.shape+" and transposeA="+i+" and transposeB="+s+" must match."}));var E,S,C=p.shape.slice(0,-2).concat([y,g]),I=i?p.as3D(w,v,y):p.as3D(w,y,v),T=s?d.as3D(k,g,m):d.as3D(k,m,g);null!=u&&OT(C,(E=sC(E=SI(u,"bias","fused matMul"),p)[0]).shape),null!=f&&(S=SI(f,"prelu weights","fused matMul"));var N={a:I,b:T};null!=u&&(N.bias=E),null!=f&&(N.preluActivationWeights=S);var _=[I,T];return pC.runKernelFunc((function(e,t){var n=e.fusedBatchMatMul({a:I,b:T,transposeA:i,transposeB:s,bias:E,activation:l,preluActivationWeights:S});return t([I,T,n]),n}),N,(function(e,t){var n=t[0],r=t[1],a=t[2],o=yF(e,a,l),c={};return null!=u&&(c={bias:function(){return gF(E,o)}}),i||s?!i&&s?Object.assign({a:function(){return o.matMul(r,!1,!1)},b:function(){return o.matMul(n,!0,!1)}},c):i&&!s?Object.assign({a:function(){return r.matMul(o,!1,!0)},b:function(){return n.matMul(o,!1,!1)}},c):Object.assign({a:function(){return r.matMul(o,!0,!0)},b:function(){return o.matMul(n,!0,!0)}},c):Object.assign({a:function(){return o.matMul(r,!1,!0)},b:function(){return n.matMul(o,!0,!1)}},c)}),"_FusedMatMul",{transposeA:i,transposeB:s,activation:l},_,[!0]).reshape(C)}}),wF=PI({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,f=e.activation,h=void 0===f?"linear":f,p=e.preluActivationWeights;if(h=h||"linear",!1===mF(pC.state.gradientDepth,h)){var d=_O(t,n,r,a,o,u,c);return null!=l&&(d=RT(d,l)),bF(d,h,p)}var v=SI(t,"x","conv2d"),m=SI(n,"filter","conv2d"),y=v,g=!1;3===v.rank&&(g=!0,y=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),nS(4===y.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+y.rank+"."})),nS(4===m.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+m.rank+"."})),null!=c&&nS(uS(a),(function(){return"Error in fused conv2d: pad must be an integer when using, dimRoundingMode "+c+" but got pad "+a+"."})),nS(y.shape[3]===m.shape[2],(function(){return"Error in conv2d: depth of input ("+y.shape[3]+") must match input depth for filter "+m.shape[2]+"."})),nS(s_(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),nS("NHWC"===o,(function(){return"Error in conv2d: got dataFormat of "+o+" but only NHWC is currently supported."}));var b,x,w=ZN(y.shape,m.shape,r,u,a,c);null!=l&&(b=sC(b=SI(l,"bias","fused conv2d"),v)[0],OT(w.outShape,b.shape)),null!=p&&(x=SI(p,"prelu weights","fused conv2d"));var k={x:y,filter:m};null!=l&&(k.bias=b),null!=p&&(k.preluActivationWeights=x);var E=[m,y],S=pC.runKernelFunc((function(e,t){var n=e.fusedConv2d({input:y,filter:m,convInfo:w,bias:b,activation:h,preluActivationWeights:x});return t([m,y,n]),n}),k,(function(e,t){var n=t,i=n[0],o=n[1],s=n[2],c=yF(e,s,h);nS(o_(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '"+u+"'"}));var f={};return null!=l&&(f={bias:function(){return gF(b,c)}}),Object.assign({x:function(){return DO(o.shape,c,i,r,a)},filter:function(){return AO(o,c,i.shape,r,a)}},f)}),"FusedConv2D",{convInfo:w,activation:h},E,[!0]);return g?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),kF=PI({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,a=e.pad,i=e.dataFormat,o=void 0===i?"NHWC":i,s=e.dilations,u=void 0===s?[1,1]:s,c=e.dimRoundingMode,l=e.bias,f=e.activation,h=void 0===f?"linear":f,p=e.preluActivationWeights;if(!1===mF(pC.state.gradientDepth,h)){var d=OO(t,n,r,a,o,u,c);return null!=l&&(d=RT(d,l)),bF(d,h,p)}var v=SI(t,"x","depthwiseConv2d"),m=SI(n,"filter","depthwiseConv2d"),y=v,g=!1;3===v.rank&&(g=!0,y=v.as4D(1,v.shape[0],v.shape[1],v.shape[2])),nS(4===y.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got rank "+y.rank+"."})),nS(4===m.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, but got rank "+m.rank+"."})),nS(y.shape[3]===m.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels ("+y.shape[3]+") must match the inChannels dimension in filter "+m.shape[2]+"."})),null==u&&(u=[1,1]),nS(s_(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides "+r+" and dilations '"+u+"'"})),null!=c&&nS(uS(a),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when using dimRoundingMode "+c+" but got pad "+a+"."}));var b,x,w=ZN(y.shape,m.shape,r,u,a,c,!0);null!=l&&(b=sC(b=SI(l,"bias","fused conv2d"),v)[0],OT(w.outShape,b.shape)),null!=p&&(x=SI(p,"prelu weights","fused depthwiseConv2d"));var k={x:y,filter:m};null!=l&&(k.bias=b),null!=p&&(k.preluActivationWeights=x);var E=[m,y],S=pC.runKernelFunc((function(e,t){var n=e.fusedDepthwiseConv2D({input:y,filter:m,convInfo:w,bias:b,activation:h,preluActivationWeights:x});return t([m,y,n]),n}),k,(function(e,t){nS(o_(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '"+u+"'"}));var n=t[0],r=t[1],a=t[2],i=yF(e,a,h),o={};return null!=l&&(o={bias:function(){return gF(b,i)}}),Object.assign({x:function(){return MO(r.shape,i,n,w)},filter:function(){return FO(r,i,n.shape,w)}},o)}),"FusedDepthwiseConv2D",{convInfo:w,activation:h},E,[!0]);return g?S.as3D(S.shape[1],S.shape[2],S.shape[3]):S}}),EF=Object.freeze({matMul:xF,conv2d:wF,depthwiseConv2d:kF}),SF=Object.freeze({image:vF,linalg:uF,losses:rF,spectral:PM,fused:EF,signal:KM,add:RT,addN:mD,batchNorm:kD,batchNormalization:wD,batchNorm2d:CD,batchNormalization2d:SD,batchNorm3d:ND,batchNormalization3d:TD,batchNorm4d:AD,batchNormalization4d:RD,broadcastTo:DD,clone:OD,div:AN,divNoNan:zD,eye:WD,multinomial:jD,oneHot:GD,pad:HD,pad1d:qD,pad2d:KD,pad3d:XD,pad4d:$D,rand:QD,randomGamma:rO,randomNormal:aO,randomUniform:iO,square:oO,squaredDifference:sO,tile:UD,truncatedNormal:uO,conv1d:NO,conv2d:_O,conv3d:RO,depthwiseConv2d:OO,separableConv2d:PO,conv2dTranspose:LO,conv3dTranspose:BO,op:PI,booleanMaskAsync:function(e,t,n){return BE(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,f,h,p,d,v;return VE(this,(function(m){switch(m.label){case 0:for(r=SI(e,"tensor","boolMask"),a=SI(t,"mask","boolMask","bool"),i=null==n?0:n,o=a.rank,s=r.shape,nS(o>0,(function(){return"mask cannot be scalar"})),rS(s.slice(i,i+o),a.shape,"mask's shape must match the first K dimensions of tensor's shape,"),u=1,c=i;c<i+o;c++)u*=s[c];return l=s.slice(0,i).concat([u],s.slice(i+o)),f=r.reshape(l),h=a.reshape([-1]),[4,VD(h)];case 1:return p=m.sent(),d=p.squeeze([1]),v=EO(f,d,i),e!==r&&r.dispose(),t!==a&&a.dispose(),d.dispose(),f.dispose(),h.dispose(),p.dispose(),[2,v]}}))}))},complex:LI,real:BI,imag:VI,concat:eT,concat1d:tT,concat2d:nT,concat3d:rT,concat4d:aT,split:iT,matMul:VO,dot:zO,outerProduct:UO,reverse:WO,reverse1d:jO,reverse2d:GO,reverse3d:HO,reverse4d:qO,maxPool:$O,avgPool:QO,pool:YO,maxPool3d:JO,avgPool3d:ZO,maxPoolWithArgmax:eM,slice:tM,slice1d:nM,slice2d:rM,slice3d:aM,slice4d:iM,abs:MT,acos:FT,acosh:PT,asin:LT,asinh:BT,atan:VT,atanh:zT,ceil:UT,clipByValue:WT,cos:jT,cosh:GT,erf:HT,exp:qT,expm1:KT,floor:XT,log:$T,log1p:QT,logSigmoid:YT,neg:JT,reciprocal:ZT,round:eN,rsqrt:tN,sigmoid:nN,sign:rN,isNaN:aN,isInf:iN,isFinite:oN,sin:sN,sinh:uN,softplus:cN,sqrt:lN,step:fN,tan:hN,tanh:pN,all:sM,any:uM,argMax:cM,argMin:lM,logSumExp:fM,max:hM,mean:pM,min:dM,moments:vM,sum:mM,prod:yM,equal:cO,equalStrict:lO,greater:fO,greaterEqual:hO,greaterEqualStrict:pO,greaterStrict:dO,less:vO,lessEqual:mO,lessEqualStrict:yO,lessStrict:gO,notEqual:bO,notEqualStrict:xO,addStrict:dN,atan2:vN,divStrict:mN,floorDiv:yN,maximum:gN,maximumStrict:bN,minimum:xN,minimumStrict:wN,mod:kN,modStrict:EN,mul:SN,mulStrict:CN,pow:IN,powStrict:TN,squaredDifferenceStrict:NN,sub:_N,subStrict:RN,elu:gM,leakyRelu:bM,prelu:xM,relu:wM,relu6:kM,selu:EM,logicalAnd:MD,logicalNot:FD,logicalOr:PD,logicalXor:LD,where:BD,whereAsync:VD,buffer:oT,print:function(e,t){void 0===t&&(t=!1),console.log(e.toString(t))},batchToSpaceND:sT,cast:uT,cumsum:cT,depthToSpace:lT,expandDims:fT,reshape:hT,spaceToBatchND:pT,squeeze:dT,stack:vT,unstack:mT,setdiff1dAsync:yT,fill:$I,linspace:QI,ones:KI,range:YI,scalar:WI,tensor:zI,tensor1d:jI,tensor2d:GI,tensor3d:HI,tensor4d:qI,tensor5d:function(e,t,n){if(aS(e),null!=t&&5!==t.length)throw new Error("tensor5d() requires shape to have five numbers");var r=kI(e,n);if(5!==r.length&&1!==r.length)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return UI(e,t,r,n)},tensor6d:function(e,t,n){if(aS(e),null!=t&&6!==t.length)throw new Error("tensor6d() requires shape to have six numbers");var r=kI(e,n);if(6!==r.length&&1!==r.length)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return UI(e,t=t||r,r,n)},variable:function(e,t,n,r){return void 0===t&&(t=!0),pC.makeVariable(e,t,n,r)},zeros:XI,onesLike:JI,zerosLike:ZI,transpose:KN,softmax:HN,logSoftmax:qN,localResponseNormalization:SM,norm:CM,gather:EO,unsortedSegmentSum:SO,basicLSTMCell:IM,multiRNNCell:TM,movingAverage:NM,stridedSlice:_M,topk:RM,scatterND:AM,fft:DM,ifft:OM,rfft:MM,irfft:FM,sparseToDense:LM,gatherND:BM,diag:VM,dropout:zM,hannWindow:jM,hammingWindow:GM,frame:HM,stft:qM,inTopKAsync:function(e,t,n){return void 0===n&&(n=1),BE(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,f,h,p,d,v,m;return VE(this,(function(y){switch(y.label){case 0:return r=SI(e,"predictions","inTopK"),a=SI(t,"targets","inTopK"),nS(r.rank>1,(function(){return"inTopK() expects the predictions to be of rank 2 or higher, but got "+r.rank})),nS(r.rank-1===a.rank,(function(){return"predictions rank should be 1 larger than targets rank, but got predictions rank "+r.rank+" and targets rank "+a.rank})),rS(r.shape.slice(0,r.shape.length-1),a.shape,"predictions's shape should be align with the targets' shape, except the last dimension."),i=r.shape[r.shape.length-1],nS(n>0&&n<=i,(function(){return"'k' passed to inTopK() must be > 0 && <= the predictions last dimension ("+i+"), but got "+n})),[4,r.data()];case 1:return o=y.sent(),[4,a.data()];case 2:for(s=y.sent(),u=[o.length/i,i],l=u[1],f=mS("bool",c=u[0]),h=0;h<c;h++){for(p=h*l,d=o.subarray(p,p+l),v=[],m=0;m<d.length;m++)v.push({value:d[m],index:m});for(v.sort((function(e,t){return t.value-e.value})),f[h]=0,m=0;m<n;m++)if(v[m].index===s[h]){f[h]=1;break}}return e!==r&&r.dispose(),t!==a&&a.dispose(),[2,zI(f,a.shape,"bool")]}}))}))}});function CF(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&nS("complex64"!==e.dtype,(function(){return t+" does not support complex64 tensors."}))}))}function IF(e,t,n,r,a,i){for(var o=a.strideHeight,s=a.strideWidth,u=a.dilationHeight,c=a.dilationWidth,l=a.effectiveFilterHeight,f=a.effectiveFilterWidth,h=a.padInfo.top,p=a.padInfo.left,d="max"===i?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=oT(a.outShape,n),m=v.values,y=a.outShape[1]*a.outShape[2]*a.outShape[3],g=a.outShape[2]*a.outShape[3],b=a.outShape[3],x=0;x<a.batchSize;++x)for(var w=x*y,k=x*r[0],E=0;E<a.inChannels;++E)for(var S=0;S<a.outHeight;++S)for(var C=S*o-h,I=Math.max(0,C),T=Math.min(a.inHeight,l+C),N=w+S*g,_=0;_<a.outWidth;++_){for(var R=_*s-p,A=Math.max(0,R),D=Math.min(a.inWidth,f+R),O=d,M=0,F=0,P=I;P<T;P+=u){for(var L=k+P*r[1],B=A;B<D;B+=c){var V=e[L+B*r[2]+E];"max"===i&&V>O?O=V:"avg"===i&&(M+=V,F++)}if(isNaN(O))break}m[N+_*b+E]="avg"===i?M/F:O}return v}function TF(e,t,n,r,a,i){void 0===a&&(a=!1),void 0===i&&(i=!1);for(var o=oT(r.outShape,"int32"),s=r.strideHeight,u=r.strideWidth,c=r.dilationHeight,l=r.dilationWidth,f=r.effectiveFilterHeight,h=r.effectiveFilterWidth,p=r.padInfo.top,d=r.padInfo.left,v=oT(t,n,e),m=0;m<r.batchSize;++m)for(var y=0;y<r.inChannels;++y)for(var g=0;g<r.outHeight;++g){for(var b=g*s-p,x=b;x<0;)x+=c;for(var w=Math.min(r.inHeight,f+b),k=0;k<r.outWidth;++k){for(var E=k*u-d,S=E;S<0;)S+=l;for(var C=Math.min(r.inWidth,h+E),I=Number.NEGATIVE_INFINITY,T=-1,N=x;N<w;N+=c)for(var _=N-b,R=S;R<C;R+=l){var A=R-E,D=v.get(m,N,R,y);D>I&&(I=D,T=a?i?((m*r.inHeight+N)*r.inWidth+R)*r.inChannels+y:(N*r.inWidth+R)*r.inChannels+y:_*h+A)}o.set(T,m,g,k,y)}}return o}function NF(e,t,n,r){if("linear"===n)return e.linear(t);if("relu"===n)return e.relu(t);if("elu"===n)return e.elu(t);if("relu6"===n)return e.relu6(t);if("prelu"===n)return e.prelu(t,r);throw new Error("Activation "+n+" has not been implemented for the CPU backend.")}var _F=function(e){function t(){var t=e.call(this)||this;return t.blockSize=48,t.firstUse=!0,t.data=new XN(t,pC),t}return LE(t,e),t.prototype.write=function(e,t,n){this.firstUse&&(this.firstUse=!1,WE().get("IS_NODE")&&wI("\n============================\nHi there \ud83d\udc4b. Looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, which binds to TensorFlow C++, by running npm i @tensorflow/tfjs-node, or npm i @tensorflow/tfjs-node-gpu if you have CUDA. Then call require('@tensorflow/tfjs-node'); (-gpu suffix for CUDA) at the start of your program. Visit https://github.com/tensorflow/tfjs-node for more details.\n============================"));var r={};return this.data.set(r,{values:e,dtype:n}),r},t.prototype.move=function(e,t,n,r){this.data.set(e,{values:t,dtype:r})},t.prototype.numDataIds=function(){return this.data.numDataIds()},t.prototype.read=function(e){return BE(this,void 0,void 0,(function(){return VE(this,(function(t){return[2,this.readSync(e)]}))}))},t.prototype.readSync=function(e){var t=this.data.get(e),n=t.dtype,r=t.complexTensors;return"complex64"===n?h_(this.readSync(r.real.dataId),this.readSync(r.imag.dataId)):this.data.get(e).values},t.prototype.bufferSync=function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return BS(e)}))}catch(e){throw new Error("Failed to decode encoded string bytes into utf-8")}return oT(e.shape,e.dtype,n)},t.prototype.makeOutput=function(e,t,n){var r=this.write(e,t,n);return pC.makeTensorFromDataId(r,t,n,this)},t.prototype.disposeData=function(e){if(this.data.has(e)){var t=this.data.get(e).complexTensors;null!=t&&(t.real.dispose(),t.imag.dispose()),this.data.delete(e)}},t.prototype.time=function(e){return BE(this,void 0,void 0,(function(){var t;return VE(this,(function(n){return t=FS(),e(),[2,{kernelMs:FS()-t}]}))}))},t.prototype.memory=function(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}},t.prototype.complex=function(e,t){var n=this.makeOutput(null,e.shape,"complex64");return this.data.get(n.dataId).complexTensors={real:pC.keep(e.clone()),imag:pC.keep(t.clone())},n},t.prototype.real=function(e){return this.data.get(e.dataId).complexTensors.real.clone()},t.prototype.imag=function(e){return this.data.get(e.dataId).complexTensors.imag.clone()},t.prototype.slice=function(e,t,n){if(CF(e,"slice"),WN(e.shape,t,n)){var r=jN(t,e.strides),a=oS(n);return zI(this.readSync(e.dataId).subarray(r,r+a),n,e.dtype)}for(var i=oT(n,e.dtype),o=this.bufferSync(e),s=0;s<i.size;++s){var u=i.indexToLoc(s).map((function(e,n){return e+t[n]}));i.values[s]=o.get.apply(o,u)}return i.toTensor()},t.prototype.stridedSlice=function(e,t,n,r){CF(e,"stridedSlice");var a=VN(t,n,r);if(a.some((function(e){return 0===e})))return zI([],a);for(var i=oT(a,e.dtype),o=this.bufferSync(e),s=0;s<i.size;s++){for(var u=i.indexToLoc(s),c=new Array(u.length),l=0;l<c.length;l++)c[l]=u[l]*r[l]+t[l];i.set.apply(i,[o.get.apply(o,c)].concat(u))}return i.toTensor()},t.prototype.diag=function(e){for(var t=this.readSync(e.dataId),n=oT([e.size,e.size],e.dtype),r=n.values,a=0;a<t.length;a++)r[a*e.size+a]=t[a];return n.toTensor()},t.prototype.unstack=function(e,t){for(var n=e.shape[t],r=new Array(e.rank-1),a=0,i=0;i<e.rank;i++)i!==t&&(r[a++]=e.shape[i]);var o=new Array(e.rank).fill(0),s=e.shape.slice();s[t]=1;var u=new Array(n);for(i=0;i<u.length;i++)o[t]=i,u[i]=this.slice(e,o,s).reshape(r);return u},t.prototype.reverse=function(e,t){CF(e,"reverse");for(var n=oT(e.shape,e.dtype),r=this.bufferSync(e),a=function(a){var i=n.indexToLoc(a),o=i.slice();t.forEach((function(t){return o[t]=e.shape[t]-1-o[t]})),n.set.apply(n,[r.get.apply(r,o)].concat(i))},i=0;i<n.size;i++)a(i);return n.toTensor()},t.prototype.concat=function(e,t){var n=this;if("complex64"===e[0].dtype){var r=e.map((function(e){return BI(e)})),a=e.map((function(e){return VI(e)}));return LI(this.concat(r,t),this.concat(a,t))}var i=e.map((function(e){var n=oS(e.shape.slice(t));return e.as2D(-1,n)})),o=FI(i.map((function(e){return e.shape})),1),s=oT(o,e[0].dtype).values;if(1===i[0].shape[0]){var u=0;i.forEach((function(e){s.set(n.readSync(e.dataId),u),u+=e.size}))}else{var c=0;i.forEach((function(e){for(var t=n.readSync(e.dataId),r=0,a=0;a<e.shape[0];++a)for(var i=a*o[1]+c,u=0;u<e.shape[1];++u)s[i+u]=t[r++];c+=e.shape[1]}))}var l=FI(e.map((function(e){return e.shape})),t);return zI(s,l,e[0].dtype)},t.prototype.neg=function(e){return CF(e,"neg"),this.multiply(WI(-1),e)},t.prototype.add=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e+n,imag:t+r}})):this.broadcastedBinaryOp(e,t,iC(e.dtype,t.dtype),(function(e,t){return e+t}))},t.prototype.addN=function(e){var t=this;CF(e,"addN");for(var n=e.map((function(e){return t.readSync(e.dataId)})),r=oT(e[0].shape,e[0].dtype),a=r.values,i=0;i<e.length;i++)for(var o=n[i],s=0;s<a.length;s++)a[s]+=o[s];return r.toTensor()},t.prototype.softmax=function(e,t){var n=dS([t],e.shape),r=this.max(e,n),a=_I(r.shape,n),i=this.subtract(e,r.reshape(a)),o=this.exp(i),s=this.sum(o,n).reshape(a);return AN(o,s)},t.prototype.subtract=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e-n,imag:t-r}})):this.broadcastedBinaryOp(e,t,iC(e.dtype,t.dtype),(function(e,t){return e-t}))},t.prototype.pow=function(e,t){return CF([e,t],"pow"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.pow(e,t)}))},t.prototype.batchMatMul=function(e,t,n,r){CF([e,t],"matMul");for(var a=n?e.shape[1]:e.shape[2],i=n?e.shape[2]:e.shape[1],o=r?t.shape[1]:t.shape[2],s=e.shape[0],u=this.readSync(e.dataId),c=this.readSync(t.dataId),l=n?[e.strides[0],1,e.strides[1]]:[e.strides[0],e.strides[1],1],f=l[0],h=l[1],p=l[2],d=r?[1,t.strides[1],t.strides[0]]:[t.strides[1],1,t.strides[0]],v=d[0],m=d[1],y=d[2],g=i*o,b=oT([s,i,o],e.dtype),x=b.values,w=this.blockSize,k=0;k<s;k++)for(var E=0;E<i;E+=w)for(var S=0;S<o;S+=w)for(var C=0;C<a;C+=w)for(var I=Math.min(E+w,i),T=Math.min(S+w,o),N=Math.min(C+w,a),_=E;_<I;_++)for(var R=S;R<T;R++){for(var A=0,D=C;D<N;D++)A+=u[k*f+_*h+D*p]*c[D*v+R*m+k*y];x[k*g+(_*o+R)]+=A}return b.toTensor()},t.prototype.fusedBatchMatMul=function(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.bias,o=e.activation,s=e.preluActivationWeights,u=this.batchMatMul(t,n,r,a);return i&&(u=this.add(u,i)),o&&(u=NF(this,u,o,s)),u},t.prototype.multiply=function(e,t){return"complex64"===e.dtype||"complex64"===t.dtype?this.broadcastedBinaryComplexOp(e.cast("complex64"),t.cast("complex64"),(function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}})):this.broadcastedBinaryOp(e,t,iC(e.dtype,t.dtype),(function(e,t){return e*t}))},t.prototype.floorDiv=function(e,t){return CF([e,t],"floorDiv"),this.broadcastedBinaryOp(e,t,"int32",(function(e,t){return Math.floor(e/t)}))},t.prototype.sum=function(e,t){CF(e,"sum"),RI("sum",t,e.rank);for(var n=NI(e.shape,t),r=n[0],a=n[1],i=XI(r,iC(e.dtype,"int32")),o=oS(a),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,f=0,h=0;h<o;++h)f+=u[l+h];s[c]=f}return i},t.prototype.prod=function(e,t){CF(e,"sum");for(var n=NI(e.shape,t),r=n[0],a=n[1],i=XI(r,iC(e.dtype,"int32")),o=oS(a),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,f=1,h=0;h<o;++h)f*=u[l+h];s[c]=f}return i},t.prototype.unsortedSegmentSum=function(e,t,n){CF(e,"unsortedSegmentSum");for(var r=[],a=e.rank-t.rank,i=0;i<a;++i)t=t.expandDims(i+1);for(i=0;i<n;++i){var o=WI(i,"int32"),s=cO(o,t).asType("float32").mul(e).sum(0);r.push(s)}return vT(r)},t.prototype.argMin=function(e,t){CF(e,"argMin");var n=[t];RI("argMin",n,e.rank);for(var r=NI(e.shape,n),a=r[0],i=r[1],o=XI(a,"int32"),s=oS(i),u=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var f=l*s,h=c[f],p=0,d=0;d<s;++d){var v=c[f+d];v<h&&(h=v,p=d)}u[l]=p}return o},t.prototype.argMax=function(e,t){CF(e,"argMax");var n=[t];RI("argMax",n,e.rank);for(var r=NI(e.shape,n),a=r[0],i=r[1],o=XI(a,"int32"),s=oS(i),u=this.readSync(o.dataId),c=this.readSync(e.dataId),l=0;l<u.length;++l){for(var f=l*s,h=c[f],p=0,d=0;d<s;++d){var v=c[f+d];v>h&&(h=v,p=d)}u[l]=p}return o},t.prototype.cumsum=function(e,t,n,r){if(CF(e,"cumsum"),t!==e.rank-1)throw new Error("backend.cumsum in CPU expects an inner-most axis="+(e.rank-1)+" but got axis="+t);for(var a=iC(e.dtype,"int32"),i=XI(e.shape,a),o=this.readSync(i.dataId),s=this.readSync(e.dataId),u=e.shape[e.rank-1],c=r?function(e,t){return e+u-t-1}:function(e,t){return e+t},l=0;l<s.length;l+=u)for(var f=0;f<u;f++){var h=c(l,f);if(0===f)o[h]=n?0:s[h];else{var p=c(l,f-1);o[h]=n?s[p]+o[p]:s[h]+o[p]}}return i},t.prototype.equal=function(e,t){return CF([e,t],"equal"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e===t?1:0}))},t.prototype.notEqual=function(e,t){return CF([e,t],"notEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e!==t?1:0}))},t.prototype.less=function(e,t){return CF([e,t],"less"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<t?1:0}))},t.prototype.lessEqual=function(e,t){return CF([e,t],"lessEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e<=t?1:0}))},t.prototype.greater=function(e,t){return CF([e,t],"greater"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>t?1:0}))},t.prototype.greaterEqual=function(e,t){return CF([e,t],"greaterEqual"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e>=t?1:0}))},t.prototype.logicalNot=function(e){CF(e,"logicalNot");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)n[r]=t[r]?0:1;return this.makeOutput(n,e.shape,"bool")},t.prototype.logicalAnd=function(e,t){return CF([e,t],"logicalAnd"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e&&t}))},t.prototype.logicalOr=function(e,t){return CF([e,t],"logicalOr"),this.broadcastedBinaryOp(e,t,"bool",(function(e,t){return e||t}))},t.prototype.select=function(e,t,n){CF([e,t,n],"select");for(var r=this.readSync(e.dataId),a=this.readSync(t.dataId),i=this.readSync(n.dataId),o=XI(t.shape,iC(t.dtype,n.dtype)),s=this.readSync(o.dataId),u=0,c=0===e.rank||e.rank>1||1===t.rank?1:oS(t.shape.slice(1)),l=0;l<r.length;l++)for(var f=0;f<c;f++)1===r[l]?s[u++]=a[l]:s[u++]=i[l];return o},t.prototype.where=function(e){CF([e],"where");var t=this.readSync(e.dataId);return T_(e.shape,t)},t.prototype.topk=function(e,t,n){return CF(e,"topk"),I_(this.readSync(e.dataId),e.shape,e.dtype,t)},t.prototype.min=function(e,t){CF(e,"min"),RI("min",t,e.rank);for(var n=NI(e.shape,t),r=n[0],a=n[1],i=XI(r,e.dtype),o=oS(a),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,f=u[l],h=0;h<o;++h){var p=u[l+h];p<f&&(f=p)}s[c]=f}return i},t.prototype.minimum=function(e,t){return CF([e,t],"minimum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.min(e,t)}))},t.prototype.mod=function(e,t){return CF([e,t],"mod"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e%t;return e<0&&t<0||e>=0&&t>=0?n:(n+t)%t}))},t.prototype.max=function(e,t){CF(e,"max"),RI("max",t,e.rank);for(var n=NI(e.shape,t),r=n[0],a=n[1],i=XI(r,e.dtype),o=oS(a),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,f=u[l],h=0;h<o;++h){var p=u[l+h];p>f&&(f=p)}s[c]=f}return i},t.prototype.maximum=function(e,t){return CF([e,t],"maximum"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.max(e,t)}))},t.prototype.all=function(e,t){CF(e,"all"),RI("all",t,e.rank);for(var n=NI(e.shape,t),r=n[0],a=n[1],i=XI(r,e.dtype),o=oS(a),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,f=u[l],h=0;h<o;++h){var p=u[l+h];f=f&&p}s[c]=f}return i},t.prototype.any=function(e,t){CF(e,"any"),RI("any",t,e.rank);for(var n=NI(e.shape,t),r=n[0],a=n[1],i=XI(r,e.dtype),o=oS(a),s=this.readSync(i.dataId),u=this.readSync(e.dataId),c=0;c<s.length;++c){for(var l=c*o,f=u[l],h=0;h<o;++h){var p=u[l+h];f=f||p}s[c]=f}return i},t.prototype.squaredDifference=function(e,t){return CF([e,t],"squaredDifference"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){var n=e-t;return n*n}))},t.prototype.ceil=function(e){CF(e,"ceil");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.ceil(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.floor=function(e){CF(e,"floor");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.floor(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.sign=function(e){CF(e,"x");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)t[r]<0?n[r]=-1:t[r]>0?n[r]=1:n[r]=0;return this.makeOutput(n,e.shape,"float32")},t.prototype.isNaN=function(e){CF(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isNaN(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isInf=function(e){CF(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Math.abs(t[r])===1/0&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.isFinite=function(e){CF(e,"x");for(var t=this.readSync(e.dataId),n=new Uint8Array(t.length),r=0;r<t.length;++r)Number.isFinite(t[r])&&(n[r]=1);return this.makeOutput(n,e.shape,"bool")},t.prototype.round=function(e){CF(e,"round");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=Math.floor(t[r]);t[r]-a<.5?n[r]=Math.floor(t[r]):t[r]-a>.5?n[r]=Math.ceil(t[r]):n[r]=a%2==0?a:a+1}return this.makeOutput(n,e.shape,"float32")},t.prototype.exp=function(e){CF(e,"exp");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.exp(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.expm1=function(e){CF(e,"expm1");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.expm1(t[r]);return this.makeOutput(n,e.shape,"float32")},t.prototype.log=function(e){CF(e,"log");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.log(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.log1p=function(e){CF(e,"log1p");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.log1p(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.sqrt=function(e){CF(e,"sqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=Math.sqrt(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.rsqrt=function(e){CF(e,"rsqrt");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r){var a=t[r];n[r]=1/Math.sqrt(a)}return this.makeOutput(n,e.shape,"float32")},t.prototype.reciprocal=function(e){CF(e,"reciprocal");for(var t=this.readSync(e.dataId),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=1/t[r];return this.makeOutput(n,e.shape,"float32")},t.prototype.linear=function(e){return e},t.prototype.relu=function(e){CF(e,"relu");for(var t=XI(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),a=0;a<r.length;++a)n[a]=Math.max(0,r[a]);return t},t.prototype.relu6=function(e){CF(e,"relu");for(var t=XI(e.shape,e.dtype),n=this.readSync(t.dataId),r=this.readSync(e.dataId),a=0;a<r.length;++a)n[a]=Math.min(Math.max(0,r[a]),6);return t},t.prototype.prelu=function(e,t){return CF([e,t],"prelu"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return e<0?t*e:e}))},t.prototype.elu=function(e){CF(e,"elu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var a=n[r];t[r]=a>=0?a:Math.exp(a)-1}return this.makeOutput(t,e.shape,"float32")},t.prototype.eluDer=function(e,t){CF([e,t],"eluDer");for(var n=new Float32Array(t.size),r=this.readSync(t.dataId),a=this.readSync(e.dataId),i=0;i<r.length;++i){var o=r[i];n[i]=o>=1?a[i]:a[i]*(o+1)}return this.makeOutput(n,t.shape,"float32")},t.prototype.selu=function(e){CF(e,"selu");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var a=n[r];t[r]=a>=0?1.0507009873554805*a:1.7580993408473768*(Math.exp(a)-1)}return this.makeOutput(t,e.shape,"float32")},t.prototype.clip=function(e,t,n){CF(e,"clip");for(var r=new Float32Array(e.size),a=this.readSync(e.dataId),i=0;i<a.length;++i){var o=a[i];r[i]=o>n?n:o<t?t:o}return this.makeOutput(r,e.shape,"float32")},t.prototype.abs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.abs(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.complexAbs=function(e){for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<e.size;++r){var a=n[2*r],i=n[2*r+1];t[r]=Math.hypot(a,i)}return this.makeOutput(t,e.shape,"float32")},t.prototype.int=function(e){CF(e,"int");for(var t=new Int32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=n[r];return this.makeOutput(t,e.shape,"int32")},t.prototype.sigmoid=function(e){CF(e,"sigmoid");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=1/(1+Math.exp(-n[r]));return this.makeOutput(t,e.shape,"float32")},t.prototype.softplus=function(e){CF(e,"softplus");for(var t=Math.log(1.1920928955078125e-7)+2,n=new Float32Array(e.size),r=this.readSync(e.dataId),a=0;a<r.length;++a){var i,o=r[a]>-t,s=r[a]<t,u=Math.exp(r[a]);i=s?u:o?r[a]:Math.log(1+u),n[a]=i}return this.makeOutput(n,e.shape,"float32")},t.prototype.sin=function(e){CF(e,"sin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cos=function(e){CF(e,"cos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tan=function(e){CF(e,"tan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.tan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asin=function(e){CF(e,"asin");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asin(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acos=function(e){CF(e,"acos");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acos(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan=function(e){CF(e,"atan");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atan(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atan2=function(e,t){return CF([e,t],"atan2"),this.broadcastedBinaryOp(e,t,e.dtype,(function(e,t){return Math.atan2(e,t)}))},t.prototype.sinh=function(e){CF(e,"sinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.sinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.cosh=function(e){CF(e,"cosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.cosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.tanh=function(e){CF(e,"tanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=cS(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.asinh=function(e){CF(e,"asinh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.asinh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.acosh=function(e){CF(e,"acosh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.acosh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.atanh=function(e){CF(e,"atanh");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r)t[r]=Math.atanh(n[r]);return this.makeOutput(t,e.shape,"float32")},t.prototype.erf=function(e){CF(e,"erf");for(var t=new Float32Array(e.size),n=this.readSync(e.dataId),r=0;r<n.length;++r){var a=Math.sign(n[r]),i=Math.abs(n[r]),o=1/(1+.3275911*i);t[r]=a*(1-((((1.061405429*o-1.453152027)*o+1.421413741)*o-.284496736)*o+.254829592)*o*Math.exp(-i*i))}return this.makeOutput(t,e.shape,"float32")},t.prototype.step=function(e,t){void 0===t&&(t=0),CF(e,"step");for(var n=new Float32Array(e.size),r=this.readSync(e.dataId),a=0;a<r.length;++a){var i=r[a];isNaN(i)?n[a]=NaN:n[a]=i>0?1:t}return this.makeOutput(n,e.shape,"float32")},t.prototype.fusedConv2d=function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights,s=this.conv2d(t,n,r);return a&&(s=this.add(s,a)),i&&(s=NF(this,s,i,o)),s},t.prototype.conv2d=function(e,t,n){CF([e,t],"conv2d");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c="channelsLast"===n.dataFormat,l=oT(n.outShape,e.dtype),f=e.strides[0],h=c?e.strides[1]:e.strides[2],p=c?e.strides[2]:1,d=c?1:e.strides[1],v=l.strides[0],m=c?l.strides[1]:l.strides[2],y=c?l.strides[2]:1,g=c?1:l.strides[1],b=this.readSync(e.dataId),x=this.readSync(t.dataId),w=l.values,k=0;k<n.batchSize;++k)for(var E=k*f,S=k*v,C=0;C<n.outHeight;++C)for(var I=S+C*m,T=C*n.strideHeight-u,N=0;N<r;N++){var _=T+N*i;if(!(_<0||_>=n.inHeight))for(var R=N*t.strides[0],A=E+_*h,D=0;D<n.outWidth;++D)for(var O=I+D*y,M=D*n.strideWidth-s,F=0;F<a;F++){var P=M+F*o;if(!(P<0||P>=n.inWidth))for(var L=A+P*p,B=R+F*t.strides[1],V=0;V<n.inChannels;++V){for(var z=b[L+V*d],U=0;U<n.outChannels;++U)w[O+U*g]+=z*x[B+U];B+=n.outChannels}}}return l.toTensor()},t.prototype.conv3d=function(e,t,n){for(var r=n.filterDepth,a=n.filterHeight,i=n.filterWidth,o=n.dilationDepth,s=n.dilationHeight,u=n.dilationWidth,c=n.padInfo.front,l=n.padInfo.left,f=n.padInfo.top,h=oT(n.outShape,e.dtype),p=this.readSync(e.dataId),d=this.readSync(t.dataId),v=h.values,m=0;m<n.batchSize;++m)for(var y=m*e.strides[0],g=m*h.strides[0],b=0;b<n.outDepth;++b)for(var x=g+b*h.strides[1],w=b*n.strideDepth-c,k=0;k<r;k++){var E=w+k*o;if(!(E<0||E>=n.inDepth))for(var S=k*t.strides[0],C=y+E*e.strides[1],I=0;I<n.outHeight;++I)for(var T=x+I*h.strides[2],N=I*n.strideHeight-f,_=0;_<a;_++){var R=N+_*s;if(!(R<0||R>=n.inHeight))for(var A=S+_*t.strides[1],D=C+R*e.strides[2],O=0;O<n.outWidth;++O)for(var M=T+O*n.outChannels,F=O*n.strideWidth-l,P=0;P<i;P++){var L=F+P*u;if(!(L<0||L>=n.inWidth))for(var B=A+P*t.strides[2],V=D+L*n.inChannels,z=B,U=0;U<n.inChannels;++U){for(var W=p[V+U],j=0;j<n.outChannels;++j)v[M+j]+=W*d[z+j];z+=n.outChannels}}}}return h.toTensor()},t.prototype.conv2dDerInput=function(e,t,n){CF([e,t],"conv2dDerInput");for(var r=oT(n.inShape,"float32"),a=r.values,i=this.readSync(e.dataId),o=this.readSync(t.dataId),s=t.strides,u=s[0],c=s[1],l=s[2],f=n.batchSize,h=n.filterHeight,p=n.filterWidth,d=n.inChannels,v=n.inHeight,m=n.inWidth,y=n.outChannels,g=n.outHeight,b=n.outWidth,x=n.strideHeight,w=n.strideWidth,k=n.dataFormat,E=h-1-n.padInfo.top,S=p-1-n.padInfo.left,C="channelsLast"===k,I=r.strides[0],T=C?r.strides[1]:r.strides[2],N=C?r.strides[2]:1,_=C?1:r.strides[1],R=e.strides[0],A=C?e.strides[1]:e.strides[2],D=C?e.strides[2]:1,O=C?1:e.strides[1],M=0;M<f;++M)for(var F=0;F<d;++F)for(var P=0;P<v;++P)for(var L=P-E,B=Math.max(0,Math.ceil(L/x)),V=Math.min(g,(h+L)/x),z=0;z<m;++z){for(var U=z-S,W=Math.max(0,Math.ceil(U/w)),j=Math.min(b,(p+U)/w),G=0,H=B;H<V;++H)for(var q=H*x-L,K=W;K<j;++K)for(var X=R*M+A*H+D*K,$=u*(h-1-q)+c*(p-1-(K*w-U))+l*F,Q=0;Q<y;++Q)G+=i[X+O*Q]*o[$+Q];a[I*M+T*P+N*z+_*F]=G}return r.toTensor()},t.prototype.conv3dDerInput=function(e,t,n){for(var r=oT(n.inShape,"float32"),a=r.values,i=r.strides,o=i[0],s=i[1],u=i[2],c=i[3],l=this.readSync(e.dataId),f=e.strides,h=f[0],p=f[1],d=f[2],v=f[3],m=this.readSync(t.dataId),y=t.strides,g=y[0],b=y[1],x=y[2],w=y[3],k=n.batchSize,E=n.filterDepth,S=n.filterHeight,C=n.filterWidth,I=n.inChannels,T=n.inDepth,N=n.inHeight,_=n.inWidth,R=n.outChannels,A=n.outDepth,D=n.outHeight,O=n.outWidth,M=n.strideDepth,F=n.strideHeight,P=n.strideWidth,L=E-1-n.padInfo.front,B=S-1-n.padInfo.top,V=C-1-n.padInfo.left,z=0;z<k;++z)for(var U=0;U<I;++U)for(var W=0;W<T;++W)for(var j=W-L,G=Math.max(0,Math.ceil(j/M)),H=Math.min(A,(E+j)/M),q=0;q<N;++q)for(var K=q-B,X=Math.max(0,Math.ceil(K/F)),$=Math.min(D,(S+K)/F),Q=0;Q<_;++Q){for(var Y=Q-V,J=Math.max(0,Math.ceil(Y/P)),Z=Math.min(O,(C+Y)/P),ee=0,te=G;te<H;++te)for(var ne=te*M-j,re=X;re<$;++re)for(var ae=re*F-K,ie=J;ie<Z;++ie)for(var oe=h*z+p*te+d*re+v*ie,se=g*(E-1-ne)+b*(S-1-ae)+x*(C-1-(ie*P-Y))+w*U,ue=0;ue<R;++ue)ee+=l[oe+ue]*m[se+ue];a[o*z+s*W+u*q+c*Q+U]=ee}return r.toTensor()},t.prototype.conv2dDerFilter=function(e,t,n){CF([e,t],"conv2dDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s="channelsLast"===n.dataFormat,u=oT(n.filterShape,"float32"),c=n.padInfo.left,l=n.padInfo.top,f=this.bufferSync(e),h=this.bufferSync(t),p=0;p<i;++p)for(var d=Math.max(0,Math.ceil((l-p)/r)),v=Math.min(n.outHeight,(n.inHeight+l-p)/r),m=0;m<o;++m)for(var y=Math.max(0,Math.ceil((c-m)/a)),g=Math.min(n.outWidth,(n.inWidth+c-m)/a),b=0;b<n.inChannels;++b)for(var x=0;x<n.outChannels;++x){for(var w=0,k=0;k<n.batchSize;++k)for(var E=d;E<v;++E)for(var S=p+E*r-l,C=y;C<g;++C){var I=m+C*a-c;w+=s?f.get(k,S,I,b)*h.get(k,E,C,x):f.get(k,b,S,I)*h.get(k,x,E,C)}u.set(w,p,m,b,x)}return u.toTensor()},t.prototype.conv3dDerFilter=function(e,t,n){for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=oT(n.filterShape,"float32"),l=c.values,f=c.strides,h=f[0],p=f[1],d=f[2],v=f[3],m=this.readSync(t.dataId),y=t.strides,g=y[0],b=y[1],x=y[2],w=y[3],k=this.readSync(e.dataId),E=e.strides,S=E[0],C=E[1],I=E[2],T=E[3],N=n.padInfo.front,_=n.padInfo.left,R=n.padInfo.top,A=0;A<o;++A)for(var D=Math.max(0,Math.ceil((N-A)/r)),O=Math.min(n.outDepth,(n.inDepth+N-A)/r),M=A*h,F=0;F<s;++F)for(var P=Math.max(0,Math.ceil((R-F)/a)),L=Math.min(n.outHeight,(n.inHeight+R-F)/a),B=F*p+M,V=0;V<u;++V)for(var z=Math.max(0,Math.ceil((_-V)/i)),U=Math.min(n.outWidth,(n.inWidth+_-V)/i),W=V*d+B,j=0;j<n.inChannels;++j)for(var G=j*v+W,H=0;H<n.outChannels;++H){for(var q=0,K=0;K<n.batchSize;++K)for(var X=K*S,$=K*g,Q=D;Q<O;++Q)for(var Y=(A+Q*r-N)*C+X,J=Q*b+$,Z=P;Z<L;++Z)for(var ee=(F+Z*a-R)*I+Y,te=Z*x+J,ne=z;ne<U;++ne){var re=ne*w+te;q+=k[(V+ne*i-_)*T+ee+j]*m[re+H]}l[G+H]=q}return c.toTensor()},t.prototype.fusedDepthwiseConv2D=function(e){var t=e.input,n=e.filter,r=e.convInfo,a=e.bias,i=e.activation,o=e.preluActivationWeights,s=this.depthwiseConv2D(t,n,r);return a&&(s=this.add(s,a)),i&&(s=NF(this,s,i,o)),s},t.prototype.depthwiseConv2D=function(e,t,n){CF([e,t],"depthwiseConv2D");for(var r=n.filterHeight,a=n.filterWidth,i=n.dilationHeight,o=n.dilationWidth,s=n.padInfo.left,u=n.padInfo.top,c=n.outChannels/n.inChannels,l=oT(n.outShape,e.dtype),f=this.readSync(e.dataId),h=this.readSync(t.dataId),p=l.values,d=0;d<n.batchSize;++d)for(var v=d*e.strides[0],m=d*l.strides[0],y=0;y<n.outHeight;++y)for(var g=m+y*l.strides[1],b=y*n.strideHeight-s,x=0;x<r;++x){var w=b+x*i;if(!(w<0||w>=n.inHeight))for(var k=x*t.strides[0],E=v+w*e.strides[1],S=0;S<n.outWidth;++S)for(var C=g+S*l.strides[2],I=S*n.strideWidth-u,T=0;T<a;++T){var N=I+T*o;if(!(N<0||N>=n.inWidth))for(var _=k+T*t.strides[1],R=E+N*n.inChannels,A=C,D=_,O=0;O<n.inChannels;++O){for(var M=f[R+O],F=0;F<c;++F)p[A+F]+=M*h[D+F];A+=c,D+=c}}}return l.toTensor()},t.prototype.depthwiseConv2DDerInput=function(e,t,n){CF([e,t],"depthwiseConv2DDerInput");for(var r=oT(n.inShape,"float32"),a=r.values,i=r.strides,o=i[0],s=i[1],u=i[2],c=this.readSync(e.dataId),l=e.strides,f=l[0],h=l[1],p=l[2],d=this.readSync(t.dataId),v=t.strides,m=v[0],y=v[1],g=v[2],b=n.batchSize,x=n.filterHeight,w=n.filterWidth,k=n.inChannels,E=n.inHeight,S=n.inWidth,C=n.outChannels,I=n.outHeight,T=n.outWidth,N=n.strideHeight,_=n.strideWidth,R=x-1-n.padInfo.top,A=w-1-n.padInfo.left,D=C/k,O=0;O<b;++O)for(var M=0;M<k;++M)for(var F=0;F<E;++F)for(var P=F-R,L=Math.max(0,Math.ceil(P/N)),B=Math.min(I,(x+P)/N),V=0;V<S;++V){for(var z=V-A,U=Math.max(0,Math.ceil(z/_)),W=Math.min(T,(w+z)/_),j=0,G=L;G<B;++G)for(var H=G*N-P,q=U;q<W;++q)for(var K=f*O+h*G+p*q,X=m*(x-1-H)+y*(w-1-(q*_-z))+g*M,$=0;$<D;++$)j+=c[K+(M*D+$)]*d[X+$];a[o*O+s*F+u*V+M]=j}return r.toTensor()},t.prototype.depthwiseConv2DDerFilter=function(e,t,n){CF([e,t],"depthwiseConv2DDerFilter");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s=oT(n.filterShape,"float32"),u=n.padInfo.left,c=n.padInfo.top,l=n.outChannels/n.inChannels,f=this.bufferSync(e),h=this.bufferSync(t),p=0;p<i;++p)for(var d=Math.max(0,Math.ceil((c-p)/r)),v=Math.min(n.outHeight,(n.inHeight+c-p)/r),m=0;m<o;++m)for(var y=Math.max(0,Math.ceil((u-m)/a)),g=Math.min(n.outWidth,(n.inWidth+u-m)/a),b=0;b<n.outChannels;++b){for(var x=Math.trunc(b/l),w=b%l,k=0,E=0;E<n.batchSize;++E)for(var S=d;S<v;++S)for(var C=p+S*r-c,I=y;I<g;++I){var T=m+I*a-u;k+=f.get(E,C,T,x)*h.get(E,S,I,b)}s.set(k,p,m,x,w)}return s.toTensor()},t.prototype.tile=function(e,t){return CF(e,"tile"),C_(this.bufferSync(e),t)},t.prototype.pad=function(e,t,n){CF(e,"pad");var r=t.map((function(t,n){return t[0]+e.shape[n]+t[1]})),a=t.map((function(e){return e[0]})),i=this.bufferSync(e),o=oT(r,e.dtype);0!==n&&o.values.fill(n);for(var s=0;s<e.size;s++){var u=i.indexToLoc(s),c=u.map((function(e,t){return e+a[t]}));o.set.apply(o,[i.get.apply(i,u)].concat(c))}return o.toTensor()},t.prototype.gather=function(e,t,n){CF([e,t],"gather");var r=e.shape.slice(),a=this.readSync(t.dataId);r[n]=a.length;for(var i=oT(r,e.dtype),o=this.bufferSync(e),s=0;s<i.size;++s){var u=i.indexToLoc(s),c=u.slice();c[n]=a[u[n]];var l=o.locToIndex(c);i.values[s]=o.values[l]}return i.toTensor()},t.prototype.batchToSpaceND=function(e,t,n){CF([e],"batchToSpaceND");var r=t.reduce((function(e,t){return e*t})),a=gT(e.shape,t,r),i=bT(a.length,t.length),o=xT(e.shape,t,r),s=wT(n,t.length),u=kT(o,n,t.length);return KN(e.reshape(a),i).reshape(o).slice(s,u)},t.prototype.spaceToBatchND=function(e,t,n){CF([e],"spaceToBatchND");var r=t.reduce((function(e,t){return e*t})),a=[[0,0]];a.push.apply(a,n);for(var i=1+t.length;i<e.shape.length;++i)a.push([0,0]);var o=e.pad(a),s=gT(o.shape,t,r,!1),u=bT(s.length,t.length,!1),c=xT(o.shape,t,r,!1);return KN(o.reshape(s),u).reshape(c)},t.prototype.maxPool=function(e,t){return CF(e,"maxPool"),IF(this.readSync(e.dataId),e.shape,e.dtype,e.strides,t,"max").toTensor()},t.prototype.maxPoolBackprop=function(e,t,n,r){CF([t,n],"maxPoolBackprop");for(var a=this.readSync(t.dataId),i=oT(r.outShape,t.dtype,TF(a,t.shape,t.dtype,r).values),o=r.strideHeight,s=r.strideWidth,u=r.dilationHeight,c=r.dilationWidth,l=r.effectiveFilterHeight,f=r.effectiveFilterWidth,h=f-1-r.padInfo.left,p=l-1-r.padInfo.top,d=oT(t.shape,"float32"),v=this.bufferSync(e),m=0;m<r.batchSize;++m)for(var y=0;y<r.inChannels;++y)for(var g=0;g<r.inHeight;++g)for(var b=0;b<r.inWidth;++b){for(var x=g-p,w=b-h,k=0,E=0;E<l;E+=u){var S=(x+E)/o;if(!(S<0||S>=r.outHeight||Math.floor(S)!==S))for(var C=0;C<f;C+=c){var I=(w+C)/s;if(!(I<0||I>=r.outWidth||Math.floor(I)!==I)){var T=l*f-1-i.get(m,S,I,y)===E*f+C?1:0;0!==T&&(k+=v.get(m,S,I,y)*T)}}}d.set(k,m,g,b,y)}return d.toTensor()},t.prototype.avgPoolBackprop=function(e,t,n){CF([e,t],"avgPoolBackprop");for(var r=n.strideHeight,a=n.strideWidth,i=n.filterHeight,o=n.filterWidth,s=n.dilationHeight,u=n.dilationWidth,c=n.effectiveFilterHeight,l=n.effectiveFilterWidth,f=l-1-n.padInfo.left,h=c-1-n.padInfo.top,p=oT(t.shape,"float32"),d=1/(i*o),v=this.bufferSync(e),m=0;m<n.batchSize;++m)for(var y=0;y<n.inChannels;++y)for(var g=0;g<n.inHeight;++g)for(var b=0;b<n.inWidth;++b){for(var x=g-h,w=b-f,k=0,E=0;E<c;E+=s){var S=(x+E)/r;if(!(S<0||S>=n.outHeight||Math.floor(S)!==S))for(var C=0;C<l;C+=u){var I=(w+C)/a;I<0||I>=n.outWidth||Math.floor(I)!==I||(k+=v.get(m,S,I,y))}}p.set(k*d,m,g,b,y)}return p.toTensor()},t.prototype.pool3d=function(e,t,n){CF(e,"pool3d");for(var r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=t.padInfo.front,p=t.padInfo.top,d=t.padInfo.left,v="max"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=this.readSync(e.dataId),y=oT(t.outShape,e.dtype),g=y.values,b=t.outShape[1]*t.outShape[2]*t.outShape[3]*t.outShape[4],x=t.outShape[2]*t.outShape[3]*t.outShape[4],w=t.outShape[3]*t.outShape[4],k=t.outShape[4],E=0;E<t.batchSize;++E)for(var S=E*b,C=E*e.strides[0],I=0;I<t.inChannels;++I)for(var T=0;T<t.outDepth;++T){for(var N=T*r-h,_=N;_<0;)_+=o;for(var R=Math.min(t.inDepth,c+N),A=S+T*x,D=0;D<t.outHeight;++D){for(var O=D*a-p,M=O;M<0;)M+=s;for(var F=Math.min(t.inHeight,l+O),P=A+D*w,L=0;L<t.outWidth;++L){for(var B=L*i-d,V=B;V<0;)V+=u;for(var z=Math.min(t.inWidth,f+B),U=P+L*k,W=v,j=0,G=0,H=_;H<R;H+=o){for(var q=C+H*e.strides[1],K=M;K<F;K+=s){for(var X=q+K*e.strides[2],$=V;$<z;$+=u){var Q=m[X+$*e.strides[3]+I];if("max"===n&&Q>W?W=Q:"avg"===n&&(j+=Q,G++),isNaN(W))break}if(isNaN(W))break}if(isNaN(W))break}g[U+I]="avg"===n?j/G:W}}}return y.toTensor()},t.prototype.avgPool3d=function(e,t){return CF(e,"avgPool3d"),this.pool3d(e,t,"avg").toFloat()},t.prototype.avgPool3dBackprop=function(e,t,n){CF([e,t],"avgPool3dBackprop");for(var r=n.strideDepth,a=n.strideHeight,i=n.strideWidth,o=n.filterDepth,s=n.filterHeight,u=n.filterWidth,c=n.dilationDepth,l=n.dilationHeight,f=n.dilationWidth,h=n.effectiveFilterDepth,p=n.effectiveFilterHeight,d=n.effectiveFilterWidth,v=h-1-n.padInfo.front,m=d-1-n.padInfo.left,y=p-1-n.padInfo.top,g=oT(t.shape,"float32"),b=1/(o*s*u),x=this.bufferSync(e),w=0;w<n.batchSize;++w)for(var k=0;k<n.inChannels;++k)for(var E=0;E<n.inDepth;++E)for(var S=0;S<n.inHeight;++S)for(var C=0;C<n.inWidth;++C){for(var I=E-v,T=S-y,N=C-m,_=0,R=0;R<h;R+=c){var A=(I+R)/r;if(!(A<0||A>=n.outDepth||Math.floor(A)!==A))for(var D=0;D<p;D+=l){var O=(T+D)/a;if(!(O<0||O>=n.outHeight||Math.floor(O)!==O))for(var M=0;M<d;M+=f){var F=(N+M)/i;F<0||F>=n.outWidth||Math.floor(F)!==F||(_+=x.get(w,A,O,F,k))}}}g.set(_*b,w,E,S,C,k)}return g.toTensor()},t.prototype.maxPool3d=function(e,t){return CF(e,"maxPool3d"),this.pool3d(e,t,"max").toFloat()},t.prototype.maxPool3dPositions=function(e,t){for(var n=oT(t.outShape,"int32"),r=t.strideDepth,a=t.strideHeight,i=t.strideWidth,o=t.dilationDepth,s=t.dilationHeight,u=t.dilationWidth,c=t.effectiveFilterDepth,l=t.effectiveFilterHeight,f=t.effectiveFilterWidth,h=t.padInfo.front,p=t.padInfo.top,d=t.padInfo.left,v=this.bufferSync(e),m=0;m<t.batchSize;++m)for(var y=0;y<t.inChannels;++y)for(var g=0;g<t.outDepth;++g){for(var b=g*r-h,x=b;x<0;)x+=o;for(var w=Math.min(t.inDepth,c+b),k=0;k<t.outHeight;++k){for(var E=k*a-p,S=E;S<0;)S+=s;for(var C=Math.min(t.inHeight,l+E),I=0;I<t.outWidth;++I){for(var T=I*i-d,N=T;N<0;)N+=u;for(var _=Math.min(t.inWidth,f+T),R=Number.NEGATIVE_INFINITY,A=-1,D=x;D<w;D+=o)for(var O=D-b,M=S;M<C;M+=s)for(var F=M-E,P=N;P<_;P+=u){var L=P-T,B=v.get(m,D,M,P,y);B>=R&&(R=B,A=O*l*f+F*l+L)}n.set(A,m,g,k,I,y)}}}return n.toTensor()},t.prototype.maxPool3dBackprop=function(e,t,n,r){CF([t,n],"maxPool3dBackprop");for(var a=this.maxPool3dPositions(t,r),i=r.strideDepth,o=r.strideHeight,s=r.strideWidth,u=r.dilationDepth,c=r.dilationHeight,l=r.dilationWidth,f=r.effectiveFilterDepth,h=r.effectiveFilterHeight,p=r.effectiveFilterWidth,d=f-1-r.padInfo.front,v=p-1-r.padInfo.left,m=h-1-r.padInfo.top,y=oT(t.shape,"float32"),g=this.bufferSync(a),b=this.bufferSync(e),x=0;x<r.batchSize;++x)for(var w=0;w<r.inChannels;++w)for(var k=0;k<r.inDepth;++k)for(var E=0;E<r.inHeight;++E)for(var S=0;S<r.inWidth;++S){for(var C=k-d,I=E-m,T=S-v,N=0,_=0;_<f;_+=u){var R=(C+_)/i;if(!(R<0||R>=r.outDepth||Math.floor(R)!==R))for(var A=0;A<h;A+=c){var D=(I+A)/o;if(!(D<0||D>=r.outHeight||Math.floor(D)!==D))for(var O=0;O<p;O+=l){var M=(T+O)/s;if(!(M<0||M>=r.outWidth||Math.floor(M)!==M)){var F=f*h*p-1-g.get(x,R,D,M,w)===_*h*p+A*p+O?1:0;0!==F&&(N+=b.get(x,R,D,M,w)*F)}}}}y.set(N,x,k,E,S,w)}return y.toTensor()},t.prototype.cast=function(e,t){return c_(e,t,this)},t.prototype.reshape=function(e,t){return l_(e,t)},t.prototype.avgPool=function(e,t){return CF(e,"avgPool"),CF(e,"maxPool"),IF(this.readSync(e.dataId),e.shape,e.dtype,e.strides,t,"avg").toTensor().toFloat()},t.prototype.resizeBilinear=function(e,t,n,r){CF(e,"resizeBilinear");for(var a=e.shape,i=a[0],o=a[1],s=a[2],u=a[3],c=this.readSync(e.dataId),l=new Float32Array(oS([i,t,n,u])),f=[r&&t>1?o-1:o,r&&n>1?s-1:s],h=[r&&t>1?t-1:t,r&&n>1?n-1:n],p=0,d=f[0]/h[0],v=f[1]/h[1],m=0;m<i;m++)for(var y=0;y<t;y++)for(var g=d*y,b=Math.floor(g),x=g-b,w=Math.min(o-1,Math.ceil(g)),k=m*e.strides[0]+b*e.strides[1],E=m*e.strides[0]+w*e.strides[1],S=0;S<n;S++)for(var C=v*S,I=Math.floor(C),T=C-I,N=Math.min(s-1,Math.ceil(C)),_=k+I*e.strides[2],R=E+I*e.strides[2],A=k+N*e.strides[2],D=E+N*e.strides[2],O=0;O<u;O++){var M=c[_+O],F=c[R+O],P=M+(c[A+O]-M)*T,L=P+(F+(c[D+O]-F)*T-P)*x;l[p++]=L}return zI(l,[i,t,n,u])},t.prototype.resizeBilinearBackprop=function(e,t,n){CF([e,t],"resizeBilinearBackprop");for(var r=t.shape,a=r[0],i=r[1],o=r[2],s=r[3],u=e.shape,c=u[1],l=u[2],f=new Float32Array(a*i*o*s),h=[n&&c>1?i-1:i,n&&l>1?o-1:o],p=[n&&c>1?c-1:c,n&&l>1?l-1:l],d=h[0]/p[0],v=h[1]/p[1],m=this.readSync(e.dataId),y=0,g=0;g<a;g++)for(var b=g*t.strides[0],x=0;x<c;x++)for(var w=x*d,k=Math.floor(w),E=Math.min(Math.ceil(w),i-1),S=b+k*t.strides[1],C=b+E*t.strides[1],I=w-k,T=1-I,N=0;N<l;N++)for(var _=N*v,R=Math.floor(_),A=Math.min(Math.ceil(_),o-1),D=_-R,O=1-D,M=S+R*t.strides[2],F=S+A*t.strides[2],P=C+R*t.strides[2],L=C+A*t.strides[2],B=T*O,V=T*D,z=I*O,U=I*D,W=0;W<s;W++){var j=m[y++];f[M+W]+=j*B,f[F+W]+=j*V,f[P+W]+=j*z,f[L+W]+=j*U}return qI(f,[a,o,i,s],t.dtype)},t.prototype.resizeNearestNeighbor=function(e,t,n,r){CF(e,"resizeNearestNeighbor");for(var a=e.shape,i=a[0],o=a[1],s=a[2],u=a[3],c=this.readSync(e.dataId),l=new Float32Array(i*t*n*u),f=[r&&t>1?o-1:o,r&&n>1?s-1:s],h=[r&&t>1?t-1:t,r&&n>1?n-1:n],p=f[0]/h[0],d=f[1]/h[1],v=0,m=0;m<i;m++)for(var y=m*e.strides[0],g=0;g<t;g++)for(var b=p*g,x=y+Math.min(o-1,r?Math.round(b):Math.floor(b))*e.strides[1],w=0;w<n;w++)for(var k=d*w,E=x+Math.min(s-1,r?Math.round(k):Math.floor(k))*e.strides[2],S=0;S<u;S++){var C=c[E+S];l[v++]=C}return zI(l,[i,t,n,u],e.dtype)},t.prototype.resizeNearestNeighborBackprop=function(e,t,n){CF([e,t],"resizeNearestNeighborBackprop");for(var r=t.shape,a=r[0],i=r[1],o=r[2],s=r[3],u=e.shape,c=u[1],l=u[2],f=new Float32Array(a*i*o*s),h=this.readSync(e.dataId),p=[n&&c>1?i-1:i,n&&l>1?o-1:o],d=[n&&c>1?c-1:c,n&&l>1?l-1:l],v=p[0]/d[0],m=p[1]/d[1],y=1/v,g=1/m,b=2*Math.ceil(y)+2,x=2*Math.ceil(g)+2,w=0;w<a;w++)for(var k=w*t.strides[0],E=0;E<i;E++)for(var S=k+E*t.strides[1],C=Math.floor(E*y),I=Math.floor(C-b/2),T=0;T<o;T++)for(var N=S+T*t.strides[2],_=Math.floor(T*g),R=Math.floor(_-x/2),A=0;A<s;A++){for(var D=0,O=0;O<b;O++){var M=O+I;if(!(M<0||M>=c)){var F=k+M*e.strides[1],P=M*v;if(E===Math.min(i-1,n?Math.round(P):Math.floor(P)))for(var L=0;L<x;L++){var B=L+R;if(!(B<0||B>=l)){var V=F+B*e.strides[2],z=B*m;T===Math.min(o-1,n?Math.round(z):Math.floor(z))&&(D+=h[V+A])}}}}f[N+A]=D}return qI(f,t.shape,t.dtype)},t.prototype.batchNormalization=function(e,t,n,r,a,i){CF([e,t,n,a,i],"batchNorm");for(var o=this.readSync(e.dataId),s=this.readSync(t.dataId),u=this.readSync(n.dataId),c=a?this.readSync(a.dataId):new Float32Array([1]),l=i?this.readSync(i.dataId):new Float32Array([0]),f=new Float32Array(o.length),h=l.length,p=c.length,d=u.length,v=s.length,m=0,y=0,g=0,b=0,x=0;x<o.length;++x)f[x]=l[m++]+(o[x]-s[y++])*c[g++]/Math.sqrt(u[b++]+r),m>=h&&(m=0),y>=v&&(y=0),g>=p&&(g=0),b>=d&&(b=0);return qI(f,e.shape)},t.prototype.localResponseNormalization4D=function(e,t,n,r,a){CF(e,"localResponseNormalization4D");var i=e.shape[3],o=i-1,s=this.readSync(e.dataId),u=e.size,c=new Float32Array(u);function l(e){for(var n=e%i,r=e-n+Math.max(0,n-t),a=e-n+Math.min(n+t,o),u=0;r<=a;r++){var c=s[r];u+=c*c}return u}for(var f=0;f<u;f++){var h=l(f),p=s[f]*Math.pow(n+r*h,-a);c[f]=p}return qI(c,e.shape)},t.prototype.LRNGrad=function(e,t,n,r,a,i,o){CF(e,"LRNGrad");for(var s=e.shape[3],u=this.readSync(e.dataId),c=this.readSync(t.dataId),l=this.readSync(n.dataId),f=new Float32Array(e.size),h=e.size,p=0;p<h;p++){for(var d=p%s,v=p-d+Math.max(0,d-r),m=p-d+Math.min(s,d+r+1),y=0,g=v;g<m;g++)y+=Math.pow(c[g],2);for(y=i*y+a,g=v;g<m;g++){var b=-2*i*o*c[g]*l[p]/y;p===g&&(b+=Math.pow(y,-o)),b*=u[p],f[g]+=b}}return qI(f,e.shape)},t.prototype.multinomial=function(e,t,n,r){CF(e,"multinomial");for(var a=t?e:HN(e),i=a.shape[0],o=a.shape[1],s=XI([i,n],"int32"),u=this.readSync(s.dataId),c=this.readSync(a.dataId),l=0;l<i;++l){var f=l*o,h=new Float32Array(o-1);h[0]=c[f];for(var p=1;p<h.length;++p)h[p]=h[p-1]+c[f+p];for(var d=vD(r.toString()),v=l*n,m=0;m<n;++m){var y=d();u[v+m]=h.length;for(var g=0;g<h.length;g++)if(y<h[g]){u[v+m]=g;break}}}return s},t.prototype.oneHot=function(e,t,n,r){CF(e,"oneHot");var a=new Float32Array(e.size*t);a.fill(r);for(var i=this.readSync(e.dataId),o=0;o<e.size;++o)i[o]>=0&&i[o]<t&&(a[o*t+i[o]]=n);return GI(a,[e.size,t],"int32")},t.prototype.nonMaxSuppression=function(e,t,n,r,a){return CF(e,"nonMaxSuppression"),g_(this.readSync(e.dataId),this.readSync(t.dataId),n,r,a)},t.prototype.fft=function(e){return this.fftBatch(e,!1)},t.prototype.ifft=function(e){return this.fftBatch(e,!0)},t.prototype.fftBatch=function(e,t){for(var n=e.shape[0],r=e.shape[1],a=oT(e.shape,"float32"),i=oT(e.shape,"float32"),o=BI(e).as2D(n,r),s=VI(e).as2D(n,r),u=0;u<n;u++)for(var c=o.slice([u,0],[1,r]),l=s.slice([u,0],[1,r]),f=LI(c,l),h=this.readSync(this.fftImpl(f,t).dataId),p=0;p<r;p++){var d=p_(h,p);a.values[u*r+p]=d.real,i.values[u*r+p]=d.imag}return LI(a.toTensor(),i.toTensor()).as2D(n,r)},t.prototype.fftImpl=function(e,t){var n=e.as1D(),r=n.size;if(this.isExponentOf2(r)){var a=this.fftRadix2(n,r,t).as2D(e.shape[0],e.shape[1]);return t&&(a=LI(BI(a).div(WI(r)),VI(a).div(WI(r)))),a}var i=this.readSync(e.dataId),o=function(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}(this.fourierTransformByMatmul(i,r,t));return LI(o.real,o.imag).as2D(e.shape[0],e.shape[1])},t.prototype.isExponentOf2=function(e){return 0==(e&e-1)},t.prototype.fftRadix2=function(e,t,n){if(1===t)return e;var r=this.readSync(e.dataId),a=t/2,i=function(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(r),o=LI(i.real,i.imag).as1D(),s=function(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}(r),u=LI(s.real,s.imag).as1D();o=this.fftRadix2(o,a,n),u=this.fftRadix2(u,a,n);var c=function(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}(t,n),l=LI(c.real,c.imag).mul(u),f=o.add(l),h=o.sub(l),p=BI(f).concat(BI(h)),d=VI(f).concat(VI(h));return LI(p,d).as1D()},t.prototype.fourierTransformByMatmul=function(e,t,n){for(var r=new Float32Array(2*t),a=0;a<t;a++){for(var i=0,o=0,s=0;s<t;s++){var u=v_(a*s,t,n),c=p_(e,s);i+=c.real*u.real-c.imag*u.imag,o+=c.real*u.imag+c.imag*u.real}n&&(i/=t,o/=t),d_(r,i,o,a)}return r},t.prototype.depthToSpace=function(e,t,n){nS("NHWC"===n,(function(){return"Only NHWC dataFormat supported on CPU for depthToSpace. Got "+n})),nS(t>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: "+t}));for(var r=e.shape[0],a=e.shape[1],i=e.shape[2],o=e.shape[3],s=a*t,u=i*t,c=o/(t*t),l=this.readSync(e.dataId),f=new Float32Array(r*s*u*c),h=0,p=0;p<r;++p)for(var d=0;d<s;++d)for(var v=Math.floor(d/t),m=d%t,y=0;y<u;++y)for(var g=Math.floor(y/t),b=(m*t+y%t)*c,x=0;x<c;++x){var w=x+b+o*(g+i*(v+a*p));f[h++]=l[w]}return qI(f,[r,s,u,c])},t.prototype.broadcastedBinaryOp=function(e,t,n,r){var a=OT(e.shape,t.shape),i=oT(a,n),o=this.readSync(e.dataId),s=this.readSync(t.dataId),u=AT(e.shape,a),c=AT(t.shape,a),l=i.values;if(u.length+c.length===0)for(var f=0;f<l.length;++f)l[f]=r(o[f%o.length],s[f%s.length]);else{var h=this.bufferSync(e),p=this.bufferSync(t),d=function(n){var a=i.indexToLoc(n),f=a.slice(-e.rank);u.forEach((function(e){return f[e]=0}));var d=h.locToIndex(f),v=a.slice(-t.rank);c.forEach((function(e){return v[e]=0}));var m=p.locToIndex(v);l[n]=r(o[d],s[m])};for(f=0;f<l.length;++f)d(f)}return i.toTensor()},t.prototype.broadcastedBinaryComplexOp=function(e,t,n){var r=OT(e.shape,t.shape),a=oT(r,"float32"),i=oT(r,"float32"),o=this.readSync(e.dataId),s=this.readSync(t.dataId),u=AT(e.shape,r),c=AT(t.shape,r),l=a.values,f=i.values;if(u.length+c.length===0)for(var h=0;h<l.length;h++){var p=h%o.length,d=h%s.length,v=n(o[2*p],o[2*p+1],s[2*d],s[2*d+1]);l[h]=v.real,f[h]=v.imag}else{var m=this.bufferSync(this.data.get(e.dataId).complexTensors.real),y=this.bufferSync(this.data.get(t.dataId).complexTensors.real),g=function(r){var i=a.indexToLoc(r),h=i.slice(-e.rank);u.forEach((function(e){return h[e]=0}));var p=m.locToIndex(h),d=i.slice(-t.rank);c.forEach((function(e){return d[e]=0}));var v=y.locToIndex(d),g=n(o[2*p],o[2*p+1],s[2*v],s[2*v+1]);l[r]=g.real,f[r]=g.imag};for(h=0;h<l.length;h++)g(h)}return this.complex(a.toTensor(),i.toTensor())},t.prototype.split=function(e,t,n){return S_(e,t,n)},t.prototype.dispose=function(){},t.prototype.floatPrecision=function(){return 32},t.prototype.epsilon=function(){return 1e-7},t.prototype.cropAndResize=function(e,t,n,r,a,i){for(var o=e.shape,s=o[0],u=o[1],c=o[2],l=o[3],f=t.shape[0],h=r[0],p=r[1],d=oT([f,h,p,l],"float32"),v=this.readSync(t.dataId),m=this.readSync(n.dataId),y=this.readSync(e.dataId),g=e.strides,b=d.strides,x=0;x<f;x++){var w=4*x,k=v[w],E=v[w+1],S=v[w+2],C=v[w+3],I=m[x];if(!(I>=s))for(var T=h>1?(S-k)*(u-1)/(h-1):0,N=p>1?(C-E)*(c-1)/(p-1):0,_=0;_<h;_++){var R=h>1?k*(u-1)+_*T:.5*(k+S)*(u-1);if(R<0||R>u-1)for(var A=0;A<p;A++)for(var D=0;D<l;D++){var O=D+A*b[2]+_*b[1]+x*b[0];d.values[O]=i}else if("bilinear"===a){var M=Math.floor(R),F=Math.ceil(R),P=R-M;for(A=0;A<p;A++)if((H=p>1?E*(c-1)+A*N:.5*(E+C)*(c-1))<0||H>c-1)for(D=0;D<l;D++)O=D+A*b[2]+_*b[1]+x*b[0],d.values[O]=i;else{var L=Math.floor(H),B=Math.ceil(H),V=H-L;for(D=0;D<l;D++){var z=y[O=D+L*g[2]+M*g[1]+I*g[0]],U=y[O=D+B*g[2]+M*g[1]+I*g[0]],W=y[O=D+L*g[2]+F*g[1]+I*g[0]],j=z+(U-z)*V,G=W+(y[O=D+B*g[2]+F*g[1]+I*g[0]]-W)*V;O=D+A*b[2]+_*b[1]+x*b[0],d.values[O]=j+(G-j)*P}}}else for(A=0;A<p;++A){var H;if((H=p>1?E*(c-1)+A*N:.5*(E+C)*(c-1))<0||H>c-1)for(D=0;D<l;D++)O=D+A*b[2]+_*b[1]+x*b[0],d.values[O]=i;else{var q=Math.round(H),K=Math.round(R);for(D=0;D<l;D++){var X=D+q*g[2]+K*g[1]+I*g[0],$=D+A*b[2]+_*b[1]+x*b[0];d.values[$]=y[X]}}}}}return d.toTensor()},t.prototype.sparseToDense=function(e,t,n,r){var a=PN(0,e,n),i=a.sliceRank,o=a.numUpdates,s=a.sliceSize,u=a.strides,c=a.outputSize;return this.scatter(e,t,n,c,s,o,i,u,r,!1)},t.prototype.gatherND=function(e,t){var n=t.shape,r=n[n.length-1],a=DN(e,t),i=a[0],o=a[1],s=a[2],u=a[3];if(0===o)return zI([],i,e.dtype);for(var c=new KS([o,s],e.dtype),l=this.readSync(t.dataId),f=this.readSync(e.dataId),h=0;h<o;h++){for(var p=[],d=0,v=0;v<r;v++){var m=l[h*r+v];d+=m*u[v],p.push(m)}if(d<0||d>=e.size/s)throw new Error("Invalid indices: "+p+" does not index into "+e.shape);for(var y=0;y<s;y++)c.values[h*s+y]=f[d*s+y]}return c.toTensor().reshape(i)},t.prototype.scatterND=function(e,t,n){var r=PN(0,e,n),a=r.sliceRank,i=r.numUpdates,o=r.sliceSize,s=r.strides,u=r.outputSize,c=WI(0);return this.scatter(e,t,n,u,o,i,a,s,c,!0)},t.prototype.fill=function(e,t,n){var r=yS(n=n||TS(t),oS(e));return r.fill(t),pC.makeTensor(r,e,n,this)},t.prototype.onesLike=function(e){if("string"===e.dtype)throw new Error("onesLike is not supported for string tensors");return this.fill(e.shape,1,e.dtype)},t.prototype.zerosLike=function(e){var t=yS(e.dtype,oS(e.shape));return this.makeOutput(t,e.shape,e.dtype)},t.prototype.linspace=function(e,t,n){return f_(e,t,n)},t.prototype.scatter=function(e,t,n,r,a,i,o,s,u,c){var l=[r/a,a],f=this.readSync(e.dataId),h=this.readSync(t.dataId);if(0===r)return zI([],n,t.dtype);var p=new KS(l,t.dtype);p.values.fill(this.readSync(u.dataId)[0]);for(var d=0;d<i;d++){for(var v=[],m=0,y=0;y<o;y++){var g=f[d*o+y];v.push(g),m+=g*s[y]}if(m<0||m>=r/a)throw new Error("Invalid indices: "+v+" does not index into "+n);for(var b=0;b<a;b++)c?p.values[m*a+b]+=h[d*a+b]:p.values[m*a+b]=0===t.rank?h[0]:h[d*a+b]}return p.toTensor().reshape(n)},t}($N);function RF(e,t){return{kernelName:e,backendName:"cpu",kernelFunc:function(n){var r=n.inputs,a=n.backend,i=r,o=i.a,s=i.b,u=a;CF([o,s],e);var c=u.data.get(o.dataId).values,l=u.data.get(s.dataId).values,f=t(o.shape,s.shape,c,l,o.dtype),h=f[0],p=f[1];return{dataId:u.write(h,p,o.dtype),shape:p,dtype:o.dtype}}}}function AF(e){return function(t,n,r,a,i){var o=OT(t,n),s=o.length,u=RS(o),c=mS(i,oS(o)),l=t.length,f=n.length,h=RS(t),p=RS(n),d=AT(t,o),v=AT(n,o);if(d.length+v.length===0)for(var m=0;m<c.length;++m)c[m]=e(r[m%r.length],a[m%a.length]);else{var y=function(t){var n=zS(t,s,u),i=n.slice(-l);d.forEach((function(e){return i[e]=0}));var o=VS(i,l,h),m=n.slice(-f);v.forEach((function(e){return m[e]=0}));var y=VS(m,f,p);c[t]=e(r[o],a[y])};for(m=0;m<c.length;++m)y(m)}return[c,o]}}pC.registerBackend("cpu",(function(){return new _F}),1);var DF=AF((function(e,t){return e/t})),OF=RF(ET,DF),MF={kernelName:"MaxPoolWithArgmax",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n,o=i.filterSize,s=i.strides,u=i.pad,c=i.includeBatchInIndex,l=r;CF(a,"MaxPoolWithArgmax");var f=l.data.get(a.dataId).values,h=YN(a.shape,o,s,[1,1],u),p=function(e,t,n,r,a){var i=IF(e,0,n,RS(t),a,"max"),o=TF(e,t,n,a,!0,r);return[i.values,o.values]}(f,a.shape,a.dtype,c,h),d=p[0],v=p[1],m=l.write(d,h.outShape,a.dtype),y=l.write(v,h.outShape,a.dtype);return[{dataId:m,shape:h.outShape,dtype:a.dtype},{dataId:y,shape:h.outShape,dtype:"int32"}]}},FF={kernelName:"NonMaxSuppressionV5",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t,i=a.boxes,o=a.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,f=s.softNmsSigma,h=n;CF(i,"NonMaxSuppressionWithScore");var p=b_(h.data.get(i.dataId).values,h.data.get(o.dataId).values,u,c,l,f);return[p.selectedIndices,p.selectedScores]}},PF={kernelName:"Square",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n;CF(r,"square");for(var i=a.data.get(r.dataId).values,o=new Float32Array(i.length),s=0;s<i.length;++s){var u=i[s];o[s]=u*u}return{dataId:a.write(o,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}},LF=AF((function(e,t){var n=e-t;return n*n}));function BF(e,t,n,r,a){for(var i=oS(t),o=t.length,s=RS(t),u=RS(a),c=mS(n,oS(a)),l=0;l<i;++l){for(var f=zS(l,o,s),h=new Array(f.length),p=0;p<h.length;p++)h[p]=f[r[p]];c[VS(h,o,u)]=e[l]}return c}for(var VF=0,zF=[FF,PF,RF(ST,LF),OF,{kernelName:"Transpose",backendName:"cpu",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.perm,o=r;CF(a,"transpose");for(var s=a.shape.length,u=new Array(s),c=0;c<u.length;c++)u[c]=a.shape[i[c]];var l=BF(o.data.get(a.dataId).values,a.shape,a.dtype,i,u);return{dataId:o.write(l,u,a.dtype),shape:u,dtype:a.dtype}}},MF];VF<zF.length;VF++)$E(zF[VF]);for(var UF,WF=function(e){this.variableNames=["A"];var t=O_(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2("+r+".0, "+n+".0);\n\n        vec4 values = "+t.texture2D+"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    "},jF=function(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var t=O_(),n=e[0],r=e[1];this.outputShape=e,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2("+r+".0, "+n+".0);\n            vec4 values = "+t.texture2D+"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        "+t.output+" = result;\n      }\n    "},GF=function(e,t){this.variableNames=["A"];for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];this.outputShape=n,this.rank=n.length;var a=q_(this.rank),i=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank "+t+" is not yet supported");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(t);this.userCode="\n    void main() {\n      "+a+" resRC = getOutputCoords();\n      setOutput(getA("+i+"));\n    }\n    "},HF=function(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e[t[r]];if(this.outputShape=n,this.rank=n.length,this.rank>6)throw Error("Packed transpose for rank "+this.rank+" is not yet supported.");var a=q_(this.rank),i=A_("rc",this.rank),o=new Array(this.rank);for(r=0;r<t.length;r++)o[t[r]]=i[r];var s="vec2("+o.slice(-2).join()+")",u="++"+i[this.rank-1]+" < "+n[this.rank-1],c="getChannel(getA("+o.join()+"), "+s+")";this.userCode="\n    void main() {\n      "+a+" rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = "+c+";\n      if("+u+") {\n        result[1] = "+c+";\n      }\n      --"+i[this.rank-1]+";\n      if(++"+i[this.rank-2]+" < "+n[this.rank-2]+") {\n        result[2] = "+c+";\n        if("+u+") {\n          result[3] = "+c+";\n        }\n      }\n      setOutput(result);\n    }\n    "},qF=0,KF=[{kernelName:"FromPixels",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.pixels,i=r.numChannels,o="undefined"!=typeof HTMLVideoElement&&a instanceof HTMLVideoElement,s="undefined"!=typeof HTMLImageElement&&a instanceof HTMLImageElement,u=o?[a.videoWidth,a.videoHeight]:[a.width,a.height],c=u[0],l=u[1],f=[l,c],h=[l,c,i];(s||o)&&(null==UF&&(UF=document.createElement("canvas").getContext("2d")),UF.canvas.width=c,UF.canvas.height=l,UF.drawImage(a,0,0,c,l),a=UF.canvas);var p=n.makeTensorInfo(f,"int32");n.texData.get(p.dataId).usage=yC.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),a);var d=WE().getBool("WEBGL_PACK")?new jF(h):new WF(h),v=n.runWebGLProgram(d,[p],"int32");return n.disposeData(p.dataId),v}},{kernelName:ET,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t;return function(e,t,n){var r=new iR("\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",e.shape,t.shape);return WE().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&(r=new sR("\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",e.shape,t.shape,!0)),n.runWebGLProgram(r,[e,t],"float32")}(r.a,r.b,n)}},{kernelName:"NonMaxSuppressionV5",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;wI("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var a=t,i=a.boxes,o=a.scores,s=r,u=s.maxOutputSize,c=s.iouThreshold,l=s.scoreThreshold,f=s.softNmsSigma,h=n,p=b_(h.readSync(i.dataId),h.readSync(o.dataId),u,c,l,f);return[p.selectedIndices,p.selectedScores]}},{kernelName:"Square",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n,i=new UA(r.shape,"return x * x;");return a.runWebGLProgram(i,[r],r.dtype)}},{kernelName:ST,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t,a=r.a,i=r.b,o=n,s=WE().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sR("return (a - b) * (a - b);",a.shape,i.shape):new iR("return (a - b) * (a - b);",a.shape,i.shape);return o.compileAndRun(s,[a,i])}},{kernelName:"Transpose",backendName:"webgl",kernelFunc:function(e){for(var t,n=e.inputs,r=e.attrs,a=e.backend,i=n.x,o=r.perm,s=a,u=i.shape.length,c=new Array(u),l=0;l<c.length;l++)c[l]=i.shape[o[l]];if(s.shouldExecuteOnCPU([i])){var f=BF(s.texData.get(i.dataId).values,i.shape,i.dtype,o,c);t=s.makeTensorInfo(c,i.dtype),s.texData.get(t.dataId).values=f}else t=function(e,t,n){var r=WE().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new HF(e.shape,t):new GF(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}(i,o,s);return t}},{kernelName:"MaxPoolWithArgmax",backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n,o=i.filterSize,s=i.strides,u=i.pad,c=i.includeBatchInIndex,l=r;nS(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank "+a.shape.length+"."}));var f=[1,1];nS(s_(s,f),(function(){return"Error in maxPool: Either strides or dilations must be 1. Got strides "+s+" and dilations '"+f+"'"}));var h=YN(a.shape,o,s,f,u),p=function(e,t,n,r){var a=new yA(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new yA(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,c,h,l);return[p[0],p[1]]}}];qF<KF.length;qF++)$E(KF[qF]);for(var XF=0,$F=[{kernelName:"Add",inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],a=OT(n.shape,r.shape);return{a:function(){var t=e,r=DT(n.shape,a);return r.length>0&&(t=t.sum(r)),t.reshape(n.shape)},b:function(){var t=e,n=DT(r.shape,a);return n.length>0&&(t=t.sum(n)),t.reshape(r.shape)}}}},{kernelName:"AddN",saveAllInputs:!0,gradFunc:function(e,t){var n={};return t.forEach((function(t,r){n[r]=function(){return e.clone()}})),n}},{kernelName:CT,gradFunc:function(e,t,n){for(var r=n,a=r.inputShape,i=r.shape,o=Array.from(i),s=a.length-1;s>=0;s--)if(a[s]===i[s])o[s]=1;else if(1!==a[s])throw new Error("broadcastTo(): ["+a+"] cannot be broadcast to ["+i+"].");var u=[];for(s=0;s<o.length;s++)o[s]>1&&u.push(s);return{x:function(){return e.sum(u,!0)}}}},{kernelName:ET,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],a=OT(n.shape,r.shape);return{a:function(){var t=AN(e,r.toFloat()),i=DT(n.shape,a);return i.length>0?mM(t,i).reshape(n.shape):t},b:function(){var t=e.mul(n.toFloat()),i=DT(r.shape,a);i.length>0&&(t=mM(t,i).reshape(r.shape));var o=oO(r);return JT(AN(t,o.toFloat()))}}}},{kernelName:"FusedBatchNorm",inputsToSave:["x","mean","variance","scale"],gradFunc:function(e,t,n){var r=n.varianceEpsilon,a=t[0],i=t[1],o=t[2],s=t[3],u=gD(a),c=null==s?WI(1):s,l=DT(i.shape,u.shape),f=[];if(1===i.rank){for(var h=0;h<u.shape.length-1;++h)f.push(u.shape[h]);f.push(1)}var p=_N(a,i),d=SN(e,c),v=tN(RT(o,WI(r))),m=SN(SN(SN(v,v),v),WI(-.5));return{x:function(){return 1===i.rank?hT(SN(SN(e,UD(v.as4D(1,1,1,i.shape[0]),f)),c),a.shape):hT(SN(SN(e,v),c),a.shape)},mean:function(){var e=SN(SN(v,WI(-1)),d);return 1===i.rank&&(e=mM(e,l)),hT(e,i.shape)},variance:function(){var e=SN(SN(m,p),d);return 1===i.rank&&(e=mM(e,l)),hT(e,i.shape)},scale:function(){var t=SN(p,v),n=SN(e,t);return 1===i.rank&&(n=mM(n,l)),hT(n,i.shape)},offset:function(){var t=e;return 1===i.rank&&(t=mM(t,l)),hT(t,i.shape)}}}},{kernelName:TT,gradFunc:function(e){return{x:function(){return e.toFloat()}}}},{kernelName:IT,inputsToSave:["indices"],gradFunc:function(e,t){var n=t[0];return{indices:function(){return XI(n.shape,"float32")}}}},{kernelName:_T,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.paddings.map((function(e){return e[0]}));return{x:function(){return e.slice(a,r.shape)}}}},{kernelName:"Square",inputsToSave:["x"],gradFunc:function(e,t){var n=t[0];return{x:function(){return e.mul(n.toFloat().mul(2))}}}},{kernelName:ST,inputsToSave:["a","b"],gradFunc:function(e,t){var n=t[0],r=t[1],a=WI(2);return{a:function(){return SN(e,SN(a,_N(n,r)))},b:function(){return SN(e,SN(a,_N(r,n)))}}}},{kernelName:NT,inputsToSave:["x"],gradFunc:function(e,t,n){var r=t[0],a=n.reps;return{x:function(){var t=ZI(r);if(1===r.rank)for(var n=0;n<a[0];++n)t=t.add(e.slice([n*r.shape[0]],[r.shape[0]]));else if(2===r.rank)for(n=0;n<a[0];++n)for(var i=0;i<a[1];++i)t=t.add(e.slice([n*r.shape[0],i*r.shape[1]],[r.shape[0],r.shape[1]]));else if(3===r.rank)for(n=0;n<a[0];++n)for(i=0;i<a[1];++i)for(var o=0;o<a[2];++o)t=t.add(e.slice([n*r.shape[0],i*r.shape[1],o*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else{if(4!==r.rank)throw new Error("Gradient for tile operation is not implemented for rank-"+r.rank+" tensors yet.");for(n=0;n<a[0];++n)for(i=0;i<a[1];++i)for(o=0;o<a[2];++o)for(var s=0;s<a[3];++s)t=t.add(e.slice([n*r.shape[0],i*r.shape[1],o*r.shape[2],s*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]))}return t}}}},{kernelName:"Transpose",gradFunc:function(e,t,n){var r=DI(n.perm);return{x:function(){return KN(e,r)}}}}];XF<$F.length;XF++)QE($F[XF]);var QF=function(){function e(){}return e.prototype.fetch=function(e,t){return fetch(e,t)},e.prototype.now=function(){return performance.now()},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got "+t);return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return new TextDecoder(t).decode(e)},e}();WE().get("IS_BROWSER")&&WE().setPlatform("browser",new QF);var YF,JF=function(){function e(){this.util=n(753),this.textEncoder=new this.util.TextEncoder}return e.prototype.fetch=function(e,t){return null!=WE().global.fetch?WE().global.fetch(e,t):(null==YF&&(YF=n(522)),YF(e,t))},e.prototype.now=function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6},e.prototype.encode=function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got "+t);return this.textEncoder.encode(e)},e.prototype.decode=function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)},e}();WE().get("IS_NODE")&&WE().setPlatform("node",new JF);var ZF={float32:4,int32:4,uint16:2,uint8:1,bool:1};function eP(e,t){for(var n={},r=0,a=function(t){var a=t.name,i=t.dtype,o=t.shape,s=oS(o),u=void 0;if("quantization"in t){var c=t.quantization;if("uint8"!==c.dtype&&"uint16"!==c.dtype)throw new Error("Weight "+t.name+" has unknown quantization dtype "+c.dtype+". Supported quantization dtypes are: 'uint8' and 'uint16'.");var l=ZF[c.dtype],f=e.slice(r,r+s*l),h="uint8"===c.dtype?new Uint8Array(f):new Uint16Array(f);if("float32"===i)u=Float32Array.from(h,(function(e){return e*c.scale+c.min}));else{if("int32"!==i)throw new Error("Unsupported dtype in weight '"+a+"': "+i);u=Int32Array.from(h,(function(e){return Math.round(e*c.scale+c.min)}))}r+=s*l}else if("string"===i){var p=oS(t.shape);u=[];for(var d=0;d<p;d++){var v=new Uint32Array(e.slice(r,r+4))[0];r+=4;var m=new Uint8Array(e.slice(r,r+v));u.push(m),r+=v}}else{var y=ZF[i];if(f=e.slice(r,r+s*y),"float32"===i)u=new Float32Array(f);else if("int32"===i)u=new Int32Array(f);else{if("bool"!==i)throw new Error("Unsupported dtype in weight '"+a+"': "+i);u=new Uint8Array(f)}r+=s*y}n[a]=zI(u,o,i)},i=0,o=t;i<o.length;i++)a(o[i]);return n}function tP(e){if(null===e)throw new Error("Invalid input value: "+JSON.stringify(e));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: "+e.constructor.name)}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var nP="undefined"!=typeof Buffer&&("undefined"==typeof Blob||"undefined"==typeof atob||"undefined"==typeof btoa);function rP(e){return nP?Buffer.byteLength(e):new Blob([e]).size}function aP(e){var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function iP(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function oP(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:rP(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:rP(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}var sP=function(){function e(){this.saveRouters=[],this.loadRouters=[]}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerSaveRouter=function(t){e.getInstance().saveRouters.push(t)},e.registerLoadRouter=function(t){e.getInstance().loadRouters.push(t)},e.getSaveHandlers=function(t){return e.getHandlers(t,"save")},e.getLoadHandlers=function(t,n){return e.getHandlers(t,"load",n)},e.getHandlers=function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a},e}(),uP="://",cP=function(){function e(){this.managers={}}return e.getInstance=function(){return null==e.instance&&(e.instance=new e),e.instance},e.registerManager=function(t,n){nS(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(uP)&&(t=t.slice(0,t.indexOf(uP))),nS(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();nS(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '"+t+"'."})),r.managers[t]=n},e.getManager=function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '"+e+"'");return t},e.getSchemes=function(){return Object.keys(this.getInstance().managers)},e}();function lP(e){if(-1===e.indexOf(uP))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+cP.getSchemes().join(","));return{scheme:e.split(uP)[0],path:e.split(uP)[1]}}function fP(e,t,n){return void 0===n&&(n=!1),BE(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,f;return VE(this,(function(h){switch(h.label){case 0:return nS(e!==t,(function(){return"Old path and new path are the same: '"+e+"'"})),nS((r=sP.getLoadHandlers(e)).length>0,(function(){return"Copying failed because no load handler is found for source URL "+e+"."})),nS(r.length<2,(function(){return"Copying failed because more than one ("+r.length+") load handlers for source URL "+e+"."})),a=r[0],nS((i=sP.getSaveHandlers(t)).length>0,(function(){return"Copying failed because no save handler is found for destination URL "+t+"."})),nS(i.length<2,(function(){return"Copying failed because more than one ("+r.length+") save handlers for destination URL "+t+"."})),o=i[0],s=lP(e).scheme,u=lP(e).path,c=s===lP(e).scheme,[4,a.load()];case 1:return l=h.sent(),n&&c?[4,cP.getManager(s).removeModel(u)]:[3,3];case 2:h.sent(),h.label=3;case 3:return[4,o.save(l)];case 4:return f=h.sent(),!n||c?[3,6]:[4,cP.getManager(s).removeModel(u)];case 5:h.sent(),h.label=6;case 6:return[2,f.modelArtifactsInfo]}}))}))}var hP="models_store",pP="model_info_store";function dP(){if(!WE().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e=window||self,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function vP(e){var t=e.result;t.createObjectStore(hP,{keyPath:"modelPath"}),t.createObjectStore(pP,{keyPath:"modelPath"})}var mP=function(){function e(e){if(this.indexedDB=dP(),null==e||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}return e.prototype.save=function(e){return BE(this,void 0,void 0,(function(){return VE(this,(function(t){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return[2,this.databaseAction(this.modelPath,e)]}))}))},e.prototype.load=function(){return BE(this,void 0,void 0,(function(){return VE(this,(function(e){return[2,this.databaseAction(this.modelPath)]}))}))},e.prototype.databaseAction=function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return vP(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(hP,"readonly"),s=o.objectStore(hP).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '"+n.modelPath+"' in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var u,c=oP(t),l=i.transaction(pP,"readwrite"),f=l.objectStore(pP),h=f.put({modelPath:n.modelPath,modelArtifactsInfo:c});h.onsuccess=function(){var a=(u=i.transaction(hP,"readwrite")).objectStore(hP).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:c});a.onsuccess=function(){return e({modelArtifactsInfo:c})},a.onerror=function(e){var t=(f=l.objectStore(pP)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},h.onerror=function(e){return i.close(),r(h.error)},l.oncomplete=function(){null==u?i.close():u.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))},e.URL_SCHEME="indexeddb://",e}(),yP=function(e){return WE().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(mP.URL_SCHEME)?(t=e.slice(mP.URL_SCHEME.length),new mP(t)):null;var t};sP.registerSaveRouter(yP),sP.registerLoadRouter(yP);var gP=function(){function e(){this.indexedDB=dP()}return e.prototype.listModels=function(){return BE(this,void 0,void 0,(function(){var e=this;return VE(this,(function(t){return[2,new Promise((function(t,n){var r=e.indexedDB.open("tensorflowjs",1);r.onupgradeneeded=function(){return vP(r)},r.onsuccess=function(){var e=r.result,a=e.transaction(pP,"readonly"),i=a.objectStore(pP).getAll();i.onsuccess=function(){for(var e={},n=0,r=i.result;n<r.length;n++){var a=r[n];e[a.modelPath]=a.modelArtifactsInfo}t(e)},i.onerror=function(t){return e.close(),n(i.error)},a.oncomplete=function(){return e.close()}},r.onerror=function(e){return n(r.error)}}))]}))}))},e.prototype.removeModel=function(e){return BE(this,void 0,void 0,(function(){var t=this;return VE(this,(function(n){var r;return e=(r=e).startsWith(mP.URL_SCHEME)?r.slice(mP.URL_SCHEME.length):r,[2,new Promise((function(n,r){var a=t.indexedDB.open("tensorflowjs",1);a.onupgradeneeded=function(){return vP(a)},a.onsuccess=function(){var t,i=a.result,o=i.transaction(pP,"readwrite"),s=o.objectStore(pP),u=s.get(e);u.onsuccess=function(){if(null==u.result)return i.close(),r(new Error("Cannot find model with path '"+e+"' in IndexedDB."));var a=s.delete(e),o=function(){var a=(t=i.transaction(hP,"readwrite")).objectStore(hP).delete(e);a.onsuccess=function(){return n(u.result.modelArtifactsInfo)},a.onerror=function(e){return r(u.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(u.error)}},u.onerror=function(e){return i.close(),r(u.error)},o.oncomplete=function(){null==t?i.close():t.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}}))]}))}))},e}();if(WE().getBool("IS_BROWSER"))try{cP.registerManager(mP.URL_SCHEME,new gP)}catch(ki){}var bP="/",xP="tensorflowjs_models",wP="info",kP="model_topology",EP="weight_specs",SP="weight_data",CP="model_metadata";function IP(e){return{info:[xP,e,wP].join(bP),topology:[xP,e,kP].join(bP),weightSpecs:[xP,e,EP].join(bP),weightData:[xP,e,SP].join(bP),modelMetadata:[xP,e,CP].join(bP)}}function TP(e){var t=e.split(bP);if(t.length<3)throw new Error("Invalid key format: "+e);return t.slice(1,t.length-1).join(bP)}var NP=function(){function e(e){if(!WE().getBool("IS_BROWSER")||"undefined"==typeof window||void 0===window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==e||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=IP(this.modelPath)}return e.prototype.save=function(e){return BE(this,void 0,void 0,(function(){var t,n,r;return VE(this,(function(a){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");t=JSON.stringify(e.modelTopology),n=JSON.stringify(e.weightSpecs),r=oP(e);try{return this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,n),this.LS.setItem(this.keys.weightData,function(e){if(nP)return Buffer.from(e).toString("base64");for(var t=new Uint8Array(e),n="",r=0,a=t.length;r<a;r++)n+=String.fromCharCode(t[r]);return btoa(n)}(e.weightData)),this.LS.setItem(this.keys.modelMetadata,JSON.stringify({format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata})),[2,{modelArtifactsInfo:r}]}catch(e){throw this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '"+this.modelPath+"' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes="+r.modelTopologyBytes+", weightSpecsBytes="+r.weightSpecsBytes+", weightDataBytes="+r.weightDataBytes+".")}return[2]}))}))},e.prototype.load=function(){return BE(this,void 0,void 0,(function(){var e,t,n,r,a,i,o;return VE(this,(function(s){if(null==(e=JSON.parse(this.LS.getItem(this.keys.info))))throw new Error("In local storage, there is no model with name '"+this.modelPath+"'");if("JSON"!==e.modelTopologyType)throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");if(t={},null==(n=JSON.parse(this.LS.getItem(this.keys.topology))))throw new Error("In local storage, the topology of model '"+this.modelPath+"' is missing.");if(t.modelTopology=n,null==(r=JSON.parse(this.LS.getItem(this.keys.weightSpecs))))throw new Error("In local storage, the weight specs of model '"+this.modelPath+"' are missing.");if(t.weightSpecs=r,null!=(a=this.LS.getItem(this.keys.modelMetadata))&&(i=JSON.parse(a),t.format=i.format,t.generatedBy=i.generatedBy,t.convertedBy=i.convertedBy,t.userDefinedMetadata=i.userDefinedMetadata),null==(o=this.LS.getItem(this.keys.weightData)))throw new Error("In local storage, the binary weight values of model '"+this.modelPath+"' are missing.");return t.weightData=function(e){if(nP){var t=Buffer.from(e,"base64");return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}for(var n=atob(e),r=new Uint8Array(n.length),a=0;a<n.length;++a)r.set([n.charCodeAt(a)],a);return r.buffer}(o),[2,t]}))}))},e.URL_SCHEME="localstorage://",e}(),_P=function(e){return WE().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(NP.URL_SCHEME)?(t=e.slice(NP.URL_SCHEME.length),new NP(t)):null;var t};sP.registerSaveRouter(_P),sP.registerLoadRouter(_P);var RP=function(){function e(){nS(WE().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),nS("undefined"==typeof window||void 0!==window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return e.prototype.listModels=function(){return BE(this,void 0,void 0,(function(){var e,t,n,r,a,i;return VE(this,(function(o){for(e={},t=xP+bP,n=bP+wP,r=0;r<this.LS.length;++r)(a=this.LS.key(r)).startsWith(t)&&a.endsWith(n)&&(i=TP(a),e[i]=JSON.parse(this.LS.getItem(a)));return[2,e]}))}))},e.prototype.removeModel=function(e){return BE(this,void 0,void 0,(function(){var t,n;return VE(this,(function(r){var a;if(e=(a=e).startsWith(NP.URL_SCHEME)?a.slice(NP.URL_SCHEME.length):a,t=IP(e),null==this.LS.getItem(t.info))throw new Error("Cannot find model at path '"+e+"'");return n=JSON.parse(this.LS.getItem(t.info)),this.LS.removeItem(t.info),this.LS.removeItem(t.topology),this.LS.removeItem(t.weightSpecs),this.LS.removeItem(t.weightData),[2,n]}))}))},e}();if(WE().getBool("IS_BROWSER"))try{cP.registerManager(NP.URL_SCHEME,new RP)}catch(ki){}function AP(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var DP=function(){function e(t){if(!WE().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return e.prototype.save=function(e){return BE(this,void 0,void 0,(function(){var t,n,r,a,i,o;return VE(this,(function(s){switch(s.label){case 0:if("undefined"==typeof document)throw new Error("Browser downloads are not supported in this environment since `document` is not present");if(t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"})),!(e.modelTopology instanceof ArrayBuffer))return[3,1];throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 1:return n=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,weightsManifest:n},a=window.URL.createObjectURL(new Blob([JSON.stringify(r)],{type:"application/json"})),(i=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,i.href=a,[4,AP((function(){return i.dispatchEvent(new MouseEvent("click"))}))];case 2:return s.sent(),null==e.weightData?[3,4]:((o=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,o.href=t,[4,AP((function(){return o.dispatchEvent(new MouseEvent("click"))}))]);case 3:s.sent(),s.label=4;case 4:return[2,{modelArtifactsInfo:oP(e)}]}}))}))},e.URL_SCHEME="downloads://",e}(),OP=function(){function e(e){if(null==e||e.length<1)throw new Error("When calling browserFiles, at least 1 file is required, but received "+e);this.files=e}return e.prototype.load=function(){return BE(this,void 0,void 0,(function(){var e,t,n=this;return VE(this,(function(r){return e=this.files[0],t=this.files.slice(1),[2,new Promise((function(r,a){var i=new FileReader;i.onload=function(i){var o=JSON.parse(i.target.result),s=o.modelTopology;if(null!=s){0===t.length&&r({modelTopology:s});var u=o.weightsManifest;if(null!=u){var c;try{c=n.checkManifestAndWeightFiles(u,t)}catch(e){return void a(e)}var l=[],f=[],h=[];u.forEach((function(e){e.paths.forEach((function(e){f.push(e),h.push(null)})),l.push.apply(l,e.weights)})),u.forEach((function(e){e.paths.forEach((function(e){var t=new FileReader;t.onload=function(t){var n=t.target.result,a=f.indexOf(e);h[a]=n,-1===h.indexOf(null)&&r({modelTopology:s,weightSpecs:l,weightData:aP(h),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy,userDefinedMetadata:o.userDefinedMetadata})},t.onerror=function(t){return a("Failed to weights data from file of path '"+e+"'.")},t.readAsArrayBuffer(c[e])}))}))}else a(new Error("weightManifest field is missing from file "+e.name))}else a(new Error("modelTopology field is missing from file "+e.name))},i.onerror=function(t){return a("Failed to read model topology and weights manifest JSON from file '"+e.name+"'. BrowserFiles supports loading Keras-style tf.Model artifacts only.")},i.readAsText(e)}))]}))}))},e.prototype.checkManifestAndWeightFiles=function(e,t){for(var n=[],r=t.map((function(e){return iP(e.name)})),a={},i=0,o=e;i<o.length;i++)o[i].paths.forEach((function(e){var i=iP(e);if(-1!==n.indexOf(i))throw new Error("Duplicate file basename found in weights manifest: '"+i+"'");if(n.push(i),-1===r.indexOf(i))throw new Error("Weight file with basename '"+i+"' is not provided.");a[e]=t[r.indexOf(i)]}));if(n.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest ("+n.length+") and the number of weight files provided ("+t.length+").");return a},e}();function MP(e,t,n,r){!function(e){nS(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){nS(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but got startFraction "+e})),nS(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but got endFraction "+t})),nS(t>=e,(function(){return"startFraction must be no more than endFraction, but got startFraction "+e+" and endFraction "+t}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}function FP(e,t){return BE(this,void 0,void 0,(function(){var n,r,a,i,o,s,u,c,l;return VE(this,(function(f){switch(f.label){case 0:return null==t&&(t={}),n=null==t.fetchFunc?WE().platform.fetch:t.fetchFunc,r=e.map((function(e){return n(e,t.requestInit,{isBinary:!0})})),a=0,i=.5,null!=t.onProgress?[3,2]:[4,Promise.all(r)];case 1:return o=f.sent(),[3,4];case 2:return[4,MP(r,t.onProgress,a,i)];case 3:o=f.sent(),f.label=4;case 4:return s=o.map((function(e){return e.arrayBuffer()})),u=.5,c=1,null!=t.onProgress?[3,6]:[4,Promise.all(s)];case 5:return l=f.sent(),[3,8];case 6:return[4,MP(s,t.onProgress,u,c)];case 7:l=f.sent(),f.label=8;case 8:return[2,l]}}))}))}function PP(e){var t=this;return function(n,r,a){return void 0===r&&(r=""),BE(t,void 0,void 0,(function(){var t,i,o,s,u,c,l,f,h,p;return VE(this,(function(d){switch(d.label){case 0:if(t=n.map((function(){return!1})),i={},o=null!=a?a.map((function(){return!1})):[],s=[],n.forEach((function(e,n){var r=0;e.weights.forEach((function(e){var u="quantization"in e?e.quantization.dtype:e.dtype,c=ZF[u]*oS(e.shape),l=function(){t[n]=!0,null==i[n]&&(i[n]=[]),i[n].push({manifestEntry:e,groupOffset:r,sizeBytes:c})};null!=a?a.forEach((function(t,n){t===e.name&&(l(),o[n]=!0)})):l(),s.push(e.name),r+=c}))})),!o.every((function(e){return e})))throw u=a.filter((function(e,t){return!o[t]})),new Error("Could not find weights in manifest with names: "+u.join(", ")+". \nManifest JSON has weights with names: "+s.join(", ")+".");return c=t.reduce((function(e,t,n){return t&&e.push(n),e}),[]),l=[],c.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;l.push(t)}))})),[4,e(l)];case 1:return f=d.sent(),h={},p=0,c.forEach((function(e){for(var t=n[e].paths.length,r=0,a=0;a<t;a++)r+=f[p+a].byteLength;for(var o=new ArrayBuffer(r),s=new Uint8Array(o),u=0,c=0;c<t;c++){var l=new Uint8Array(f[p+c]);s.set(l,u),u+=l.byteLength}i[e].forEach((function(e){var t=eP(o.slice(e.groupOffset,e.groupOffset+e.sizeBytes),[e.manifestEntry]);for(var n in t)h[n]=t[n]})),p+=t})),[2,h]}}))}))}}sP.registerSaveRouter((function(e){return WE().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(DP.URL_SCHEME)?function(e){return void 0===e&&(e="model"),new DP(e)}(e.slice(DP.URL_SCHEME.length)):null}));var LP=function(){function e(e,t){if(this.DEFAULT_METHOD="POST",null==t&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,null!=t.fetchFunc?(nS("function"==typeof t.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=t.fetchFunc):this.fetch=WE().platform.fetch,nS(null!=e&&e.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(e)&&nS(2===e.length,(function(){return"URL paths for http must have a length of 2, (actual length is "+e.length+")."})),this.path=e,null!=t.requestInit&&null!=t.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}return e.prototype.save=function(e){return BE(this,void 0,void 0,(function(){var t,n,r,a;return VE(this,(function(i){switch(i.label){case 0:if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");return(t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,n=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r={modelTopology:e.modelTopology,format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,userDefinedMetadata:e.userDefinedMetadata,weightsManifest:n},t.body.append("model.json",new Blob([JSON.stringify(r)],{type:"application/json"}),"model.json"),null!=e.weightData&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:"application/octet-stream"}),"model.weights.bin"),[4,this.fetch(this.path,t)];case 1:if((a=i.sent()).ok)return[2,{modelArtifactsInfo:oP(e),responses:[a]}];throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+a.status+".")}}))}))},e.prototype.load=function(){return BE(this,void 0,void 0,(function(){var e,t,n,r,a,i,o,s,u,c,l,f;return VE(this,(function(h){switch(h.label){case 0:return[4,this.fetch(this.path,this.requestInit)];case 1:if(!(e=h.sent()).ok)throw new Error("Request to "+this.path+" failed with status code "+e.status+". Please verify this URL points to the model JSON of the model to load.");h.label=2;case 2:return h.trys.push([2,4,,5]),[4,e.json()];case 3:return t=h.sent(),[3,5];case 4:throw h.sent(),n="Failed to parse model JSON of response from "+this.path+".",this.path.endsWith(".pb")?n+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":n+=" Please make sure the server is serving valid JSON for this request.",new Error(n);case 5:if(r=t.modelTopology,a=t.weightsManifest,i=t.generatedBy,o=t.convertedBy,s=t.format,u=t.userDefinedMetadata,null==r&&null==a)throw new Error("The JSON from HTTP path "+this.path+" contains neither model topology or manifest for weights.");return null==a?[3,7]:[4,this.loadWeights(a)];case 6:f=h.sent(),c=f[0],l=f[1],h.label=7;case 7:return[2,{modelTopology:r,weightSpecs:c,weightData:l,userDefinedMetadata:u,generatedBy:i,convertedBy:o,format:s}]}}))}))},e.prototype.loadWeights=function(e){return BE(this,void 0,void 0,(function(){var t,n,r,a,i,o,s,u,c,l,f;return VE(this,(function(h){switch(h.label){case 0:for(t=Array.isArray(this.path)?this.path[1]:this.path,n=function(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}(t),r=n[0],a=n[1],i=this.weightPathPrefix||r,o=[],s=0,u=e;s<u.length;s++)c=u[s],o.push.apply(o,c.weights);return l=[],e.forEach((function(e){e.paths.forEach((function(e){l.push(i+e+a)}))})),[4,FP(l,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress})];case 1:return f=h.sent(),[2,[o,aP(f)]]}}))}))},e.URL_SCHEME_REGEX=/^https?:\/\//,e}();function BP(e){return null!=e.match(LP.URL_SCHEME_REGEX)}var VP=function(e,t){return"undefined"==typeof fetch?null:(Array.isArray(e)?e.every((function(e){return BP(e)})):BP(e))?zP(e,{onProgress:t}):null};function zP(e,t){return new LP(e,t)}sP.registerSaveRouter(VP),sP.registerLoadRouter(VP);var UP,WP=function(){function e(e){this.modelArtifacts=e}return e.prototype.load=function(){return BE(this,void 0,void 0,(function(){return VE(this,(function(e){return[2,this.modelArtifacts]}))}))},e}(),jP=function(){function e(e){this.saveHandler=e}return e.prototype.save=function(e){return BE(this,void 0,void 0,(function(){return VE(this,(function(t){return[2,this.saveHandler(e)]}))}))},e}(),GP=Object.freeze({browserFiles:function(e){return new OP(e)},browserHTTPRequest:function(e,t){return zP(e,t)},concatenateArrayBuffers:aP,decodeWeights:eP,encodeWeights:function(e,t){return BE(this,void 0,void 0,(function(){var n,r,a,i,o,s=this;return VE(this,(function(u){switch(u.label){case 0:for(n=[],r=[],a=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e),i=function(i){var o=a[i],u=Array.isArray(e)?e[i].tensor:e[o];if("float32"!==u.dtype&&"int32"!==u.dtype&&"bool"!==u.dtype&&"string"!==u.dtype)throw new Error("Unsupported dtype in weight '"+o+"': "+u.dtype);var c={name:o,shape:u.shape,dtype:u.dtype};if("string"===u.dtype){var l=new Promise((function(e){return BE(s,void 0,void 0,(function(){var t,n,r,a,i,o,s;return VE(this,(function(c){switch(c.label){case 0:return[4,u.bytes()];case 1:for(t=c.sent(),n=t.reduce((function(e,t){return e+t.length}),0)+4*t.length,r=new Uint8Array(n),a=0,i=0;i<t.length;i++)o=t[i],s=new Uint8Array(new Uint32Array([o.length]).buffer),r.set(s,a),a+=4,r.set(o,a),a+=o.length;return e(r),[2]}}))}))}));r.push(l)}else r.push(u.data());null!=t&&(c.group=t),n.push(c)},o=0;o<a.length;++o)i(o);return[4,Promise.all(r)];case 1:return[2,{data:tP(u.sent()),specs:n}]}}))}))},fromMemory:function(e,t,n,r){return 1===arguments.length?null!=e.modelTopology||null!=e.weightSpecs?new WP(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new WP({modelTopology:e})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new WP({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r}))},getLoadHandlers:function(e,t){return sP.getLoadHandlers(e,t)},getModelArtifactsInfoForJSON:oP,getSaveHandlers:function(e){return sP.getSaveHandlers(e)},http:zP,isHTTPScheme:BP,loadWeights:function(e,t,n,r){return void 0===t&&(t=""),BE(this,void 0,void 0,(function(){return VE(this,(function(a){return[2,PP((function(e){return FP(e,{requestInit:r})}))(e,t,n)]}))}))},registerLoadRouter:function(e){return sP.registerLoadRouter(e)},registerSaveRouter:function(e){return sP.registerSaveRouter(e)},weightsLoaderFactory:PP,withSaveHandler:function(e){return new jP(e)},copyModel:function(e,t){return BE(this,void 0,void 0,(function(){return VE(this,(function(n){return[2,fP(e,t,!1)]}))}))},listModels:function(){return BE(this,void 0,void 0,(function(){var e,t,n,r,a,i,o;return VE(this,(function(s){switch(s.label){case 0:e=cP.getSchemes(),t={},n=0,r=e,s.label=1;case 1:return n<r.length?(a=r[n],[4,cP.getManager(a).listModels()]):[3,4];case 2:for(o in i=s.sent())t[a+uP+o]=i[o];s.label=3;case 3:return n++,[3,1];case 4:return[2,t]}}))}))},moveModel:function(e,t){return BE(this,void 0,void 0,(function(){return VE(this,(function(n){return[2,fP(e,t,!0)]}))}))},removeModel:function(e){return BE(this,void 0,void 0,(function(){var t;return VE(this,(function(n){return t=lP(e),[2,cP.getManager(t.scheme).removeModel(t.path)]}))}))}}),HP=PI({confusionMatrix_:function(e,t,n){var r=SI(e,"labels","confusionMatrix"),a=SI(t,"predictions","confusionMatrix");nS(null==n||n>0&&Number.isInteger(n),(function(){return"If provided, numClasses must be a positive integer, but got "+n})),nS(1===r.rank,(function(){return"Expected the rank of labels to be 1, but got "+r.rank})),nS(1===a.rank,(function(){return"Expected the rank of predictions to be 1, but got "+a.rank})),nS(r.shape[0]===a.shape[0],(function(){return"Mismatch in the number of examples: "+r.shape[0]+" vs. "+a.shape[0]+". Labels and predictions should have the same number of elements."})),nS(n>0&&Number.isInteger(n),(function(){return"numClasses is required to be a positive integer, but got "+n}));var i=GD(r.asType("int32"),n),o=GD(a.asType("int32"),n);return i.transpose().matMul(o).asType("int32")}}),qP=(Object.freeze({confusionMatrix:HP}),PI({fromPixels_:function(e,t){if(void 0===t&&(t=3),t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!=typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!=typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else{if(null==e.getContext)throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was "+e.constructor.name);o=!0}if(a&&a&&e.readyState<2)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.");if(null!=qE("FromPixels",pC.backendName))return pC.runKernel("FromPixels",{pixels:e},{numChannels:t});var s,u,c=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],l=c[0],f=c[1];if(o?s=e.getContext("2d").getImageData(0,0,l,f).data:r||n?s=e.data:(i||a)&&(null==UP&&(UP=document.createElement("canvas").getContext("2d")),UP.canvas.width=l,UP.canvas.height=f,UP.drawImage(e,0,0,l,f),s=UP.getImageData(0,0,l,f).data),4===t)u=new Int32Array(s);else{var h=l*f;u=new Int32Array(h*t);for(var p=0;p<h;p++)for(var d=0;d<t;++d)u[p*t+d]=s[4*p+d]}return HI(u,[f,l,t],"int32")}})),KP=(Object.freeze({toPixels:function(e,t){return BE(this,void 0,void 0,(function(){var n,r,a,i,o,s,u,c,l,f,h,p,d,v,m,y,g,b,x,w,k,E,S;return VE(this,(function(C){switch(C.label){case 0:if(n=SI(e,"img","toPixels"),e instanceof YS||(n=n.toInt()),2!==n.rank&&3!==n.rank)throw new Error("toPixels only supports rank 2 or 3 tensors, got rank "+n.rank+".");if(r=n.shape.slice(0,2),a=r[0],i=r[1],(o=2===n.rank?1:n.shape[2])>4||2===o)throw new Error("toPixels only supports depth of size 1, 3 or 4 but got "+o);return[4,n.data()];case 1:return s=C.sent(),u=n.min(),c=n.max(),[4,Promise.all([u.data(),c.data()])];case 2:if(l=C.sent(),f=l[0],h=l[1],p=f[0],d=h[0],u.dispose(),c.dispose(),"float32"===n.dtype){if(p<0||d>1)throw new Error("Tensor values for a float32 Tensor must be in the range [0 - 1] but got range ["+p+" - "+d+"].")}else{if("int32"!==n.dtype)throw new Error("Unsupported type for toPixels: "+n.dtype+". Please use float32 or int32 tensors.");if(p<0||d>255)throw new Error("Tensor values for a int32 Tensor must be in the range [0 - 255] but got range ["+p+" - "+d+"].")}for(v="float32"===n.dtype?255:1,m=new Uint8ClampedArray(i*a*4),y=0;y<a*i;++y)g=void 0,b=void 0,x=void 0,w=void 0,1===o?(g=s[y]*v,b=s[y]*v,x=s[y]*v,w=255):3===o?(g=s[3*y]*v,b=s[3*y+1]*v,x=s[3*y+2]*v,w=255):4===o&&(g=s[4*y]*v,b=s[4*y+1]*v,x=s[4*y+2]*v,w=s[4*y+3]*v),m[0+(k=4*y)]=Math.round(g),m[k+1]=Math.round(b),m[k+2]=Math.round(x),m[k+3]=Math.round(w);return null!=t&&(t.width=i,t.height=a,E=t.getContext("2d"),S=new ImageData(m,i,a),E.putImageData(S,0,0)),n!==e&&n.dispose(),[2,m]}}))}))},fromPixels:qP}),function(){function e(){}return e.prototype.getClassName=function(){return this.constructor.className},e.fromConfig=function(e,t){return new e(t)},e}()),XP=function(){function e(){this.classNameMap={}}return e.getMap=function(){return null==e.instance&&(e.instance=new e),e.instance},e.register=function(t){e.getMap().classNameMap[t.className]=[t,t.fromConfig]},e}();function $P(e){nS(null!=e.className,(function(){return"Class being registered does not have the static className property defined."})),nS("string"==typeof e.className,(function(){return"className is required to be a string, but got type "+typeof e.className})),nS(e.className.length>0,(function(){return"Class being registered has an empty-string as its className, which is disallowed."})),XP.register(e)}Object.freeze({Serializable:KP,SerializationMap:XP,registerClass:$P}),Object.freeze({gpgpu_util:nA,webgl_util:mI,forceHalfFloat:function(){WE().set("WEBGL_FORCE_F16_TEXTURES",!0)},MathBackendWebGL:oD,setWebGLContext:wC,GPGPUContext:rA});var QP=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return LE(t,e),t.prototype.minimize=function(e,t,n){void 0===t&&(t=!1);var r=this.computeGradients(e,n),a=r.value,i=r.grads;if(null!=n){var o=n.map((function(e){return{name:e.name,tensor:i[e.name]}}));this.applyGradients(o)}else this.applyGradients(i);return xI(i),t?a:(a.dispose(),null)},Object.defineProperty(t.prototype,"iterations",{get:function(){return null==this.iterations_&&(this.iterations_=0),this.iterations_},enumerable:!0,configurable:!0}),t.prototype.incrementIterations=function(){this.iterations_=this.iterations+1},t.prototype.computeGradients=function(e,t){return function(e,t){nS(NS(e),(function(){return"The f passed in variableGrads(f) must be a function"})),nS(null==t||Array.isArray(t)&&t.every((function(e){return e instanceof rC})),(function(){return"The varList passed in variableGrads(f, varList) must be an array of variables"}));var n=null!=t;if(!n)for(var r in t=[],pC.registeredVariables)t.push(pC.registeredVariables[r]);var a=n?t.filter((function(e){return!e.trainable})):null,i=t.length;nS((t=t.filter((function(e){return e.trainable}))).length>0,(function(){return"variableGrads() expects at least one of the input variables to be trainable, but none of the "+i+" variables is trainable."}));var o=pC.gradients(e,t,null,!0),s=o.value,u=o.grads;nS(u.some((function(e){return null!=e})),(function(){return"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."})),nS(0===s.rank,(function(){return"The f passed in variableGrads(f) must return a scalar, but it returned a rank-"+s.rank+" tensor"}));var c={};return t.forEach((function(e,t){null!=u[t]&&(c[e.name]=u[t])})),null!=a&&a.forEach((function(e){return c[e.name]=null})),{value:s,grads:c}}(e,t)},t.prototype.dispose=function(){null!=this.iterations_&&xI(this.iterations_)},t.prototype.saveIterations=function(){return BE(this,void 0,void 0,(function(){return VE(this,(function(e){return null==this.iterations_&&(this.iterations_=0),[2,{name:"iter",tensor:WI(this.iterations_,"int32")}]}))}))},t.prototype.getWeights=function(){return BE(this,void 0,void 0,(function(){return VE(this,(function(e){throw new Error("getWeights() is not implemented for this optimizer yet.")}))}))},t.prototype.setWeights=function(e){return BE(this,void 0,void 0,(function(){return VE(this,(function(e){throw new Error("setWeights() is not implemented for this optimizer class "+this.getClassName())}))}))},t.prototype.extractIterations=function(e){return BE(this,void 0,void 0,(function(){var t;return VE(this,(function(n){switch(n.label){case 0:return t=this,[4,e[0].tensor.data()];case 1:return t.iterations_=n.sent()[0],[2,e.slice(1)]}}))}))},t}(KP);Object.defineProperty(QP,Symbol.hasInstance,{value:function(e){return null!=e.minimize&&null!=e.computeGradients&&null!=e.applyGradients}});var YP=function(e){function t(t,n,r){void 0===r&&(r=null);var a=e.call(this)||this;return a.learningRate=t,a.rho=n,a.epsilon=r,a.accumulatedGrads=[],a.accumulatedUpdates=[],null==r&&(a.epsilon=pC.backend.epsilon()),a}return LE(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=pC.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accum_grad",variable:bI((function(){return ZI(a).variable(!1)}))}),null==t.accumulatedUpdates[r]&&(t.accumulatedUpdates[r]={originalName:n+"/accum_var",variable:bI((function(){return ZI(a).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable,s=t.accumulatedUpdates[r].variable;bI((function(){var e=o.mul(t.rho).add(i.square().mul(1-t.rho)),n=s.add(t.epsilon).sqrt().div(o.add(t.epsilon).sqrt()).mul(i),r=s.mul(t.rho).add(n.square().mul(1-t.rho));o.assign(e),s.assign(r);var u=n.mul(-t.learningRate).add(a);a.assign(u)}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedUpdates&&(xI(this.accumulatedGrads.map((function(e){return e.variable}))),xI(this.accumulatedUpdates.map((function(e){return e.variable}))))},t.prototype.getWeights=function(){return BE(this,void 0,void 0,(function(){var e;return VE(this,(function(t){switch(t.label){case 0:return e=this.accumulatedGrads.concat(this.accumulatedUpdates),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return BE(this,void 0,void 0,(function(){var t;return VE(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=e.length/2,this.accumulatedGrads=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedUpdates=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.rho,t.epsilon)},t.className="Adadelta",t}(QP);$P(YP);var JP=function(e){function t(t,n){void 0===n&&(n=.1);var r=e.call(this)||this;return r.learningRate=t,r.initialAccumulatorValue=n,r.accumulatedGrads=[],r}return LE(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=pC.registeredVariables[n];null==t.accumulatedGrads[r]&&(t.accumulatedGrads[r]={originalName:n+"/accumulator",variable:bI((function(){return $I(a.shape,t.initialAccumulatorValue).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedGrads[r].variable;bI((function(){var e=o.add(i.square());o.assign(e);var n=i.div(e.add(pC.backend.epsilon()).sqrt()).mul(-t.learningRate).add(a);a.assign(n)}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedGrads&&xI(this.accumulatedGrads.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return BE(this,void 0,void 0,(function(){return VE(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulatedGrads.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return BE(this,void 0,void 0,(function(){return VE(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulatedGrads=e.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}},t.fromConfig=function(e,t){return new e(t.learningRate,t.initialAccumulatorValue)},t.className="Adagrad",t}(QP);$P(JP);var ZP=function(e){function t(t,n,r,a){void 0===a&&(a=null);var i=e.call(this)||this;return i.learningRate=t,i.beta1=n,i.beta2=r,i.epsilon=a,i.accumulatedFirstMoment=[],i.accumulatedSecondMoment=[],bI((function(){i.accBeta1=WI(n).variable(),i.accBeta2=WI(r).variable()})),null==a&&(i.epsilon=pC.backend.epsilon()),i}return LE(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);bI((function(){var r=_N(1,t.accBeta1),a=_N(1,t.accBeta2);n.forEach((function(n,i){var o=pC.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:bI((function(){return ZI(o).variable(!1)}))}),null==t.accumulatedSecondMoment[i]&&(t.accumulatedSecondMoment[i]={originalName:n+"/v",variable:bI((function(){return ZI(o).variable(!1)}))});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedSecondMoment[i].variable,l=u.mul(t.beta1).add(s.mul(1-t.beta1)),f=c.mul(t.beta2).add(s.square().mul(1-t.beta2)),h=l.div(r),p=f.div(a);u.assign(l),c.assign(f);var d=h.div(p.sqrt().add(t.epsilon)).mul(-t.learningRate).add(o);o.assign(d)}})),t.accBeta1.assign(t.accBeta1.mul(t.beta1)),t.accBeta2.assign(t.accBeta2.mul(t.beta2))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.accBeta2.dispose(),null!=this.accumulatedFirstMoment&&xI(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedSecondMoment&&xI(this.accumulatedSecondMoment.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return BE(this,void 0,void 0,(function(){var e;return VE(this,(function(t){switch(t.label){case 0:return e=this.accumulatedFirstMoment.concat(this.accumulatedSecondMoment),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return BE(this,void 0,void 0,(function(){var t,n=this;return VE(this,(function(r){switch(r.label){case 0:return[4,this.extractIterations(e)];case 1:return e=r.sent(),bI((function(){n.accBeta1.assign(IN(n.beta1,n.iterations_+1)),n.accBeta2.assign(IN(n.beta2,n.iterations_+1))})),t=e.length/2,this.accumulatedFirstMoment=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedSecondMoment=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon)},t.className="Adam",t}(QP);$P(ZP);var eL=function(e){function t(t,n,r,a,i){void 0===a&&(a=null),void 0===i&&(i=0);var o=e.call(this)||this;return o.learningRate=t,o.beta1=n,o.beta2=r,o.epsilon=a,o.decay=i,o.accumulatedFirstMoment=[],o.accumulatedWeightedInfNorm=[],bI((function(){o.iteration=WI(0).variable(),o.accBeta1=WI(n).variable()})),null==a&&(o.epsilon=pC.backend.epsilon()),o}return LE(t,e),t.prototype.applyGradients=function(e){var t=this,n=Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e);bI((function(){var r=_N(1,t.accBeta1),a=AN(-t.learningRate,t.iteration.mul(t.decay).add(1));n.forEach((function(n,i){var o=pC.registeredVariables[n];null==t.accumulatedFirstMoment[i]&&(t.accumulatedFirstMoment[i]={originalName:n+"/m",variable:ZI(o).variable(!1)}),null==t.accumulatedWeightedInfNorm[i]&&(t.accumulatedWeightedInfNorm[i]={originalName:n+"/v",variable:ZI(o).variable(!1)});var s=Array.isArray(e)?e[i].tensor:e[n];if(null!=s){var u=t.accumulatedFirstMoment[i].variable,c=t.accumulatedWeightedInfNorm[i].variable,l=u.mul(t.beta1).add(s.mul(1-t.beta1)),f=c.mul(t.beta2),h=s.abs(),p=f.maximum(h);u.assign(l),c.assign(p);var d=a.div(r).mul(l.div(p.add(t.epsilon))).add(o);o.assign(d)}})),t.iteration.assign(t.iteration.add(1)),t.accBeta1.assign(t.accBeta1.mul(t.beta1))})),this.incrementIterations()},t.prototype.dispose=function(){this.accBeta1.dispose(),this.iteration.dispose(),null!=this.accumulatedFirstMoment&&xI(this.accumulatedFirstMoment.map((function(e){return e.variable}))),null!=this.accumulatedWeightedInfNorm&&xI(this.accumulatedWeightedInfNorm.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return BE(this,void 0,void 0,(function(){return VE(this,(function(e){throw new Error("getWeights() is not implemented for Adamax yet.")}))}))},t.prototype.setWeights=function(e){return BE(this,void 0,void 0,(function(){return VE(this,(function(e){throw new Error("setWeights() is not implemented for Adamax yet.")}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}},t.fromConfig=function(e,t){return new e(t.learningRate,t.beta1,t.beta2,t.epsilon,t.decay)},t.className="Adamax",t}(QP);$P(eL);var tL=function(e){function t(t){var n=e.call(this)||this;return n.learningRate=t,n.setLearningRate(t),n}return LE(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=Array.isArray(e)?e[r].tensor:e[n];if(null!=a){var i=pC.registeredVariables[n];bI((function(){var e=t.c.mul(a).add(i);i.assign(e)}))}})),this.incrementIterations()},t.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=function(e){return pC.keep(e)}(WI(-e))},t.prototype.dispose=function(){this.c.dispose()},t.prototype.getWeights=function(){return BE(this,void 0,void 0,(function(){return VE(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()]]}}))}))},t.prototype.setWeights=function(e){return BE(this,void 0,void 0,(function(){return VE(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:if(0!==(e=t.sent()).length)throw new Error("SGD optimizer does not have settable weights.");return[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate}},t.fromConfig=function(e,t){return new e(t.learningRate)},t.className="SGD",t}(QP);$P(tL);var nL=function(e){function t(t,n,r){void 0===r&&(r=!1);var a=e.call(this,t)||this;return a.learningRate=t,a.momentum=n,a.useNesterov=r,a.accumulations=[],a.m=WI(a.momentum),a}return LE(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=pC.registeredVariables[n];null==t.accumulations[r]&&(t.accumulations[r]={originalName:n+"/momentum",variable:bI((function(){return ZI(a).variable(!1)}))});var i=t.accumulations[r].variable,o=Array.isArray(e)?e[r].tensor:e[n];null!=o&&bI((function(){var e,n=t.m.mul(i).add(o);e=t.useNesterov?t.c.mul(o.add(n.mul(t.m))).add(a):t.c.mul(n).add(a),i.assign(n),a.assign(e)}))})),this.incrementIterations()},t.prototype.dispose=function(){this.m.dispose(),null!=this.accumulations&&xI(this.accumulations.map((function(e){return e.variable})))},t.prototype.setMomentum=function(e){this.momentum=e},t.prototype.getWeights=function(){return BE(this,void 0,void 0,(function(){return VE(this,(function(e){switch(e.label){case 0:return[4,this.saveIterations()];case 1:return[2,[e.sent()].concat(this.accumulations.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return BE(this,void 0,void 0,(function(){return VE(this,(function(t){switch(t.label){case 0:return[4,this.extractIterations(e)];case 1:return e=t.sent(),this.accumulations=e.map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}},t.fromConfig=function(e,t){return new e(t.learningRate,t.momentum,t.useNesterov)},t.className="Momentum",t}(tL);$P(nL);var rL=function(e){function t(t,n,r,a,i){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===a&&(a=null),void 0===i&&(i=!1);var o=e.call(this)||this;if(o.learningRate=t,o.decay=n,o.momentum=r,o.epsilon=a,o.accumulatedMeanSquares=[],o.accumulatedMoments=[],o.accumulatedMeanGrads=[],o.centered=i,null==a&&(o.epsilon=pC.backend.epsilon()),null==t)throw new Error("learningRate for RMSPropOptimizer must be defined.");return o}return LE(t,e),t.prototype.applyGradients=function(e){var t=this;(Array.isArray(e)?e.map((function(e){return e.name})):Object.keys(e)).forEach((function(n,r){var a=pC.registeredVariables[n];null==t.accumulatedMeanSquares[r]&&(t.accumulatedMeanSquares[r]={originalName:n+"/rms",variable:bI((function(){return ZI(a).variable(!1)}))}),null==t.accumulatedMoments[r]&&(t.accumulatedMoments[r]={originalName:n+"/momentum",variable:bI((function(){return ZI(a).variable(!1)}))}),null==t.accumulatedMeanGrads[r]&&t.centered&&(t.accumulatedMeanGrads[r]={originalName:n+"/mg",variable:bI((function(){return ZI(a).variable(!1)}))});var i=Array.isArray(e)?e[r].tensor:e[n];if(null!=i){var o=t.accumulatedMeanSquares[r].variable,s=t.accumulatedMoments[r].variable;bI((function(){var e=o.mul(t.decay).add(i.square().mul(1-t.decay));if(t.centered){var n=t.accumulatedMeanGrads[r].variable,u=n.mul(t.decay).add(i.mul(1-t.decay)),c=s.mul(t.momentum).add(i.mul(t.learningRate).div(e.sub(u.square().add(t.epsilon)).sqrt()));o.assign(e),n.assign(u),s.assign(c);var l=a.sub(c);a.assign(l)}else{var f=o.mul(t.decay).add(i.square().mul(1-t.decay));c=s.mul(t.momentum).add(i.mul(t.learningRate).div(f.add(t.epsilon).sqrt())),o.assign(f),s.assign(c),l=a.sub(c),a.assign(l)}}))}})),this.incrementIterations()},t.prototype.dispose=function(){null!=this.accumulatedMeanSquares&&xI(this.accumulatedMeanSquares.map((function(e){return e.variable}))),null!=this.accumulatedMeanGrads&&this.centered&&xI(this.accumulatedMeanGrads.map((function(e){return e.variable}))),null!=this.accumulatedMoments&&xI(this.accumulatedMoments.map((function(e){return e.variable})))},t.prototype.getWeights=function(){return BE(this,void 0,void 0,(function(){var e;return VE(this,(function(t){switch(t.label){case 0:return e=this.accumulatedMeanSquares.concat(this.accumulatedMoments),this.centered&&e.push.apply(e,this.accumulatedMeanGrads),[4,this.saveIterations()];case 1:return[2,[t.sent()].concat(e.map((function(e){return{name:e.originalName,tensor:e.variable}})))]}}))}))},t.prototype.setWeights=function(e){return BE(this,void 0,void 0,(function(){var t;return VE(this,(function(n){switch(n.label){case 0:return[4,this.extractIterations(e)];case 1:return e=n.sent(),t=this.centered?e.length/3:e.length/2,this.accumulatedMeanSquares=e.slice(0,t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.accumulatedMoments=e.slice(t,2*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}})),this.centered&&(this.accumulatedMeanGrads=e.slice(2*t,3*t).map((function(e){return{originalName:e.name,variable:e.tensor.variable(!1)}}))),[2]}}))}))},t.prototype.getConfig=function(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}},t.fromConfig=function(e,t){return new e(t.learningRate,t.decay,t.momentum,t.epsilon,t.centered)},t.className="RMSProp",t}(QP);$P(rL);var aL=function(){function e(){}return e.sgd=function(e){return new tL(e)},e.momentum=function(e,t,n){return void 0===n&&(n=!1),new nL(e,t,n)},e.rmsprop=function(e,t,n,r,a){return void 0===t&&(t=.9),void 0===n&&(n=0),void 0===r&&(r=null),void 0===a&&(a=!1),new rL(e,t,n,r,a)},e.adam=function(e,t,n,r){return void 0===e&&(e=.001),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),new ZP(e,t,n,r)},e.adadelta=function(e,t,n){return void 0===e&&(e=.001),void 0===t&&(t=.95),void 0===n&&(n=null),new YP(e,t,n)},e.adamax=function(e,t,n,r,a){return void 0===e&&(e=.002),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=null),void 0===a&&(a=0),new eL(e,t,n,r,a)},e.adagrad=function(e,t){return void 0===t&&(t=.1),new JP(e,t)},e}();aL.sgd,aL.momentum,aL.adadelta,aL.adagrad,aL.rmsprop,aL.adamax,aL.adam,"undefined"!=typeof requestAnimationFrame?requestAnimationFrame:"undefined"!=typeof setImmediate&&setImmediate;YS.prototype.add=function(e){return RT(this,e)},YS.prototype.broadcastTo=function(e){return DD(this,e)},YS.prototype.div=function(e){return AN(this,e)},YS.prototype.divNoNan=function(e){return zD(this,e)},YS.prototype.squaredDifference=function(e){return sO(this,e)},YS.prototype.tile=function(e){return UD(this,e)},YS.prototype.oneHot=function(e,t,n){return void 0===t&&(t=1),void 0===n&&(n=0),GD(this,e,t,n)},YS.prototype.transpose=function(e){return KN(this,e)},YS.prototype.pad=function(e,t){return HD(this,e,t)},YS.prototype.batchNorm=function(e,t,n,r,a){return kD(this,e,t,n,r,a)},$S=SF;var iL,oL,sL=function(){return(sL=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function uL(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function cL(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}!function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(iL||(iL={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(oL||(oL={}));var lL={};function fL(e){return lL[e]}function hL(e,t,n,r){var a=t.inputParams[e];if(a&&void 0!==a.inputIndexStart){var i=a.inputIndexStart,o=0===a.inputIndexEnd?void 0:void 0===a.inputIndexEnd?i+1:a.inputIndexEnd;if("tensor"===a.type)return pL(t.inputNames[a.inputIndexStart],n,r);if("tensors"===a.type)return t.inputNames.slice(i,o).map((function(e){return pL(e,n,r)}));var s=Array.prototype.slice.call(pL(t.inputNames.slice(i)[0],n,r).dataSync());return"number"===a.type?s[0]:s}var u=t.attrParams[e];return u&&u.value}function pL(e,t,n){var r=mL(e),a=r[0],i=r[1],o=n.currentContextIds.find((function(e){return!!t[vL(a,e)]}));return void 0!==o?t[vL(a,o)][i]:void 0}function dL(e,t){var n=mL(e),r=n[0],a=n[1];return[vL(r,t&&t.currentContextId),a]}function vL(e,t){return t?e+"-"+t:e}function mL(e){var t=e.lastIndexOf(":");return-1===t?[e,0]:[e.substring(0,t),Number(e.substring(t+1))]}function yL(e,t){for(var n=[],r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}var gL=Object.freeze({json:[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),bL=Object.freeze({json:[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"clip_value_min",name:"clipValueMin",type:"number"},{tfName:"clip_value_max",name:"clipValueMax",type:"number"}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"clipValueMin",name:"clipValueMin",type:"number",defaultValue:0},{tfName:"clipValueMax",name:"clipValueMax",type:"number",defaultValue:6}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),xL=Object.freeze({json:[{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"number"}]}]}),wL=Object.freeze({json:[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]}]}),kL=Object.freeze({json:[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]}),EL=Object.freeze({json:[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),SL=Object.freeze({json:[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]}]}),CL=Object.freeze({json:[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]}),IL=Object.freeze({json:[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]}),TL=Object.freeze({json:[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),NL=Object.freeze({json:[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]}),_L=Object.freeze({json:[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]}),RL=Object.freeze({json:[{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]}]}),AL=Object.freeze({json:[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool",notSupported:!0}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]}),DL=Object.freeze({json:[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]}),OL=Object.freeze({json:[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]}]}),ML=function(){function e(){var e=[gL,bL,xL,wL,kL,EL,SL,TL,IL,CL,NL,_L,RL,AL,DL,OL],t=[].concat.apply([],e.map((function(e){return e.json})));this.opMappers=t.reduce((function(e,t){return e[t.tfOpName]=t,e}),{})}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!0,configurable:!0}),e.prototype.transformGraph=function(e,t){var n=this;void 0===t&&(t={});var r=[],a=[],i=e.node.reduce((function(e,t){return e[t.name]=n.mapNode(t),t.op.startsWith("Placeholder")&&r.push(e[t.name]),"Const"===t.op&&a.push(e[t.name]),e}),{}),o=[],s=[],u={},c={};null!=t&&(u=this.mapSignatureEntries(t.inputs),c=this.mapSignatureEntries(t.outputs));var l=Object.keys(i);return l.forEach((function(e){var t=i[e];t.inputNames.forEach((function(e){var n=dL(e)[0];t.inputs.push(i[n]),i[n].children.push(t)}))})),0===Object.keys(c).length?l.forEach((function(e){var t=i[e];0===t.children.length&&s.push(t)})):Object.keys(c).forEach((function(e){var t=dL(e)[0],n=i[t];null!=n&&(n.signatureKey=c[e],s.push(n))})),Object.keys(u).length>0?Object.keys(u).forEach((function(e){var t=dL(e)[0],n=i[t];n&&(n.signatureKey=u[e],o.push(n))})):o=r,{nodes:i,inputs:o,outputs:s,weights:a,placeholders:r,signature:t}},e.prototype.mapSignatureEntries=function(e){return Object.keys(e||{}).reduce((function(t,n){return t[e[n].name]=n,t}),{})},e.prototype.mapNode=function(e){var t=fL(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});var n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((function(e){return e.startsWith("^")?e.substr(1):e})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((function(e,t){return e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e}),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((function(t,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=PL(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=PL(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=HL(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=HL(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=BL(e.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=BL(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=GL(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=GL(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=LL(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=LL(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=KL(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=KL(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=jL(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=jL(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=qL(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=qL(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=zL(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=zL(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=UL(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=UL(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: "+n.type+" for op: "+e.op)}return t[n.name]={value:a,type:r},t}),{})),n},e}();function FL(e,t){var n=Array.isArray(e)?String.fromCharCode.apply(null,e):function(e){var t=WE().global;if(void 0!==t.atob)return t.atob(e);if("undefined"!=typeof Buffer)return new Buffer(e,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(e);return t?n:n.toLowerCase()}function PL(e,t,n,r){void 0===r&&(r=!1);var a=e[t];return null!=a?FL(a.s,r):n}function LL(e,t,n){var r=e[t];return r?r.b:n}function BL(e,t,n){var r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"==typeof a?a:parseInt(a,10)}function VL(e){switch("string"==typeof e&&(e=iL[e]),e){case iL.DT_FLOAT:return"float32";case iL.DT_INT32:case iL.DT_INT64:case iL.DT_INT8:case iL.DT_UINT8:return"int32";case iL.DT_BOOL:return"bool";case iL.DT_DOUBLE:return"float32";case iL.DT_STRING:return"string";default:return null}}function zL(e,t,n){var r=e[t];return r&&r.type?VL(r.type):n}function UL(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map((function(e){return VL(e)})):n}function WL(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((function(e){return"number"==typeof e.size?e.size:parseInt(e.size,10)})):[]}function jL(e,t,n){var r=e[t];return r&&r.shape?WL(r.shape):n}function GL(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(e){return"number"==typeof e?e:parseInt(e,10)})):n}function HL(e,t,n,r){void 0===r&&(r=!1);var a=e[t];return a&&a.list&&a.list.s?a.list.s.map((function(e){return FL(e,r)})):n}function qL(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((function(e){return WL(e)})):n}function KL(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}var XL=function(){function e(e,t,n){var r=this;this.node=e,this.tensorMap=t,this.context=n,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map((function(e){return r.getInput(e)})),null!=e.rawAttrs&&(this.attrs=Object.keys(e.rawAttrs).reduce((function(e,t){return e[t]=r.getAttr(t),e}),{}))}return e.prototype.getInput=function(e){return pL(e,this.tensorMap,this.context)},e.prototype.getAttr=function(e,t){var n=this.node.rawAttrs[e];if(null!=n.tensor)return pL(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return BL(this.node.rawAttrs,e,t);if(null!=n.s)return PL(this.node.rawAttrs,e,t);if(null!=n.b)return LL(this.node.rawAttrs,e,t);if(null!=n.shape)return jL(this.node.rawAttrs,e,t);if(null!=n.type)return zL(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return GL(this.node.rawAttrs,e,t);if(null!=n.list.s)return HL(this.node.rawAttrs,e,t);if(null!=n.list.shape)return qL(this.node.rawAttrs,e,t);if(null!=n.list.b)return KL(this.node.rawAttrs,e,t);if(null!=n.list.type)return UL(this.node.rawAttrs,e,t)}return t},e}(),$L=function(){function e(t,n,r,a,i,o,s){this.name=t,this.dtype=n,this.maxSize=r,this.elementShape=a,this.identicalElementShapes=i,this.dynamicSize=o,this.clearAfterRead=s,this.tensors=[],this.closed_=!1,this.id=e.nextId++}return Object.defineProperty(e.prototype,"closed",{get:function(){return this.closed_},enumerable:!0,configurable:!0}),e.prototype.clearAndClose=function(){this.tensors.forEach((function(e){return e.tensor.dispose()})),this.tensors=[],this.closed_=!0},e.prototype.size=function(){return this.tensors.length},e.prototype.read=function(e){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(e<0||e>=this.tensors.length)throw new Error("Tried to read from index "+e+", but array size is: "+this.tensors.length);var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray "+this.name+": Could not read index "+e+" twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor},e.prototype.readMany=function(e){var t=this;return e.map((function(e){return t.read(e)}))},e.prototype.write=function(e,t){if(this.closed_)throw new Error("TensorArray "+this.name+" has already been closed.");if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index "+e+", but array is not resizeable and size is: "+this.maxSize);var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+",\n          because the value dtype is "+t.dtype+", but TensorArray dtype is "+this.dtype+".");if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),this.assertShapesMatchAllowUndefinedSize(this.elementShape,t.shape,"TensorArray "+this.name+": Could not write to TensorArray index "+e+"."),n&&n.read)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+", because it has already been read.");if(n&&n.written)throw new Error("TensorArray "+this.name+": Could not write to TensorArray index "+e+", because it has already been written.");n.tensor=t,n.written=!0,this.tensors[e]=n},e.prototype.writeMany=function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray "+this.name+": could not write multiple tensors,because the index size: "+e.length+" is not the same as tensors size: "+t.length+".");e.forEach((function(e,r){return n.write(e,t[r])}))},e.prototype.gather=function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but gather requested dtype "+t);if(!e){e=[];for(var n=0;n<this.size();n++)e.push(n)}if(0===e.length)return zI([],[0].concat(this.elementShape));var r=this.readMany(e);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),vT(r,0)},e.prototype.concat=function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but concat requested dtype "+e);if(0===this.size())return zI([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var r=this.readMany(t);return this.assertShapesMatchAllowUndefinedSize(this.elementShape,r[0].shape,"TensorArray shape mismatch: tensor array shape ("+this.elementShape+") vs first tensor shape ("+r[0].shape+")"),eT(r,0)},e.prototype.scatter=function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+t.dtype);if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: "+e.length+" vs. "+t.shape[0]);var n=Math.max.apply(Math,e);if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size ("+n+"  vs. "+this.maxSize+")");this.writeMany(e,mT(t,0))},e.prototype.split=function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is "+this.dtype+" but tensor has dtype "+t.dtype);var r=0,a=e.map((function(e){return r+=e}));if(r!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        "+r+", and tensor's shape is: "+t.shape);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths ("+this.maxSize+" vs. "+e.length+"), and the TensorArray is not marked as dynamically resizeable");var i=0===r?0:t.size/r,o=[];bI((function(){t=t.reshape([1,r,i]);for(var s=0;s<e.length;++s){var u=[0,0===s?0:a[s-1],0],c=[1,e[s],i];o[s]=tM(t,u,c).reshape(n.elementShape)}return o}));for(var s=[],u=0;u<e.length;u++)s[u]=u;this.writeMany(s,o)},e.prototype.assertShapesMatchAllowUndefinedSize=function(e,t,n){void 0===n&&(n=""),US.assert(this.shapesEqualAllowUndefinedSize(e,t),(function(){return n+" Shapes "+e+" and "+t+" must match"}))},e.prototype.shapesEqualAllowUndefinedSize=function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(-1!==e[n]&&-1!==t[n]&&e[n]!==t[n])return!1;return!0},e.nextId=0,e}();function QL(e,t,n){var r=function(e,t,n){switch(e.category){case"arithmetic":return bI((function(){return function(e,t,n){switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[RT(hL("a",e,t,n),hL("b",e,t,n))];case"AddN":return[mD(hL("tensors",e,t,n))];case"FloorMod":case"Mod":return[kN(hL("a",e,t,n),hL("b",e,t,n))];case"Mul":return[SN(hL("a",e,t,n),hL("b",e,t,n))];case"RealDiv":case"Div":return[AN(hL("a",e,t,n),hL("b",e,t,n))];case"DivNoNan":return[zD(hL("a",e,t,n),hL("b",e,t,n))];case"FloorDiv":return[yN(hL("a",e,t,n),hL("b",e,t,n))];case"Sub":return[_N(hL("a",e,t,n),hL("b",e,t,n))];case"Minimum":return[xN(hL("a",e,t,n),hL("b",e,t,n))];case"Maximum":return[gN(hL("a",e,t,n),hL("b",e,t,n))];case"Pow":return[IN(hL("a",e,t,n),hL("b",e,t,n))];case"SquaredDifference":return[sO(hL("a",e,t,n),hL("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"basic_math":return bI((function(){return function(e,t,n){switch(e.op){case"Abs":case"ComplexAbs":return[MT(hL("x",e,t,n))];case"Acos":return[FT(hL("x",e,t,n))];case"Acosh":return[PT(hL("x",e,t,n))];case"Asin":return[LT(hL("x",e,t,n))];case"Asinh":return[BT(hL("x",e,t,n))];case"Atan":return[VT(hL("x",e,t,n))];case"Atan2":return[vN(hL("x",e,t,n),hL("y",e,t,n))];case"Atanh":return[zT(hL("x",e,t,n))];case"Ceil":return[UT(hL("x",e,t,n))];case"Complex":return[LI(hL("real",e,t,n),hL("imag",e,t,n))];case"Cos":return[jT(hL("x",e,t,n))];case"Cosh":return[GT(hL("x",e,t,n))];case"Elu":return[gM(hL("x",e,t,n))];case"Erf":return[HT(hL("x",e,t,n))];case"Exp":return[qT(hL("x",e,t,n))];case"Expm1":return[KT(hL("x",e,t,n))];case"Floor":return[XT(hL("x",e,t,n))];case"Log":return[$T(hL("x",e,t,n))];case"Log1p":return[QT(hL("x",e,t,n))];case"Imag":return[VI(hL("x",e,t,n))];case"Neg":return[JT(hL("x",e,t,n))];case"Reciprocal":return[ZT(hL("x",e,t,n))];case"Real":return[BI(hL("x",e,t,n))];case"Relu":return[wM(hL("x",e,t,n))];case"Round":return[eN(hL("x",e,t,n))];case"Selu":return[EM(hL("x",e,t,n))];case"Sigmoid":return[nN(hL("x",e,t,n))];case"Sin":return[sN(hL("x",e,t,n))];case"Sign":return[rN(hL("x",e,t,n))];case"Sinh":return[uN(hL("x",e,t,n))];case"Softplus":return[cN(hL("x",e,t,n))];case"Sqrt":return[lN(hL("x",e,t,n))];case"Square":return[oO(hL("x",e,t,n))];case"Tanh":return[pN(hL("x",e,t,n))];case"Tan":return[hN(hL("x",e,t,n))];case"Relu6":case"ClipByValue":return[WT(hL("x",e,t,n),hL("clipValueMin",e,t,n),hL("clipValueMax",e,t,n))];case"Rsqrt":return[tN(pL(e.inputNames[0],t,n))];case"Prod":return[yM(hL("x",e,t,n),hL("axes",e,t,n))];case"LeakyRelu":return[bM(hL("x",e,t,n),hL("alpha",e,t,n))];case"Prelu":return[xM(hL("x",e,t,n),hL("alpha",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"control":return function(e,t,n){return uL(void 0,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,f,h,p,d,v,m,y,g,b,x,w,k,E,S,C,I,T,N,_,R,A,D,O,M,F,P;return cL(this,(function(L){switch(L.label){case 0:switch(e.op){case"LoopCond":return[3,1];case"Switch":return[3,2];case"Merge":return[3,4];case"Enter":return[3,5];case"Exit":return[3,6];case"NextIteration":return[3,7];case"TensorArrayV3":return[3,8];case"TensorArrayWriteV3":return[3,9];case"TensorArrayReadV3":return[3,10];case"TensorArrayGatherV3":return[3,11];case"TensorArrayScatterV3":return[3,12];case"TensorArrayConcatV3":return[3,13];case"TensorArraySplitV3":return[3,14];case"TensorArraySizeV3":return[3,15];case"TensorArrayCloseV3":return[3,16]}return[3,17];case 1:return[2,[hL("pred",e,t,n).clone()]];case 2:return r=hL("pred",e,t,n),a=hL("data",e,t,n),[4,r.data()];case 3:return[2,L.sent()[0]?[void 0,a.clone()]:[a.clone(),void 0]];case 4:return[2,(i=e.inputNames.find((function(e){return void 0!==pL(e,t,n)})))?[pL(i,t,n).clone()]:void 0];case 5:return o=hL("frameName",e,t,n),s=hL("tensor",e,t,n),n.enterFrame(o),[2,[s.clone()]];case 6:return u=hL("tensor",e,t,n),n.exitFrame(),[2,[u.clone()]];case 7:return c=hL("tensor",e,t,n),n.nextIteration(),[2,[c.clone()]];case 8:return l=hL("size",e,t,n),f=hL("dtype",e,t,n),h=hL("elementShape",e,t,n),p=hL("dynamicSize",e,t,n),d=hL("clearAfterRead",e,t,n),v=hL("identicalElementShapes",e,t,n),m=hL("name",e,t,n),y=new $L(m,f,l,h,v,p,d),n.addTensorArray(y),[2,[WI(y.id),WI(1)]];case 9:return g=hL("tensorArrayId",e,t,n),b=hL("index",e,t,n),x=hL("tensor",e,t,n),n.getTensorArray(g).write(b,x),[2,[WI(1)]];case 10:return w=hL("tensorArrayId",e,t,n),k=hL("index",e,t,n),[2,[n.getTensorArray(w).read(k)]];case 11:return E=hL("tensorArrayId",e,t,n),S=hL("indices",e,t,n),C=hL("dtype",e,t,n),[2,[n.getTensorArray(E).gather(S,C)]];case 12:return I=hL("tensorArrayId",e,t,n),T=hL("indices",e,t,n),N=hL("tensor",e,t,n),n.getTensorArray(I).scatter(T,N),[2,[WI(1)]];case 13:return _=hL("tensorArrayId",e,t,n),R=n.getTensorArray(_),A=hL("dtype",e,t,n),[2,[R.concat(A)]];case 14:return D=hL("tensorArrayId",e,t,n),O=hL("tensor",e,t,n),M=hL("lengths",e,t,n),n.getTensorArray(D).split(M,O),[2,[WI(1)]];case 15:return F=hL("tensorArrayId",e,t,n),[2,[WI(n.getTensorArray(F).size(),"int32")]];case 16:return P=hL("tensorArrayId",e,t,n),n.getTensorArray(P).clearAndClose(),[2,[WI(0)]];case 17:throw TypeError("Node type "+e.op+" is not implemented")}}))}))}(e,t,n);case"convolution":return bI((function(){return function(e,t,n){switch(e.op){case"Conv1D":var r=hL("stride",e,t,n),a=hL("pad",e,t,n),i=hL("dataFormat",e,t,n).toUpperCase(),o=hL("dilation",e,t,n);return[NO(hL("x",e,t,n),hL("filter",e,t,n),r,a,i,o)];case"Conv2D":r=hL("strides",e,t,n),a=hL("pad",e,t,n),i=hL("dataFormat",e,t,n).toUpperCase();var s=hL("dilations",e,t,n);return[_O(hL("x",e,t,n),hL("filter",e,t,n),[r[1],r[2]],a,i,[s[1],s[2]])];case"_FusedConv2D":case"FusedDepthwiseConv2dNative":var u=hL("fusedOps",e,t,n),c=u[0],l=u[1],f="biasadd"===c,h="prelu"===l,p="fusedbatchnorm"===c,d=hL("numArgs",e,t,n);if(f){if(h&&2!==d)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!h&&1!==d)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(p)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");r=hL("strides",e,t,n),a=hL("pad",e,t,n),i=hL("dataFormat",e,t,n).toUpperCase(),s=hL("dilations",e,t,n);var v=hL("args",e,t,n),m=v[0],y=v[1];return[("_FusedConv2D"===e.op?EF.conv2d:EF.depthwiseConv2d)({x:hL("x",e,t,n),filter:hL("filter",e,t,n),strides:[r[1],r[2]],pad:a,dataFormat:i,dilations:[s[1],s[2]],bias:m,activation:l,preluActivationWeights:y})];case"Conv2DBackpropInput":case"Conv2dTranspose":var g=hL("outputShape",e,t,n);return r=hL("strides",e,t,n),a=hL("pad",e,t,n),[LO(hL("x",e,t,n),hL("filter",e,t,n),g,[r[1],r[2]],a)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":return r=hL("strides",e,t,n),a=hL("pad",e,t,n),s=hL("dilations",e,t,n),i=hL("dataFormat",e,t,n).toUpperCase(),[OO(hL("input",e,t,n),hL("filter",e,t,n),[r[1],r[2]],a,i,[s[1],s[2]])];case"Conv3D":return r=hL("strides",e,t,n),a=hL("pad",e,t,n),i=hL("dataFormat",e,t,n).toUpperCase(),s=hL("dilations",e,t,n),[RO(hL("x",e,t,n),hL("filter",e,t,n),[r[1],r[2],r[3]],a,i,[s[1],s[2],s[3]])];case"AvgPool":r=hL("strides",e,t,n),a=hL("pad",e,t,n);var b=hL("kernelSize",e,t,n);return[QO(hL("x",e,t,n),[b[1],b[2]],[r[1],r[2]],a)];case"MaxPool":return r=hL("strides",e,t,n),a=hL("pad",e,t,n),b=hL("kernelSize",e,t,n),[$O(hL("x",e,t,n),[b[1],b[2]],[r[1],r[2]],a)];case"MaxPoolWithArgmax":r=hL("strides",e,t,n),a=hL("pad",e,t,n),b=hL("kernelSize",e,t,n);var x=hL("includeBatchInIndex",e,t,n),w=eM(hL("x",e,t,n),[b[1],b[2]],[r[1],r[2]],a,x);return[w.result,w.indexes];case"AvgPool3D":return r=hL("strides",e,t,n),a=hL("pad",e,t,n),b=hL("kernelSize",e,t,n),[ZO(hL("x",e,t,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],a)];case"MaxPool3D":return r=hL("strides",e,t,n),a=hL("pad",e,t,n),b=hL("kernelSize",e,t,n),[JO(hL("x",e,t,n),[b[1],b[2],b[3]],[r[1],r[2],r[3]],a)];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"creation":return bI((function(){return function(e,t,n){switch(e.op){case"Fill":var r=hL("shape",e,t,n),a=hL("dtype",e,t,n);return[$I(r,hL("value",e,t,n),a)];case"LinSpace":var i=hL("start",e,t,n);return[QI(i,hL("stop",e,t,n),hL("num",e,t,n))];case"Multinomial":var o=hL("logits",e,t,n),s=hL("numSamples",e,t,n),u=hL("seed",e,t,n);return[jD(o,s,u)];case"OneHot":var c=hL("indices",e,t,n),l=hL("depth",e,t,n),f=hL("onValue",e,t,n),h=hL("offValue",e,t,n);return[GD(c,l,f,h)];case"Ones":return[KI(hL("shape",e,t,n),hL("dtype",e,t,n))];case"OnesLike":return[JI(hL("x",e,t,n))];case"RandomUniform":return[iO(hL("shape",e,t,n),hL("minval",e,t,n),hL("maxval",e,t,n),hL("dtype",e,t,n))];case"Range":return[YI(i=hL("start",e,t,n),hL("stop",e,t,n),hL("step",e,t,n),hL("dtype",e,t,n))];case"TruncatedNormal":r=hL("shape",e,t,n);var p=hL("mean",e,t,n),d=hL("stdDev",e,t,n);return u=hL("seed",e,t,n),[uO(r,p,d,hL("dtype",e,t,n),u)];case"Zeros":return[XI(hL("shape",e,t,n),hL("dtype",e,t,n))];case"ZerosLike":return[ZI(hL("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"dynamic":return function(e,t,n){return uL(void 0,void 0,void 0,(function(){var r,a,i,o,s,u,c,l;return cL(this,(function(f){switch(f.label){case 0:switch(e.op){case"NonMaxSuppressionV5":case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":return[3,1];case"Where":return[3,5];case"ListDiff":return[3,7]}return[3,8];case 1:return r=hL("boxes",e,t,n),a=hL("scores",e,t,n),i=hL("maxOutputSize",e,t,n),o=hL("iouThreshold",e,t,n),s=hL("scoreThreshold",e,t,n),"NonMaxSuppressionV5"!==e.op?[3,3]:(u=hL("softNmsSigma",e,t,n),[4,vF.nonMaxSuppressionWithScoreAsync(r,a,i,o,s,u)]);case 2:return[2,[(l=f.sent()).selectedIndices,l.selectedScores]];case 3:return[4,vF.nonMaxSuppressionAsync(r,a,i,o,s)];case 4:return[2,[f.sent()]];case 5:return c=hL("condition",e,t,n).asType("bool"),[4,VD(c)];case 6:return l=[f.sent()],c.dispose(),[2,l];case 7:return[2,yT(hL("x",e,t,n),hL("y",e,t,n))];case 8:throw TypeError("Node type "+e.op+" is not implemented")}}))}))}(e,t,n);case"evaluation":return bI((function(){return function(e,t,n){if("TopKV2"===e.op){var r=hL("x",e,t,n),a=hL("k",e,t,n),i=hL("sorted",e,t,n),o=RM(r,a,i);return[o.values,o.indices]}throw TypeError("Node type "+e.op+" is not implemented")}(e,t,n)}));case"image":return bI((function(){return function(e,t,n){switch(e.op){case"ResizeBilinear":var r=hL("images",e,t,n),a=hL("size",e,t,n),i=hL("alignCorners",e,t,n);return[vF.resizeBilinear(r,[a[0],a[1]],i)];case"ResizeNearestNeighbor":return r=hL("images",e,t,n),a=hL("size",e,t,n),i=hL("alignCorners",e,t,n),[vF.resizeNearestNeighbor(r,[a[0],a[1]],i)];case"CropAndResize":var o=hL("image",e,t,n),s=hL("boxes",e,t,n),u=hL("boxInd",e,t,n),c=hL("cropSize",e,t,n),l=hL("method",e,t,n),f=hL("extrapolationValue",e,t,n);return[vF.cropAndResize(o,s,u,c,l,f)];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"graph":return bI((function(){return function(e,t,n){switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var r=hL("default",e,t,n);return[pL(e.name,t,n)||r];case"Placeholder":return[pL(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":case"Snapshot":return[hL("x",e,t,n).clone()];case"IdentityN":return hL("x",e,t,n).map((function(e){return e.clone()}));case"Shape":return[jI(hL("x",e,t,n).shape,"int32")];case"ShapeN":return hL("x",e,t,n).map((function(e){return jI(e.shape)}));case"Size":return[WI(hL("x",e,t,n).size,"int32")];case"Rank":return[WI(hL("x",e,t,n).rank,"int32")];case"NoOp":return[WI(1)];case"Print":var a=hL("x",e,t,n),i=hL("data",e,t,n),o=hL("message",e,t,n),s=hL("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(o);for(var u=0;u<i.length;u++)console.log(Array.prototype.slice.call(i[u].dataSync()).slice(0,s));return[a];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"logical":return bI((function(){return function(e,t,n){switch(e.op){case"Equal":return[cO(hL("a",e,t,n),hL("b",e,t,n))];case"NotEqual":return[bO(hL("a",e,t,n),hL("b",e,t,n))];case"Greater":return[fO(hL("a",e,t,n),hL("b",e,t,n))];case"GreaterEqual":return[hO(hL("a",e,t,n),hL("b",e,t,n))];case"Less":return[vO(hL("a",e,t,n),hL("b",e,t,n))];case"LessEqual":return[mO(hL("a",e,t,n),hL("b",e,t,n))];case"LogicalAnd":return[MD(hL("a",e,t,n),hL("b",e,t,n))];case"LogicalNot":return[FD(hL("a",e,t,n))];case"LogicalOr":return[PD(hL("a",e,t,n),hL("b",e,t,n))];case"Select":case"SelectV2":return[BD(hL("condition",e,t,n),hL("a",e,t,n),hL("b",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"matrices":return bI((function(){return function(e,t,n){switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[VO(hL("a",e,t,n),hL("b",e,t,n),hL("transposeA",e,t,n),hL("transposeB",e,t,n))];case"Transpose":return[KN(hL("x",e,t,n),hL("perm",e,t,n))];case"_FusedMatMul":var r=hL("fusedOps",e,t,n),a=r[0],i=r[1],o="biasadd"===a,s="prelu"===i,u=hL("numArgs",e,t,n);if(o){if(s&&2!==u)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!s&&1!==u)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var c=hL("args",e,t,n),l=c[0],f=c[1];return[EF.matMul({a:hL("a",e,t,n),b:hL("b",e,t,n),transposeA:hL("transposeA",e,t,n),transposeB:hL("transposeB",e,t,n),bias:l,activation:i,preluActivationWeights:f})];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"normalization":return bI((function(){return function(e,t,n){switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[kD(hL("x",e,t,n),hL("mean",e,t,n),hL("variance",e,t,n),hL("offset",e,t,n),hL("scale",e,t,n),hL("epsilon",e,t,n))];case"LRN":return[SM(hL("x",e,t,n),hL("radius",e,t,n),hL("bias",e,t,n),hL("alpha",e,t,n),hL("beta",e,t,n))];case"Softmax":return[HN(hL("x",e,t,n))];case"LogSoftmax":return[qN(hL("x",e,t,n))];case"SparseToDense":return[LM(hL("sparseIndices",e,t,n),hL("outputShape",e,t,n),hL("sparseValues",e,t,n),hL("defaultValue",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"reduction":return bI((function(){return function(e,t,n){switch(e.op){case"Max":var r=hL("axis",e,t,n),a=hL("keepDims",e,t,n);return[hM(hL("x",e,t,n),r,a)];case"Mean":return r=hL("axis",e,t,n),a=hL("keepDims",e,t,n),[pM(hL("x",e,t,n),r,a)];case"Min":return r=hL("axis",e,t,n),a=hL("keepDims",e,t,n),[dM(hL("x",e,t,n),r,a)];case"Sum":return r=hL("axis",e,t,n),a=hL("keepDims",e,t,n),[mM(hL("x",e,t,n),r,a)];case"All":return r=hL("axis",e,t,n),a=hL("keepDims",e,t,n),[sM(hL("x",e,t,n),r,a)];case"Any":return r=hL("axis",e,t,n),a=hL("keepDims",e,t,n),[uM(hL("x",e,t,n),r,a)];case"ArgMax":return r=hL("axis",e,t,n),[cM(hL("x",e,t,n),r)];case"ArgMin":return r=hL("axis",e,t,n),[lM(hL("x",e,t,n),r)];case"Prod":return r=hL("axis",e,t,n),a=hL("keepDims",e,t,n),[yM(hL("x",e,t,n),r,a)];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"slice_join":return bI((function(){return function(e,t,n){switch(e.op){case"ConcatV2":case"Concat":var r=hL("n",e,t,n),a=hL("axis",e,t,n),i=hL("tensors",e,t,n);return i=i.slice(0,r),[eT(i,a)];case"GatherV2":case"Gather":a=hL("axis",e,t,n);var o=hL("x",e,t,n),s=hL("indices",e,t,n);return[EO(o,s.asType("int32"),a)];case"ReverseV2":case"Reverse":return a=hL("axis",e,t,n),o=hL("x",e,t,n),[WO(o,a)];case"Slice":var u=hL("begin",e,t,n),c=hL("size",e,t,n);return[tM(hL("x",e,t,n),u,c)];case"StridedSlice":u=hL("begin",e,t,n);var l=hL("end",e,t,n),f=hL("strides",e,t,n),h=hL("beginMask",e,t,n),p=hL("endMask",e,t,n),d=hL("ellipsisMask",e,t,n),v=hL("newAxisMask",e,t,n),m=hL("shrinkAxisMask",e,t,n),y=hL("x",e,t,n);if(1===u.length&&y.shape.length>1)for(var g=1;g<y.shape.length;g++)u.push(0),l.push(y.shape[g]),f.push(f[0]);return[_M(y,u,l,f,h,p,d,v,m)];case"Pack":return bI((function(){var r=hL("axis",e,t,n),a=hL("tensors",e,t,n),i=a[0].shape,o=a[0].squeeze().shape,s=a.map((function(e){var t=US.arraysEqual(e.shape,i);if(!t&&!US.arraysEqual(e.squeeze().shape,o))throw new Error("the input tensors shape does not match");return t?e:e.reshape(i)}));return[vT(s,r)]}));case"Unpack":return bI((function(){var r=hL("axis",e,t,n),a=hL("tensor",e,t,n);return mT(a,r)}));case"Tile":var b=hL("reps",e,t,n);return[UD(hL("x",e,t,n),b)];case"Split":case"SplitV":a=hL("axis",e,t,n);var x=hL("numOrSizeSplits",e,t,n);return iT(hL("x",e,t,n),x,a);case"ScatterNd":s=hL("indices",e,t,n);var w=hL("values",e,t,n),k=hL("shape",e,t,n);return[AM(s,w,k)];case"GatherNd":var E=hL("x",e,t,n);return s=hL("indices",e,t,n),[BM(E,s)];case"SparseToDense":s=hL("sparseIndices",e,t,n),k=hL("outputShape",e,t,n);var S=hL("sparseValues",e,t,n),C=hL("defaultValue",e,t,n);return[LM(s,S,k,S.dtype===C.dtype?C:C.asType(S.dtype))];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"spectral":return bI((function(){return function(e,t,n){switch(e.op){case"FFT":return[DM(hL("x",e,t,n))];case"IFFT":return[OM(hL("x",e,t,n))];case"RFFT":return[MM(hL("x",e,t,n))];case"IRFFT":return[FM(hL("x",e,t,n))];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"transformation":return bI((function(){return function(e,t,n){switch(e.op){case"Cast":return[uT(hL("x",e,t,n),hL("dtype",e,t,n))];case"ExpandDims":var r=hL("axis",e,t,n);return[fT(hL("x",e,t,n),r)];case"Squeeze":return r=hL("axis",e,t,n),[dT(hL("x",e,t,n),r)];case"Reshape":return[hT(hL("x",e,t,n),hL("shape",e,t,n))];case"PadV2":case"Pad":return[HD(hL("x",e,t,n),yL(hL("padding",e,t,n),2),hL("constantValue",e,t,n))];case"SpaceToBatchND":var a=hL("blockShape",e,t,n),i=yL(hL("paddings",e,t,n),2);return[pT(hL("x",e,t,n),a,i)];case"BatchToSpaceND":a=hL("blockShape",e,t,n);var o=yL(hL("crops",e,t,n),2);return[sT(hL("x",e,t,n),a,o)];case"DepthToSpace":var s=hL("blockSize",e,t,n),u=hL("dataFormat",e,t,n).toUpperCase();return[lT(hL("x",e,t,n),s,u)];default:throw TypeError("Node type "+e.op+" is not implemented")}}(e,t,n)}));case"custom":var r=fL(e.op);if(r&&r.customExecutor)return r.customExecutor(new XL(e,t,n));throw TypeError("Custom op "+e.op+" is not registered.");default:throw TypeError("Unknown op '"+e.op+"'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(e,t,n);return r instanceof Promise?r.then((function(e){return[].concat(e)})):[].concat(r)}var YL=function(){function e(e,t){this.weightMap=e,this.tensorArrayMap=t,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return e.prototype.newFrame=function(e,t){return{id:e,frameName:t,iterationId:0}},Object.defineProperty(e.prototype,"currentContext",{get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextId",{get:function(){return this._currentContextIds[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentContextIds",{get:function(){return this._currentContextIds},enumerable:!0,configurable:!0}),e.prototype.generateCurrentContextIds=function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e},e.prototype.contextIdforContexts=function(e){return e?e.map((function(e){return 0===e.id&&0===e.iterationId?"":e.frameName+"-"+e.iterationId})).join("/"):""},e.prototype.enterFrame=function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))},e.prototype.exitFrame=function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()},e.prototype.nextIteration=function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))},e.prototype.getWeight=function(e){return this.weightMap[e]},e.prototype.addTensorArray=function(e){this.tensorArrayMap[e.id]=e},e.prototype.getTensorArray=function(e){return this.tensorArrayMap[e]},e}();function JL(e,t,n){for(var r=new Set,a=[],i=null,o=null,s=new Set,u=Object.keys(e).map((function(e){return mL(e)[0]})),c=t.slice();c.length>0;){var l=c.pop();(tB(l)||nB(l))&&null==i&&(o=(i=l).children.map((function(e){return e.name})).filter((function(e){return r.has(e)}))),r.add(l.name),null==n[l.name]&&-1===u.indexOf(l.name)&&(0!==l.inputs.length?l.inputs.forEach((function(e){s.has(e.name)||(s.add(e.name),c.push(e))})):a.push(l.name))}return{inputs:e,outputs:t,usedNodes:r,missingInputs:a,dynamicNode:i,syncInputs:o}}var ZL=["Switch","Merge","Enter","Exit","NextIteration"],eB=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"];function tB(e){return ZL.indexOf(e.op)>=0}function nB(e){return eB.indexOf(e.op)>=0}var rB=function(){function e(e){this.graph=e,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._outputs=e.outputs,this._inputs=e.inputs,this._signature=e.signature}return Object.defineProperty(e.prototype,"weightMap",{get:function(){return this._weightMap},set:function(e){var t=Object.keys(e).map((function(t){return e[t].map((function(e){return e.id}))}));this.weightIds=[].concat.apply([],t),this._weightMap=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this._inputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this._outputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this._inputs.map((function(e){return e.signatureKey||e.name}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this._outputs.map((function(e){return e.signatureKey||e.name}))},enumerable:!0,configurable:!0}),e.prototype.getCompilationKey=function(e,t){var n=e.map((function(e){return e.name})).sort(),r=t.map((function(e){return e.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)},e.prototype.compile=function(e,t){var n=JL(e,t,this.weightMap),r=n.missingInputs,a=n.dynamicNode,i=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '"+a.name+"', which has the dynamic op '"+a.op+"'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs ["+i+"]");if(r.length>0){var o=t.map((function(e){return e.name})),s=Object.keys(e);throw new Error("Cannot compute the outputs ["+o+"] from the provided inputs ["+s+"]. Missing the following inputs: ["+r+"]")}return function(e,t,n){var r=n.usedNodes,a=n.inputs,i=[];Object.keys(a).map((function(e){return mL(e)[0]})).map((function(t){return e.nodes[t]})).forEach((function(e){r.has(e.name)&&i.push(e)})),e.weights.forEach((function(e){r.has(e.name)&&i.push(e)}));for(var o=new Set,s=[];i.length>0;){var u=i.pop();o.add(u.name),t[u.name]||s.push(u),u.children.forEach((function(e){!o.has(e.name)&&r.has(e.name)&&e.inputs.every((function(e){return o.has(e.name)}))&&i.push(e)}))}return s}(this.graph,this.weightMap,n)},e.prototype.execute=function(e,t){var n=this;e=this.mapInputs(e);var r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);var a=r.map((function(e){return n.graph.nodes[mL(e)[0]]})),i=t.map((function(e){return n.graph.nodes[mL(e)[0]]})),o=this.getCompilationKey(a,i),s=this.compiledMap.get(o);null==s&&(s=this.compile(e,i),this.compiledMap.set(o,s));var u={};return bI((function(){var r=new YL(n._weightMap,u),a=sL({},n.weightMap);Object.keys(e).forEach((function(t){var n=mL(t),r=n[0],i=[];i[n[1]]=e[t],a[r]=i}));for(var i=n.getFrozenTensorIds(a),o={},c=0;c<s.length;c++){var l=s[c];if(!a[l.name]){var f=QL(l,a,r);if(f instanceof Promise)throw new Error("The execution of the op '"+l.op+"' returned a promise. Please use model.executeAsync() instead.");a[l.name]=f,n.checkTensorForDisposal(l.name,l,a,r,i,t,o)}}return t.map((function(e){return pL(e,a,r)}))}))},e.prototype.getFrozenTensorIds=function(e){var t=[].concat.apply([],Object.keys(e).map((function(t){return e[t]})).map((function(e){return e.map((function(e){return e.id}))})));return new Set(t)},e.prototype.checkTensorForDisposal=function(e,t,n,r,a,i,o){"control"!==t.category&&-1===i.indexOf(e)&&(n[e].forEach((function(e){null!=e&&(o[e.id]=(o[e.id]||0)+t.children.length)})),t.inputs.forEach((function(e){if("control"!==e.category){var t=function(e,t,n){return t[vL(e,n.currentContextId)]}(e.name,n,r);null!=t&&t.forEach((function(e){if(e&&!a.has(e.id)){var t=o[e.id];1===t?(e.dispose(),delete o[e.id]):null!=t&&o[e.id]--}}))}})))},e.prototype.executeAsync=function(e,t){return uL(this,void 0,void 0,(function(){var n,r,a,i,o,s,u=this;return cL(this,(function(c){switch(c.label){case 0:return e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t),n={},r=new YL(this._weightMap,n),[4,this.executeWithControlFlow(e,r,t)];case 1:return a=c.sent(),i=t.map((function(e){return pL(e,a,r)})),o=new Set(i.map((function(e){return e.id}))),s=new Set(Object.keys(e).map((function(t){return e[t].id}))),Object.keys(a).forEach((function(e){a[e].forEach((function(e){!e||e.isDisposed||o.has(e.id)||s.has(e.id)||-1!==u.weightIds.indexOf(e.id)||e.dispose()}))})),[2,i]}}))}))},e.prototype.executeWithControlFlow=function(e,t,n){return uL(this,void 0,void 0,(function(){var r,a,i,o,s,u,c,l,f,h,p,d,v,m,y,g,b=this;return cL(this,(function(x){switch(x.label){case 0:r=Object.keys(e),a=r.map((function(e){return b.graph.nodes[mL(e)[0]]})),i=n.map((function(e){return b.graph.nodes[mL(e)[0]]})),o=JL(e,i,this.weightMap),s=o.usedNodes,u=o.missingInputs,c=o.dynamicNode,l=o.syncInputs,f=a.concat(this.graph.weights).map((function(e){return{node:e,contexts:t.currentContext}})),h=sL({},this.weightMap),Object.keys(e).forEach((function(t){var n=mL(t),r=n[0],a=[];a[n[1]]=e[t],h[r]=a})),p={},d=this.getFrozenTensorIds(h),v={},x.label=1;case 1:return f.length>0?(m=this.processStack(a,f,t,h,v,d,n,p,s),[4,Promise.all(m)]):[3,3];case 2:return x.sent(),[3,1];case 3:if(null==c&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),(y=i.filter((function(e){return!tB(e)&&!pL(e.name,h,t)})).map((function(e){return e.name}))).length>0)throw g="",null!=c&&(g="Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs ["+l+"]"),new Error("Cannot compute the outputs ["+y+"] from the provided inputs ["+r+"]. Consider providing the following inputs: ["+u+"]. "+g);return[2,h]}}))}))},e.prototype.processStack=function(e,t,n,r,a,i,o,s,u){for(var c=this,l=[],f=function(){var f=t.pop();n.currentContext=f.contexts;var p="";if("Enter"===f.node.op&&hL("isConstant",f.node,r,n)&&(p=dL(f.node.name,n)[0]),-1===e.indexOf(f.node)){var d=QL(f.node,r,n);p||(p=dL(f.node.name,n)[0]);var v=n.currentContext;d instanceof Promise?l.push(d.then((function(e){return r[p]=e,n.currentContext=v,c.checkTensorForDisposal(p,f.node,r,n,i,o,s),c.processChildNodes(f.node,t,n,r,a,u),e}))):(r[p]=d,h.checkTensorForDisposal(p,f.node,r,n,i,o,s),h.processChildNodes(f.node,t,n,r,a,u))}else h.processChildNodes(f.node,t,n,r,a,u)},h=this;t.length>0;)f();return l},e.prototype.processChildNodes=function(e,t,n,r,a,i){e.children.forEach((function(e){var o=dL(e.name,n)[0];!a[o]&&i.has(e.name)&&("Merge"===e.op?e.inputNames.some((function(e){return!!pL(e,r,n)}))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((function(e){return!!pL(e,r,n)}))&&(a[o]=!0,t.push({contexts:n.currentContext,node:e})))}))},e.prototype.dispose=function(){var e=this;Object.keys(this.weightMap).forEach((function(t){return e.weightMap[t].forEach((function(e){return e.dispose()}))}))},e.prototype.checkInputShapeAndType=function(e){var t=this;Object.keys(e).forEach((function(n){var r=e[n],a=mL(n)[0],i=t.graph.nodes[a];if(i.attrParams.shape&&i.attrParams.shape.value){var o=i.attrParams.shape.value,s=o.length===r.shape.length&&r.shape.every((function(e,t){return-1===o[t]||o[t]===e}));US.assert(s,(function(){return"The shape of dict['"+i.name+"'] provided in model.execute(dict) must be ["+o+"], but was ["+r.shape+"]"}))}i.attrParams.dtype&&i.attrParams.dtype.value&&US.assert(r.dtype===i.attrParams.dtype.value,(function(){return"The dtype of dict['"+i.name+"'] provided in model.execute(dict) must be "+i.attrParams.dtype.value+", but was "+r.dtype}))}))},e.prototype.mapInputs=function(e){var t={};for(var n in e)null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n]?t[this._signature.inputs[n].name]=e[n]:t[n]=e[n];return t},e.prototype.checkInputs=function(e){var t=this,n=Object.keys(e).filter((function(e){var n=mL(e)[0];return null==t.graph.nodes[n]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has keys: ["+n+"] that are not part of graph")},e.prototype.mapOutputs=function(e){var t=this;return e.map((function(e){return null!=t._signature&&null!=t._signature.outputs&&null!=t._signature.outputs[e]?t._signature.outputs[e].name:e}),{})},e.prototype.checkOutputs=function(e){var t=this;e.forEach((function(e){var n=mL(e)[0];if(!t.graph.nodes[n])throw new Error("The output '"+e+"' is not found in the graph")}))},e}(),aB=function(){function e(e,t){void 0===t&&(t={}),this.modelUrl=e,this.loadOptions=t,this.version="n/a",null==t&&(this.loadOptions={})}return Object.defineProperty(e.prototype,"modelVersion",{get:function(){return this.version},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputNodes",{get:function(){return this.executor.inputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputNodes",{get:function(){return this.executor.outputNodes},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inputs",{get:function(){return this.executor.inputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"outputs",{get:function(){return this.executor.outputs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"weights",{get:function(){return this.executor.weightMap},enumerable:!0,configurable:!0}),e.prototype.findIOHandler=function(){var e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=GP.browserHTTPRequest(e,this.loadOptions);else{var t=GP.getLoadHandlers(e,this.loadOptions.onProgress);if(0===t.length)t.push(GP.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one ("+t.length+") load handlers for URL '"+[e]+"'");this.handler=t[0]}},e.prototype.load=function(){return uL(this,void 0,void 0,(function(){var e,t,n,r;return cL(this,(function(a){switch(a.label){case 0:if(this.findIOHandler(),null==this.handler.load)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");return e=this,[4,this.handler.load()];case 1:return e.artifacts=a.sent(),t=this.artifacts.modelTopology,n={},null!=this.artifacts.userDefinedMetadata&&(n=this.artifacts.userDefinedMetadata.signature),this.version=t.versions.producer+"."+t.versions.minConsumer,r=GP.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs),this.executor=new rB(ML.Instance.transformGraph(t,n)),this.executor.weightMap=this.convertTensorMapToTensorsMap(r),[2,!0]}}))}))},e.prototype.save=function(e,t){return uL(this,void 0,void 0,(function(){var t;return cL(this,(function(n){if("string"==typeof e){if(0===(t=GP.getSaveHandlers(e)).length)throw new Error("Cannot find any save handlers for URL '"+e+"'");if(t.length>1)throw new Error("Found more than one ("+t.length+") save handlers for URL '"+e+"'");e=t[0]}if(null==e.save)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return[2,e.save(this.artifacts)]}))}))},e.prototype.predict=function(e,t){return this.execute(e,this.outputNodes)},e.prototype.normalizeInputs=function(e){if(!(e instanceof YS||Array.isArray(e)))return e;if((e=Array.isArray(e)?e:[e]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,the graph model has "+this.inputNodes.length+" placeholders, while there are "+e.length+" input tensors.");return this.inputNodes.reduce((function(t,n,r){return t[n]=e[r],t}),{})},e.prototype.normalizeOutputs=function(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]},e.prototype.execute=function(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);var n=this.executor.execute(e,t);return n.length>1?n:n[0]},e.prototype.executeAsync=function(e,t){return uL(this,void 0,void 0,(function(){var n;return cL(this,(function(r){switch(r.label){case 0:return e=this.normalizeInputs(e),t=this.normalizeOutputs(t),[4,this.executor.executeAsync(e,t)];case 1:return[2,(n=r.sent()).length>1?n:n[0]]}}))}))},e.prototype.convertTensorMapToTensorsMap=function(e){return Object.keys(e).reduce((function(t,n){return t[n]=[e[n]],t}),{})},e.prototype.dispose=function(){this.executor.dispose()},e}();function iB(e,t){return void 0===t&&(t={}),uL(this,void 0,void 0,(function(){var n;return cL(this,(function(r){switch(r.label){case 0:if(null==e)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");return null==t&&(t={}),t.fromTFHub&&null==e.load&&(e.endsWith("/")||(e+="/"),e+="model.json?tfjs-format=file"),[4,(n=new aB(e,t)).load()];case 1:return r.sent(),[2,n]}}))}))}function oB(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function sB(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function uB(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{u(r.next(e))}catch(e){i(e)}}function s(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){e.done?a(e.value):new n((function(t){t(e.value)})).then(o,s)}u((r=r.apply(e,t||[])).next())}))}function cB(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var lB=function(e){for(var t=[],n=0,r=e;n<r.length;n++){var a=r[n];t.push(a)}return t},fB=function(){this.parent=null,this.children={},this.end=!1,this.word=[[],0,0]},hB=function(){function e(){this.root=new fB}return e.prototype.insert=function(e,t,n){for(var r=this.root,a=lB(e),i=0;i<a.length;i++)r.children[a[i]]||(r.children[a[i]]=new fB,r.children[a[i]].parent=r,r.children[a[i]].word[0]=r.word[0].concat(a[i])),r=r.children[a[i]],i===a.length-1&&(r.end=!0,r.word[1]=t,r.word[2]=n)},e.prototype.commonPrefixSearch=function(e){for(var t=[],n=this.root.children[e[0]],r=0;r<e.length&&n;r++)n.end&&t.push(n.word),n=n.children[e[r+1]];return t.length||t.push([[e[0]],0,0]),t},e}();var pB=function(){function e(e){this.vocabulary=e,this.trie=new hB;for(var t=6;t<this.vocabulary.length;t++)this.trie.insert(this.vocabulary[t][0],this.vocabulary[t][1],t)}return e.prototype.encode=function(e){var t=[],n=[],r=[];e=function(e){return"\u2581"+e.normalize("NFKC").replace(/ /g,"\u2581")}(e);for(var a=lB(e),i=0;i<=a.length;i++)t.push({}),n.push(0),r.push(0);for(i=0;i<a.length;i++)for(var o=this.trie.commonPrefixSearch(a.slice(i)),s=0;s<o.length;s++){var u=o[s],c={key:u[0],score:u[1],index:u[2]};null==t[i+(l=u[0].length)][i]&&(t[i+l][i]=[]),t[i+l][i].push(c)}for(var l=0;l<=a.length;l++)for(var f in t[l]){var h=t[l][f];for(s=0;s<h.length;s++){var p=h[s],d=p.score+r[l-p.key.length];(0===r[l]||d>=r[l])&&(r[l]=d,n[l]=h[s].index)}}for(var v=[],m=n.length-1;m>0;)v.push(n[m]),m-=this.vocabulary[n[m]][0].length;var y=[],g=!1;for(i=0;i<v.length;i++){var b=v[i];g&&0===b||y.push(b),g=0===b}return y.reverse()},e}();function dB(e){return uB(this,void 0,void 0,(function(){var t;return cB(this,(function(n){switch(n.label){case 0:return[4,vB(e)];case 1:return t=n.sent(),[2,new pB(t)]}}))}))}function vB(e){return void 0===e&&(e="https://storage.googleapis.com/tfjs-models/savedmodel/universal_sentence_encoder/vocab.json"),uB(this,void 0,void 0,(function(){return cB(this,(function(t){switch(t.label){case 0:return[4,US.fetch(e)];case 1:return[2,t.sent().json()]}}))}))}function mB(e,t){return oB(this,void 0,void 0,(function(){var n;return sB(this,(function(r){switch(r.label){case 0:return[4,(n=new yB(e,t)).load()];case 1:return r.sent(),[2,n]}}))}))}var yB=function(){function e(e,t){void 0===e&&(e=.85),void 0===t&&(t=[]),this.threshold=e,this.toxicityLabels=t}return e.prototype.loadModel=function(){return oB(this,void 0,void 0,(function(){return sB(this,(function(e){return[2,iB("https://tfhub.dev/tensorflow/tfjs-model/toxicity/1/default/1",{fromTFHub:!0})]}))}))},e.prototype.loadTokenizer=function(){return oB(this,void 0,void 0,(function(){return sB(this,(function(e){return[2,dB()]}))}))},e.prototype.load=function(){return oB(this,void 0,void 0,(function(){var e,t,n,r=this;return sB(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.loadModel(),this.loadTokenizer()])];case 1:return e=a.sent(),t=e[0],n=e[1],this.model=t,this.tokenizer=n,this.labels=t.outputs.map((function(e){return e.name.split("/")[0]})),0===this.toxicityLabels.length?this.toxicityLabels=this.labels:US.assert(this.toxicityLabels.every((function(e){return r.labels.indexOf(e)>-1})),(function(){return"toxicityLabels argument must contain only items from the model heads "+r.labels.join(", ")+", got "+r.toxicityLabels.join(", ")})),[2]}}))}))},e.prototype.classify=function(e){return oB(this,void 0,void 0,(function(){var t,n,r,a,i,o,s,u=this;return sB(this,(function(c){switch(c.label){case 0:for("string"==typeof e&&(e=[e]),t=e.map((function(e){return u.tokenizer.encode(e)})),n=t.map((function(e,t){return e.map((function(e,n){return[t,n]}))})),r=[],a=0;a<n.length;a++)r=r.concat(n[a]);return i=GI(r,[r.length,2],"int32"),o=jI(US.flatten(t),"int32"),[4,this.model.executeAsync({Placeholder_1:i,Placeholder:o})];case 1:return s=c.sent(),i.dispose(),o.dispose(),[2,s.map((function(e,t){return{data:e,headIndex:t}})).filter((function(e){return u.toxicityLabels.indexOf(u.labels[e.headIndex])>-1})).map((function(t){for(var n=t.data.dataSync(),r=[],a=0;a<e.length;a++){var i=n.slice(2*a,2*a+2),o=null;Math.max(i[0],i[1])>u.threshold&&(o=i[0]<i[1]),r.push({probabilities:i,match:o})}return{label:u.labels[t.headIndex],results:r}}))]}}))}))},e}();var gB=function(t){var n=t.scroll,r=o((0,e.useState)(""),2),a=r[0],i=r[1],s=o((0,e.useState)(null),2),u=s[0],c=s[1],l=function(){var e=x(g().mark((function e(t){var r,o,s,c,l,f,h;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),r=1e4,o=Ey.currentUser,s=o.uid,c=o.photoURL,l=o.displayName,e.next=5,u.classify(a);case 5:for(f=e.sent,h=0;h<f.length-1;h++)r-=Math.round(9e3*parseFloat(f[h].results[0].probabilities[1]));return r/=1e4,(r-=Math.floor(5*Math.random())/100)<0&&(r=Math.floor(5*Math.random())/100),r<.1&&alert("Please be advised that your comment may subject to further toxicity detection."),console.log(r),e.next=14,gy(Rm(ky,"chats"),{uid:s,photoURL:c,displayName:l,message:a,healthiness:r,timestamp:Kc.now()});case 14:i(""),n.current.scrollIntoView({behavior:"smooth"});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return(0,e.useEffect)((function(){var e=function(){var e=x(g().mark((function e(){var t;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Please be patient as the model is loading..."),.9,e.next=4,mB(.9);case 4:t=e.sent,c(t),console.log("The model has been successfully loaded.");case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),(0,vk.jsx)(vk.Fragment,{children:(0,vk.jsx)("form",{onSubmit:l,children:(0,vk.jsxs)("div",{className:"sendChat",children:[u?(0,vk.jsx)(FE,{style:{width:"78%",fontSize:"18px",fontWeight:"550",marginLeft:"5px",marginBottom:"-3px"},value:a,onChange:function(e){return i(e.target.value)},placeholder:"Say Something..."}):(0,vk.jsx)(FE,{style:{width:"78%",fontSize:"18px",fontWeight:"550",marginLeft:"5px",marginBottom:"-3px"},value:a,onChange:function(e){return i(e.target.value)},placeholder:"Please wait as the model is loading...",disabled:!0}),(0,vk.jsx)(nE,{style:{width:"18%",fontSize:"18px",fontWeight:"550",margin:"4px 5% -13px 5%",maxWidth:"200px"},type:"submit",children:"Send"})]})})})},bB=function(e,t,n){var r,a,i;if(t){var o=function(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e},s=n<.5?n*(1+t):n+t-n*t,u=2*n-s;r=o(u,s,e+1/3),a=o(u,s,e),i=o(u,s,e-1/3)}else r=a=i=n;return[Math.round(255*r),Math.round(255*a),Math.round(255*i)]},xB=function(e,t){var n=e.getTime()-t.getTime(),r=Math.floor(n/1e3/60/60/24/365);if(r)return 1===r?"1 year":r.toString()+" years";n-=1e3*r*60*60*24*365;var a=Math.floor(n/1e3/60/60/24/7);if(a)return 1===a?"1 week":a.toString()+" weeks";n-=1e3*a*60*60*24*7;var i=Math.floor(n/1e3/60/60/24);if(i)return 1===i?"1 day":i.toString()+" days";n-=1e3*i*60*60*24;var o=Math.floor(n/1e3/60/60);if(o)return 1===o?"1 hour":o.toString()+" hours";n-=1e3*o*60*60;var s=Math.floor(n/1e3/60);if(s)return s.toString()+" min";n-=1e3*s*60;var u=Math.floor(n/1e3);return u?u.toString()+" sec":"just now"},wB=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=e;(t>0||n<1)&&(r=e<t?0:e>n?1:(e-t)/(n-t));var a=1.2*r/3.6,i=bB(a,1,.5);return"rgb("+i[0]+","+i[1]+","+i[2]+")"};var kB=function(t){var n=t.chat,r=n.uid,a=n.photoURL,i=n.displayName,s=n.message,u=n.healthiness,c=n.timestamp,l=o((0,e.useState)(!1),2),f=l[0],h=l[1];return(0,vk.jsx)("div",{children:(0,vk.jsxs)("div",{className:"chat ".concat(r===Ey.currentUser.uid?"sent":"received"),children:[(0,vk.jsxs)("div",{children:[(0,vk.jsx)("img",{style:{marginLeft:"auto"},src:a,alt:"profile",loading:"lazy",decoding:"async"}),r!==Ey.currentUser.uid&&(0,vk.jsx)("small",{style:{color:"grey",display:"block",textAlign:"center"},children:i.length>10?i.substring(0,10)+".":i}),(0,vk.jsx)("small",{style:{color:"grey",display:"block",fontSize:"10px",textAlign:"center"},children:xB(new Date(Date.now()),new Date(1e3*c.seconds))})]}),(0,vk.jsx)("div",{onClick:function(e){return function(e){2!==e.detail||u>.1||h((function(e){return!e}))}(e)},children:u>.1||f?(0,vk.jsxs)("p",{children:[" ",s," "]}):(0,vk.jsx)("p",{style:{color:"red"},children:" This message might be toxic. Double click to toggle view. "})}),(0,vk.jsx)("div",{children:(0,vk.jsxs)("p",{style:{color:"white",backgroundColor:wB(u),padding:"10px",fontSize:"12px",fontWeight:"bold",marginTop:"0px",borderRadius:"20px"},children:[" ",u>.1?"H":"T"," "]})})]},Math.random())})};var EB=function(){var t=o((0,e.useState)([]),2),n=t[0],r=t[1],a=(0,e.useRef)();return(0,e.useEffect)((function(){var e=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0,i=n;a<i.length;a++){e=i[a]._apply(e)}return e}(Rm(ky,"chats"),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=ay("orderBy",e);return new hy(n,t)}("timestamp"),function(e){return Sm("limit",e),new py("limit",e,"F")}(50));!function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a,i,o;e=$(e);var s={includeMetadataChanges:!1},u=0;"object"!=typeof n[u]||Dm(n[u])||(s=n[u],u++);var c,l,f,h={includeMetadataChanges:s.includeMetadataChanges};if(Dm(n[u])){var p=n[u];n[u]=null===(a=p.next)||void 0===a?void 0:a.bind(p),n[u+1]=null===(i=p.error)||void 0===i?void 0:i.bind(p),n[u+2]=null===(o=p.complete)||void 0===o?void 0:o.bind(p)}if(e instanceof Tm)l=Em(e.firestore,Om),f=xf(e._key.path),c={next:function(t){n[u]&&n[u](xy(l,e,t))},error:n[u+1],complete:n[u+2]};else{var d=Em(e,Nm);l=Em(d.firestore,Om),f=d._query;var v=new yy(l);c={next:function(e){n[u]&&n[u](new uy(l,v,d,e))},error:n[u+1],complete:n[u+2]},ly(e._query)}(function(e,t,n,r){var a=new im(r),i=new bv(t,a,n);e.asyncQueue.enqueueAndForget(x(g().mark((function t(){return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=dv,t.next=3,mm(e);case 3:return t.t1=t.sent,t.t2=i,t.abrupt("return",(0,t.t0)(t.t1,t.t2));case 6:case"end":return t.stop()}}),t)}))))})(Mm(l),f,h,c)}(e,(function(e){r(e.docs.map((function(e){return e.data()})))}))}),[]),(0,vk.jsxs)(vk.Fragment,{children:[(0,vk.jsx)(aE,{}),(0,vk.jsx)("div",{className:"chats",children:n.map((function(e){return(0,vk.jsx)(kB,{chat:e})}))}),(0,vk.jsx)(gB,{scroll:a}),(0,vk.jsx)("div",{ref:a})]})};var SB=function(){var e=o(si(Ey),3),t=e[0];return e[1],e[2],(0,vk.jsx)("div",{className:"App",children:(0,vk.jsx)(vk.Fragment,{children:t?(0,vk.jsx)(EB,{}):(0,vk.jsx)(rE,{})})})},CB=function(e){e&&e instanceof Function&&n.e(787).then(n.bind(n,787)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),i(e),o(e)}))};r.createRoot(document.getElementById("root")).render((0,vk.jsx)(e.StrictMode,{children:(0,vk.jsx)(SB,{})})),CB()}()}();
//# sourceMappingURL=main.f73f60ac.js.map